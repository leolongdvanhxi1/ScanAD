<!DOCTYPE html>
<!-- saved from url=(0064)https://www.pingcastle.com/PingCastleFiles/ad_hc_rules_list.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="PingCastle report">
    <meta name="author" content="PingCastle">

<meta http-equiv="Content-Security-Policy" content="default-src &#39;self&#39;; script-src &#39;sha256-t+xSDjAl7us/fSDwXMOUEX9O//OSNHhrky8hNs6bz6Q=&#39; &#39;sha256-h+34cx/xpluAJ76qVjjni3os1cv0h5VLSGEvWSmjkYs=&#39; &#39;sha256-CH0uenxDr8JF+9hdg3C0QTuYiyd0NwAiTG/x52M3PCk=&#39; &#39;sha256-2p+csRyNakdkpVpD/radLwmuQZvpIY5bmkCQr5KMqq8=&#39; &#39;sha256-9PQp/VAjiv1cnX5UR+yatxeJroTsH248dc+N6gXqRFc=&#39;  &#39;unsafe-inline&#39;; style-src &#39;sha256-E9PYAbZ2xRLgOf3rB5f6VpHnWkNn/h/OgqRUt5xwYrA=&#39; &#39;sha256-lox79Yfn7OPDiZBy8kM6/sn3tmULLHsY/fz8/1jhU+A=&#39; &#39;sha256-hchCDOIoMpqFdP02Dnr/5awf5iNkPAgwUN5eoZIA20c=&#39; &#39;sha256-DuiulLPU1G3hqZy7yDW/R6ckOsh3l8NggGHHTu8yuis=&#39;  &#39;unsafe-inline&#39;; object-src &#39;none&#39;; base-uri https://www.pingcastle.com ; img-src data: https://www.pingcastle.com;">
<title>PingCastle Health Check rules - 2023-07-26</title><link href="data:image/x-icon;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAE10lEQVRYw71XfWwTdRhet4xBssFigMja61rafbK5bGFuiqh1ISaMP2QI++jaXtvUZGKIigUkUTTzmwUxIQtRYBZHr3e9rjYOY4zLlprMEDROJagZAzEgMYiTZJvr7zrmc0cHXekXxfWSJ9f2rvc8977P+76/X0YGDsKubiSuwh2ELy8SfPVZGek+QG4hTjkhDPUrPh8grOYJwhXlCV9tSZMAdnUDBEwRZ8HsTcivE0bxJQR1QEyJ0L8+e2EFcEWlhJFfuS3gFoIQcpG4VMcRmUbcd58wqJeJ/2FYfhGwDegG9gKrUhfAly4H0UgUAWGQTyAiw8Sl3kv6qpaDcDMwDswCQaCH5fqWpCRA8D2YQ1zK/vgCQnCprgv9j9aD8FCIfA4XAGVqAj7fIBrxg6QEMIop4i7ZADI7IIQJ8AP5qaeBobYnJ0D5O6LwsIvzrADhQWAUGHJxfEOA1TwE09LEU6EUPnsk8y4rQfO0VIqxyW+IHgh4KnVWs6HaaDI/85J9t+Z4r1Pl599ZSbjiRlz/Ec8QcD4rRdRdrCOcNlcYaE6mErS1qITxGAYkeKDzam9VsdlibWptaz8DCPp2488Wq20H8daUg/TCndGS/wN8IUWXK9YSvix2k4NaCvkdi0I+DvJ9gwcbKIOR3gXiqy2t+tk5QITvoqNODZLRONELSs9mqI/wohshJl8YbJPNF+BZk4sb/BGGOw/y1lefb1WD6DDIp8LJQwK+P9bZrIQ3hpLykFTOiq/x3F1o/QW3K+GkLhPqGgir3omS9OOmoQCrXW+hjTVtesMAyIKR5CJw7fL2DlsZxDuSEyAhAAE9SIk8I9TVZHC1Fmc9zrpL7k3yPx1rCvTthkYx39GI54Drk7TZCrNp3k2uiqSUvoJSXnbr7UG6FuQjoY4mdrcXOp59biXe7nQ88hBm4A0TBJgR3pkE5KOYO83EW50zL/8gfDuiq/105NjHFPL7aRICZlGSL2NOPCblNzr5jJhSvHmtwFfI7qgAEL4ZIWDkaI8DKTAyILiRSEC7weSYYCtLQHI5Cvk0DNoDbxXic/QSBGEF8A0wDVwBbKc+sS2maVpsOJ1IxQiIpmMJgFC//9CTqATFdxGO/xu/7YG5l8VtQvCAKKKAdfdtQkutHufqNchVN1S/9i+jrurc2aI0muitIDoBwkuRUYHAM512Won7D4DwN8kLDDWGkG8F+aK7XB2pWvCAb6W8ie3XiXUCo2Dxu/7c0ZpCq9n0AEJuB+mwWAHAWXx/an/X+3l+91v3T/Loii7Vi3B5vdD/eGYKqyP1nhhGQi4VPyAyXeLQ+XBfE2WizRtNtEWsoHWAFzgNvM5xHDqdPuXl2ZbEQ0l+DSE+Cedv7uOZfJAOhBk4AFjuZX24VjJPUouTQqfXfUIFwvMRVdR1L+tDcSidS66rUcNjfNsqELrDyCdg6m2pC3CX5krDIvFQgSeobuKpXIq1YBmI3wN6ARoClqQsQPDVZUFAbwLyvzCwdmOEL537H0pYxvHeLAj4XzYq++P0c2xeVE2o7+wF3KiobaE+ENHPqUFcq8Ucly3wVk2lQ5gn5/UAp/ywaNDgKXsatmpckThY/gitiq5J+Xap8tK3WeXLb+6UGMUvWC03EV9ddkY6D2y9cpDrN9CU1kHAgub7P7CsZhuj7eUMAAAAAElFTkSuQmCC" rel="icon" type="image/x-icon"><style type="text/css">
@charset "UTF-8";/*!
 * Bootstrap v5.1.3 (https://getbootstrap.com/)
 * Copyright 2011-2021 The Bootstrap Authors
 * Copyright 2011-2021 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
 */:root{--bs-blue:#0d6efd;--bs-indigo:#6610f2;--bs-purple:#6f42c1;--bs-pink:#d63384;--bs-red:#dc3545;--bs-orange:#fd7e14;--bs-yellow:#ffc107;--bs-green:#198754;--bs-teal:#20c997;--bs-cyan:#0dcaf0;--bs-white:#fff;--bs-gray:#6c757d;--bs-gray-dark:#343a40;--bs-gray-100:#f8f9fa;--bs-gray-200:#e9ecef;--bs-gray-300:#dee2e6;--bs-gray-400:#ced4da;--bs-gray-500:#adb5bd;--bs-gray-600:#6c757d;--bs-gray-700:#495057;--bs-gray-800:#343a40;--bs-gray-900:#212529;--bs-primary:#0d6efd;--bs-secondary:#6c757d;--bs-success:#198754;--bs-info:#0dcaf0;--bs-warning:#ffc107;--bs-danger:#dc3545;--bs-light:#f8f9fa;--bs-dark:#212529;--bs-primary-rgb:13,110,253;--bs-secondary-rgb:108,117,125;--bs-success-rgb:25,135,84;--bs-info-rgb:13,202,240;--bs-warning-rgb:255,193,7;--bs-danger-rgb:220,53,69;--bs-light-rgb:248,249,250;--bs-dark-rgb:33,37,41;--bs-white-rgb:255,255,255;--bs-black-rgb:0,0,0;--bs-body-color-rgb:33,37,41;--bs-body-bg-rgb:255,255,255;--bs-font-sans-serif:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--bs-font-monospace:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;--bs-gradient:linear-gradient(180deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0));--bs-body-font-family:var(--bs-font-sans-serif);--bs-body-font-size:1rem;--bs-body-font-weight:400;--bs-body-line-height:1.5;--bs-body-color:#212529;--bs-body-bg:#fff}*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:var(--bs-body-font-family);font-size:var(--bs-body-font-size);font-weight:var(--bs-body-font-weight);line-height:var(--bs-body-line-height);color:var(--bs-body-color);text-align:var(--bs-body-text-align);background-color:var(--bs-body-bg);-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}.h1,.h2,.h3,.h4,.h5,.h6,h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}.h1,h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){.h1,h1{font-size:2.5rem}}.h2,h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){.h2,h2{font-size:2rem}}.h3,h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){.h3,h3{font-size:1.75rem}}.h4,h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){.h4,h4{font-size:1.5rem}}.h5,h5{font-size:1.25rem}.h6,h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}.small,small{font-size:.875em}.mark,mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:var(--bs-font-monospace);font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::-webkit-file-upload-button{font:inherit}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}.lead{font-size:1.25rem;font-weight:300}.display-1{font-size:calc(1.625rem + 4.5vw);font-weight:300;line-height:1.2}@media (min-width:1200px){.display-1{font-size:5rem}}.display-2{font-size:calc(1.575rem + 3.9vw);font-weight:300;line-height:1.2}@media (min-width:1200px){.display-2{font-size:4.5rem}}.display-3{font-size:calc(1.525rem + 3.3vw);font-weight:300;line-height:1.2}@media (min-width:1200px){.display-3{font-size:4rem}}.display-4{font-size:calc(1.475rem + 2.7vw);font-weight:300;line-height:1.2}@media (min-width:1200px){.display-4{font-size:3.5rem}}.display-5{font-size:calc(1.425rem + 2.1vw);font-weight:300;line-height:1.2}@media (min-width:1200px){.display-5{font-size:3rem}}.display-6{font-size:calc(1.375rem + 1.5vw);font-weight:300;line-height:1.2}@media (min-width:1200px){.display-6{font-size:2.5rem}}.list-unstyled{padding-left:0;list-style:none}.list-inline{padding-left:0;list-style:none}.list-inline-item{display:inline-block}.list-inline-item:not(:last-child){margin-right:.5rem}.initialism{font-size:.875em;text-transform:uppercase}.blockquote{margin-bottom:1rem;font-size:1.25rem}.blockquote>:last-child{margin-bottom:0}.blockquote-footer{margin-top:-1rem;margin-bottom:1rem;font-size:.875em;color:#6c757d}.blockquote-footer::before{content:"— "}.img-fluid{max-width:100%;height:auto}.img-thumbnail{padding:.25rem;background-color:#fff;border:1px solid #dee2e6;border-radius:.25rem;max-width:100%;height:auto}.figure{display:inline-block}.figure-img{margin-bottom:.5rem;line-height:1}.figure-caption{font-size:.875em;color:#6c757d}.container,.container-fluid,.container-lg,.container-md,.container-sm,.container-xl,.container-xxl{width:100%;padding-right:var(--bs-gutter-x,.75rem);padding-left:var(--bs-gutter-x,.75rem);margin-right:auto;margin-left:auto}@media (min-width:576px){.container,.container-sm{max-width:540px}}@media (min-width:768px){.container,.container-md,.container-sm{max-width:720px}}@media (min-width:992px){.container,.container-lg,.container-md,.container-sm{max-width:960px}}@media (min-width:1200px){.container,.container-lg,.container-md,.container-sm,.container-xl{max-width:1140px}}@media (min-width:1400px){.container,.container-lg,.container-md,.container-sm,.container-xl,.container-xxl{max-width:1320px}}.row{--bs-gutter-x:1.5rem;--bs-gutter-y:0;display:flex;flex-wrap:wrap;margin-top:calc(-1 * var(--bs-gutter-y));margin-right:calc(-.5 * var(--bs-gutter-x));margin-left:calc(-.5 * var(--bs-gutter-x))}.row>*{flex-shrink:0;width:100%;max-width:100%;padding-right:calc(var(--bs-gutter-x) * .5);padding-left:calc(var(--bs-gutter-x) * .5);margin-top:var(--bs-gutter-y)}.col{flex:1 0 0%}.row-cols-auto>*{flex:0 0 auto;width:auto}.row-cols-1>*{flex:0 0 auto;width:100%}.row-cols-2>*{flex:0 0 auto;width:50%}.row-cols-3>*{flex:0 0 auto;width:33.3333333333%}.row-cols-4>*{flex:0 0 auto;width:25%}.row-cols-5>*{flex:0 0 auto;width:20%}.row-cols-6>*{flex:0 0 auto;width:16.6666666667%}.col-auto{flex:0 0 auto;width:auto}.col-1{flex:0 0 auto;width:8.33333333%}.col-2{flex:0 0 auto;width:16.66666667%}.col-3{flex:0 0 auto;width:25%}.col-4{flex:0 0 auto;width:33.33333333%}.col-5{flex:0 0 auto;width:41.66666667%}.col-6{flex:0 0 auto;width:50%}.col-7{flex:0 0 auto;width:58.33333333%}.col-8{flex:0 0 auto;width:66.66666667%}.col-9{flex:0 0 auto;width:75%}.col-10{flex:0 0 auto;width:83.33333333%}.col-11{flex:0 0 auto;width:91.66666667%}.col-12{flex:0 0 auto;width:100%}.offset-1{margin-left:8.33333333%}.offset-2{margin-left:16.66666667%}.offset-3{margin-left:25%}.offset-4{margin-left:33.33333333%}.offset-5{margin-left:41.66666667%}.offset-6{margin-left:50%}.offset-7{margin-left:58.33333333%}.offset-8{margin-left:66.66666667%}.offset-9{margin-left:75%}.offset-10{margin-left:83.33333333%}.offset-11{margin-left:91.66666667%}.g-0,.gx-0{--bs-gutter-x:0}.g-0,.gy-0{--bs-gutter-y:0}.g-1,.gx-1{--bs-gutter-x:0.25rem}.g-1,.gy-1{--bs-gutter-y:0.25rem}.g-2,.gx-2{--bs-gutter-x:0.5rem}.g-2,.gy-2{--bs-gutter-y:0.5rem}.g-3,.gx-3{--bs-gutter-x:1rem}.g-3,.gy-3{--bs-gutter-y:1rem}.g-4,.gx-4{--bs-gutter-x:1.5rem}.g-4,.gy-4{--bs-gutter-y:1.5rem}.g-5,.gx-5{--bs-gutter-x:3rem}.g-5,.gy-5{--bs-gutter-y:3rem}@media (min-width:576px){.col-sm{flex:1 0 0%}.row-cols-sm-auto>*{flex:0 0 auto;width:auto}.row-cols-sm-1>*{flex:0 0 auto;width:100%}.row-cols-sm-2>*{flex:0 0 auto;width:50%}.row-cols-sm-3>*{flex:0 0 auto;width:33.3333333333%}.row-cols-sm-4>*{flex:0 0 auto;width:25%}.row-cols-sm-5>*{flex:0 0 auto;width:20%}.row-cols-sm-6>*{flex:0 0 auto;width:16.6666666667%}.col-sm-auto{flex:0 0 auto;width:auto}.col-sm-1{flex:0 0 auto;width:8.33333333%}.col-sm-2{flex:0 0 auto;width:16.66666667%}.col-sm-3{flex:0 0 auto;width:25%}.col-sm-4{flex:0 0 auto;width:33.33333333%}.col-sm-5{flex:0 0 auto;width:41.66666667%}.col-sm-6{flex:0 0 auto;width:50%}.col-sm-7{flex:0 0 auto;width:58.33333333%}.col-sm-8{flex:0 0 auto;width:66.66666667%}.col-sm-9{flex:0 0 auto;width:75%}.col-sm-10{flex:0 0 auto;width:83.33333333%}.col-sm-11{flex:0 0 auto;width:91.66666667%}.col-sm-12{flex:0 0 auto;width:100%}.offset-sm-0{margin-left:0}.offset-sm-1{margin-left:8.33333333%}.offset-sm-2{margin-left:16.66666667%}.offset-sm-3{margin-left:25%}.offset-sm-4{margin-left:33.33333333%}.offset-sm-5{margin-left:41.66666667%}.offset-sm-6{margin-left:50%}.offset-sm-7{margin-left:58.33333333%}.offset-sm-8{margin-left:66.66666667%}.offset-sm-9{margin-left:75%}.offset-sm-10{margin-left:83.33333333%}.offset-sm-11{margin-left:91.66666667%}.g-sm-0,.gx-sm-0{--bs-gutter-x:0}.g-sm-0,.gy-sm-0{--bs-gutter-y:0}.g-sm-1,.gx-sm-1{--bs-gutter-x:0.25rem}.g-sm-1,.gy-sm-1{--bs-gutter-y:0.25rem}.g-sm-2,.gx-sm-2{--bs-gutter-x:0.5rem}.g-sm-2,.gy-sm-2{--bs-gutter-y:0.5rem}.g-sm-3,.gx-sm-3{--bs-gutter-x:1rem}.g-sm-3,.gy-sm-3{--bs-gutter-y:1rem}.g-sm-4,.gx-sm-4{--bs-gutter-x:1.5rem}.g-sm-4,.gy-sm-4{--bs-gutter-y:1.5rem}.g-sm-5,.gx-sm-5{--bs-gutter-x:3rem}.g-sm-5,.gy-sm-5{--bs-gutter-y:3rem}}@media (min-width:768px){.col-md{flex:1 0 0%}.row-cols-md-auto>*{flex:0 0 auto;width:auto}.row-cols-md-1>*{flex:0 0 auto;width:100%}.row-cols-md-2>*{flex:0 0 auto;width:50%}.row-cols-md-3>*{flex:0 0 auto;width:33.3333333333%}.row-cols-md-4>*{flex:0 0 auto;width:25%}.row-cols-md-5>*{flex:0 0 auto;width:20%}.row-cols-md-6>*{flex:0 0 auto;width:16.6666666667%}.col-md-auto{flex:0 0 auto;width:auto}.col-md-1{flex:0 0 auto;width:8.33333333%}.col-md-2{flex:0 0 auto;width:16.66666667%}.col-md-3{flex:0 0 auto;width:25%}.col-md-4{flex:0 0 auto;width:33.33333333%}.col-md-5{flex:0 0 auto;width:41.66666667%}.col-md-6{flex:0 0 auto;width:50%}.col-md-7{flex:0 0 auto;width:58.33333333%}.col-md-8{flex:0 0 auto;width:66.66666667%}.col-md-9{flex:0 0 auto;width:75%}.col-md-10{flex:0 0 auto;width:83.33333333%}.col-md-11{flex:0 0 auto;width:91.66666667%}.col-md-12{flex:0 0 auto;width:100%}.offset-md-0{margin-left:0}.offset-md-1{margin-left:8.33333333%}.offset-md-2{margin-left:16.66666667%}.offset-md-3{margin-left:25%}.offset-md-4{margin-left:33.33333333%}.offset-md-5{margin-left:41.66666667%}.offset-md-6{margin-left:50%}.offset-md-7{margin-left:58.33333333%}.offset-md-8{margin-left:66.66666667%}.offset-md-9{margin-left:75%}.offset-md-10{margin-left:83.33333333%}.offset-md-11{margin-left:91.66666667%}.g-md-0,.gx-md-0{--bs-gutter-x:0}.g-md-0,.gy-md-0{--bs-gutter-y:0}.g-md-1,.gx-md-1{--bs-gutter-x:0.25rem}.g-md-1,.gy-md-1{--bs-gutter-y:0.25rem}.g-md-2,.gx-md-2{--bs-gutter-x:0.5rem}.g-md-2,.gy-md-2{--bs-gutter-y:0.5rem}.g-md-3,.gx-md-3{--bs-gutter-x:1rem}.g-md-3,.gy-md-3{--bs-gutter-y:1rem}.g-md-4,.gx-md-4{--bs-gutter-x:1.5rem}.g-md-4,.gy-md-4{--bs-gutter-y:1.5rem}.g-md-5,.gx-md-5{--bs-gutter-x:3rem}.g-md-5,.gy-md-5{--bs-gutter-y:3rem}}@media (min-width:992px){.col-lg{flex:1 0 0%}.row-cols-lg-auto>*{flex:0 0 auto;width:auto}.row-cols-lg-1>*{flex:0 0 auto;width:100%}.row-cols-lg-2>*{flex:0 0 auto;width:50%}.row-cols-lg-3>*{flex:0 0 auto;width:33.3333333333%}.row-cols-lg-4>*{flex:0 0 auto;width:25%}.row-cols-lg-5>*{flex:0 0 auto;width:20%}.row-cols-lg-6>*{flex:0 0 auto;width:16.6666666667%}.col-lg-auto{flex:0 0 auto;width:auto}.col-lg-1{flex:0 0 auto;width:8.33333333%}.col-lg-2{flex:0 0 auto;width:16.66666667%}.col-lg-3{flex:0 0 auto;width:25%}.col-lg-4{flex:0 0 auto;width:33.33333333%}.col-lg-5{flex:0 0 auto;width:41.66666667%}.col-lg-6{flex:0 0 auto;width:50%}.col-lg-7{flex:0 0 auto;width:58.33333333%}.col-lg-8{flex:0 0 auto;width:66.66666667%}.col-lg-9{flex:0 0 auto;width:75%}.col-lg-10{flex:0 0 auto;width:83.33333333%}.col-lg-11{flex:0 0 auto;width:91.66666667%}.col-lg-12{flex:0 0 auto;width:100%}.offset-lg-0{margin-left:0}.offset-lg-1{margin-left:8.33333333%}.offset-lg-2{margin-left:16.66666667%}.offset-lg-3{margin-left:25%}.offset-lg-4{margin-left:33.33333333%}.offset-lg-5{margin-left:41.66666667%}.offset-lg-6{margin-left:50%}.offset-lg-7{margin-left:58.33333333%}.offset-lg-8{margin-left:66.66666667%}.offset-lg-9{margin-left:75%}.offset-lg-10{margin-left:83.33333333%}.offset-lg-11{margin-left:91.66666667%}.g-lg-0,.gx-lg-0{--bs-gutter-x:0}.g-lg-0,.gy-lg-0{--bs-gutter-y:0}.g-lg-1,.gx-lg-1{--bs-gutter-x:0.25rem}.g-lg-1,.gy-lg-1{--bs-gutter-y:0.25rem}.g-lg-2,.gx-lg-2{--bs-gutter-x:0.5rem}.g-lg-2,.gy-lg-2{--bs-gutter-y:0.5rem}.g-lg-3,.gx-lg-3{--bs-gutter-x:1rem}.g-lg-3,.gy-lg-3{--bs-gutter-y:1rem}.g-lg-4,.gx-lg-4{--bs-gutter-x:1.5rem}.g-lg-4,.gy-lg-4{--bs-gutter-y:1.5rem}.g-lg-5,.gx-lg-5{--bs-gutter-x:3rem}.g-lg-5,.gy-lg-5{--bs-gutter-y:3rem}}@media (min-width:1200px){.col-xl{flex:1 0 0%}.row-cols-xl-auto>*{flex:0 0 auto;width:auto}.row-cols-xl-1>*{flex:0 0 auto;width:100%}.row-cols-xl-2>*{flex:0 0 auto;width:50%}.row-cols-xl-3>*{flex:0 0 auto;width:33.3333333333%}.row-cols-xl-4>*{flex:0 0 auto;width:25%}.row-cols-xl-5>*{flex:0 0 auto;width:20%}.row-cols-xl-6>*{flex:0 0 auto;width:16.6666666667%}.col-xl-auto{flex:0 0 auto;width:auto}.col-xl-1{flex:0 0 auto;width:8.33333333%}.col-xl-2{flex:0 0 auto;width:16.66666667%}.col-xl-3{flex:0 0 auto;width:25%}.col-xl-4{flex:0 0 auto;width:33.33333333%}.col-xl-5{flex:0 0 auto;width:41.66666667%}.col-xl-6{flex:0 0 auto;width:50%}.col-xl-7{flex:0 0 auto;width:58.33333333%}.col-xl-8{flex:0 0 auto;width:66.66666667%}.col-xl-9{flex:0 0 auto;width:75%}.col-xl-10{flex:0 0 auto;width:83.33333333%}.col-xl-11{flex:0 0 auto;width:91.66666667%}.col-xl-12{flex:0 0 auto;width:100%}.offset-xl-0{margin-left:0}.offset-xl-1{margin-left:8.33333333%}.offset-xl-2{margin-left:16.66666667%}.offset-xl-3{margin-left:25%}.offset-xl-4{margin-left:33.33333333%}.offset-xl-5{margin-left:41.66666667%}.offset-xl-6{margin-left:50%}.offset-xl-7{margin-left:58.33333333%}.offset-xl-8{margin-left:66.66666667%}.offset-xl-9{margin-left:75%}.offset-xl-10{margin-left:83.33333333%}.offset-xl-11{margin-left:91.66666667%}.g-xl-0,.gx-xl-0{--bs-gutter-x:0}.g-xl-0,.gy-xl-0{--bs-gutter-y:0}.g-xl-1,.gx-xl-1{--bs-gutter-x:0.25rem}.g-xl-1,.gy-xl-1{--bs-gutter-y:0.25rem}.g-xl-2,.gx-xl-2{--bs-gutter-x:0.5rem}.g-xl-2,.gy-xl-2{--bs-gutter-y:0.5rem}.g-xl-3,.gx-xl-3{--bs-gutter-x:1rem}.g-xl-3,.gy-xl-3{--bs-gutter-y:1rem}.g-xl-4,.gx-xl-4{--bs-gutter-x:1.5rem}.g-xl-4,.gy-xl-4{--bs-gutter-y:1.5rem}.g-xl-5,.gx-xl-5{--bs-gutter-x:3rem}.g-xl-5,.gy-xl-5{--bs-gutter-y:3rem}}@media (min-width:1400px){.col-xxl{flex:1 0 0%}.row-cols-xxl-auto>*{flex:0 0 auto;width:auto}.row-cols-xxl-1>*{flex:0 0 auto;width:100%}.row-cols-xxl-2>*{flex:0 0 auto;width:50%}.row-cols-xxl-3>*{flex:0 0 auto;width:33.3333333333%}.row-cols-xxl-4>*{flex:0 0 auto;width:25%}.row-cols-xxl-5>*{flex:0 0 auto;width:20%}.row-cols-xxl-6>*{flex:0 0 auto;width:16.6666666667%}.col-xxl-auto{flex:0 0 auto;width:auto}.col-xxl-1{flex:0 0 auto;width:8.33333333%}.col-xxl-2{flex:0 0 auto;width:16.66666667%}.col-xxl-3{flex:0 0 auto;width:25%}.col-xxl-4{flex:0 0 auto;width:33.33333333%}.col-xxl-5{flex:0 0 auto;width:41.66666667%}.col-xxl-6{flex:0 0 auto;width:50%}.col-xxl-7{flex:0 0 auto;width:58.33333333%}.col-xxl-8{flex:0 0 auto;width:66.66666667%}.col-xxl-9{flex:0 0 auto;width:75%}.col-xxl-10{flex:0 0 auto;width:83.33333333%}.col-xxl-11{flex:0 0 auto;width:91.66666667%}.col-xxl-12{flex:0 0 auto;width:100%}.offset-xxl-0{margin-left:0}.offset-xxl-1{margin-left:8.33333333%}.offset-xxl-2{margin-left:16.66666667%}.offset-xxl-3{margin-left:25%}.offset-xxl-4{margin-left:33.33333333%}.offset-xxl-5{margin-left:41.66666667%}.offset-xxl-6{margin-left:50%}.offset-xxl-7{margin-left:58.33333333%}.offset-xxl-8{margin-left:66.66666667%}.offset-xxl-9{margin-left:75%}.offset-xxl-10{margin-left:83.33333333%}.offset-xxl-11{margin-left:91.66666667%}.g-xxl-0,.gx-xxl-0{--bs-gutter-x:0}.g-xxl-0,.gy-xxl-0{--bs-gutter-y:0}.g-xxl-1,.gx-xxl-1{--bs-gutter-x:0.25rem}.g-xxl-1,.gy-xxl-1{--bs-gutter-y:0.25rem}.g-xxl-2,.gx-xxl-2{--bs-gutter-x:0.5rem}.g-xxl-2,.gy-xxl-2{--bs-gutter-y:0.5rem}.g-xxl-3,.gx-xxl-3{--bs-gutter-x:1rem}.g-xxl-3,.gy-xxl-3{--bs-gutter-y:1rem}.g-xxl-4,.gx-xxl-4{--bs-gutter-x:1.5rem}.g-xxl-4,.gy-xxl-4{--bs-gutter-y:1.5rem}.g-xxl-5,.gx-xxl-5{--bs-gutter-x:3rem}.g-xxl-5,.gy-xxl-5{--bs-gutter-y:3rem}}.table{--bs-table-bg:transparent;--bs-table-accent-bg:transparent;--bs-table-striped-color:#212529;--bs-table-striped-bg:rgba(0, 0, 0, 0.05);--bs-table-active-color:#212529;--bs-table-active-bg:rgba(0, 0, 0, 0.1);--bs-table-hover-color:#212529;--bs-table-hover-bg:rgba(0, 0, 0, 0.075);width:100%;margin-bottom:1rem;color:#212529;vertical-align:top;border-color:#dee2e6}.table>:not(caption)>*>*{padding:.5rem .5rem;background-color:var(--bs-table-bg);border-bottom-width:1px;box-shadow:inset 0 0 0 9999px var(--bs-table-accent-bg)}.table>tbody{vertical-align:inherit}.table>thead{vertical-align:bottom}.table>:not(:first-child){border-top:2px solid currentColor}.caption-top{caption-side:top}.table-sm>:not(caption)>*>*{padding:.25rem .25rem}.table-bordered>:not(caption)>*{border-width:1px 0}.table-bordered>:not(caption)>*>*{border-width:0 1px}.table-borderless>:not(caption)>*>*{border-bottom-width:0}.table-borderless>:not(:first-child){border-top-width:0}.table-striped>tbody>tr:nth-of-type(odd)>*{--bs-table-accent-bg:var(--bs-table-striped-bg);color:var(--bs-table-striped-color)}.table-active{--bs-table-accent-bg:var(--bs-table-active-bg);color:var(--bs-table-active-color)}.table-hover>tbody>tr:hover>*{--bs-table-accent-bg:var(--bs-table-hover-bg);color:var(--bs-table-hover-color)}.table-primary{--bs-table-bg:#cfe2ff;--bs-table-striped-bg:#c5d7f2;--bs-table-striped-color:#000;--bs-table-active-bg:#bacbe6;--bs-table-active-color:#000;--bs-table-hover-bg:#bfd1ec;--bs-table-hover-color:#000;color:#000;border-color:#bacbe6}.table-secondary{--bs-table-bg:#e2e3e5;--bs-table-striped-bg:#d7d8da;--bs-table-striped-color:#000;--bs-table-active-bg:#cbccce;--bs-table-active-color:#000;--bs-table-hover-bg:#d1d2d4;--bs-table-hover-color:#000;color:#000;border-color:#cbccce}.table-success{--bs-table-bg:#d1e7dd;--bs-table-striped-bg:#c7dbd2;--bs-table-striped-color:#000;--bs-table-active-bg:#bcd0c7;--bs-table-active-color:#000;--bs-table-hover-bg:#c1d6cc;--bs-table-hover-color:#000;color:#000;border-color:#bcd0c7}.table-info{--bs-table-bg:#cff4fc;--bs-table-striped-bg:#c5e8ef;--bs-table-striped-color:#000;--bs-table-active-bg:#badce3;--bs-table-active-color:#000;--bs-table-hover-bg:#bfe2e9;--bs-table-hover-color:#000;color:#000;border-color:#badce3}.table-warning{--bs-table-bg:#fff3cd;--bs-table-striped-bg:#f2e7c3;--bs-table-striped-color:#000;--bs-table-active-bg:#e6dbb9;--bs-table-active-color:#000;--bs-table-hover-bg:#ece1be;--bs-table-hover-color:#000;color:#000;border-color:#e6dbb9}.table-danger{--bs-table-bg:#f8d7da;--bs-table-striped-bg:#eccccf;--bs-table-striped-color:#000;--bs-table-active-bg:#dfc2c4;--bs-table-active-color:#000;--bs-table-hover-bg:#e5c7ca;--bs-table-hover-color:#000;color:#000;border-color:#dfc2c4}.table-light{--bs-table-bg:#f8f9fa;--bs-table-striped-bg:#ecedee;--bs-table-striped-color:#000;--bs-table-active-bg:#dfe0e1;--bs-table-active-color:#000;--bs-table-hover-bg:#e5e6e7;--bs-table-hover-color:#000;color:#000;border-color:#dfe0e1}.table-dark{--bs-table-bg:#212529;--bs-table-striped-bg:#2c3034;--bs-table-striped-color:#fff;--bs-table-active-bg:#373b3e;--bs-table-active-color:#fff;--bs-table-hover-bg:#323539;--bs-table-hover-color:#fff;color:#fff;border-color:#373b3e}.table-responsive{overflow-x:auto;-webkit-overflow-scrolling:touch}@media (max-width:575.98px){.table-responsive-sm{overflow-x:auto;-webkit-overflow-scrolling:touch}}@media (max-width:767.98px){.table-responsive-md{overflow-x:auto;-webkit-overflow-scrolling:touch}}@media (max-width:991.98px){.table-responsive-lg{overflow-x:auto;-webkit-overflow-scrolling:touch}}@media (max-width:1199.98px){.table-responsive-xl{overflow-x:auto;-webkit-overflow-scrolling:touch}}@media (max-width:1399.98px){.table-responsive-xxl{overflow-x:auto;-webkit-overflow-scrolling:touch}}.form-label{margin-bottom:.5rem}.col-form-label{padding-top:calc(.375rem + 1px);padding-bottom:calc(.375rem + 1px);margin-bottom:0;font-size:inherit;line-height:1.5}.col-form-label-lg{padding-top:calc(.5rem + 1px);padding-bottom:calc(.5rem + 1px);font-size:1.25rem}.col-form-label-sm{padding-top:calc(.25rem + 1px);padding-bottom:calc(.25rem + 1px);font-size:.875rem}.form-text{margin-top:.25rem;font-size:.875em;color:#6c757d}.form-control{display:block;width:100%;padding:.375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;background-clip:padding-box;border:1px solid #ced4da;-webkit-appearance:none;-moz-appearance:none;appearance:none;border-radius:.25rem;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media (prefers-reduced-motion:reduce){.form-control{transition:none}}.form-control[type=file]{overflow:hidden}.form-control[type=file]:not(:disabled):not([readonly]){cursor:pointer}.form-control:focus{color:#212529;background-color:#fff;border-color:#86b7fe;outline:0;box-shadow:0 0 0 .25rem rgba(13,110,253,.25)}.form-control::-webkit-date-and-time-value{height:1.5em}.form-control::-moz-placeholder{color:#6c757d;opacity:1}.form-control::placeholder{color:#6c757d;opacity:1}.form-control:disabled,.form-control[readonly]{background-color:#e9ecef;opacity:1}.form-control::-webkit-file-upload-button{padding:.375rem .75rem;margin:-.375rem -.75rem;-webkit-margin-end:.75rem;margin-inline-end:.75rem;color:#212529;background-color:#e9ecef;pointer-events:none;border-color:inherit;border-style:solid;border-width:0;border-inline-end-width:1px;border-radius:0;-webkit-transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}.form-control::file-selector-button{padding:.375rem .75rem;margin:-.375rem -.75rem;-webkit-margin-end:.75rem;margin-inline-end:.75rem;color:#212529;background-color:#e9ecef;pointer-events:none;border-color:inherit;border-style:solid;border-width:0;border-inline-end-width:1px;border-radius:0;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media (prefers-reduced-motion:reduce){.form-control::-webkit-file-upload-button{-webkit-transition:none;transition:none}.form-control::file-selector-button{transition:none}}.form-control:hover:not(:disabled):not([readonly])::-webkit-file-upload-button{background-color:#dde0e3}.form-control:hover:not(:disabled):not([readonly])::file-selector-button{background-color:#dde0e3}.form-control::-webkit-file-upload-button{padding:.375rem .75rem;margin:-.375rem -.75rem;-webkit-margin-end:.75rem;margin-inline-end:.75rem;color:#212529;background-color:#e9ecef;pointer-events:none;border-color:inherit;border-style:solid;border-width:0;border-inline-end-width:1px;border-radius:0;-webkit-transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media (prefers-reduced-motion:reduce){.form-control::-webkit-file-upload-button{-webkit-transition:none;transition:none}}.form-control:hover:not(:disabled):not([readonly])::-webkit-file-upload-button{background-color:#dde0e3}.form-control-plaintext{display:block;width:100%;padding:.375rem 0;margin-bottom:0;line-height:1.5;color:#212529;background-color:transparent;border:solid transparent;border-width:1px 0}.form-control-plaintext.form-control-lg,.form-control-plaintext.form-control-sm{padding-right:0;padding-left:0}.form-control-sm{min-height:calc(1.5em + .5rem + 2px);padding:.25rem .5rem;font-size:.875rem;border-radius:.2rem}.form-control-sm::-webkit-file-upload-button{padding:.25rem .5rem;margin:-.25rem -.5rem;-webkit-margin-end:.5rem;margin-inline-end:.5rem}.form-control-sm::file-selector-button{padding:.25rem .5rem;margin:-.25rem -.5rem;-webkit-margin-end:.5rem;margin-inline-end:.5rem}.form-control-sm::-webkit-file-upload-button{padding:.25rem .5rem;margin:-.25rem -.5rem;-webkit-margin-end:.5rem;margin-inline-end:.5rem}.form-control-lg{min-height:calc(1.5em + 1rem + 2px);padding:.5rem 1rem;font-size:1.25rem;border-radius:.3rem}.form-control-lg::-webkit-file-upload-button{padding:.5rem 1rem;margin:-.5rem -1rem;-webkit-margin-end:1rem;margin-inline-end:1rem}.form-control-lg::file-selector-button{padding:.5rem 1rem;margin:-.5rem -1rem;-webkit-margin-end:1rem;margin-inline-end:1rem}.form-control-lg::-webkit-file-upload-button{padding:.5rem 1rem;margin:-.5rem -1rem;-webkit-margin-end:1rem;margin-inline-end:1rem}textarea.form-control{min-height:calc(1.5em + .75rem + 2px)}textarea.form-control-sm{min-height:calc(1.5em + .5rem + 2px)}textarea.form-control-lg{min-height:calc(1.5em + 1rem + 2px)}.form-control-color{width:3rem;height:auto;padding:.375rem}.form-control-color:not(:disabled):not([readonly]){cursor:pointer}.form-control-color::-moz-color-swatch{height:1.5em;border-radius:.25rem}.form-control-color::-webkit-color-swatch{height:1.5em;border-radius:.25rem}.form-select{display:block;width:100%;padding:.375rem 2.25rem .375rem .75rem;-moz-padding-start:calc(0.75rem - 3px);font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='%23343a40' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M2 5l6 6 6-6'/%3e%3c/svg%3e");background-repeat:no-repeat;background-position:right .75rem center;background-size:16px 12px;border:1px solid #ced4da;border-radius:.25rem;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out;-webkit-appearance:none;-moz-appearance:none;appearance:none}@media (prefers-reduced-motion:reduce){.form-select{transition:none}}.form-select:focus{border-color:#86b7fe;outline:0;box-shadow:0 0 0 .25rem rgba(13,110,253,.25)}.form-select[multiple],.form-select[size]:not([size="1"]){padding-right:.75rem;background-image:none}.form-select:disabled{background-color:#e9ecef}.form-select:-moz-focusring{color:transparent;text-shadow:0 0 0 #212529}.form-select-sm{padding-top:.25rem;padding-bottom:.25rem;padding-left:.5rem;font-size:.875rem;border-radius:.2rem}.form-select-lg{padding-top:.5rem;padding-bottom:.5rem;padding-left:1rem;font-size:1.25rem;border-radius:.3rem}.form-check{display:block;min-height:1.5rem;padding-left:1.5em;margin-bottom:.125rem}.form-check .form-check-input{float:left;margin-left:-1.5em}.form-check-input{width:1em;height:1em;margin-top:.25em;vertical-align:top;background-color:#fff;background-repeat:no-repeat;background-position:center;background-size:contain;border:1px solid rgba(0,0,0,.25);-webkit-appearance:none;-moz-appearance:none;appearance:none;-webkit-print-color-adjust:exact;color-adjust:exact}.form-check-input[type=checkbox]{border-radius:.25em}.form-check-input[type=radio]{border-radius:50%}.form-check-input:active{filter:brightness(90%)}.form-check-input:focus{border-color:#86b7fe;outline:0;box-shadow:0 0 0 .25rem rgba(13,110,253,.25)}.form-check-input:checked{background-color:#0d6efd;border-color:#0d6efd}.form-check-input:checked[type=checkbox]{background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'%3e%3cpath fill='none' stroke='%23fff' stroke-linecap='round' stroke-linejoin='round' stroke-width='3' d='M6 10l3 3l6-6'/%3e%3c/svg%3e")}.form-check-input:checked[type=radio]{background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-4 -4 8 8'%3e%3ccircle r='2' fill='%23fff'/%3e%3c/svg%3e")}.form-check-input[type=checkbox]:indeterminate{background-color:#0d6efd;border-color:#0d6efd;background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'%3e%3cpath fill='none' stroke='%23fff' stroke-linecap='round' stroke-linejoin='round' stroke-width='3' d='M6 10h8'/%3e%3c/svg%3e")}.form-check-input:disabled{pointer-events:none;filter:none;opacity:.5}.form-check-input:disabled~.form-check-label,.form-check-input[disabled]~.form-check-label{opacity:.5}.form-switch{padding-left:2.5em}.form-switch .form-check-input{width:2em;margin-left:-2.5em;background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-4 -4 8 8'%3e%3ccircle r='3' fill='rgba%280, 0, 0, 0.25%29'/%3e%3c/svg%3e");background-position:left center;border-radius:2em;transition:background-position .15s ease-in-out}@media (prefers-reduced-motion:reduce){.form-switch .form-check-input{transition:none}}.form-switch .form-check-input:focus{background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-4 -4 8 8'%3e%3ccircle r='3' fill='%2386b7fe'/%3e%3c/svg%3e")}.form-switch .form-check-input:checked{background-position:right center;background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-4 -4 8 8'%3e%3ccircle r='3' fill='%23fff'/%3e%3c/svg%3e")}.form-check-inline{display:inline-block;margin-right:1rem}.btn-check{position:absolute;clip:rect(0,0,0,0);pointer-events:none}.btn-check:disabled+.btn,.btn-check[disabled]+.btn{pointer-events:none;filter:none;opacity:.65}.form-range{width:100%;height:1.5rem;padding:0;background-color:transparent;-webkit-appearance:none;-moz-appearance:none;appearance:none}.form-range:focus{outline:0}.form-range:focus::-webkit-slider-thumb{box-shadow:0 0 0 1px #fff,0 0 0 .25rem rgba(13,110,253,.25)}.form-range:focus::-moz-range-thumb{box-shadow:0 0 0 1px #fff,0 0 0 .25rem rgba(13,110,253,.25)}.form-range::-moz-focus-outer{border:0}.form-range::-webkit-slider-thumb{width:1rem;height:1rem;margin-top:-.25rem;background-color:#0d6efd;border:0;border-radius:1rem;-webkit-transition:background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;transition:background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;-webkit-appearance:none;appearance:none}@media (prefers-reduced-motion:reduce){.form-range::-webkit-slider-thumb{-webkit-transition:none;transition:none}}.form-range::-webkit-slider-thumb:active{background-color:#b6d4fe}.form-range::-webkit-slider-runnable-track{width:100%;height:.5rem;color:transparent;cursor:pointer;background-color:#dee2e6;border-color:transparent;border-radius:1rem}.form-range::-moz-range-thumb{width:1rem;height:1rem;background-color:#0d6efd;border:0;border-radius:1rem;-moz-transition:background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;transition:background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;-moz-appearance:none;appearance:none}@media (prefers-reduced-motion:reduce){.form-range::-moz-range-thumb{-moz-transition:none;transition:none}}.form-range::-moz-range-thumb:active{background-color:#b6d4fe}.form-range::-moz-range-track{width:100%;height:.5rem;color:transparent;cursor:pointer;background-color:#dee2e6;border-color:transparent;border-radius:1rem}.form-range:disabled{pointer-events:none}.form-range:disabled::-webkit-slider-thumb{background-color:#adb5bd}.form-range:disabled::-moz-range-thumb{background-color:#adb5bd}.form-floating{position:relative}.form-floating>.form-control,.form-floating>.form-select{height:calc(3.5rem + 2px);line-height:1.25}.form-floating>label{position:absolute;top:0;left:0;height:100%;padding:1rem .75rem;pointer-events:none;border:1px solid transparent;transform-origin:0 0;transition:opacity .1s ease-in-out,transform .1s ease-in-out}@media (prefers-reduced-motion:reduce){.form-floating>label{transition:none}}.form-floating>.form-control{padding:1rem .75rem}.form-floating>.form-control::-moz-placeholder{color:transparent}.form-floating>.form-control::placeholder{color:transparent}.form-floating>.form-control:not(:-moz-placeholder-shown){padding-top:1.625rem;padding-bottom:.625rem}.form-floating>.form-control:focus,.form-floating>.form-control:not(:placeholder-shown){padding-top:1.625rem;padding-bottom:.625rem}.form-floating>.form-control:-webkit-autofill{padding-top:1.625rem;padding-bottom:.625rem}.form-floating>.form-select{padding-top:1.625rem;padding-bottom:.625rem}.form-floating>.form-control:not(:-moz-placeholder-shown)~label{opacity:.65;transform:scale(.85) translateY(-.5rem) translateX(.15rem)}.form-floating>.form-control:focus~label,.form-floating>.form-control:not(:placeholder-shown)~label,.form-floating>.form-select~label{opacity:.65;transform:scale(.85) translateY(-.5rem) translateX(.15rem)}.form-floating>.form-control:-webkit-autofill~label{opacity:.65;transform:scale(.85) translateY(-.5rem) translateX(.15rem)}.input-group{position:relative;display:flex;flex-wrap:wrap;align-items:stretch;width:100%}.input-group>.form-control,.input-group>.form-select{position:relative;flex:1 1 auto;width:1%;min-width:0}.input-group>.form-control:focus,.input-group>.form-select:focus{z-index:3}.input-group .btn{position:relative;z-index:2}.input-group .btn:focus{z-index:3}.input-group-text{display:flex;align-items:center;padding:.375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:#212529;text-align:center;white-space:nowrap;background-color:#e9ecef;border:1px solid #ced4da;border-radius:.25rem}.input-group-lg>.btn,.input-group-lg>.form-control,.input-group-lg>.form-select,.input-group-lg>.input-group-text{padding:.5rem 1rem;font-size:1.25rem;border-radius:.3rem}.input-group-sm>.btn,.input-group-sm>.form-control,.input-group-sm>.form-select,.input-group-sm>.input-group-text{padding:.25rem .5rem;font-size:.875rem;border-radius:.2rem}.input-group-lg>.form-select,.input-group-sm>.form-select{padding-right:3rem}.input-group:not(.has-validation)>.dropdown-toggle:nth-last-child(n+3),.input-group:not(.has-validation)>:not(:last-child):not(.dropdown-toggle):not(.dropdown-menu){border-top-right-radius:0;border-bottom-right-radius:0}.input-group.has-validation>.dropdown-toggle:nth-last-child(n+4),.input-group.has-validation>:nth-last-child(n+3):not(.dropdown-toggle):not(.dropdown-menu){border-top-right-radius:0;border-bottom-right-radius:0}.input-group>:not(:first-child):not(.dropdown-menu):not(.valid-tooltip):not(.valid-feedback):not(.invalid-tooltip):not(.invalid-feedback){margin-left:-1px;border-top-left-radius:0;border-bottom-left-radius:0}.valid-feedback{display:none;width:100%;margin-top:.25rem;font-size:.875em;color:#198754}.valid-tooltip{position:absolute;top:100%;z-index:5;display:none;max-width:100%;padding:.25rem .5rem;margin-top:.1rem;font-size:.875rem;color:#fff;background-color:rgba(25,135,84,.9);border-radius:.25rem}.is-valid~.valid-feedback,.is-valid~.valid-tooltip,.was-validated :valid~.valid-feedback,.was-validated :valid~.valid-tooltip{display:block}.form-control.is-valid,.was-validated .form-control:valid{border-color:#198754;padding-right:calc(1.5em + .75rem);background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8 8'%3e%3cpath fill='%23198754' d='M2.3 6.73L.6 4.53c-.4-1.04.46-1.4 1.1-.8l1.1 1.4 3.4-3.8c.6-.63 1.6-.27 1.2.7l-4 4.6c-.43.5-.8.4-1.1.1z'/%3e%3c/svg%3e");background-repeat:no-repeat;background-position:right calc(.375em + .1875rem) center;background-size:calc(.75em + .375rem) calc(.75em + .375rem)}.form-control.is-valid:focus,.was-validated .form-control:valid:focus{border-color:#198754;box-shadow:0 0 0 .25rem rgba(25,135,84,.25)}.was-validated textarea.form-control:valid,textarea.form-control.is-valid{padding-right:calc(1.5em + .75rem);background-position:top calc(.375em + .1875rem) right calc(.375em + .1875rem)}.form-select.is-valid,.was-validated .form-select:valid{border-color:#198754}.form-select.is-valid:not([multiple]):not([size]),.form-select.is-valid:not([multiple])[size="1"],.was-validated .form-select:valid:not([multiple]):not([size]),.was-validated .form-select:valid:not([multiple])[size="1"]{padding-right:4.125rem;background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='%23343a40' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M2 5l6 6 6-6'/%3e%3c/svg%3e"),url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8 8'%3e%3cpath fill='%23198754' d='M2.3 6.73L.6 4.53c-.4-1.04.46-1.4 1.1-.8l1.1 1.4 3.4-3.8c.6-.63 1.6-.27 1.2.7l-4 4.6c-.43.5-.8.4-1.1.1z'/%3e%3c/svg%3e");background-position:right .75rem center,center right 2.25rem;background-size:16px 12px,calc(.75em + .375rem) calc(.75em + .375rem)}.form-select.is-valid:focus,.was-validated .form-select:valid:focus{border-color:#198754;box-shadow:0 0 0 .25rem rgba(25,135,84,.25)}.form-check-input.is-valid,.was-validated .form-check-input:valid{border-color:#198754}.form-check-input.is-valid:checked,.was-validated .form-check-input:valid:checked{background-color:#198754}.form-check-input.is-valid:focus,.was-validated .form-check-input:valid:focus{box-shadow:0 0 0 .25rem rgba(25,135,84,.25)}.form-check-input.is-valid~.form-check-label,.was-validated .form-check-input:valid~.form-check-label{color:#198754}.form-check-inline .form-check-input~.valid-feedback{margin-left:.5em}.input-group .form-control.is-valid,.input-group .form-select.is-valid,.was-validated .input-group .form-control:valid,.was-validated .input-group .form-select:valid{z-index:1}.input-group .form-control.is-valid:focus,.input-group .form-select.is-valid:focus,.was-validated .input-group .form-control:valid:focus,.was-validated .input-group .form-select:valid:focus{z-index:3}.invalid-feedback{display:none;width:100%;margin-top:.25rem;font-size:.875em;color:#dc3545}.invalid-tooltip{position:absolute;top:100%;z-index:5;display:none;max-width:100%;padding:.25rem .5rem;margin-top:.1rem;font-size:.875rem;color:#fff;background-color:rgba(220,53,69,.9);border-radius:.25rem}.is-invalid~.invalid-feedback,.is-invalid~.invalid-tooltip,.was-validated :invalid~.invalid-feedback,.was-validated :invalid~.invalid-tooltip{display:block}.form-control.is-invalid,.was-validated .form-control:invalid{border-color:#dc3545;padding-right:calc(1.5em + .75rem);background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12' width='12' height='12' fill='none' stroke='%23dc3545'%3e%3ccircle cx='6' cy='6' r='4.5'/%3e%3cpath stroke-linejoin='round' d='M5.8 3.6h.4L6 6.5z'/%3e%3ccircle cx='6' cy='8.2' r='.6' fill='%23dc3545' stroke='none'/%3e%3c/svg%3e");background-repeat:no-repeat;background-position:right calc(.375em + .1875rem) center;background-size:calc(.75em + .375rem) calc(.75em + .375rem)}.form-control.is-invalid:focus,.was-validated .form-control:invalid:focus{border-color:#dc3545;box-shadow:0 0 0 .25rem rgba(220,53,69,.25)}.was-validated textarea.form-control:invalid,textarea.form-control.is-invalid{padding-right:calc(1.5em + .75rem);background-position:top calc(.375em + .1875rem) right calc(.375em + .1875rem)}.form-select.is-invalid,.was-validated .form-select:invalid{border-color:#dc3545}.form-select.is-invalid:not([multiple]):not([size]),.form-select.is-invalid:not([multiple])[size="1"],.was-validated .form-select:invalid:not([multiple]):not([size]),.was-validated .form-select:invalid:not([multiple])[size="1"]{padding-right:4.125rem;background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='%23343a40' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M2 5l6 6 6-6'/%3e%3c/svg%3e"),url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12' width='12' height='12' fill='none' stroke='%23dc3545'%3e%3ccircle cx='6' cy='6' r='4.5'/%3e%3cpath stroke-linejoin='round' d='M5.8 3.6h.4L6 6.5z'/%3e%3ccircle cx='6' cy='8.2' r='.6' fill='%23dc3545' stroke='none'/%3e%3c/svg%3e");background-position:right .75rem center,center right 2.25rem;background-size:16px 12px,calc(.75em + .375rem) calc(.75em + .375rem)}.form-select.is-invalid:focus,.was-validated .form-select:invalid:focus{border-color:#dc3545;box-shadow:0 0 0 .25rem rgba(220,53,69,.25)}.form-check-input.is-invalid,.was-validated .form-check-input:invalid{border-color:#dc3545}.form-check-input.is-invalid:checked,.was-validated .form-check-input:invalid:checked{background-color:#dc3545}.form-check-input.is-invalid:focus,.was-validated .form-check-input:invalid:focus{box-shadow:0 0 0 .25rem rgba(220,53,69,.25)}.form-check-input.is-invalid~.form-check-label,.was-validated .form-check-input:invalid~.form-check-label{color:#dc3545}.form-check-inline .form-check-input~.invalid-feedback{margin-left:.5em}.input-group .form-control.is-invalid,.input-group .form-select.is-invalid,.was-validated .input-group .form-control:invalid,.was-validated .input-group .form-select:invalid{z-index:2}.input-group .form-control.is-invalid:focus,.input-group .form-select.is-invalid:focus,.was-validated .input-group .form-control:invalid:focus,.was-validated .input-group .form-select:invalid:focus{z-index:3}.btn{display:inline-block;font-weight:400;line-height:1.5;color:#212529;text-align:center;text-decoration:none;vertical-align:middle;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;user-select:none;background-color:transparent;border:1px solid transparent;padding:.375rem .75rem;font-size:1rem;border-radius:.25rem;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media (prefers-reduced-motion:reduce){.btn{transition:none}}.btn:hover{color:#212529}.btn-check:focus+.btn,.btn:focus{outline:0;box-shadow:0 0 0 .25rem rgba(13,110,253,.25)}.btn.disabled,.btn:disabled,fieldset:disabled .btn{pointer-events:none;opacity:.65}.btn-primary{color:#fff;background-color:#0d6efd;border-color:#0d6efd}.btn-primary:hover{color:#fff;background-color:#0b5ed7;border-color:#0a58ca}.btn-check:focus+.btn-primary,.btn-primary:focus{color:#fff;background-color:#0b5ed7;border-color:#0a58ca;box-shadow:0 0 0 .25rem rgba(49,132,253,.5)}.btn-check:active+.btn-primary,.btn-check:checked+.btn-primary,.btn-primary.active,.btn-primary:active,.show>.btn-primary.dropdown-toggle{color:#fff;background-color:#0a58ca;border-color:#0a53be}.btn-check:active+.btn-primary:focus,.btn-check:checked+.btn-primary:focus,.btn-primary.active:focus,.btn-primary:active:focus,.show>.btn-primary.dropdown-toggle:focus{box-shadow:0 0 0 .25rem rgba(49,132,253,.5)}.btn-primary.disabled,.btn-primary:disabled{color:#fff;background-color:#0d6efd;border-color:#0d6efd}.btn-secondary{color:#fff;background-color:#6c757d;border-color:#6c757d}.btn-secondary:hover{color:#fff;background-color:#5c636a;border-color:#565e64}.btn-check:focus+.btn-secondary,.btn-secondary:focus{color:#fff;background-color:#5c636a;border-color:#565e64;box-shadow:0 0 0 .25rem rgba(130,138,145,.5)}.btn-check:active+.btn-secondary,.btn-check:checked+.btn-secondary,.btn-secondary.active,.btn-secondary:active,.show>.btn-secondary.dropdown-toggle{color:#fff;background-color:#565e64;border-color:#51585e}.btn-check:active+.btn-secondary:focus,.btn-check:checked+.btn-secondary:focus,.btn-secondary.active:focus,.btn-secondary:active:focus,.show>.btn-secondary.dropdown-toggle:focus{box-shadow:0 0 0 .25rem rgba(130,138,145,.5)}.btn-secondary.disabled,.btn-secondary:disabled{color:#fff;background-color:#6c757d;border-color:#6c757d}.btn-success{color:#fff;background-color:#198754;border-color:#198754}.btn-success:hover{color:#fff;background-color:#157347;border-color:#146c43}.btn-check:focus+.btn-success,.btn-success:focus{color:#fff;background-color:#157347;border-color:#146c43;box-shadow:0 0 0 .25rem rgba(60,153,110,.5)}.btn-check:active+.btn-success,.btn-check:checked+.btn-success,.btn-success.active,.btn-success:active,.show>.btn-success.dropdown-toggle{color:#fff;background-color:#146c43;border-color:#13653f}.btn-check:active+.btn-success:focus,.btn-check:checked+.btn-success:focus,.btn-success.active:focus,.btn-success:active:focus,.show>.btn-success.dropdown-toggle:focus{box-shadow:0 0 0 .25rem rgba(60,153,110,.5)}.btn-success.disabled,.btn-success:disabled{color:#fff;background-color:#198754;border-color:#198754}.btn-info{color:#000;background-color:#0dcaf0;border-color:#0dcaf0}.btn-info:hover{color:#000;background-color:#31d2f2;border-color:#25cff2}.btn-check:focus+.btn-info,.btn-info:focus{color:#000;background-color:#31d2f2;border-color:#25cff2;box-shadow:0 0 0 .25rem rgba(11,172,204,.5)}.btn-check:active+.btn-info,.btn-check:checked+.btn-info,.btn-info.active,.btn-info:active,.show>.btn-info.dropdown-toggle{color:#000;background-color:#3dd5f3;border-color:#25cff2}.btn-check:active+.btn-info:focus,.btn-check:checked+.btn-info:focus,.btn-info.active:focus,.btn-info:active:focus,.show>.btn-info.dropdown-toggle:focus{box-shadow:0 0 0 .25rem rgba(11,172,204,.5)}.btn-info.disabled,.btn-info:disabled{color:#000;background-color:#0dcaf0;border-color:#0dcaf0}.btn-warning{color:#000;background-color:#ffc107;border-color:#ffc107}.btn-warning:hover{color:#000;background-color:#ffca2c;border-color:#ffc720}.btn-check:focus+.btn-warning,.btn-warning:focus{color:#000;background-color:#ffca2c;border-color:#ffc720;box-shadow:0 0 0 .25rem rgba(217,164,6,.5)}.btn-check:active+.btn-warning,.btn-check:checked+.btn-warning,.btn-warning.active,.btn-warning:active,.show>.btn-warning.dropdown-toggle{color:#000;background-color:#ffcd39;border-color:#ffc720}.btn-check:active+.btn-warning:focus,.btn-check:checked+.btn-warning:focus,.btn-warning.active:focus,.btn-warning:active:focus,.show>.btn-warning.dropdown-toggle:focus{box-shadow:0 0 0 .25rem rgba(217,164,6,.5)}.btn-warning.disabled,.btn-warning:disabled{color:#000;background-color:#ffc107;border-color:#ffc107}.btn-danger{color:#fff;background-color:#dc3545;border-color:#dc3545}.btn-danger:hover{color:#fff;background-color:#bb2d3b;border-color:#b02a37}.btn-check:focus+.btn-danger,.btn-danger:focus{color:#fff;background-color:#bb2d3b;border-color:#b02a37;box-shadow:0 0 0 .25rem rgba(225,83,97,.5)}.btn-check:active+.btn-danger,.btn-check:checked+.btn-danger,.btn-danger.active,.btn-danger:active,.show>.btn-danger.dropdown-toggle{color:#fff;background-color:#b02a37;border-color:#a52834}.btn-check:active+.btn-danger:focus,.btn-check:checked+.btn-danger:focus,.btn-danger.active:focus,.btn-danger:active:focus,.show>.btn-danger.dropdown-toggle:focus{box-shadow:0 0 0 .25rem rgba(225,83,97,.5)}.btn-danger.disabled,.btn-danger:disabled{color:#fff;background-color:#dc3545;border-color:#dc3545}.btn-light{color:#000;background-color:#f8f9fa;border-color:#f8f9fa}.btn-light:hover{color:#000;background-color:#f9fafb;border-color:#f9fafb}.btn-check:focus+.btn-light,.btn-light:focus{color:#000;background-color:#f9fafb;border-color:#f9fafb;box-shadow:0 0 0 .25rem rgba(211,212,213,.5)}.btn-check:active+.btn-light,.btn-check:checked+.btn-light,.btn-light.active,.btn-light:active,.show>.btn-light.dropdown-toggle{color:#000;background-color:#f9fafb;border-color:#f9fafb}.btn-check:active+.btn-light:focus,.btn-check:checked+.btn-light:focus,.btn-light.active:focus,.btn-light:active:focus,.show>.btn-light.dropdown-toggle:focus{box-shadow:0 0 0 .25rem rgba(211,212,213,.5)}.btn-light.disabled,.btn-light:disabled{color:#000;background-color:#f8f9fa;border-color:#f8f9fa}.btn-dark{color:#fff;background-color:#212529;border-color:#212529}.btn-dark:hover{color:#fff;background-color:#1c1f23;border-color:#1a1e21}.btn-check:focus+.btn-dark,.btn-dark:focus{color:#fff;background-color:#1c1f23;border-color:#1a1e21;box-shadow:0 0 0 .25rem rgba(66,70,73,.5)}.btn-check:active+.btn-dark,.btn-check:checked+.btn-dark,.btn-dark.active,.btn-dark:active,.show>.btn-dark.dropdown-toggle{color:#fff;background-color:#1a1e21;border-color:#191c1f}.btn-check:active+.btn-dark:focus,.btn-check:checked+.btn-dark:focus,.btn-dark.active:focus,.btn-dark:active:focus,.show>.btn-dark.dropdown-toggle:focus{box-shadow:0 0 0 .25rem rgba(66,70,73,.5)}.btn-dark.disabled,.btn-dark:disabled{color:#fff;background-color:#212529;border-color:#212529}.btn-outline-primary{color:#0d6efd;border-color:#0d6efd}.btn-outline-primary:hover{color:#fff;background-color:#0d6efd;border-color:#0d6efd}.btn-check:focus+.btn-outline-primary,.btn-outline-primary:focus{box-shadow:0 0 0 .25rem rgba(13,110,253,.5)}.btn-check:active+.btn-outline-primary,.btn-check:checked+.btn-outline-primary,.btn-outline-primary.active,.btn-outline-primary.dropdown-toggle.show,.btn-outline-primary:active{color:#fff;background-color:#0d6efd;border-color:#0d6efd}.btn-check:active+.btn-outline-primary:focus,.btn-check:checked+.btn-outline-primary:focus,.btn-outline-primary.active:focus,.btn-outline-primary.dropdown-toggle.show:focus,.btn-outline-primary:active:focus{box-shadow:0 0 0 .25rem rgba(13,110,253,.5)}.btn-outline-primary.disabled,.btn-outline-primary:disabled{color:#0d6efd;background-color:transparent}.btn-outline-secondary{color:#6c757d;border-color:#6c757d}.btn-outline-secondary:hover{color:#fff;background-color:#6c757d;border-color:#6c757d}.btn-check:focus+.btn-outline-secondary,.btn-outline-secondary:focus{box-shadow:0 0 0 .25rem rgba(108,117,125,.5)}.btn-check:active+.btn-outline-secondary,.btn-check:checked+.btn-outline-secondary,.btn-outline-secondary.active,.btn-outline-secondary.dropdown-toggle.show,.btn-outline-secondary:active{color:#fff;background-color:#6c757d;border-color:#6c757d}.btn-check:active+.btn-outline-secondary:focus,.btn-check:checked+.btn-outline-secondary:focus,.btn-outline-secondary.active:focus,.btn-outline-secondary.dropdown-toggle.show:focus,.btn-outline-secondary:active:focus{box-shadow:0 0 0 .25rem rgba(108,117,125,.5)}.btn-outline-secondary.disabled,.btn-outline-secondary:disabled{color:#6c757d;background-color:transparent}.btn-outline-success{color:#198754;border-color:#198754}.btn-outline-success:hover{color:#fff;background-color:#198754;border-color:#198754}.btn-check:focus+.btn-outline-success,.btn-outline-success:focus{box-shadow:0 0 0 .25rem rgba(25,135,84,.5)}.btn-check:active+.btn-outline-success,.btn-check:checked+.btn-outline-success,.btn-outline-success.active,.btn-outline-success.dropdown-toggle.show,.btn-outline-success:active{color:#fff;background-color:#198754;border-color:#198754}.btn-check:active+.btn-outline-success:focus,.btn-check:checked+.btn-outline-success:focus,.btn-outline-success.active:focus,.btn-outline-success.dropdown-toggle.show:focus,.btn-outline-success:active:focus{box-shadow:0 0 0 .25rem rgba(25,135,84,.5)}.btn-outline-success.disabled,.btn-outline-success:disabled{color:#198754;background-color:transparent}.btn-outline-info{color:#0dcaf0;border-color:#0dcaf0}.btn-outline-info:hover{color:#000;background-color:#0dcaf0;border-color:#0dcaf0}.btn-check:focus+.btn-outline-info,.btn-outline-info:focus{box-shadow:0 0 0 .25rem rgba(13,202,240,.5)}.btn-check:active+.btn-outline-info,.btn-check:checked+.btn-outline-info,.btn-outline-info.active,.btn-outline-info.dropdown-toggle.show,.btn-outline-info:active{color:#000;background-color:#0dcaf0;border-color:#0dcaf0}.btn-check:active+.btn-outline-info:focus,.btn-check:checked+.btn-outline-info:focus,.btn-outline-info.active:focus,.btn-outline-info.dropdown-toggle.show:focus,.btn-outline-info:active:focus{box-shadow:0 0 0 .25rem rgba(13,202,240,.5)}.btn-outline-info.disabled,.btn-outline-info:disabled{color:#0dcaf0;background-color:transparent}.btn-outline-warning{color:#ffc107;border-color:#ffc107}.btn-outline-warning:hover{color:#000;background-color:#ffc107;border-color:#ffc107}.btn-check:focus+.btn-outline-warning,.btn-outline-warning:focus{box-shadow:0 0 0 .25rem rgba(255,193,7,.5)}.btn-check:active+.btn-outline-warning,.btn-check:checked+.btn-outline-warning,.btn-outline-warning.active,.btn-outline-warning.dropdown-toggle.show,.btn-outline-warning:active{color:#000;background-color:#ffc107;border-color:#ffc107}.btn-check:active+.btn-outline-warning:focus,.btn-check:checked+.btn-outline-warning:focus,.btn-outline-warning.active:focus,.btn-outline-warning.dropdown-toggle.show:focus,.btn-outline-warning:active:focus{box-shadow:0 0 0 .25rem rgba(255,193,7,.5)}.btn-outline-warning.disabled,.btn-outline-warning:disabled{color:#ffc107;background-color:transparent}.btn-outline-danger{color:#dc3545;border-color:#dc3545}.btn-outline-danger:hover{color:#fff;background-color:#dc3545;border-color:#dc3545}.btn-check:focus+.btn-outline-danger,.btn-outline-danger:focus{box-shadow:0 0 0 .25rem rgba(220,53,69,.5)}.btn-check:active+.btn-outline-danger,.btn-check:checked+.btn-outline-danger,.btn-outline-danger.active,.btn-outline-danger.dropdown-toggle.show,.btn-outline-danger:active{color:#fff;background-color:#dc3545;border-color:#dc3545}.btn-check:active+.btn-outline-danger:focus,.btn-check:checked+.btn-outline-danger:focus,.btn-outline-danger.active:focus,.btn-outline-danger.dropdown-toggle.show:focus,.btn-outline-danger:active:focus{box-shadow:0 0 0 .25rem rgba(220,53,69,.5)}.btn-outline-danger.disabled,.btn-outline-danger:disabled{color:#dc3545;background-color:transparent}.btn-outline-light{color:#f8f9fa;border-color:#f8f9fa}.btn-outline-light:hover{color:#000;background-color:#f8f9fa;border-color:#f8f9fa}.btn-check:focus+.btn-outline-light,.btn-outline-light:focus{box-shadow:0 0 0 .25rem rgba(248,249,250,.5)}.btn-check:active+.btn-outline-light,.btn-check:checked+.btn-outline-light,.btn-outline-light.active,.btn-outline-light.dropdown-toggle.show,.btn-outline-light:active{color:#000;background-color:#f8f9fa;border-color:#f8f9fa}.btn-check:active+.btn-outline-light:focus,.btn-check:checked+.btn-outline-light:focus,.btn-outline-light.active:focus,.btn-outline-light.dropdown-toggle.show:focus,.btn-outline-light:active:focus{box-shadow:0 0 0 .25rem rgba(248,249,250,.5)}.btn-outline-light.disabled,.btn-outline-light:disabled{color:#f8f9fa;background-color:transparent}.btn-outline-dark{color:#212529;border-color:#212529}.btn-outline-dark:hover{color:#fff;background-color:#212529;border-color:#212529}.btn-check:focus+.btn-outline-dark,.btn-outline-dark:focus{box-shadow:0 0 0 .25rem rgba(33,37,41,.5)}.btn-check:active+.btn-outline-dark,.btn-check:checked+.btn-outline-dark,.btn-outline-dark.active,.btn-outline-dark.dropdown-toggle.show,.btn-outline-dark:active{color:#fff;background-color:#212529;border-color:#212529}.btn-check:active+.btn-outline-dark:focus,.btn-check:checked+.btn-outline-dark:focus,.btn-outline-dark.active:focus,.btn-outline-dark.dropdown-toggle.show:focus,.btn-outline-dark:active:focus{box-shadow:0 0 0 .25rem rgba(33,37,41,.5)}.btn-outline-dark.disabled,.btn-outline-dark:disabled{color:#212529;background-color:transparent}.btn-link{font-weight:400;color:#0d6efd;text-decoration:underline}.btn-link:hover{color:#0a58ca}.btn-link.disabled,.btn-link:disabled{color:#6c757d}.btn-group-lg>.btn,.btn-lg{padding:.5rem 1rem;font-size:1.25rem;border-radius:.3rem}.btn-group-sm>.btn,.btn-sm{padding:.25rem .5rem;font-size:.875rem;border-radius:.2rem}.fade{transition:opacity .15s linear}@media (prefers-reduced-motion:reduce){.fade{transition:none}}.fade:not(.show){opacity:0}.collapse:not(.show){display:none}.collapsing{height:0;overflow:hidden;transition:height .35s ease}@media (prefers-reduced-motion:reduce){.collapsing{transition:none}}.collapsing.collapse-horizontal{width:0;height:auto;transition:width .35s ease}@media (prefers-reduced-motion:reduce){.collapsing.collapse-horizontal{transition:none}}.dropdown,.dropend,.dropstart,.dropup{position:relative}.dropdown-toggle{white-space:nowrap}.dropdown-toggle::after{display:inline-block;margin-left:.255em;vertical-align:.255em;content:"";border-top:.3em solid;border-right:.3em solid transparent;border-bottom:0;border-left:.3em solid transparent}.dropdown-toggle:empty::after{margin-left:0}.dropdown-menu{position:absolute;z-index:1000;display:none;min-width:10rem;padding:.5rem 0;margin:0;font-size:1rem;color:#212529;text-align:left;list-style:none;background-color:#fff;background-clip:padding-box;border:1px solid rgba(0,0,0,.15);border-radius:.25rem}.dropdown-menu[data-bs-popper]{top:100%;left:0;margin-top:.125rem}.dropdown-menu-start{--bs-position:start}.dropdown-menu-start[data-bs-popper]{right:auto;left:0}.dropdown-menu-end{--bs-position:end}.dropdown-menu-end[data-bs-popper]{right:0;left:auto}@media (min-width:576px){.dropdown-menu-sm-start{--bs-position:start}.dropdown-menu-sm-start[data-bs-popper]{right:auto;left:0}.dropdown-menu-sm-end{--bs-position:end}.dropdown-menu-sm-end[data-bs-popper]{right:0;left:auto}}@media (min-width:768px){.dropdown-menu-md-start{--bs-position:start}.dropdown-menu-md-start[data-bs-popper]{right:auto;left:0}.dropdown-menu-md-end{--bs-position:end}.dropdown-menu-md-end[data-bs-popper]{right:0;left:auto}}@media (min-width:992px){.dropdown-menu-lg-start{--bs-position:start}.dropdown-menu-lg-start[data-bs-popper]{right:auto;left:0}.dropdown-menu-lg-end{--bs-position:end}.dropdown-menu-lg-end[data-bs-popper]{right:0;left:auto}}@media (min-width:1200px){.dropdown-menu-xl-start{--bs-position:start}.dropdown-menu-xl-start[data-bs-popper]{right:auto;left:0}.dropdown-menu-xl-end{--bs-position:end}.dropdown-menu-xl-end[data-bs-popper]{right:0;left:auto}}@media (min-width:1400px){.dropdown-menu-xxl-start{--bs-position:start}.dropdown-menu-xxl-start[data-bs-popper]{right:auto;left:0}.dropdown-menu-xxl-end{--bs-position:end}.dropdown-menu-xxl-end[data-bs-popper]{right:0;left:auto}}.dropup .dropdown-menu[data-bs-popper]{top:auto;bottom:100%;margin-top:0;margin-bottom:.125rem}.dropup .dropdown-toggle::after{display:inline-block;margin-left:.255em;vertical-align:.255em;content:"";border-top:0;border-right:.3em solid transparent;border-bottom:.3em solid;border-left:.3em solid transparent}.dropup .dropdown-toggle:empty::after{margin-left:0}.dropend .dropdown-menu[data-bs-popper]{top:0;right:auto;left:100%;margin-top:0;margin-left:.125rem}.dropend .dropdown-toggle::after{display:inline-block;margin-left:.255em;vertical-align:.255em;content:"";border-top:.3em solid transparent;border-right:0;border-bottom:.3em solid transparent;border-left:.3em solid}.dropend .dropdown-toggle:empty::after{margin-left:0}.dropend .dropdown-toggle::after{vertical-align:0}.dropstart .dropdown-menu[data-bs-popper]{top:0;right:100%;left:auto;margin-top:0;margin-right:.125rem}.dropstart .dropdown-toggle::after{display:inline-block;margin-left:.255em;vertical-align:.255em;content:""}.dropstart .dropdown-toggle::after{display:none}.dropstart .dropdown-toggle::before{display:inline-block;margin-right:.255em;vertical-align:.255em;content:"";border-top:.3em solid transparent;border-right:.3em solid;border-bottom:.3em solid transparent}.dropstart .dropdown-toggle:empty::after{margin-left:0}.dropstart .dropdown-toggle::before{vertical-align:0}.dropdown-divider{height:0;margin:.5rem 0;overflow:hidden;border-top:1px solid rgba(0,0,0,.15)}.dropdown-item{display:block;width:100%;padding:.25rem 1rem;clear:both;font-weight:400;color:#212529;text-align:inherit;text-decoration:none;white-space:nowrap;background-color:transparent;border:0}.dropdown-item:focus,.dropdown-item:hover{color:#1e2125;background-color:#e9ecef}.dropdown-item.active,.dropdown-item:active{color:#fff;text-decoration:none;background-color:#0d6efd}.dropdown-item.disabled,.dropdown-item:disabled{color:#adb5bd;pointer-events:none;background-color:transparent}.dropdown-menu.show{display:block}.dropdown-header{display:block;padding:.5rem 1rem;margin-bottom:0;font-size:.875rem;color:#6c757d;white-space:nowrap}.dropdown-item-text{display:block;padding:.25rem 1rem;color:#212529}.dropdown-menu-dark{color:#dee2e6;background-color:#343a40;border-color:rgba(0,0,0,.15)}.dropdown-menu-dark .dropdown-item{color:#dee2e6}.dropdown-menu-dark .dropdown-item:focus,.dropdown-menu-dark .dropdown-item:hover{color:#fff;background-color:rgba(255,255,255,.15)}.dropdown-menu-dark .dropdown-item.active,.dropdown-menu-dark .dropdown-item:active{color:#fff;background-color:#0d6efd}.dropdown-menu-dark .dropdown-item.disabled,.dropdown-menu-dark .dropdown-item:disabled{color:#adb5bd}.dropdown-menu-dark .dropdown-divider{border-color:rgba(0,0,0,.15)}.dropdown-menu-dark .dropdown-item-text{color:#dee2e6}.dropdown-menu-dark .dropdown-header{color:#adb5bd}.btn-group,.btn-group-vertical{position:relative;display:inline-flex;vertical-align:middle}.btn-group-vertical>.btn,.btn-group>.btn{position:relative;flex:1 1 auto}.btn-group-vertical>.btn-check:checked+.btn,.btn-group-vertical>.btn-check:focus+.btn,.btn-group-vertical>.btn.active,.btn-group-vertical>.btn:active,.btn-group-vertical>.btn:focus,.btn-group-vertical>.btn:hover,.btn-group>.btn-check:checked+.btn,.btn-group>.btn-check:focus+.btn,.btn-group>.btn.active,.btn-group>.btn:active,.btn-group>.btn:focus,.btn-group>.btn:hover{z-index:1}.btn-toolbar{display:flex;flex-wrap:wrap;justify-content:flex-start}.btn-toolbar .input-group{width:auto}.btn-group>.btn-group:not(:first-child),.btn-group>.btn:not(:first-child){margin-left:-1px}.btn-group>.btn-group:not(:last-child)>.btn,.btn-group>.btn:not(:last-child):not(.dropdown-toggle){border-top-right-radius:0;border-bottom-right-radius:0}.btn-group>.btn-group:not(:first-child)>.btn,.btn-group>.btn:nth-child(n+3),.btn-group>:not(.btn-check)+.btn{border-top-left-radius:0;border-bottom-left-radius:0}.dropdown-toggle-split{padding-right:.5625rem;padding-left:.5625rem}.dropdown-toggle-split::after,.dropend .dropdown-toggle-split::after,.dropup .dropdown-toggle-split::after{margin-left:0}.dropstart .dropdown-toggle-split::before{margin-right:0}.btn-group-sm>.btn+.dropdown-toggle-split,.btn-sm+.dropdown-toggle-split{padding-right:.375rem;padding-left:.375rem}.btn-group-lg>.btn+.dropdown-toggle-split,.btn-lg+.dropdown-toggle-split{padding-right:.75rem;padding-left:.75rem}.btn-group-vertical{flex-direction:column;align-items:flex-start;justify-content:center}.btn-group-vertical>.btn,.btn-group-vertical>.btn-group{width:100%}.btn-group-vertical>.btn-group:not(:first-child),.btn-group-vertical>.btn:not(:first-child){margin-top:-1px}.btn-group-vertical>.btn-group:not(:last-child)>.btn,.btn-group-vertical>.btn:not(:last-child):not(.dropdown-toggle){border-bottom-right-radius:0;border-bottom-left-radius:0}.btn-group-vertical>.btn-group:not(:first-child)>.btn,.btn-group-vertical>.btn~.btn{border-top-left-radius:0;border-top-right-radius:0}.nav{display:flex;flex-wrap:wrap;padding-left:0;margin-bottom:0;list-style:none}.nav-link{display:block;padding:.5rem 1rem;color:#0d6efd;text-decoration:none;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out}@media (prefers-reduced-motion:reduce){.nav-link{transition:none}}.nav-link:focus,.nav-link:hover{color:#0a58ca}.nav-link.disabled{color:#6c757d;pointer-events:none;cursor:default}.nav-tabs{border-bottom:1px solid #dee2e6}.nav-tabs .nav-link{margin-bottom:-1px;background:0 0;border:1px solid transparent;border-top-left-radius:.25rem;border-top-right-radius:.25rem}.nav-tabs .nav-link:focus,.nav-tabs .nav-link:hover{border-color:#e9ecef #e9ecef #dee2e6;isolation:isolate}.nav-tabs .nav-link.disabled{color:#6c757d;background-color:transparent;border-color:transparent}.nav-tabs .nav-item.show .nav-link,.nav-tabs .nav-link.active{color:#495057;background-color:#fff;border-color:#dee2e6 #dee2e6 #fff}.nav-tabs .dropdown-menu{margin-top:-1px;border-top-left-radius:0;border-top-right-radius:0}.nav-pills .nav-link{background:0 0;border:0;border-radius:.25rem}.nav-pills .nav-link.active,.nav-pills .show>.nav-link{color:#fff;background-color:#0d6efd}.nav-fill .nav-item,.nav-fill>.nav-link{flex:1 1 auto;text-align:center}.nav-justified .nav-item,.nav-justified>.nav-link{flex-basis:0;flex-grow:1;text-align:center}.nav-fill .nav-item .nav-link,.nav-justified .nav-item .nav-link{width:100%}.tab-content>.tab-pane{display:none}.tab-content>.active{display:block}.navbar{position:relative;display:flex;flex-wrap:wrap;align-items:center;justify-content:space-between;padding-top:.5rem;padding-bottom:.5rem}.navbar>.container,.navbar>.container-fluid,.navbar>.container-lg,.navbar>.container-md,.navbar>.container-sm,.navbar>.container-xl,.navbar>.container-xxl{display:flex;flex-wrap:inherit;align-items:center;justify-content:space-between}.navbar-brand{padding-top:.3125rem;padding-bottom:.3125rem;margin-right:1rem;font-size:1.25rem;text-decoration:none;white-space:nowrap}.navbar-nav{display:flex;flex-direction:column;padding-left:0;margin-bottom:0;list-style:none}.navbar-nav .nav-link{padding-right:0;padding-left:0}.navbar-nav .dropdown-menu{position:static}.navbar-text{padding-top:.5rem;padding-bottom:.5rem}.navbar-collapse{flex-basis:100%;flex-grow:1;align-items:center}.navbar-toggler{padding:.25rem .75rem;font-size:1.25rem;line-height:1;background-color:transparent;border:1px solid transparent;border-radius:.25rem;transition:box-shadow .15s ease-in-out}@media (prefers-reduced-motion:reduce){.navbar-toggler{transition:none}}.navbar-toggler:hover{text-decoration:none}.navbar-toggler:focus{text-decoration:none;outline:0;box-shadow:0 0 0 .25rem}.navbar-toggler-icon{display:inline-block;width:1.5em;height:1.5em;vertical-align:middle;background-repeat:no-repeat;background-position:center;background-size:100%}.navbar-nav-scroll{max-height:var(--bs-scroll-height,75vh);overflow-y:auto}@media (min-width:576px){.navbar-expand-sm{flex-wrap:nowrap;justify-content:flex-start}.navbar-expand-sm .navbar-nav{flex-direction:row}.navbar-expand-sm .navbar-nav .dropdown-menu{position:absolute}.navbar-expand-sm .navbar-nav .nav-link{padding-right:.5rem;padding-left:.5rem}.navbar-expand-sm .navbar-nav-scroll{overflow:visible}.navbar-expand-sm .navbar-collapse{display:flex!important;flex-basis:auto}.navbar-expand-sm .navbar-toggler{display:none}.navbar-expand-sm .offcanvas-header{display:none}.navbar-expand-sm .offcanvas{position:inherit;bottom:0;z-index:1000;flex-grow:1;visibility:visible!important;background-color:transparent;border-right:0;border-left:0;transition:none;transform:none}.navbar-expand-sm .offcanvas-bottom,.navbar-expand-sm .offcanvas-top{height:auto;border-top:0;border-bottom:0}.navbar-expand-sm .offcanvas-body{display:flex;flex-grow:0;padding:0;overflow-y:visible}}@media (min-width:768px){.navbar-expand-md{flex-wrap:nowrap;justify-content:flex-start}.navbar-expand-md .navbar-nav{flex-direction:row}.navbar-expand-md .navbar-nav .dropdown-menu{position:absolute}.navbar-expand-md .navbar-nav .nav-link{padding-right:.5rem;padding-left:.5rem}.navbar-expand-md .navbar-nav-scroll{overflow:visible}.navbar-expand-md .navbar-collapse{display:flex!important;flex-basis:auto}.navbar-expand-md .navbar-toggler{display:none}.navbar-expand-md .offcanvas-header{display:none}.navbar-expand-md .offcanvas{position:inherit;bottom:0;z-index:1000;flex-grow:1;visibility:visible!important;background-color:transparent;border-right:0;border-left:0;transition:none;transform:none}.navbar-expand-md .offcanvas-bottom,.navbar-expand-md .offcanvas-top{height:auto;border-top:0;border-bottom:0}.navbar-expand-md .offcanvas-body{display:flex;flex-grow:0;padding:0;overflow-y:visible}}@media (min-width:992px){.navbar-expand-lg{flex-wrap:nowrap;justify-content:flex-start}.navbar-expand-lg .navbar-nav{flex-direction:row}.navbar-expand-lg .navbar-nav .dropdown-menu{position:absolute}.navbar-expand-lg .navbar-nav .nav-link{padding-right:.5rem;padding-left:.5rem}.navbar-expand-lg .navbar-nav-scroll{overflow:visible}.navbar-expand-lg .navbar-collapse{display:flex!important;flex-basis:auto}.navbar-expand-lg .navbar-toggler{display:none}.navbar-expand-lg .offcanvas-header{display:none}.navbar-expand-lg .offcanvas{position:inherit;bottom:0;z-index:1000;flex-grow:1;visibility:visible!important;background-color:transparent;border-right:0;border-left:0;transition:none;transform:none}.navbar-expand-lg .offcanvas-bottom,.navbar-expand-lg .offcanvas-top{height:auto;border-top:0;border-bottom:0}.navbar-expand-lg .offcanvas-body{display:flex;flex-grow:0;padding:0;overflow-y:visible}}@media (min-width:1200px){.navbar-expand-xl{flex-wrap:nowrap;justify-content:flex-start}.navbar-expand-xl .navbar-nav{flex-direction:row}.navbar-expand-xl .navbar-nav .dropdown-menu{position:absolute}.navbar-expand-xl .navbar-nav .nav-link{padding-right:.5rem;padding-left:.5rem}.navbar-expand-xl .navbar-nav-scroll{overflow:visible}.navbar-expand-xl .navbar-collapse{display:flex!important;flex-basis:auto}.navbar-expand-xl .navbar-toggler{display:none}.navbar-expand-xl .offcanvas-header{display:none}.navbar-expand-xl .offcanvas{position:inherit;bottom:0;z-index:1000;flex-grow:1;visibility:visible!important;background-color:transparent;border-right:0;border-left:0;transition:none;transform:none}.navbar-expand-xl .offcanvas-bottom,.navbar-expand-xl .offcanvas-top{height:auto;border-top:0;border-bottom:0}.navbar-expand-xl .offcanvas-body{display:flex;flex-grow:0;padding:0;overflow-y:visible}}@media (min-width:1400px){.navbar-expand-xxl{flex-wrap:nowrap;justify-content:flex-start}.navbar-expand-xxl .navbar-nav{flex-direction:row}.navbar-expand-xxl .navbar-nav .dropdown-menu{position:absolute}.navbar-expand-xxl .navbar-nav .nav-link{padding-right:.5rem;padding-left:.5rem}.navbar-expand-xxl .navbar-nav-scroll{overflow:visible}.navbar-expand-xxl .navbar-collapse{display:flex!important;flex-basis:auto}.navbar-expand-xxl .navbar-toggler{display:none}.navbar-expand-xxl .offcanvas-header{display:none}.navbar-expand-xxl .offcanvas{position:inherit;bottom:0;z-index:1000;flex-grow:1;visibility:visible!important;background-color:transparent;border-right:0;border-left:0;transition:none;transform:none}.navbar-expand-xxl .offcanvas-bottom,.navbar-expand-xxl .offcanvas-top{height:auto;border-top:0;border-bottom:0}.navbar-expand-xxl .offcanvas-body{display:flex;flex-grow:0;padding:0;overflow-y:visible}}.navbar-expand{flex-wrap:nowrap;justify-content:flex-start}.navbar-expand .navbar-nav{flex-direction:row}.navbar-expand .navbar-nav .dropdown-menu{position:absolute}.navbar-expand .navbar-nav .nav-link{padding-right:.5rem;padding-left:.5rem}.navbar-expand .navbar-nav-scroll{overflow:visible}.navbar-expand .navbar-collapse{display:flex!important;flex-basis:auto}.navbar-expand .navbar-toggler{display:none}.navbar-expand .offcanvas-header{display:none}.navbar-expand .offcanvas{position:inherit;bottom:0;z-index:1000;flex-grow:1;visibility:visible!important;background-color:transparent;border-right:0;border-left:0;transition:none;transform:none}.navbar-expand .offcanvas-bottom,.navbar-expand .offcanvas-top{height:auto;border-top:0;border-bottom:0}.navbar-expand .offcanvas-body{display:flex;flex-grow:0;padding:0;overflow-y:visible}.navbar-light .navbar-brand{color:rgba(0,0,0,.9)}.navbar-light .navbar-brand:focus,.navbar-light .navbar-brand:hover{color:rgba(0,0,0,.9)}.navbar-light .navbar-nav .nav-link{color:rgba(0,0,0,.55)}.navbar-light .navbar-nav .nav-link:focus,.navbar-light .navbar-nav .nav-link:hover{color:rgba(0,0,0,.7)}.navbar-light .navbar-nav .nav-link.disabled{color:rgba(0,0,0,.3)}.navbar-light .navbar-nav .nav-link.active,.navbar-light .navbar-nav .show>.nav-link{color:rgba(0,0,0,.9)}.navbar-light .navbar-toggler{color:rgba(0,0,0,.55);border-color:rgba(0,0,0,.1)}.navbar-light .navbar-toggler-icon{background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%280, 0, 0, 0.55%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e")}.navbar-light .navbar-text{color:rgba(0,0,0,.55)}.navbar-light .navbar-text a,.navbar-light .navbar-text a:focus,.navbar-light .navbar-text a:hover{color:rgba(0,0,0,.9)}.navbar-dark .navbar-brand{color:#fff}.navbar-dark .navbar-brand:focus,.navbar-dark .navbar-brand:hover{color:#fff}.navbar-dark .navbar-nav .nav-link{color:rgba(255,255,255,.55)}.navbar-dark .navbar-nav .nav-link:focus,.navbar-dark .navbar-nav .nav-link:hover{color:rgba(255,255,255,.75)}.navbar-dark .navbar-nav .nav-link.disabled{color:rgba(255,255,255,.25)}.navbar-dark .navbar-nav .nav-link.active,.navbar-dark .navbar-nav .show>.nav-link{color:#fff}.navbar-dark .navbar-toggler{color:rgba(255,255,255,.55);border-color:rgba(255,255,255,.1)}.navbar-dark .navbar-toggler-icon{background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%28255, 255, 255, 0.55%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e")}.navbar-dark .navbar-text{color:rgba(255,255,255,.55)}.navbar-dark .navbar-text a,.navbar-dark .navbar-text a:focus,.navbar-dark .navbar-text a:hover{color:#fff}.card{position:relative;display:flex;flex-direction:column;min-width:0;word-wrap:break-word;background-color:#fff;background-clip:border-box;border:1px solid rgba(0,0,0,.125);border-radius:.25rem}.card>hr{margin-right:0;margin-left:0}.card>.list-group{border-top:inherit;border-bottom:inherit}.card>.list-group:first-child{border-top-width:0;border-top-left-radius:calc(.25rem - 1px);border-top-right-radius:calc(.25rem - 1px)}.card>.list-group:last-child{border-bottom-width:0;border-bottom-right-radius:calc(.25rem - 1px);border-bottom-left-radius:calc(.25rem - 1px)}.card>.card-header+.list-group,.card>.list-group+.card-footer{border-top:0}.card-body{flex:1 1 auto;padding:1rem 1rem}.card-title{margin-bottom:.5rem}.card-subtitle{margin-top:-.25rem;margin-bottom:0}.card-text:last-child{margin-bottom:0}.card-link+.card-link{margin-left:1rem}.card-header{padding:.5rem 1rem;margin-bottom:0;background-color:rgba(0,0,0,.03);border-bottom:1px solid rgba(0,0,0,.125)}.card-header:first-child{border-radius:calc(.25rem - 1px) calc(.25rem - 1px) 0 0}.card-footer{padding:.5rem 1rem;background-color:rgba(0,0,0,.03);border-top:1px solid rgba(0,0,0,.125)}.card-footer:last-child{border-radius:0 0 calc(.25rem - 1px) calc(.25rem - 1px)}.card-header-tabs{margin-right:-.5rem;margin-bottom:-.5rem;margin-left:-.5rem;border-bottom:0}.card-header-pills{margin-right:-.5rem;margin-left:-.5rem}.card-img-overlay{position:absolute;top:0;right:0;bottom:0;left:0;padding:1rem;border-radius:calc(.25rem - 1px)}.card-img,.card-img-bottom,.card-img-top{width:100%}.card-img,.card-img-top{border-top-left-radius:calc(.25rem - 1px);border-top-right-radius:calc(.25rem - 1px)}.card-img,.card-img-bottom{border-bottom-right-radius:calc(.25rem - 1px);border-bottom-left-radius:calc(.25rem - 1px)}.card-group>.card{margin-bottom:.75rem}@media (min-width:576px){.card-group{display:flex;flex-flow:row wrap}.card-group>.card{flex:1 0 0%;margin-bottom:0}.card-group>.card+.card{margin-left:0;border-left:0}.card-group>.card:not(:last-child){border-top-right-radius:0;border-bottom-right-radius:0}.card-group>.card:not(:last-child) .card-header,.card-group>.card:not(:last-child) .card-img-top{border-top-right-radius:0}.card-group>.card:not(:last-child) .card-footer,.card-group>.card:not(:last-child) .card-img-bottom{border-bottom-right-radius:0}.card-group>.card:not(:first-child){border-top-left-radius:0;border-bottom-left-radius:0}.card-group>.card:not(:first-child) .card-header,.card-group>.card:not(:first-child) .card-img-top{border-top-left-radius:0}.card-group>.card:not(:first-child) .card-footer,.card-group>.card:not(:first-child) .card-img-bottom{border-bottom-left-radius:0}}.accordion-button{position:relative;display:flex;align-items:center;width:100%;padding:1rem 1.25rem;font-size:1rem;color:#212529;text-align:left;background-color:#fff;border:0;border-radius:0;overflow-anchor:none;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out,border-radius .15s ease}@media (prefers-reduced-motion:reduce){.accordion-button{transition:none}}.accordion-button:not(.collapsed){color:#0c63e4;background-color:#e7f1ff;box-shadow:inset 0 -1px 0 rgba(0,0,0,.125)}.accordion-button:not(.collapsed)::after{background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%230c63e4'%3e%3cpath fill-rule='evenodd' d='M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z'/%3e%3c/svg%3e");transform:rotate(-180deg)}.accordion-button::after{flex-shrink:0;width:1.25rem;height:1.25rem;margin-left:auto;content:"";background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23212529'%3e%3cpath fill-rule='evenodd' d='M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z'/%3e%3c/svg%3e");background-repeat:no-repeat;background-size:1.25rem;transition:transform .2s ease-in-out}@media (prefers-reduced-motion:reduce){.accordion-button::after{transition:none}}.accordion-button:hover{z-index:2}.accordion-button:focus{z-index:3;border-color:#86b7fe;outline:0;box-shadow:0 0 0 .25rem rgba(13,110,253,.25)}.accordion-header{margin-bottom:0}.accordion-item{background-color:#fff;border:1px solid rgba(0,0,0,.125)}.accordion-item:first-of-type{border-top-left-radius:.25rem;border-top-right-radius:.25rem}.accordion-item:first-of-type .accordion-button{border-top-left-radius:calc(.25rem - 1px);border-top-right-radius:calc(.25rem - 1px)}.accordion-item:not(:first-of-type){border-top:0}.accordion-item:last-of-type{border-bottom-right-radius:.25rem;border-bottom-left-radius:.25rem}.accordion-item:last-of-type .accordion-button.collapsed{border-bottom-right-radius:calc(.25rem - 1px);border-bottom-left-radius:calc(.25rem - 1px)}.accordion-item:last-of-type .accordion-collapse{border-bottom-right-radius:.25rem;border-bottom-left-radius:.25rem}.accordion-body{padding:1rem 1.25rem}.accordion-flush .accordion-collapse{border-width:0}.accordion-flush .accordion-item{border-right:0;border-left:0;border-radius:0}.accordion-flush .accordion-item:first-child{border-top:0}.accordion-flush .accordion-item:last-child{border-bottom:0}.accordion-flush .accordion-item .accordion-button{border-radius:0}.breadcrumb{display:flex;flex-wrap:wrap;padding:0 0;margin-bottom:1rem;list-style:none}.breadcrumb-item+.breadcrumb-item{padding-left:.5rem}.breadcrumb-item+.breadcrumb-item::before{float:left;padding-right:.5rem;color:#6c757d;content:var(--bs-breadcrumb-divider, "/")}.breadcrumb-item.active{color:#6c757d}.pagination{display:flex;padding-left:0;list-style:none}.page-link{position:relative;display:block;color:#0d6efd;text-decoration:none;background-color:#fff;border:1px solid #dee2e6;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media (prefers-reduced-motion:reduce){.page-link{transition:none}}.page-link:hover{z-index:2;color:#0a58ca;background-color:#e9ecef;border-color:#dee2e6}.page-link:focus{z-index:3;color:#0a58ca;background-color:#e9ecef;outline:0;box-shadow:0 0 0 .25rem rgba(13,110,253,.25)}.page-item:not(:first-child) .page-link{margin-left:-1px}.page-item.active .page-link{z-index:3;color:#fff;background-color:#0d6efd;border-color:#0d6efd}.page-item.disabled .page-link{color:#6c757d;pointer-events:none;background-color:#fff;border-color:#dee2e6}.page-link{padding:.375rem .75rem}.page-item:first-child .page-link{border-top-left-radius:.25rem;border-bottom-left-radius:.25rem}.page-item:last-child .page-link{border-top-right-radius:.25rem;border-bottom-right-radius:.25rem}.pagination-lg .page-link{padding:.75rem 1.5rem;font-size:1.25rem}.pagination-lg .page-item:first-child .page-link{border-top-left-radius:.3rem;border-bottom-left-radius:.3rem}.pagination-lg .page-item:last-child .page-link{border-top-right-radius:.3rem;border-bottom-right-radius:.3rem}.pagination-sm .page-link{padding:.25rem .5rem;font-size:.875rem}.pagination-sm .page-item:first-child .page-link{border-top-left-radius:.2rem;border-bottom-left-radius:.2rem}.pagination-sm .page-item:last-child .page-link{border-top-right-radius:.2rem;border-bottom-right-radius:.2rem}.badge{display:inline-block;padding:.35em .65em;font-size:.75em;font-weight:700;line-height:1;color:#fff;text-align:center;white-space:nowrap;vertical-align:baseline;border-radius:.25rem}.badge:empty{display:none}.btn .badge{position:relative;top:-1px}.alert{position:relative;padding:1rem 1rem;margin-bottom:1rem;border:1px solid transparent;border-radius:.25rem}.alert-heading{color:inherit}.alert-link{font-weight:700}.alert-dismissible{padding-right:3rem}.alert-dismissible .btn-close{position:absolute;top:0;right:0;z-index:2;padding:1.25rem 1rem}.alert-primary{color:#084298;background-color:#cfe2ff;border-color:#b6d4fe}.alert-primary .alert-link{color:#06357a}.alert-secondary{color:#41464b;background-color:#e2e3e5;border-color:#d3d6d8}.alert-secondary .alert-link{color:#34383c}.alert-success{color:#0f5132;background-color:#d1e7dd;border-color:#badbcc}.alert-success .alert-link{color:#0c4128}.alert-info{color:#055160;background-color:#cff4fc;border-color:#b6effb}.alert-info .alert-link{color:#04414d}.alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5}.alert-warning .alert-link{color:#523e02}.alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7}.alert-danger .alert-link{color:#6a1a21}.alert-light{color:#636464;background-color:#fefefe;border-color:#fdfdfe}.alert-light .alert-link{color:#4f5050}.alert-dark{color:#141619;background-color:#d3d3d4;border-color:#bcbebf}.alert-dark .alert-link{color:#101214}@-webkit-keyframes progress-bar-stripes{0%{background-position-x:1rem}}@keyframes progress-bar-stripes{0%{background-position-x:1rem}}.progress{display:flex;height:1rem;overflow:hidden;font-size:.75rem;background-color:#e9ecef;border-radius:.25rem}.progress-bar{display:flex;flex-direction:column;justify-content:center;overflow:hidden;color:#fff;text-align:center;white-space:nowrap;background-color:#0d6efd;transition:width .6s ease}@media (prefers-reduced-motion:reduce){.progress-bar{transition:none}}.progress-bar-striped{background-image:linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);background-size:1rem 1rem}.progress-bar-animated{-webkit-animation:1s linear infinite progress-bar-stripes;animation:1s linear infinite progress-bar-stripes}@media (prefers-reduced-motion:reduce){.progress-bar-animated{-webkit-animation:none;animation:none}}.list-group{display:flex;flex-direction:column;padding-left:0;margin-bottom:0;border-radius:.25rem}.list-group-numbered{list-style-type:none;counter-reset:section}.list-group-numbered>li::before{content:counters(section, ".") ". ";counter-increment:section}.list-group-item-action{width:100%;color:#495057;text-align:inherit}.list-group-item-action:focus,.list-group-item-action:hover{z-index:1;color:#495057;text-decoration:none;background-color:#f8f9fa}.list-group-item-action:active{color:#212529;background-color:#e9ecef}.list-group-item{position:relative;display:block;padding:.5rem 1rem;color:#212529;text-decoration:none;background-color:#fff;border:1px solid rgba(0,0,0,.125)}.list-group-item:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.list-group-item:last-child{border-bottom-right-radius:inherit;border-bottom-left-radius:inherit}.list-group-item.disabled,.list-group-item:disabled{color:#6c757d;pointer-events:none;background-color:#fff}.list-group-item.active{z-index:2;color:#fff;background-color:#0d6efd;border-color:#0d6efd}.list-group-item+.list-group-item{border-top-width:0}.list-group-item+.list-group-item.active{margin-top:-1px;border-top-width:1px}.list-group-horizontal{flex-direction:row}.list-group-horizontal>.list-group-item:first-child{border-bottom-left-radius:.25rem;border-top-right-radius:0}.list-group-horizontal>.list-group-item:last-child{border-top-right-radius:.25rem;border-bottom-left-radius:0}.list-group-horizontal>.list-group-item.active{margin-top:0}.list-group-horizontal>.list-group-item+.list-group-item{border-top-width:1px;border-left-width:0}.list-group-horizontal>.list-group-item+.list-group-item.active{margin-left:-1px;border-left-width:1px}@media (min-width:576px){.list-group-horizontal-sm{flex-direction:row}.list-group-horizontal-sm>.list-group-item:first-child{border-bottom-left-radius:.25rem;border-top-right-radius:0}.list-group-horizontal-sm>.list-group-item:last-child{border-top-right-radius:.25rem;border-bottom-left-radius:0}.list-group-horizontal-sm>.list-group-item.active{margin-top:0}.list-group-horizontal-sm>.list-group-item+.list-group-item{border-top-width:1px;border-left-width:0}.list-group-horizontal-sm>.list-group-item+.list-group-item.active{margin-left:-1px;border-left-width:1px}}@media (min-width:768px){.list-group-horizontal-md{flex-direction:row}.list-group-horizontal-md>.list-group-item:first-child{border-bottom-left-radius:.25rem;border-top-right-radius:0}.list-group-horizontal-md>.list-group-item:last-child{border-top-right-radius:.25rem;border-bottom-left-radius:0}.list-group-horizontal-md>.list-group-item.active{margin-top:0}.list-group-horizontal-md>.list-group-item+.list-group-item{border-top-width:1px;border-left-width:0}.list-group-horizontal-md>.list-group-item+.list-group-item.active{margin-left:-1px;border-left-width:1px}}@media (min-width:992px){.list-group-horizontal-lg{flex-direction:row}.list-group-horizontal-lg>.list-group-item:first-child{border-bottom-left-radius:.25rem;border-top-right-radius:0}.list-group-horizontal-lg>.list-group-item:last-child{border-top-right-radius:.25rem;border-bottom-left-radius:0}.list-group-horizontal-lg>.list-group-item.active{margin-top:0}.list-group-horizontal-lg>.list-group-item+.list-group-item{border-top-width:1px;border-left-width:0}.list-group-horizontal-lg>.list-group-item+.list-group-item.active{margin-left:-1px;border-left-width:1px}}@media (min-width:1200px){.list-group-horizontal-xl{flex-direction:row}.list-group-horizontal-xl>.list-group-item:first-child{border-bottom-left-radius:.25rem;border-top-right-radius:0}.list-group-horizontal-xl>.list-group-item:last-child{border-top-right-radius:.25rem;border-bottom-left-radius:0}.list-group-horizontal-xl>.list-group-item.active{margin-top:0}.list-group-horizontal-xl>.list-group-item+.list-group-item{border-top-width:1px;border-left-width:0}.list-group-horizontal-xl>.list-group-item+.list-group-item.active{margin-left:-1px;border-left-width:1px}}@media (min-width:1400px){.list-group-horizontal-xxl{flex-direction:row}.list-group-horizontal-xxl>.list-group-item:first-child{border-bottom-left-radius:.25rem;border-top-right-radius:0}.list-group-horizontal-xxl>.list-group-item:last-child{border-top-right-radius:.25rem;border-bottom-left-radius:0}.list-group-horizontal-xxl>.list-group-item.active{margin-top:0}.list-group-horizontal-xxl>.list-group-item+.list-group-item{border-top-width:1px;border-left-width:0}.list-group-horizontal-xxl>.list-group-item+.list-group-item.active{margin-left:-1px;border-left-width:1px}}.list-group-flush{border-radius:0}.list-group-flush>.list-group-item{border-width:0 0 1px}.list-group-flush>.list-group-item:last-child{border-bottom-width:0}.list-group-item-primary{color:#084298;background-color:#cfe2ff}.list-group-item-primary.list-group-item-action:focus,.list-group-item-primary.list-group-item-action:hover{color:#084298;background-color:#bacbe6}.list-group-item-primary.list-group-item-action.active{color:#fff;background-color:#084298;border-color:#084298}.list-group-item-secondary{color:#41464b;background-color:#e2e3e5}.list-group-item-secondary.list-group-item-action:focus,.list-group-item-secondary.list-group-item-action:hover{color:#41464b;background-color:#cbccce}.list-group-item-secondary.list-group-item-action.active{color:#fff;background-color:#41464b;border-color:#41464b}.list-group-item-success{color:#0f5132;background-color:#d1e7dd}.list-group-item-success.list-group-item-action:focus,.list-group-item-success.list-group-item-action:hover{color:#0f5132;background-color:#bcd0c7}.list-group-item-success.list-group-item-action.active{color:#fff;background-color:#0f5132;border-color:#0f5132}.list-group-item-info{color:#055160;background-color:#cff4fc}.list-group-item-info.list-group-item-action:focus,.list-group-item-info.list-group-item-action:hover{color:#055160;background-color:#badce3}.list-group-item-info.list-group-item-action.active{color:#fff;background-color:#055160;border-color:#055160}.list-group-item-warning{color:#664d03;background-color:#fff3cd}.list-group-item-warning.list-group-item-action:focus,.list-group-item-warning.list-group-item-action:hover{color:#664d03;background-color:#e6dbb9}.list-group-item-warning.list-group-item-action.active{color:#fff;background-color:#664d03;border-color:#664d03}.list-group-item-danger{color:#842029;background-color:#f8d7da}.list-group-item-danger.list-group-item-action:focus,.list-group-item-danger.list-group-item-action:hover{color:#842029;background-color:#dfc2c4}.list-group-item-danger.list-group-item-action.active{color:#fff;background-color:#842029;border-color:#842029}.list-group-item-light{color:#636464;background-color:#fefefe}.list-group-item-light.list-group-item-action:focus,.list-group-item-light.list-group-item-action:hover{color:#636464;background-color:#e5e5e5}.list-group-item-light.list-group-item-action.active{color:#fff;background-color:#636464;border-color:#636464}.list-group-item-dark{color:#141619;background-color:#d3d3d4}.list-group-item-dark.list-group-item-action:focus,.list-group-item-dark.list-group-item-action:hover{color:#141619;background-color:#bebebf}.list-group-item-dark.list-group-item-action.active{color:#fff;background-color:#141619;border-color:#141619}.btn-close{box-sizing:content-box;width:1em;height:1em;padding:.25em .25em;color:#000;background:transparent url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23000'%3e%3cpath d='M.293.293a1 1 0 011.414 0L8 6.586 14.293.293a1 1 0 111.414 1.414L9.414 8l6.293 6.293a1 1 0 01-1.414 1.414L8 9.414l-6.293 6.293a1 1 0 01-1.414-1.414L6.586 8 .293 1.707a1 1 0 010-1.414z'/%3e%3c/svg%3e") center/1em auto no-repeat;border:0;border-radius:.25rem;opacity:.5}.btn-close:hover{color:#000;text-decoration:none;opacity:.75}.btn-close:focus{outline:0;box-shadow:0 0 0 .25rem rgba(13,110,253,.25);opacity:1}.btn-close.disabled,.btn-close:disabled{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;opacity:.25}.btn-close-white{filter:invert(1) grayscale(100%) brightness(200%)}.toast{width:350px;max-width:100%;font-size:.875rem;pointer-events:auto;background-color:rgba(255,255,255,.85);background-clip:padding-box;border:1px solid rgba(0,0,0,.1);box-shadow:0 .5rem 1rem rgba(0,0,0,.15);border-radius:.25rem}.toast.showing{opacity:0}.toast:not(.show){display:none}.toast-container{width:-webkit-max-content;width:-moz-max-content;width:max-content;max-width:100%;pointer-events:none}.toast-container>:not(:last-child){margin-bottom:.75rem}.toast-header{display:flex;align-items:center;padding:.5rem .75rem;color:#6c757d;background-color:rgba(255,255,255,.85);background-clip:padding-box;border-bottom:1px solid rgba(0,0,0,.05);border-top-left-radius:calc(.25rem - 1px);border-top-right-radius:calc(.25rem - 1px)}.toast-header .btn-close{margin-right:-.375rem;margin-left:.75rem}.toast-body{padding:.75rem;word-wrap:break-word}.modal{position:fixed;top:0;left:0;z-index:1055;display:none;width:100%;height:100%;overflow-x:hidden;overflow-y:auto;outline:0}.modal-dialog{position:relative;width:auto;margin:.5rem;pointer-events:none}.modal.fade .modal-dialog{transition:transform .3s ease-out;transform:translate(0,-50px)}@media (prefers-reduced-motion:reduce){.modal.fade .modal-dialog{transition:none}}.modal.show .modal-dialog{transform:none}.modal.modal-static .modal-dialog{transform:scale(1.02)}.modal-dialog-scrollable{height:calc(100% - 1rem)}.modal-dialog-scrollable .modal-content{max-height:100%;overflow:hidden}.modal-dialog-scrollable .modal-body{overflow-y:auto}.modal-dialog-centered{display:flex;align-items:center;min-height:calc(100% - 1rem)}.modal-content{position:relative;display:flex;flex-direction:column;width:100%;pointer-events:auto;background-color:#fff;background-clip:padding-box;border:1px solid rgba(0,0,0,.2);border-radius:.3rem;outline:0}.modal-backdrop{position:fixed;top:0;left:0;z-index:1050;width:100vw;height:100vh;background-color:#000}.modal-backdrop.fade{opacity:0}.modal-backdrop.show{opacity:.5}.modal-header{display:flex;flex-shrink:0;align-items:center;justify-content:space-between;padding:1rem 1rem;border-bottom:1px solid #dee2e6;border-top-left-radius:calc(.3rem - 1px);border-top-right-radius:calc(.3rem - 1px)}.modal-header .btn-close{padding:.5rem .5rem;margin:-.5rem -.5rem -.5rem auto}.modal-title{margin-bottom:0;line-height:1.5}.modal-body{position:relative;flex:1 1 auto;padding:1rem}.modal-footer{display:flex;flex-wrap:wrap;flex-shrink:0;align-items:center;justify-content:flex-end;padding:.75rem;border-top:1px solid #dee2e6;border-bottom-right-radius:calc(.3rem - 1px);border-bottom-left-radius:calc(.3rem - 1px)}.modal-footer>*{margin:.25rem}@media (min-width:576px){.modal-dialog{max-width:500px;margin:1.75rem auto}.modal-dialog-scrollable{height:calc(100% - 3.5rem)}.modal-dialog-centered{min-height:calc(100% - 3.5rem)}.modal-sm{max-width:300px}}@media (min-width:992px){.modal-lg,.modal-xl{max-width:800px}}@media (min-width:1200px){.modal-xl{max-width:1140px}}.modal-fullscreen{width:100vw;max-width:none;height:100%;margin:0}.modal-fullscreen .modal-content{height:100%;border:0;border-radius:0}.modal-fullscreen .modal-header{border-radius:0}.modal-fullscreen .modal-body{overflow-y:auto}.modal-fullscreen .modal-footer{border-radius:0}@media (max-width:575.98px){.modal-fullscreen-sm-down{width:100vw;max-width:none;height:100%;margin:0}.modal-fullscreen-sm-down .modal-content{height:100%;border:0;border-radius:0}.modal-fullscreen-sm-down .modal-header{border-radius:0}.modal-fullscreen-sm-down .modal-body{overflow-y:auto}.modal-fullscreen-sm-down .modal-footer{border-radius:0}}@media (max-width:767.98px){.modal-fullscreen-md-down{width:100vw;max-width:none;height:100%;margin:0}.modal-fullscreen-md-down .modal-content{height:100%;border:0;border-radius:0}.modal-fullscreen-md-down .modal-header{border-radius:0}.modal-fullscreen-md-down .modal-body{overflow-y:auto}.modal-fullscreen-md-down .modal-footer{border-radius:0}}@media (max-width:991.98px){.modal-fullscreen-lg-down{width:100vw;max-width:none;height:100%;margin:0}.modal-fullscreen-lg-down .modal-content{height:100%;border:0;border-radius:0}.modal-fullscreen-lg-down .modal-header{border-radius:0}.modal-fullscreen-lg-down .modal-body{overflow-y:auto}.modal-fullscreen-lg-down .modal-footer{border-radius:0}}@media (max-width:1199.98px){.modal-fullscreen-xl-down{width:100vw;max-width:none;height:100%;margin:0}.modal-fullscreen-xl-down .modal-content{height:100%;border:0;border-radius:0}.modal-fullscreen-xl-down .modal-header{border-radius:0}.modal-fullscreen-xl-down .modal-body{overflow-y:auto}.modal-fullscreen-xl-down .modal-footer{border-radius:0}}@media (max-width:1399.98px){.modal-fullscreen-xxl-down{width:100vw;max-width:none;height:100%;margin:0}.modal-fullscreen-xxl-down .modal-content{height:100%;border:0;border-radius:0}.modal-fullscreen-xxl-down .modal-header{border-radius:0}.modal-fullscreen-xxl-down .modal-body{overflow-y:auto}.modal-fullscreen-xxl-down .modal-footer{border-radius:0}}.tooltip{position:absolute;z-index:1080;display:block;margin:0;font-family:var(--bs-font-sans-serif);font-style:normal;font-weight:400;line-height:1.5;text-align:left;text-align:start;text-decoration:none;text-shadow:none;text-transform:none;letter-spacing:normal;word-break:normal;word-spacing:normal;white-space:normal;line-break:auto;font-size:.875rem;word-wrap:break-word;opacity:0}.tooltip.show{opacity:.9}.tooltip .tooltip-arrow{position:absolute;display:block;width:.8rem;height:.4rem}.tooltip .tooltip-arrow::before{position:absolute;content:"";border-color:transparent;border-style:solid}.bs-tooltip-auto[data-popper-placement^=top],.bs-tooltip-top{padding:.4rem 0}.bs-tooltip-auto[data-popper-placement^=top] .tooltip-arrow,.bs-tooltip-top .tooltip-arrow{bottom:0}.bs-tooltip-auto[data-popper-placement^=top] .tooltip-arrow::before,.bs-tooltip-top .tooltip-arrow::before{top:-1px;border-width:.4rem .4rem 0;border-top-color:#000}.bs-tooltip-auto[data-popper-placement^=right],.bs-tooltip-end{padding:0 .4rem}.bs-tooltip-auto[data-popper-placement^=right] .tooltip-arrow,.bs-tooltip-end .tooltip-arrow{left:0;width:.4rem;height:.8rem}.bs-tooltip-auto[data-popper-placement^=right] .tooltip-arrow::before,.bs-tooltip-end .tooltip-arrow::before{right:-1px;border-width:.4rem .4rem .4rem 0;border-right-color:#000}.bs-tooltip-auto[data-popper-placement^=bottom],.bs-tooltip-bottom{padding:.4rem 0}.bs-tooltip-auto[data-popper-placement^=bottom] .tooltip-arrow,.bs-tooltip-bottom .tooltip-arrow{top:0}.bs-tooltip-auto[data-popper-placement^=bottom] .tooltip-arrow::before,.bs-tooltip-bottom .tooltip-arrow::before{bottom:-1px;border-width:0 .4rem .4rem;border-bottom-color:#000}.bs-tooltip-auto[data-popper-placement^=left],.bs-tooltip-start{padding:0 .4rem}.bs-tooltip-auto[data-popper-placement^=left] .tooltip-arrow,.bs-tooltip-start .tooltip-arrow{right:0;width:.4rem;height:.8rem}.bs-tooltip-auto[data-popper-placement^=left] .tooltip-arrow::before,.bs-tooltip-start .tooltip-arrow::before{left:-1px;border-width:.4rem 0 .4rem .4rem;border-left-color:#000}.tooltip-inner{max-width:200px;padding:.25rem .5rem;color:#fff;text-align:center;background-color:#000;border-radius:.25rem}.popover{position:absolute;top:0;left:0;z-index:1070;display:block;max-width:276px;font-family:var(--bs-font-sans-serif);font-style:normal;font-weight:400;line-height:1.5;text-align:left;text-align:start;text-decoration:none;text-shadow:none;text-transform:none;letter-spacing:normal;word-break:normal;word-spacing:normal;white-space:normal;line-break:auto;font-size:.875rem;word-wrap:break-word;background-color:#fff;background-clip:padding-box;border:1px solid rgba(0,0,0,.2);border-radius:.3rem}.popover .popover-arrow{position:absolute;display:block;width:1rem;height:.5rem}.popover .popover-arrow::after,.popover .popover-arrow::before{position:absolute;display:block;content:"";border-color:transparent;border-style:solid}.bs-popover-auto[data-popper-placement^=top]>.popover-arrow,.bs-popover-top>.popover-arrow{bottom:calc(-.5rem - 1px)}.bs-popover-auto[data-popper-placement^=top]>.popover-arrow::before,.bs-popover-top>.popover-arrow::before{bottom:0;border-width:.5rem .5rem 0;border-top-color:rgba(0,0,0,.25)}.bs-popover-auto[data-popper-placement^=top]>.popover-arrow::after,.bs-popover-top>.popover-arrow::after{bottom:1px;border-width:.5rem .5rem 0;border-top-color:#fff}.bs-popover-auto[data-popper-placement^=right]>.popover-arrow,.bs-popover-end>.popover-arrow{left:calc(-.5rem - 1px);width:.5rem;height:1rem}.bs-popover-auto[data-popper-placement^=right]>.popover-arrow::before,.bs-popover-end>.popover-arrow::before{left:0;border-width:.5rem .5rem .5rem 0;border-right-color:rgba(0,0,0,.25)}.bs-popover-auto[data-popper-placement^=right]>.popover-arrow::after,.bs-popover-end>.popover-arrow::after{left:1px;border-width:.5rem .5rem .5rem 0;border-right-color:#fff}.bs-popover-auto[data-popper-placement^=bottom]>.popover-arrow,.bs-popover-bottom>.popover-arrow{top:calc(-.5rem - 1px)}.bs-popover-auto[data-popper-placement^=bottom]>.popover-arrow::before,.bs-popover-bottom>.popover-arrow::before{top:0;border-width:0 .5rem .5rem .5rem;border-bottom-color:rgba(0,0,0,.25)}.bs-popover-auto[data-popper-placement^=bottom]>.popover-arrow::after,.bs-popover-bottom>.popover-arrow::after{top:1px;border-width:0 .5rem .5rem .5rem;border-bottom-color:#fff}.bs-popover-auto[data-popper-placement^=bottom] .popover-header::before,.bs-popover-bottom .popover-header::before{position:absolute;top:0;left:50%;display:block;width:1rem;margin-left:-.5rem;content:"";border-bottom:1px solid #f0f0f0}.bs-popover-auto[data-popper-placement^=left]>.popover-arrow,.bs-popover-start>.popover-arrow{right:calc(-.5rem - 1px);width:.5rem;height:1rem}.bs-popover-auto[data-popper-placement^=left]>.popover-arrow::before,.bs-popover-start>.popover-arrow::before{right:0;border-width:.5rem 0 .5rem .5rem;border-left-color:rgba(0,0,0,.25)}.bs-popover-auto[data-popper-placement^=left]>.popover-arrow::after,.bs-popover-start>.popover-arrow::after{right:1px;border-width:.5rem 0 .5rem .5rem;border-left-color:#fff}.popover-header{padding:.5rem 1rem;margin-bottom:0;font-size:1rem;background-color:#f0f0f0;border-bottom:1px solid rgba(0,0,0,.2);border-top-left-radius:calc(.3rem - 1px);border-top-right-radius:calc(.3rem - 1px)}.popover-header:empty{display:none}.popover-body{padding:1rem 1rem;color:#212529}.carousel{position:relative}.carousel.pointer-event{touch-action:pan-y}.carousel-inner{position:relative;width:100%;overflow:hidden}.carousel-inner::after{display:block;clear:both;content:""}.carousel-item{position:relative;display:none;float:left;width:100%;margin-right:-100%;-webkit-backface-visibility:hidden;backface-visibility:hidden;transition:transform .6s ease-in-out}@media (prefers-reduced-motion:reduce){.carousel-item{transition:none}}.carousel-item-next,.carousel-item-prev,.carousel-item.active{display:block}.active.carousel-item-end,.carousel-item-next:not(.carousel-item-start){transform:translateX(100%)}.active.carousel-item-start,.carousel-item-prev:not(.carousel-item-end){transform:translateX(-100%)}.carousel-fade .carousel-item{opacity:0;transition-property:opacity;transform:none}.carousel-fade .carousel-item-next.carousel-item-start,.carousel-fade .carousel-item-prev.carousel-item-end,.carousel-fade .carousel-item.active{z-index:1;opacity:1}.carousel-fade .active.carousel-item-end,.carousel-fade .active.carousel-item-start{z-index:0;opacity:0;transition:opacity 0s .6s}@media (prefers-reduced-motion:reduce){.carousel-fade .active.carousel-item-end,.carousel-fade .active.carousel-item-start{transition:none}}.carousel-control-next,.carousel-control-prev{position:absolute;top:0;bottom:0;z-index:1;display:flex;align-items:center;justify-content:center;width:15%;padding:0;color:#fff;text-align:center;background:0 0;border:0;opacity:.5;transition:opacity .15s ease}@media (prefers-reduced-motion:reduce){.carousel-control-next,.carousel-control-prev{transition:none}}.carousel-control-next:focus,.carousel-control-next:hover,.carousel-control-prev:focus,.carousel-control-prev:hover{color:#fff;text-decoration:none;outline:0;opacity:.9}.carousel-control-prev{left:0}.carousel-control-next{right:0}.carousel-control-next-icon,.carousel-control-prev-icon{display:inline-block;width:2rem;height:2rem;background-repeat:no-repeat;background-position:50%;background-size:100% 100%}.carousel-control-prev-icon{background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23fff'%3e%3cpath d='M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z'/%3e%3c/svg%3e")}.carousel-control-next-icon{background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23fff'%3e%3cpath d='M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z'/%3e%3c/svg%3e")}.carousel-indicators{position:absolute;right:0;bottom:0;left:0;z-index:2;display:flex;justify-content:center;padding:0;margin-right:15%;margin-bottom:1rem;margin-left:15%;list-style:none}.carousel-indicators [data-bs-target]{box-sizing:content-box;flex:0 1 auto;width:30px;height:3px;padding:0;margin-right:3px;margin-left:3px;text-indent:-999px;cursor:pointer;background-color:#fff;background-clip:padding-box;border:0;border-top:10px solid transparent;border-bottom:10px solid transparent;opacity:.5;transition:opacity .6s ease}@media (prefers-reduced-motion:reduce){.carousel-indicators [data-bs-target]{transition:none}}.carousel-indicators .active{opacity:1}.carousel-caption{position:absolute;right:15%;bottom:1.25rem;left:15%;padding-top:1.25rem;padding-bottom:1.25rem;color:#fff;text-align:center}.carousel-dark .carousel-control-next-icon,.carousel-dark .carousel-control-prev-icon{filter:invert(1) grayscale(100)}.carousel-dark .carousel-indicators [data-bs-target]{background-color:#000}.carousel-dark .carousel-caption{color:#000}@-webkit-keyframes spinner-border{to{transform:rotate(360deg)}}@keyframes spinner-border{to{transform:rotate(360deg)}}.spinner-border{display:inline-block;width:2rem;height:2rem;vertical-align:-.125em;border:.25em solid currentColor;border-right-color:transparent;border-radius:50%;-webkit-animation:.75s linear infinite spinner-border;animation:.75s linear infinite spinner-border}.spinner-border-sm{width:1rem;height:1rem;border-width:.2em}@-webkit-keyframes spinner-grow{0%{transform:scale(0)}50%{opacity:1;transform:none}}@keyframes spinner-grow{0%{transform:scale(0)}50%{opacity:1;transform:none}}.spinner-grow{display:inline-block;width:2rem;height:2rem;vertical-align:-.125em;background-color:currentColor;border-radius:50%;opacity:0;-webkit-animation:.75s linear infinite spinner-grow;animation:.75s linear infinite spinner-grow}.spinner-grow-sm{width:1rem;height:1rem}@media (prefers-reduced-motion:reduce){.spinner-border,.spinner-grow{-webkit-animation-duration:1.5s;animation-duration:1.5s}}.offcanvas{position:fixed;bottom:0;z-index:1045;display:flex;flex-direction:column;max-width:100%;visibility:hidden;background-color:#fff;background-clip:padding-box;outline:0;transition:transform .3s ease-in-out}@media (prefers-reduced-motion:reduce){.offcanvas{transition:none}}.offcanvas-backdrop{position:fixed;top:0;left:0;z-index:1040;width:100vw;height:100vh;background-color:#000}.offcanvas-backdrop.fade{opacity:0}.offcanvas-backdrop.show{opacity:.5}.offcanvas-header{display:flex;align-items:center;justify-content:space-between;padding:1rem 1rem}.offcanvas-header .btn-close{padding:.5rem .5rem;margin-top:-.5rem;margin-right:-.5rem;margin-bottom:-.5rem}.offcanvas-title{margin-bottom:0;line-height:1.5}.offcanvas-body{flex-grow:1;padding:1rem 1rem;overflow-y:auto}.offcanvas-start{top:0;left:0;width:400px;border-right:1px solid rgba(0,0,0,.2);transform:translateX(-100%)}.offcanvas-end{top:0;right:0;width:400px;border-left:1px solid rgba(0,0,0,.2);transform:translateX(100%)}.offcanvas-top{top:0;right:0;left:0;height:30vh;max-height:100%;border-bottom:1px solid rgba(0,0,0,.2);transform:translateY(-100%)}.offcanvas-bottom{right:0;left:0;height:30vh;max-height:100%;border-top:1px solid rgba(0,0,0,.2);transform:translateY(100%)}.offcanvas.show{transform:none}.placeholder{display:inline-block;min-height:1em;vertical-align:middle;cursor:wait;background-color:currentColor;opacity:.5}.placeholder.btn::before{display:inline-block;content:""}.placeholder-xs{min-height:.6em}.placeholder-sm{min-height:.8em}.placeholder-lg{min-height:1.2em}.placeholder-glow .placeholder{-webkit-animation:placeholder-glow 2s ease-in-out infinite;animation:placeholder-glow 2s ease-in-out infinite}@-webkit-keyframes placeholder-glow{50%{opacity:.2}}@keyframes placeholder-glow{50%{opacity:.2}}.placeholder-wave{-webkit-mask-image:linear-gradient(130deg,#000 55%,rgba(0,0,0,0.8) 75%,#000 95%);mask-image:linear-gradient(130deg,#000 55%,rgba(0,0,0,0.8) 75%,#000 95%);-webkit-mask-size:200% 100%;mask-size:200% 100%;-webkit-animation:placeholder-wave 2s linear infinite;animation:placeholder-wave 2s linear infinite}@-webkit-keyframes placeholder-wave{100%{-webkit-mask-position:-200% 0%;mask-position:-200% 0%}}@keyframes placeholder-wave{100%{-webkit-mask-position:-200% 0%;mask-position:-200% 0%}}.clearfix::after{display:block;clear:both;content:""}.link-primary{color:#0d6efd}.link-primary:focus,.link-primary:hover{color:#0a58ca}.link-secondary{color:#6c757d}.link-secondary:focus,.link-secondary:hover{color:#565e64}.link-success{color:#198754}.link-success:focus,.link-success:hover{color:#146c43}.link-info{color:#0dcaf0}.link-info:focus,.link-info:hover{color:#3dd5f3}.link-warning{color:#ffc107}.link-warning:focus,.link-warning:hover{color:#ffcd39}.link-danger{color:#dc3545}.link-danger:focus,.link-danger:hover{color:#b02a37}.link-light{color:#f8f9fa}.link-light:focus,.link-light:hover{color:#f9fafb}.link-dark{color:#212529}.link-dark:focus,.link-dark:hover{color:#1a1e21}.ratio{position:relative;width:100%}.ratio::before{display:block;padding-top:var(--bs-aspect-ratio);content:""}.ratio>*{position:absolute;top:0;left:0;width:100%;height:100%}.ratio-1x1{--bs-aspect-ratio:100%}.ratio-4x3{--bs-aspect-ratio:75%}.ratio-16x9{--bs-aspect-ratio:56.25%}.ratio-21x9{--bs-aspect-ratio:42.8571428571%}.fixed-top{position:fixed;top:0;right:0;left:0;z-index:1030}.fixed-bottom{position:fixed;right:0;bottom:0;left:0;z-index:1030}.sticky-top{position:-webkit-sticky;position:sticky;top:0;z-index:1020}@media (min-width:576px){.sticky-sm-top{position:-webkit-sticky;position:sticky;top:0;z-index:1020}}@media (min-width:768px){.sticky-md-top{position:-webkit-sticky;position:sticky;top:0;z-index:1020}}@media (min-width:992px){.sticky-lg-top{position:-webkit-sticky;position:sticky;top:0;z-index:1020}}@media (min-width:1200px){.sticky-xl-top{position:-webkit-sticky;position:sticky;top:0;z-index:1020}}@media (min-width:1400px){.sticky-xxl-top{position:-webkit-sticky;position:sticky;top:0;z-index:1020}}.hstack{display:flex;flex-direction:row;align-items:center;align-self:stretch}.vstack{display:flex;flex:1 1 auto;flex-direction:column;align-self:stretch}.visually-hidden,.visually-hidden-focusable:not(:focus):not(:focus-within){position:absolute!important;width:1px!important;height:1px!important;padding:0!important;margin:-1px!important;overflow:hidden!important;clip:rect(0,0,0,0)!important;white-space:nowrap!important;border:0!important}.stretched-link::after{position:absolute;top:0;right:0;bottom:0;left:0;z-index:1;content:""}.text-truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.vr{display:inline-block;align-self:stretch;width:1px;min-height:1em;background-color:currentColor;opacity:.25}.align-baseline{vertical-align:baseline!important}.align-top{vertical-align:top!important}.align-middle{vertical-align:middle!important}.align-bottom{vertical-align:bottom!important}.align-text-bottom{vertical-align:text-bottom!important}.align-text-top{vertical-align:text-top!important}.float-start{float:left!important}.float-end{float:right!important}.float-none{float:none!important}.opacity-0{opacity:0!important}.opacity-25{opacity:.25!important}.opacity-50{opacity:.5!important}.opacity-75{opacity:.75!important}.opacity-100{opacity:1!important}.overflow-auto{overflow:auto!important}.overflow-hidden{overflow:hidden!important}.overflow-visible{overflow:visible!important}.overflow-scroll{overflow:scroll!important}.d-inline{display:inline!important}.d-inline-block{display:inline-block!important}.d-block{display:block!important}.d-grid{display:grid!important}.d-table{display:table!important}.d-table-row{display:table-row!important}.d-table-cell{display:table-cell!important}.d-flex{display:flex!important}.d-inline-flex{display:inline-flex!important}.d-none{display:none!important}.shadow{box-shadow:0 .5rem 1rem rgba(0,0,0,.15)!important}.shadow-sm{box-shadow:0 .125rem .25rem rgba(0,0,0,.075)!important}.shadow-lg{box-shadow:0 1rem 3rem rgba(0,0,0,.175)!important}.shadow-none{box-shadow:none!important}.position-static{position:static!important}.position-relative{position:relative!important}.position-absolute{position:absolute!important}.position-fixed{position:fixed!important}.position-sticky{position:-webkit-sticky!important;position:sticky!important}.top-0{top:0!important}.top-50{top:50%!important}.top-100{top:100%!important}.bottom-0{bottom:0!important}.bottom-50{bottom:50%!important}.bottom-100{bottom:100%!important}.start-0{left:0!important}.start-50{left:50%!important}.start-100{left:100%!important}.end-0{right:0!important}.end-50{right:50%!important}.end-100{right:100%!important}.translate-middle{transform:translate(-50%,-50%)!important}.translate-middle-x{transform:translateX(-50%)!important}.translate-middle-y{transform:translateY(-50%)!important}.border{border:1px solid #dee2e6!important}.border-0{border:0!important}.border-top{border-top:1px solid #dee2e6!important}.border-top-0{border-top:0!important}.border-end{border-right:1px solid #dee2e6!important}.border-end-0{border-right:0!important}.border-bottom{border-bottom:1px solid #dee2e6!important}.border-bottom-0{border-bottom:0!important}.border-start{border-left:1px solid #dee2e6!important}.border-start-0{border-left:0!important}.border-primary{border-color:#0d6efd!important}.border-secondary{border-color:#6c757d!important}.border-success{border-color:#198754!important}.border-info{border-color:#0dcaf0!important}.border-warning{border-color:#ffc107!important}.border-danger{border-color:#dc3545!important}.border-light{border-color:#f8f9fa!important}.border-dark{border-color:#212529!important}.border-white{border-color:#fff!important}.border-1{border-width:1px!important}.border-2{border-width:2px!important}.border-3{border-width:3px!important}.border-4{border-width:4px!important}.border-5{border-width:5px!important}.w-25{width:25%!important}.w-50{width:50%!important}.w-75{width:75%!important}.w-100{width:100%!important}.w-auto{width:auto!important}.mw-100{max-width:100%!important}.vw-100{width:100vw!important}.min-vw-100{min-width:100vw!important}.h-25{height:25%!important}.h-50{height:50%!important}.h-75{height:75%!important}.h-100{height:100%!important}.h-auto{height:auto!important}.mh-100{max-height:100%!important}.vh-100{height:100vh!important}.min-vh-100{min-height:100vh!important}.flex-fill{flex:1 1 auto!important}.flex-row{flex-direction:row!important}.flex-column{flex-direction:column!important}.flex-row-reverse{flex-direction:row-reverse!important}.flex-column-reverse{flex-direction:column-reverse!important}.flex-grow-0{flex-grow:0!important}.flex-grow-1{flex-grow:1!important}.flex-shrink-0{flex-shrink:0!important}.flex-shrink-1{flex-shrink:1!important}.flex-wrap{flex-wrap:wrap!important}.flex-nowrap{flex-wrap:nowrap!important}.flex-wrap-reverse{flex-wrap:wrap-reverse!important}.gap-0{gap:0!important}.gap-1{gap:.25rem!important}.gap-2{gap:.5rem!important}.gap-3{gap:1rem!important}.gap-4{gap:1.5rem!important}.gap-5{gap:3rem!important}.justify-content-start{justify-content:flex-start!important}.justify-content-end{justify-content:flex-end!important}.justify-content-center{justify-content:center!important}.justify-content-between{justify-content:space-between!important}.justify-content-around{justify-content:space-around!important}.justify-content-evenly{justify-content:space-evenly!important}.align-items-start{align-items:flex-start!important}.align-items-end{align-items:flex-end!important}.align-items-center{align-items:center!important}.align-items-baseline{align-items:baseline!important}.align-items-stretch{align-items:stretch!important}.align-content-start{align-content:flex-start!important}.align-content-end{align-content:flex-end!important}.align-content-center{align-content:center!important}.align-content-between{align-content:space-between!important}.align-content-around{align-content:space-around!important}.align-content-stretch{align-content:stretch!important}.align-self-auto{align-self:auto!important}.align-self-start{align-self:flex-start!important}.align-self-end{align-self:flex-end!important}.align-self-center{align-self:center!important}.align-self-baseline{align-self:baseline!important}.align-self-stretch{align-self:stretch!important}.order-first{order:-1!important}.order-0{order:0!important}.order-1{order:1!important}.order-2{order:2!important}.order-3{order:3!important}.order-4{order:4!important}.order-5{order:5!important}.order-last{order:6!important}.m-0{margin:0!important}.m-1{margin:.25rem!important}.m-2{margin:.5rem!important}.m-3{margin:1rem!important}.m-4{margin:1.5rem!important}.m-5{margin:3rem!important}.m-auto{margin:auto!important}.mx-0{margin-right:0!important;margin-left:0!important}.mx-1{margin-right:.25rem!important;margin-left:.25rem!important}.mx-2{margin-right:.5rem!important;margin-left:.5rem!important}.mx-3{margin-right:1rem!important;margin-left:1rem!important}.mx-4{margin-right:1.5rem!important;margin-left:1.5rem!important}.mx-5{margin-right:3rem!important;margin-left:3rem!important}.mx-auto{margin-right:auto!important;margin-left:auto!important}.my-0{margin-top:0!important;margin-bottom:0!important}.my-1{margin-top:.25rem!important;margin-bottom:.25rem!important}.my-2{margin-top:.5rem!important;margin-bottom:.5rem!important}.my-3{margin-top:1rem!important;margin-bottom:1rem!important}.my-4{margin-top:1.5rem!important;margin-bottom:1.5rem!important}.my-5{margin-top:3rem!important;margin-bottom:3rem!important}.my-auto{margin-top:auto!important;margin-bottom:auto!important}.mt-0{margin-top:0!important}.mt-1{margin-top:.25rem!important}.mt-2{margin-top:.5rem!important}.mt-3{margin-top:1rem!important}.mt-4{margin-top:1.5rem!important}.mt-5{margin-top:3rem!important}.mt-auto{margin-top:auto!important}.me-0{margin-right:0!important}.me-1{margin-right:.25rem!important}.me-2{margin-right:.5rem!important}.me-3{margin-right:1rem!important}.me-4{margin-right:1.5rem!important}.me-5{margin-right:3rem!important}.me-auto{margin-right:auto!important}.mb-0{margin-bottom:0!important}.mb-1{margin-bottom:.25rem!important}.mb-2{margin-bottom:.5rem!important}.mb-3{margin-bottom:1rem!important}.mb-4{margin-bottom:1.5rem!important}.mb-5{margin-bottom:3rem!important}.mb-auto{margin-bottom:auto!important}.ms-0{margin-left:0!important}.ms-1{margin-left:.25rem!important}.ms-2{margin-left:.5rem!important}.ms-3{margin-left:1rem!important}.ms-4{margin-left:1.5rem!important}.ms-5{margin-left:3rem!important}.ms-auto{margin-left:auto!important}.p-0{padding:0!important}.p-1{padding:.25rem!important}.p-2{padding:.5rem!important}.p-3{padding:1rem!important}.p-4{padding:1.5rem!important}.p-5{padding:3rem!important}.px-0{padding-right:0!important;padding-left:0!important}.px-1{padding-right:.25rem!important;padding-left:.25rem!important}.px-2{padding-right:.5rem!important;padding-left:.5rem!important}.px-3{padding-right:1rem!important;padding-left:1rem!important}.px-4{padding-right:1.5rem!important;padding-left:1.5rem!important}.px-5{padding-right:3rem!important;padding-left:3rem!important}.py-0{padding-top:0!important;padding-bottom:0!important}.py-1{padding-top:.25rem!important;padding-bottom:.25rem!important}.py-2{padding-top:.5rem!important;padding-bottom:.5rem!important}.py-3{padding-top:1rem!important;padding-bottom:1rem!important}.py-4{padding-top:1.5rem!important;padding-bottom:1.5rem!important}.py-5{padding-top:3rem!important;padding-bottom:3rem!important}.pt-0{padding-top:0!important}.pt-1{padding-top:.25rem!important}.pt-2{padding-top:.5rem!important}.pt-3{padding-top:1rem!important}.pt-4{padding-top:1.5rem!important}.pt-5{padding-top:3rem!important}.pe-0{padding-right:0!important}.pe-1{padding-right:.25rem!important}.pe-2{padding-right:.5rem!important}.pe-3{padding-right:1rem!important}.pe-4{padding-right:1.5rem!important}.pe-5{padding-right:3rem!important}.pb-0{padding-bottom:0!important}.pb-1{padding-bottom:.25rem!important}.pb-2{padding-bottom:.5rem!important}.pb-3{padding-bottom:1rem!important}.pb-4{padding-bottom:1.5rem!important}.pb-5{padding-bottom:3rem!important}.ps-0{padding-left:0!important}.ps-1{padding-left:.25rem!important}.ps-2{padding-left:.5rem!important}.ps-3{padding-left:1rem!important}.ps-4{padding-left:1.5rem!important}.ps-5{padding-left:3rem!important}.font-monospace{font-family:var(--bs-font-monospace)!important}.fs-1{font-size:calc(1.375rem + 1.5vw)!important}.fs-2{font-size:calc(1.325rem + .9vw)!important}.fs-3{font-size:calc(1.3rem + .6vw)!important}.fs-4{font-size:calc(1.275rem + .3vw)!important}.fs-5{font-size:1.25rem!important}.fs-6{font-size:1rem!important}.fst-italic{font-style:italic!important}.fst-normal{font-style:normal!important}.fw-light{font-weight:300!important}.fw-lighter{font-weight:lighter!important}.fw-normal{font-weight:400!important}.fw-bold{font-weight:700!important}.fw-bolder{font-weight:bolder!important}.lh-1{line-height:1!important}.lh-sm{line-height:1.25!important}.lh-base{line-height:1.5!important}.lh-lg{line-height:2!important}.text-start{text-align:left!important}.text-end{text-align:right!important}.text-center{text-align:center!important}.text-decoration-none{text-decoration:none!important}.text-decoration-underline{text-decoration:underline!important}.text-decoration-line-through{text-decoration:line-through!important}.text-lowercase{text-transform:lowercase!important}.text-uppercase{text-transform:uppercase!important}.text-capitalize{text-transform:capitalize!important}.text-wrap{white-space:normal!important}.text-nowrap{white-space:nowrap!important}.text-break{word-wrap:break-word!important;word-break:break-word!important}.text-primary{--bs-text-opacity:1;color:rgba(var(--bs-primary-rgb),var(--bs-text-opacity))!important}.text-secondary{--bs-text-opacity:1;color:rgba(var(--bs-secondary-rgb),var(--bs-text-opacity))!important}.text-success{--bs-text-opacity:1;color:rgba(var(--bs-success-rgb),var(--bs-text-opacity))!important}.text-info{--bs-text-opacity:1;color:rgba(var(--bs-info-rgb),var(--bs-text-opacity))!important}.text-warning{--bs-text-opacity:1;color:rgba(var(--bs-warning-rgb),var(--bs-text-opacity))!important}.text-danger{--bs-text-opacity:1;color:rgba(var(--bs-danger-rgb),var(--bs-text-opacity))!important}.text-light{--bs-text-opacity:1;color:rgba(var(--bs-light-rgb),var(--bs-text-opacity))!important}.text-dark{--bs-text-opacity:1;color:rgba(var(--bs-dark-rgb),var(--bs-text-opacity))!important}.text-black{--bs-text-opacity:1;color:rgba(var(--bs-black-rgb),var(--bs-text-opacity))!important}.text-white{--bs-text-opacity:1;color:rgba(var(--bs-white-rgb),var(--bs-text-opacity))!important}.text-body{--bs-text-opacity:1;color:rgba(var(--bs-body-color-rgb),var(--bs-text-opacity))!important}.text-muted{--bs-text-opacity:1;color:#6c757d!important}.text-black-50{--bs-text-opacity:1;color:rgba(0,0,0,.5)!important}.text-white-50{--bs-text-opacity:1;color:rgba(255,255,255,.5)!important}.text-reset{--bs-text-opacity:1;color:inherit!important}.text-opacity-25{--bs-text-opacity:0.25}.text-opacity-50{--bs-text-opacity:0.5}.text-opacity-75{--bs-text-opacity:0.75}.text-opacity-100{--bs-text-opacity:1}.bg-primary{--bs-bg-opacity:1;background-color:rgba(var(--bs-primary-rgb),var(--bs-bg-opacity))!important}.bg-secondary{--bs-bg-opacity:1;background-color:rgba(var(--bs-secondary-rgb),var(--bs-bg-opacity))!important}.bg-success{--bs-bg-opacity:1;background-color:rgba(var(--bs-success-rgb),var(--bs-bg-opacity))!important}.bg-info{--bs-bg-opacity:1;background-color:rgba(var(--bs-info-rgb),var(--bs-bg-opacity))!important}.bg-warning{--bs-bg-opacity:1;background-color:rgba(var(--bs-warning-rgb),var(--bs-bg-opacity))!important}.bg-danger{--bs-bg-opacity:1;background-color:rgba(var(--bs-danger-rgb),var(--bs-bg-opacity))!important}.bg-light{--bs-bg-opacity:1;background-color:rgba(var(--bs-light-rgb),var(--bs-bg-opacity))!important}.bg-dark{--bs-bg-opacity:1;background-color:rgba(var(--bs-dark-rgb),var(--bs-bg-opacity))!important}.bg-black{--bs-bg-opacity:1;background-color:rgba(var(--bs-black-rgb),var(--bs-bg-opacity))!important}.bg-white{--bs-bg-opacity:1;background-color:rgba(var(--bs-white-rgb),var(--bs-bg-opacity))!important}.bg-body{--bs-bg-opacity:1;background-color:rgba(var(--bs-body-bg-rgb),var(--bs-bg-opacity))!important}.bg-transparent{--bs-bg-opacity:1;background-color:transparent!important}.bg-opacity-10{--bs-bg-opacity:0.1}.bg-opacity-25{--bs-bg-opacity:0.25}.bg-opacity-50{--bs-bg-opacity:0.5}.bg-opacity-75{--bs-bg-opacity:0.75}.bg-opacity-100{--bs-bg-opacity:1}.bg-gradient{background-image:var(--bs-gradient)!important}.user-select-all{-webkit-user-select:all!important;-moz-user-select:all!important;user-select:all!important}.user-select-auto{-webkit-user-select:auto!important;-moz-user-select:auto!important;user-select:auto!important}.user-select-none{-webkit-user-select:none!important;-moz-user-select:none!important;user-select:none!important}.pe-none{pointer-events:none!important}.pe-auto{pointer-events:auto!important}.rounded{border-radius:.25rem!important}.rounded-0{border-radius:0!important}.rounded-1{border-radius:.2rem!important}.rounded-2{border-radius:.25rem!important}.rounded-3{border-radius:.3rem!important}.rounded-circle{border-radius:50%!important}.rounded-pill{border-radius:50rem!important}.rounded-top{border-top-left-radius:.25rem!important;border-top-right-radius:.25rem!important}.rounded-end{border-top-right-radius:.25rem!important;border-bottom-right-radius:.25rem!important}.rounded-bottom{border-bottom-right-radius:.25rem!important;border-bottom-left-radius:.25rem!important}.rounded-start{border-bottom-left-radius:.25rem!important;border-top-left-radius:.25rem!important}.visible{visibility:visible!important}.invisible{visibility:hidden!important}@media (min-width:576px){.float-sm-start{float:left!important}.float-sm-end{float:right!important}.float-sm-none{float:none!important}.d-sm-inline{display:inline!important}.d-sm-inline-block{display:inline-block!important}.d-sm-block{display:block!important}.d-sm-grid{display:grid!important}.d-sm-table{display:table!important}.d-sm-table-row{display:table-row!important}.d-sm-table-cell{display:table-cell!important}.d-sm-flex{display:flex!important}.d-sm-inline-flex{display:inline-flex!important}.d-sm-none{display:none!important}.flex-sm-fill{flex:1 1 auto!important}.flex-sm-row{flex-direction:row!important}.flex-sm-column{flex-direction:column!important}.flex-sm-row-reverse{flex-direction:row-reverse!important}.flex-sm-column-reverse{flex-direction:column-reverse!important}.flex-sm-grow-0{flex-grow:0!important}.flex-sm-grow-1{flex-grow:1!important}.flex-sm-shrink-0{flex-shrink:0!important}.flex-sm-shrink-1{flex-shrink:1!important}.flex-sm-wrap{flex-wrap:wrap!important}.flex-sm-nowrap{flex-wrap:nowrap!important}.flex-sm-wrap-reverse{flex-wrap:wrap-reverse!important}.gap-sm-0{gap:0!important}.gap-sm-1{gap:.25rem!important}.gap-sm-2{gap:.5rem!important}.gap-sm-3{gap:1rem!important}.gap-sm-4{gap:1.5rem!important}.gap-sm-5{gap:3rem!important}.justify-content-sm-start{justify-content:flex-start!important}.justify-content-sm-end{justify-content:flex-end!important}.justify-content-sm-center{justify-content:center!important}.justify-content-sm-between{justify-content:space-between!important}.justify-content-sm-around{justify-content:space-around!important}.justify-content-sm-evenly{justify-content:space-evenly!important}.align-items-sm-start{align-items:flex-start!important}.align-items-sm-end{align-items:flex-end!important}.align-items-sm-center{align-items:center!important}.align-items-sm-baseline{align-items:baseline!important}.align-items-sm-stretch{align-items:stretch!important}.align-content-sm-start{align-content:flex-start!important}.align-content-sm-end{align-content:flex-end!important}.align-content-sm-center{align-content:center!important}.align-content-sm-between{align-content:space-between!important}.align-content-sm-around{align-content:space-around!important}.align-content-sm-stretch{align-content:stretch!important}.align-self-sm-auto{align-self:auto!important}.align-self-sm-start{align-self:flex-start!important}.align-self-sm-end{align-self:flex-end!important}.align-self-sm-center{align-self:center!important}.align-self-sm-baseline{align-self:baseline!important}.align-self-sm-stretch{align-self:stretch!important}.order-sm-first{order:-1!important}.order-sm-0{order:0!important}.order-sm-1{order:1!important}.order-sm-2{order:2!important}.order-sm-3{order:3!important}.order-sm-4{order:4!important}.order-sm-5{order:5!important}.order-sm-last{order:6!important}.m-sm-0{margin:0!important}.m-sm-1{margin:.25rem!important}.m-sm-2{margin:.5rem!important}.m-sm-3{margin:1rem!important}.m-sm-4{margin:1.5rem!important}.m-sm-5{margin:3rem!important}.m-sm-auto{margin:auto!important}.mx-sm-0{margin-right:0!important;margin-left:0!important}.mx-sm-1{margin-right:.25rem!important;margin-left:.25rem!important}.mx-sm-2{margin-right:.5rem!important;margin-left:.5rem!important}.mx-sm-3{margin-right:1rem!important;margin-left:1rem!important}.mx-sm-4{margin-right:1.5rem!important;margin-left:1.5rem!important}.mx-sm-5{margin-right:3rem!important;margin-left:3rem!important}.mx-sm-auto{margin-right:auto!important;margin-left:auto!important}.my-sm-0{margin-top:0!important;margin-bottom:0!important}.my-sm-1{margin-top:.25rem!important;margin-bottom:.25rem!important}.my-sm-2{margin-top:.5rem!important;margin-bottom:.5rem!important}.my-sm-3{margin-top:1rem!important;margin-bottom:1rem!important}.my-sm-4{margin-top:1.5rem!important;margin-bottom:1.5rem!important}.my-sm-5{margin-top:3rem!important;margin-bottom:3rem!important}.my-sm-auto{margin-top:auto!important;margin-bottom:auto!important}.mt-sm-0{margin-top:0!important}.mt-sm-1{margin-top:.25rem!important}.mt-sm-2{margin-top:.5rem!important}.mt-sm-3{margin-top:1rem!important}.mt-sm-4{margin-top:1.5rem!important}.mt-sm-5{margin-top:3rem!important}.mt-sm-auto{margin-top:auto!important}.me-sm-0{margin-right:0!important}.me-sm-1{margin-right:.25rem!important}.me-sm-2{margin-right:.5rem!important}.me-sm-3{margin-right:1rem!important}.me-sm-4{margin-right:1.5rem!important}.me-sm-5{margin-right:3rem!important}.me-sm-auto{margin-right:auto!important}.mb-sm-0{margin-bottom:0!important}.mb-sm-1{margin-bottom:.25rem!important}.mb-sm-2{margin-bottom:.5rem!important}.mb-sm-3{margin-bottom:1rem!important}.mb-sm-4{margin-bottom:1.5rem!important}.mb-sm-5{margin-bottom:3rem!important}.mb-sm-auto{margin-bottom:auto!important}.ms-sm-0{margin-left:0!important}.ms-sm-1{margin-left:.25rem!important}.ms-sm-2{margin-left:.5rem!important}.ms-sm-3{margin-left:1rem!important}.ms-sm-4{margin-left:1.5rem!important}.ms-sm-5{margin-left:3rem!important}.ms-sm-auto{margin-left:auto!important}.p-sm-0{padding:0!important}.p-sm-1{padding:.25rem!important}.p-sm-2{padding:.5rem!important}.p-sm-3{padding:1rem!important}.p-sm-4{padding:1.5rem!important}.p-sm-5{padding:3rem!important}.px-sm-0{padding-right:0!important;padding-left:0!important}.px-sm-1{padding-right:.25rem!important;padding-left:.25rem!important}.px-sm-2{padding-right:.5rem!important;padding-left:.5rem!important}.px-sm-3{padding-right:1rem!important;padding-left:1rem!important}.px-sm-4{padding-right:1.5rem!important;padding-left:1.5rem!important}.px-sm-5{padding-right:3rem!important;padding-left:3rem!important}.py-sm-0{padding-top:0!important;padding-bottom:0!important}.py-sm-1{padding-top:.25rem!important;padding-bottom:.25rem!important}.py-sm-2{padding-top:.5rem!important;padding-bottom:.5rem!important}.py-sm-3{padding-top:1rem!important;padding-bottom:1rem!important}.py-sm-4{padding-top:1.5rem!important;padding-bottom:1.5rem!important}.py-sm-5{padding-top:3rem!important;padding-bottom:3rem!important}.pt-sm-0{padding-top:0!important}.pt-sm-1{padding-top:.25rem!important}.pt-sm-2{padding-top:.5rem!important}.pt-sm-3{padding-top:1rem!important}.pt-sm-4{padding-top:1.5rem!important}.pt-sm-5{padding-top:3rem!important}.pe-sm-0{padding-right:0!important}.pe-sm-1{padding-right:.25rem!important}.pe-sm-2{padding-right:.5rem!important}.pe-sm-3{padding-right:1rem!important}.pe-sm-4{padding-right:1.5rem!important}.pe-sm-5{padding-right:3rem!important}.pb-sm-0{padding-bottom:0!important}.pb-sm-1{padding-bottom:.25rem!important}.pb-sm-2{padding-bottom:.5rem!important}.pb-sm-3{padding-bottom:1rem!important}.pb-sm-4{padding-bottom:1.5rem!important}.pb-sm-5{padding-bottom:3rem!important}.ps-sm-0{padding-left:0!important}.ps-sm-1{padding-left:.25rem!important}.ps-sm-2{padding-left:.5rem!important}.ps-sm-3{padding-left:1rem!important}.ps-sm-4{padding-left:1.5rem!important}.ps-sm-5{padding-left:3rem!important}.text-sm-start{text-align:left!important}.text-sm-end{text-align:right!important}.text-sm-center{text-align:center!important}}@media (min-width:768px){.float-md-start{float:left!important}.float-md-end{float:right!important}.float-md-none{float:none!important}.d-md-inline{display:inline!important}.d-md-inline-block{display:inline-block!important}.d-md-block{display:block!important}.d-md-grid{display:grid!important}.d-md-table{display:table!important}.d-md-table-row{display:table-row!important}.d-md-table-cell{display:table-cell!important}.d-md-flex{display:flex!important}.d-md-inline-flex{display:inline-flex!important}.d-md-none{display:none!important}.flex-md-fill{flex:1 1 auto!important}.flex-md-row{flex-direction:row!important}.flex-md-column{flex-direction:column!important}.flex-md-row-reverse{flex-direction:row-reverse!important}.flex-md-column-reverse{flex-direction:column-reverse!important}.flex-md-grow-0{flex-grow:0!important}.flex-md-grow-1{flex-grow:1!important}.flex-md-shrink-0{flex-shrink:0!important}.flex-md-shrink-1{flex-shrink:1!important}.flex-md-wrap{flex-wrap:wrap!important}.flex-md-nowrap{flex-wrap:nowrap!important}.flex-md-wrap-reverse{flex-wrap:wrap-reverse!important}.gap-md-0{gap:0!important}.gap-md-1{gap:.25rem!important}.gap-md-2{gap:.5rem!important}.gap-md-3{gap:1rem!important}.gap-md-4{gap:1.5rem!important}.gap-md-5{gap:3rem!important}.justify-content-md-start{justify-content:flex-start!important}.justify-content-md-end{justify-content:flex-end!important}.justify-content-md-center{justify-content:center!important}.justify-content-md-between{justify-content:space-between!important}.justify-content-md-around{justify-content:space-around!important}.justify-content-md-evenly{justify-content:space-evenly!important}.align-items-md-start{align-items:flex-start!important}.align-items-md-end{align-items:flex-end!important}.align-items-md-center{align-items:center!important}.align-items-md-baseline{align-items:baseline!important}.align-items-md-stretch{align-items:stretch!important}.align-content-md-start{align-content:flex-start!important}.align-content-md-end{align-content:flex-end!important}.align-content-md-center{align-content:center!important}.align-content-md-between{align-content:space-between!important}.align-content-md-around{align-content:space-around!important}.align-content-md-stretch{align-content:stretch!important}.align-self-md-auto{align-self:auto!important}.align-self-md-start{align-self:flex-start!important}.align-self-md-end{align-self:flex-end!important}.align-self-md-center{align-self:center!important}.align-self-md-baseline{align-self:baseline!important}.align-self-md-stretch{align-self:stretch!important}.order-md-first{order:-1!important}.order-md-0{order:0!important}.order-md-1{order:1!important}.order-md-2{order:2!important}.order-md-3{order:3!important}.order-md-4{order:4!important}.order-md-5{order:5!important}.order-md-last{order:6!important}.m-md-0{margin:0!important}.m-md-1{margin:.25rem!important}.m-md-2{margin:.5rem!important}.m-md-3{margin:1rem!important}.m-md-4{margin:1.5rem!important}.m-md-5{margin:3rem!important}.m-md-auto{margin:auto!important}.mx-md-0{margin-right:0!important;margin-left:0!important}.mx-md-1{margin-right:.25rem!important;margin-left:.25rem!important}.mx-md-2{margin-right:.5rem!important;margin-left:.5rem!important}.mx-md-3{margin-right:1rem!important;margin-left:1rem!important}.mx-md-4{margin-right:1.5rem!important;margin-left:1.5rem!important}.mx-md-5{margin-right:3rem!important;margin-left:3rem!important}.mx-md-auto{margin-right:auto!important;margin-left:auto!important}.my-md-0{margin-top:0!important;margin-bottom:0!important}.my-md-1{margin-top:.25rem!important;margin-bottom:.25rem!important}.my-md-2{margin-top:.5rem!important;margin-bottom:.5rem!important}.my-md-3{margin-top:1rem!important;margin-bottom:1rem!important}.my-md-4{margin-top:1.5rem!important;margin-bottom:1.5rem!important}.my-md-5{margin-top:3rem!important;margin-bottom:3rem!important}.my-md-auto{margin-top:auto!important;margin-bottom:auto!important}.mt-md-0{margin-top:0!important}.mt-md-1{margin-top:.25rem!important}.mt-md-2{margin-top:.5rem!important}.mt-md-3{margin-top:1rem!important}.mt-md-4{margin-top:1.5rem!important}.mt-md-5{margin-top:3rem!important}.mt-md-auto{margin-top:auto!important}.me-md-0{margin-right:0!important}.me-md-1{margin-right:.25rem!important}.me-md-2{margin-right:.5rem!important}.me-md-3{margin-right:1rem!important}.me-md-4{margin-right:1.5rem!important}.me-md-5{margin-right:3rem!important}.me-md-auto{margin-right:auto!important}.mb-md-0{margin-bottom:0!important}.mb-md-1{margin-bottom:.25rem!important}.mb-md-2{margin-bottom:.5rem!important}.mb-md-3{margin-bottom:1rem!important}.mb-md-4{margin-bottom:1.5rem!important}.mb-md-5{margin-bottom:3rem!important}.mb-md-auto{margin-bottom:auto!important}.ms-md-0{margin-left:0!important}.ms-md-1{margin-left:.25rem!important}.ms-md-2{margin-left:.5rem!important}.ms-md-3{margin-left:1rem!important}.ms-md-4{margin-left:1.5rem!important}.ms-md-5{margin-left:3rem!important}.ms-md-auto{margin-left:auto!important}.p-md-0{padding:0!important}.p-md-1{padding:.25rem!important}.p-md-2{padding:.5rem!important}.p-md-3{padding:1rem!important}.p-md-4{padding:1.5rem!important}.p-md-5{padding:3rem!important}.px-md-0{padding-right:0!important;padding-left:0!important}.px-md-1{padding-right:.25rem!important;padding-left:.25rem!important}.px-md-2{padding-right:.5rem!important;padding-left:.5rem!important}.px-md-3{padding-right:1rem!important;padding-left:1rem!important}.px-md-4{padding-right:1.5rem!important;padding-left:1.5rem!important}.px-md-5{padding-right:3rem!important;padding-left:3rem!important}.py-md-0{padding-top:0!important;padding-bottom:0!important}.py-md-1{padding-top:.25rem!important;padding-bottom:.25rem!important}.py-md-2{padding-top:.5rem!important;padding-bottom:.5rem!important}.py-md-3{padding-top:1rem!important;padding-bottom:1rem!important}.py-md-4{padding-top:1.5rem!important;padding-bottom:1.5rem!important}.py-md-5{padding-top:3rem!important;padding-bottom:3rem!important}.pt-md-0{padding-top:0!important}.pt-md-1{padding-top:.25rem!important}.pt-md-2{padding-top:.5rem!important}.pt-md-3{padding-top:1rem!important}.pt-md-4{padding-top:1.5rem!important}.pt-md-5{padding-top:3rem!important}.pe-md-0{padding-right:0!important}.pe-md-1{padding-right:.25rem!important}.pe-md-2{padding-right:.5rem!important}.pe-md-3{padding-right:1rem!important}.pe-md-4{padding-right:1.5rem!important}.pe-md-5{padding-right:3rem!important}.pb-md-0{padding-bottom:0!important}.pb-md-1{padding-bottom:.25rem!important}.pb-md-2{padding-bottom:.5rem!important}.pb-md-3{padding-bottom:1rem!important}.pb-md-4{padding-bottom:1.5rem!important}.pb-md-5{padding-bottom:3rem!important}.ps-md-0{padding-left:0!important}.ps-md-1{padding-left:.25rem!important}.ps-md-2{padding-left:.5rem!important}.ps-md-3{padding-left:1rem!important}.ps-md-4{padding-left:1.5rem!important}.ps-md-5{padding-left:3rem!important}.text-md-start{text-align:left!important}.text-md-end{text-align:right!important}.text-md-center{text-align:center!important}}@media (min-width:992px){.float-lg-start{float:left!important}.float-lg-end{float:right!important}.float-lg-none{float:none!important}.d-lg-inline{display:inline!important}.d-lg-inline-block{display:inline-block!important}.d-lg-block{display:block!important}.d-lg-grid{display:grid!important}.d-lg-table{display:table!important}.d-lg-table-row{display:table-row!important}.d-lg-table-cell{display:table-cell!important}.d-lg-flex{display:flex!important}.d-lg-inline-flex{display:inline-flex!important}.d-lg-none{display:none!important}.flex-lg-fill{flex:1 1 auto!important}.flex-lg-row{flex-direction:row!important}.flex-lg-column{flex-direction:column!important}.flex-lg-row-reverse{flex-direction:row-reverse!important}.flex-lg-column-reverse{flex-direction:column-reverse!important}.flex-lg-grow-0{flex-grow:0!important}.flex-lg-grow-1{flex-grow:1!important}.flex-lg-shrink-0{flex-shrink:0!important}.flex-lg-shrink-1{flex-shrink:1!important}.flex-lg-wrap{flex-wrap:wrap!important}.flex-lg-nowrap{flex-wrap:nowrap!important}.flex-lg-wrap-reverse{flex-wrap:wrap-reverse!important}.gap-lg-0{gap:0!important}.gap-lg-1{gap:.25rem!important}.gap-lg-2{gap:.5rem!important}.gap-lg-3{gap:1rem!important}.gap-lg-4{gap:1.5rem!important}.gap-lg-5{gap:3rem!important}.justify-content-lg-start{justify-content:flex-start!important}.justify-content-lg-end{justify-content:flex-end!important}.justify-content-lg-center{justify-content:center!important}.justify-content-lg-between{justify-content:space-between!important}.justify-content-lg-around{justify-content:space-around!important}.justify-content-lg-evenly{justify-content:space-evenly!important}.align-items-lg-start{align-items:flex-start!important}.align-items-lg-end{align-items:flex-end!important}.align-items-lg-center{align-items:center!important}.align-items-lg-baseline{align-items:baseline!important}.align-items-lg-stretch{align-items:stretch!important}.align-content-lg-start{align-content:flex-start!important}.align-content-lg-end{align-content:flex-end!important}.align-content-lg-center{align-content:center!important}.align-content-lg-between{align-content:space-between!important}.align-content-lg-around{align-content:space-around!important}.align-content-lg-stretch{align-content:stretch!important}.align-self-lg-auto{align-self:auto!important}.align-self-lg-start{align-self:flex-start!important}.align-self-lg-end{align-self:flex-end!important}.align-self-lg-center{align-self:center!important}.align-self-lg-baseline{align-self:baseline!important}.align-self-lg-stretch{align-self:stretch!important}.order-lg-first{order:-1!important}.order-lg-0{order:0!important}.order-lg-1{order:1!important}.order-lg-2{order:2!important}.order-lg-3{order:3!important}.order-lg-4{order:4!important}.order-lg-5{order:5!important}.order-lg-last{order:6!important}.m-lg-0{margin:0!important}.m-lg-1{margin:.25rem!important}.m-lg-2{margin:.5rem!important}.m-lg-3{margin:1rem!important}.m-lg-4{margin:1.5rem!important}.m-lg-5{margin:3rem!important}.m-lg-auto{margin:auto!important}.mx-lg-0{margin-right:0!important;margin-left:0!important}.mx-lg-1{margin-right:.25rem!important;margin-left:.25rem!important}.mx-lg-2{margin-right:.5rem!important;margin-left:.5rem!important}.mx-lg-3{margin-right:1rem!important;margin-left:1rem!important}.mx-lg-4{margin-right:1.5rem!important;margin-left:1.5rem!important}.mx-lg-5{margin-right:3rem!important;margin-left:3rem!important}.mx-lg-auto{margin-right:auto!important;margin-left:auto!important}.my-lg-0{margin-top:0!important;margin-bottom:0!important}.my-lg-1{margin-top:.25rem!important;margin-bottom:.25rem!important}.my-lg-2{margin-top:.5rem!important;margin-bottom:.5rem!important}.my-lg-3{margin-top:1rem!important;margin-bottom:1rem!important}.my-lg-4{margin-top:1.5rem!important;margin-bottom:1.5rem!important}.my-lg-5{margin-top:3rem!important;margin-bottom:3rem!important}.my-lg-auto{margin-top:auto!important;margin-bottom:auto!important}.mt-lg-0{margin-top:0!important}.mt-lg-1{margin-top:.25rem!important}.mt-lg-2{margin-top:.5rem!important}.mt-lg-3{margin-top:1rem!important}.mt-lg-4{margin-top:1.5rem!important}.mt-lg-5{margin-top:3rem!important}.mt-lg-auto{margin-top:auto!important}.me-lg-0{margin-right:0!important}.me-lg-1{margin-right:.25rem!important}.me-lg-2{margin-right:.5rem!important}.me-lg-3{margin-right:1rem!important}.me-lg-4{margin-right:1.5rem!important}.me-lg-5{margin-right:3rem!important}.me-lg-auto{margin-right:auto!important}.mb-lg-0{margin-bottom:0!important}.mb-lg-1{margin-bottom:.25rem!important}.mb-lg-2{margin-bottom:.5rem!important}.mb-lg-3{margin-bottom:1rem!important}.mb-lg-4{margin-bottom:1.5rem!important}.mb-lg-5{margin-bottom:3rem!important}.mb-lg-auto{margin-bottom:auto!important}.ms-lg-0{margin-left:0!important}.ms-lg-1{margin-left:.25rem!important}.ms-lg-2{margin-left:.5rem!important}.ms-lg-3{margin-left:1rem!important}.ms-lg-4{margin-left:1.5rem!important}.ms-lg-5{margin-left:3rem!important}.ms-lg-auto{margin-left:auto!important}.p-lg-0{padding:0!important}.p-lg-1{padding:.25rem!important}.p-lg-2{padding:.5rem!important}.p-lg-3{padding:1rem!important}.p-lg-4{padding:1.5rem!important}.p-lg-5{padding:3rem!important}.px-lg-0{padding-right:0!important;padding-left:0!important}.px-lg-1{padding-right:.25rem!important;padding-left:.25rem!important}.px-lg-2{padding-right:.5rem!important;padding-left:.5rem!important}.px-lg-3{padding-right:1rem!important;padding-left:1rem!important}.px-lg-4{padding-right:1.5rem!important;padding-left:1.5rem!important}.px-lg-5{padding-right:3rem!important;padding-left:3rem!important}.py-lg-0{padding-top:0!important;padding-bottom:0!important}.py-lg-1{padding-top:.25rem!important;padding-bottom:.25rem!important}.py-lg-2{padding-top:.5rem!important;padding-bottom:.5rem!important}.py-lg-3{padding-top:1rem!important;padding-bottom:1rem!important}.py-lg-4{padding-top:1.5rem!important;padding-bottom:1.5rem!important}.py-lg-5{padding-top:3rem!important;padding-bottom:3rem!important}.pt-lg-0{padding-top:0!important}.pt-lg-1{padding-top:.25rem!important}.pt-lg-2{padding-top:.5rem!important}.pt-lg-3{padding-top:1rem!important}.pt-lg-4{padding-top:1.5rem!important}.pt-lg-5{padding-top:3rem!important}.pe-lg-0{padding-right:0!important}.pe-lg-1{padding-right:.25rem!important}.pe-lg-2{padding-right:.5rem!important}.pe-lg-3{padding-right:1rem!important}.pe-lg-4{padding-right:1.5rem!important}.pe-lg-5{padding-right:3rem!important}.pb-lg-0{padding-bottom:0!important}.pb-lg-1{padding-bottom:.25rem!important}.pb-lg-2{padding-bottom:.5rem!important}.pb-lg-3{padding-bottom:1rem!important}.pb-lg-4{padding-bottom:1.5rem!important}.pb-lg-5{padding-bottom:3rem!important}.ps-lg-0{padding-left:0!important}.ps-lg-1{padding-left:.25rem!important}.ps-lg-2{padding-left:.5rem!important}.ps-lg-3{padding-left:1rem!important}.ps-lg-4{padding-left:1.5rem!important}.ps-lg-5{padding-left:3rem!important}.text-lg-start{text-align:left!important}.text-lg-end{text-align:right!important}.text-lg-center{text-align:center!important}}@media (min-width:1200px){.float-xl-start{float:left!important}.float-xl-end{float:right!important}.float-xl-none{float:none!important}.d-xl-inline{display:inline!important}.d-xl-inline-block{display:inline-block!important}.d-xl-block{display:block!important}.d-xl-grid{display:grid!important}.d-xl-table{display:table!important}.d-xl-table-row{display:table-row!important}.d-xl-table-cell{display:table-cell!important}.d-xl-flex{display:flex!important}.d-xl-inline-flex{display:inline-flex!important}.d-xl-none{display:none!important}.flex-xl-fill{flex:1 1 auto!important}.flex-xl-row{flex-direction:row!important}.flex-xl-column{flex-direction:column!important}.flex-xl-row-reverse{flex-direction:row-reverse!important}.flex-xl-column-reverse{flex-direction:column-reverse!important}.flex-xl-grow-0{flex-grow:0!important}.flex-xl-grow-1{flex-grow:1!important}.flex-xl-shrink-0{flex-shrink:0!important}.flex-xl-shrink-1{flex-shrink:1!important}.flex-xl-wrap{flex-wrap:wrap!important}.flex-xl-nowrap{flex-wrap:nowrap!important}.flex-xl-wrap-reverse{flex-wrap:wrap-reverse!important}.gap-xl-0{gap:0!important}.gap-xl-1{gap:.25rem!important}.gap-xl-2{gap:.5rem!important}.gap-xl-3{gap:1rem!important}.gap-xl-4{gap:1.5rem!important}.gap-xl-5{gap:3rem!important}.justify-content-xl-start{justify-content:flex-start!important}.justify-content-xl-end{justify-content:flex-end!important}.justify-content-xl-center{justify-content:center!important}.justify-content-xl-between{justify-content:space-between!important}.justify-content-xl-around{justify-content:space-around!important}.justify-content-xl-evenly{justify-content:space-evenly!important}.align-items-xl-start{align-items:flex-start!important}.align-items-xl-end{align-items:flex-end!important}.align-items-xl-center{align-items:center!important}.align-items-xl-baseline{align-items:baseline!important}.align-items-xl-stretch{align-items:stretch!important}.align-content-xl-start{align-content:flex-start!important}.align-content-xl-end{align-content:flex-end!important}.align-content-xl-center{align-content:center!important}.align-content-xl-between{align-content:space-between!important}.align-content-xl-around{align-content:space-around!important}.align-content-xl-stretch{align-content:stretch!important}.align-self-xl-auto{align-self:auto!important}.align-self-xl-start{align-self:flex-start!important}.align-self-xl-end{align-self:flex-end!important}.align-self-xl-center{align-self:center!important}.align-self-xl-baseline{align-self:baseline!important}.align-self-xl-stretch{align-self:stretch!important}.order-xl-first{order:-1!important}.order-xl-0{order:0!important}.order-xl-1{order:1!important}.order-xl-2{order:2!important}.order-xl-3{order:3!important}.order-xl-4{order:4!important}.order-xl-5{order:5!important}.order-xl-last{order:6!important}.m-xl-0{margin:0!important}.m-xl-1{margin:.25rem!important}.m-xl-2{margin:.5rem!important}.m-xl-3{margin:1rem!important}.m-xl-4{margin:1.5rem!important}.m-xl-5{margin:3rem!important}.m-xl-auto{margin:auto!important}.mx-xl-0{margin-right:0!important;margin-left:0!important}.mx-xl-1{margin-right:.25rem!important;margin-left:.25rem!important}.mx-xl-2{margin-right:.5rem!important;margin-left:.5rem!important}.mx-xl-3{margin-right:1rem!important;margin-left:1rem!important}.mx-xl-4{margin-right:1.5rem!important;margin-left:1.5rem!important}.mx-xl-5{margin-right:3rem!important;margin-left:3rem!important}.mx-xl-auto{margin-right:auto!important;margin-left:auto!important}.my-xl-0{margin-top:0!important;margin-bottom:0!important}.my-xl-1{margin-top:.25rem!important;margin-bottom:.25rem!important}.my-xl-2{margin-top:.5rem!important;margin-bottom:.5rem!important}.my-xl-3{margin-top:1rem!important;margin-bottom:1rem!important}.my-xl-4{margin-top:1.5rem!important;margin-bottom:1.5rem!important}.my-xl-5{margin-top:3rem!important;margin-bottom:3rem!important}.my-xl-auto{margin-top:auto!important;margin-bottom:auto!important}.mt-xl-0{margin-top:0!important}.mt-xl-1{margin-top:.25rem!important}.mt-xl-2{margin-top:.5rem!important}.mt-xl-3{margin-top:1rem!important}.mt-xl-4{margin-top:1.5rem!important}.mt-xl-5{margin-top:3rem!important}.mt-xl-auto{margin-top:auto!important}.me-xl-0{margin-right:0!important}.me-xl-1{margin-right:.25rem!important}.me-xl-2{margin-right:.5rem!important}.me-xl-3{margin-right:1rem!important}.me-xl-4{margin-right:1.5rem!important}.me-xl-5{margin-right:3rem!important}.me-xl-auto{margin-right:auto!important}.mb-xl-0{margin-bottom:0!important}.mb-xl-1{margin-bottom:.25rem!important}.mb-xl-2{margin-bottom:.5rem!important}.mb-xl-3{margin-bottom:1rem!important}.mb-xl-4{margin-bottom:1.5rem!important}.mb-xl-5{margin-bottom:3rem!important}.mb-xl-auto{margin-bottom:auto!important}.ms-xl-0{margin-left:0!important}.ms-xl-1{margin-left:.25rem!important}.ms-xl-2{margin-left:.5rem!important}.ms-xl-3{margin-left:1rem!important}.ms-xl-4{margin-left:1.5rem!important}.ms-xl-5{margin-left:3rem!important}.ms-xl-auto{margin-left:auto!important}.p-xl-0{padding:0!important}.p-xl-1{padding:.25rem!important}.p-xl-2{padding:.5rem!important}.p-xl-3{padding:1rem!important}.p-xl-4{padding:1.5rem!important}.p-xl-5{padding:3rem!important}.px-xl-0{padding-right:0!important;padding-left:0!important}.px-xl-1{padding-right:.25rem!important;padding-left:.25rem!important}.px-xl-2{padding-right:.5rem!important;padding-left:.5rem!important}.px-xl-3{padding-right:1rem!important;padding-left:1rem!important}.px-xl-4{padding-right:1.5rem!important;padding-left:1.5rem!important}.px-xl-5{padding-right:3rem!important;padding-left:3rem!important}.py-xl-0{padding-top:0!important;padding-bottom:0!important}.py-xl-1{padding-top:.25rem!important;padding-bottom:.25rem!important}.py-xl-2{padding-top:.5rem!important;padding-bottom:.5rem!important}.py-xl-3{padding-top:1rem!important;padding-bottom:1rem!important}.py-xl-4{padding-top:1.5rem!important;padding-bottom:1.5rem!important}.py-xl-5{padding-top:3rem!important;padding-bottom:3rem!important}.pt-xl-0{padding-top:0!important}.pt-xl-1{padding-top:.25rem!important}.pt-xl-2{padding-top:.5rem!important}.pt-xl-3{padding-top:1rem!important}.pt-xl-4{padding-top:1.5rem!important}.pt-xl-5{padding-top:3rem!important}.pe-xl-0{padding-right:0!important}.pe-xl-1{padding-right:.25rem!important}.pe-xl-2{padding-right:.5rem!important}.pe-xl-3{padding-right:1rem!important}.pe-xl-4{padding-right:1.5rem!important}.pe-xl-5{padding-right:3rem!important}.pb-xl-0{padding-bottom:0!important}.pb-xl-1{padding-bottom:.25rem!important}.pb-xl-2{padding-bottom:.5rem!important}.pb-xl-3{padding-bottom:1rem!important}.pb-xl-4{padding-bottom:1.5rem!important}.pb-xl-5{padding-bottom:3rem!important}.ps-xl-0{padding-left:0!important}.ps-xl-1{padding-left:.25rem!important}.ps-xl-2{padding-left:.5rem!important}.ps-xl-3{padding-left:1rem!important}.ps-xl-4{padding-left:1.5rem!important}.ps-xl-5{padding-left:3rem!important}.text-xl-start{text-align:left!important}.text-xl-end{text-align:right!important}.text-xl-center{text-align:center!important}}@media (min-width:1400px){.float-xxl-start{float:left!important}.float-xxl-end{float:right!important}.float-xxl-none{float:none!important}.d-xxl-inline{display:inline!important}.d-xxl-inline-block{display:inline-block!important}.d-xxl-block{display:block!important}.d-xxl-grid{display:grid!important}.d-xxl-table{display:table!important}.d-xxl-table-row{display:table-row!important}.d-xxl-table-cell{display:table-cell!important}.d-xxl-flex{display:flex!important}.d-xxl-inline-flex{display:inline-flex!important}.d-xxl-none{display:none!important}.flex-xxl-fill{flex:1 1 auto!important}.flex-xxl-row{flex-direction:row!important}.flex-xxl-column{flex-direction:column!important}.flex-xxl-row-reverse{flex-direction:row-reverse!important}.flex-xxl-column-reverse{flex-direction:column-reverse!important}.flex-xxl-grow-0{flex-grow:0!important}.flex-xxl-grow-1{flex-grow:1!important}.flex-xxl-shrink-0{flex-shrink:0!important}.flex-xxl-shrink-1{flex-shrink:1!important}.flex-xxl-wrap{flex-wrap:wrap!important}.flex-xxl-nowrap{flex-wrap:nowrap!important}.flex-xxl-wrap-reverse{flex-wrap:wrap-reverse!important}.gap-xxl-0{gap:0!important}.gap-xxl-1{gap:.25rem!important}.gap-xxl-2{gap:.5rem!important}.gap-xxl-3{gap:1rem!important}.gap-xxl-4{gap:1.5rem!important}.gap-xxl-5{gap:3rem!important}.justify-content-xxl-start{justify-content:flex-start!important}.justify-content-xxl-end{justify-content:flex-end!important}.justify-content-xxl-center{justify-content:center!important}.justify-content-xxl-between{justify-content:space-between!important}.justify-content-xxl-around{justify-content:space-around!important}.justify-content-xxl-evenly{justify-content:space-evenly!important}.align-items-xxl-start{align-items:flex-start!important}.align-items-xxl-end{align-items:flex-end!important}.align-items-xxl-center{align-items:center!important}.align-items-xxl-baseline{align-items:baseline!important}.align-items-xxl-stretch{align-items:stretch!important}.align-content-xxl-start{align-content:flex-start!important}.align-content-xxl-end{align-content:flex-end!important}.align-content-xxl-center{align-content:center!important}.align-content-xxl-between{align-content:space-between!important}.align-content-xxl-around{align-content:space-around!important}.align-content-xxl-stretch{align-content:stretch!important}.align-self-xxl-auto{align-self:auto!important}.align-self-xxl-start{align-self:flex-start!important}.align-self-xxl-end{align-self:flex-end!important}.align-self-xxl-center{align-self:center!important}.align-self-xxl-baseline{align-self:baseline!important}.align-self-xxl-stretch{align-self:stretch!important}.order-xxl-first{order:-1!important}.order-xxl-0{order:0!important}.order-xxl-1{order:1!important}.order-xxl-2{order:2!important}.order-xxl-3{order:3!important}.order-xxl-4{order:4!important}.order-xxl-5{order:5!important}.order-xxl-last{order:6!important}.m-xxl-0{margin:0!important}.m-xxl-1{margin:.25rem!important}.m-xxl-2{margin:.5rem!important}.m-xxl-3{margin:1rem!important}.m-xxl-4{margin:1.5rem!important}.m-xxl-5{margin:3rem!important}.m-xxl-auto{margin:auto!important}.mx-xxl-0{margin-right:0!important;margin-left:0!important}.mx-xxl-1{margin-right:.25rem!important;margin-left:.25rem!important}.mx-xxl-2{margin-right:.5rem!important;margin-left:.5rem!important}.mx-xxl-3{margin-right:1rem!important;margin-left:1rem!important}.mx-xxl-4{margin-right:1.5rem!important;margin-left:1.5rem!important}.mx-xxl-5{margin-right:3rem!important;margin-left:3rem!important}.mx-xxl-auto{margin-right:auto!important;margin-left:auto!important}.my-xxl-0{margin-top:0!important;margin-bottom:0!important}.my-xxl-1{margin-top:.25rem!important;margin-bottom:.25rem!important}.my-xxl-2{margin-top:.5rem!important;margin-bottom:.5rem!important}.my-xxl-3{margin-top:1rem!important;margin-bottom:1rem!important}.my-xxl-4{margin-top:1.5rem!important;margin-bottom:1.5rem!important}.my-xxl-5{margin-top:3rem!important;margin-bottom:3rem!important}.my-xxl-auto{margin-top:auto!important;margin-bottom:auto!important}.mt-xxl-0{margin-top:0!important}.mt-xxl-1{margin-top:.25rem!important}.mt-xxl-2{margin-top:.5rem!important}.mt-xxl-3{margin-top:1rem!important}.mt-xxl-4{margin-top:1.5rem!important}.mt-xxl-5{margin-top:3rem!important}.mt-xxl-auto{margin-top:auto!important}.me-xxl-0{margin-right:0!important}.me-xxl-1{margin-right:.25rem!important}.me-xxl-2{margin-right:.5rem!important}.me-xxl-3{margin-right:1rem!important}.me-xxl-4{margin-right:1.5rem!important}.me-xxl-5{margin-right:3rem!important}.me-xxl-auto{margin-right:auto!important}.mb-xxl-0{margin-bottom:0!important}.mb-xxl-1{margin-bottom:.25rem!important}.mb-xxl-2{margin-bottom:.5rem!important}.mb-xxl-3{margin-bottom:1rem!important}.mb-xxl-4{margin-bottom:1.5rem!important}.mb-xxl-5{margin-bottom:3rem!important}.mb-xxl-auto{margin-bottom:auto!important}.ms-xxl-0{margin-left:0!important}.ms-xxl-1{margin-left:.25rem!important}.ms-xxl-2{margin-left:.5rem!important}.ms-xxl-3{margin-left:1rem!important}.ms-xxl-4{margin-left:1.5rem!important}.ms-xxl-5{margin-left:3rem!important}.ms-xxl-auto{margin-left:auto!important}.p-xxl-0{padding:0!important}.p-xxl-1{padding:.25rem!important}.p-xxl-2{padding:.5rem!important}.p-xxl-3{padding:1rem!important}.p-xxl-4{padding:1.5rem!important}.p-xxl-5{padding:3rem!important}.px-xxl-0{padding-right:0!important;padding-left:0!important}.px-xxl-1{padding-right:.25rem!important;padding-left:.25rem!important}.px-xxl-2{padding-right:.5rem!important;padding-left:.5rem!important}.px-xxl-3{padding-right:1rem!important;padding-left:1rem!important}.px-xxl-4{padding-right:1.5rem!important;padding-left:1.5rem!important}.px-xxl-5{padding-right:3rem!important;padding-left:3rem!important}.py-xxl-0{padding-top:0!important;padding-bottom:0!important}.py-xxl-1{padding-top:.25rem!important;padding-bottom:.25rem!important}.py-xxl-2{padding-top:.5rem!important;padding-bottom:.5rem!important}.py-xxl-3{padding-top:1rem!important;padding-bottom:1rem!important}.py-xxl-4{padding-top:1.5rem!important;padding-bottom:1.5rem!important}.py-xxl-5{padding-top:3rem!important;padding-bottom:3rem!important}.pt-xxl-0{padding-top:0!important}.pt-xxl-1{padding-top:.25rem!important}.pt-xxl-2{padding-top:.5rem!important}.pt-xxl-3{padding-top:1rem!important}.pt-xxl-4{padding-top:1.5rem!important}.pt-xxl-5{padding-top:3rem!important}.pe-xxl-0{padding-right:0!important}.pe-xxl-1{padding-right:.25rem!important}.pe-xxl-2{padding-right:.5rem!important}.pe-xxl-3{padding-right:1rem!important}.pe-xxl-4{padding-right:1.5rem!important}.pe-xxl-5{padding-right:3rem!important}.pb-xxl-0{padding-bottom:0!important}.pb-xxl-1{padding-bottom:.25rem!important}.pb-xxl-2{padding-bottom:.5rem!important}.pb-xxl-3{padding-bottom:1rem!important}.pb-xxl-4{padding-bottom:1.5rem!important}.pb-xxl-5{padding-bottom:3rem!important}.ps-xxl-0{padding-left:0!important}.ps-xxl-1{padding-left:.25rem!important}.ps-xxl-2{padding-left:.5rem!important}.ps-xxl-3{padding-left:1rem!important}.ps-xxl-4{padding-left:1.5rem!important}.ps-xxl-5{padding-left:3rem!important}.text-xxl-start{text-align:left!important}.text-xxl-end{text-align:right!important}.text-xxl-center{text-align:center!important}}@media (min-width:1200px){.fs-1{font-size:2.5rem!important}.fs-2{font-size:2rem!important}.fs-3{font-size:1.75rem!important}.fs-4{font-size:1.5rem!important}}@media print{.d-print-inline{display:inline!important}.d-print-inline-block{display:inline-block!important}.d-print-block{display:block!important}.d-print-grid{display:grid!important}.d-print-table{display:table!important}.d-print-table-row{display:table-row!important}.d-print-table-cell{display:table-cell!important}.d-print-flex{display:flex!important}.d-print-inline-flex{display:inline-flex!important}.d-print-none{display:none!important}}
/*# sourceMappingURL=bootstrap.min.css.map */
</style>
<style type="text/css">
/**
  * bootstrap-table - An extended table to integration with some of the most widely used CSS frameworks. (Supports Bootstrap, Semantic UI, Bulma, Material Design, Foundation)
  *
  * @version v1.19.1
  * @homepage https://bootstrap-table.com
  * @author wenzhixin <wenzhixin2010@gmail.com> (http://wenzhixin.net.cn/)
  * @license MIT
  */

.bootstrap-table .fixed-table-toolbar::after{content:"";display:block;clear:both}.bootstrap-table .fixed-table-toolbar .bs-bars,.bootstrap-table .fixed-table-toolbar .columns,.bootstrap-table .fixed-table-toolbar .search{position:relative;margin-top:10px;margin-bottom:10px}.bootstrap-table .fixed-table-toolbar .columns .btn-group>.btn-group{display:inline-block;margin-left:-1px!important}.bootstrap-table .fixed-table-toolbar .columns .btn-group>.btn-group>.btn{border-radius:0}.bootstrap-table .fixed-table-toolbar .columns .btn-group>.btn-group:first-child>.btn{border-top-left-radius:4px;border-bottom-left-radius:4px}.bootstrap-table .fixed-table-toolbar .columns .btn-group>.btn-group:last-child>.btn{border-top-right-radius:4px;border-bottom-right-radius:4px}.bootstrap-table .fixed-table-toolbar .columns .dropdown-menu{text-align:left;max-height:300px;overflow:auto;-ms-overflow-style:scrollbar;z-index:1001}.bootstrap-table .fixed-table-toolbar .columns label{display:block;padding:3px 20px;clear:both;font-weight:400;line-height:1.428571429}.bootstrap-table .fixed-table-toolbar .columns-left{margin-right:5px}.bootstrap-table .fixed-table-toolbar .columns-right{margin-left:5px}.bootstrap-table .fixed-table-toolbar .pull-right .dropdown-menu{right:0;left:auto}.bootstrap-table .fixed-table-container{position:relative;clear:both}.bootstrap-table .fixed-table-container .table{width:100%;margin-bottom:0!important}.bootstrap-table .fixed-table-container .table td,.bootstrap-table .fixed-table-container .table th{vertical-align:middle;box-sizing:border-box}.bootstrap-table .fixed-table-container .table thead th{vertical-align:bottom;padding:0;margin:0}.bootstrap-table .fixed-table-container .table thead th:focus{outline:0 solid transparent}.bootstrap-table .fixed-table-container .table thead th.detail{width:30px}.bootstrap-table .fixed-table-container .table thead th .th-inner{padding:.75rem;vertical-align:bottom;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.bootstrap-table .fixed-table-container .table thead th .sortable{cursor:pointer;background-position:right;background-repeat:no-repeat;padding-right:30px!important}.bootstrap-table .fixed-table-container .table thead th .both{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAQAAADYWf5HAAAAkElEQVQoz7X QMQ5AQBCF4dWQSJxC5wwax1Cq1e7BAdxD5SL+Tq/QCM1oNiJidwox0355mXnG/DrEtIQ6azioNZQxI0ykPhTQIwhCR+BmBYtlK7kLJYwWCcJA9M4qdrZrd8pPjZWPtOqdRQy320YSV17OatFC4euts6z39GYMKRPCTKY9UnPQ6P+GtMRfGtPnBCiqhAeJPmkqAAAAAElFTkSuQmCC")}.bootstrap-table .fixed-table-container .table thead th .asc{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAAZ0lEQVQ4y2NgGLKgquEuFxBPAGI2ahhWCsS/gDibUoO0gPgxEP8H4ttArEyuQYxAPBdqEAxPBImTY5gjEL9DM+wTENuQahAvEO9DMwiGdwAxOymGJQLxTyD+jgWDxCMZRsEoGAVoAADeemwtPcZI2wAAAABJRU5ErkJggg==")}.bootstrap-table .fixed-table-container .table thead th .desc{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAAZUlEQVQ4y2NgGAWjYBSggaqGu5FA/BOIv2PBIPFEUgxjB+IdQPwfC94HxLykus4GiD+hGfQOiB3J8SojEE9EM2wuSJzcsFMG4ttQgx4DsRalkZENxL+AuJQaMcsGxBOAmGvopk8AVz1sLZgg0bsAAAAASUVORK5CYII= ")}.bootstrap-table .fixed-table-container .table tbody tr.selected td{background-color:rgba(0,0,0,.075)}.bootstrap-table .fixed-table-container .table tbody tr.no-records-found td{text-align:center}.bootstrap-table .fixed-table-container .table tbody tr .card-view{display:flex}.bootstrap-table .fixed-table-container .table tbody tr .card-view .card-view-title{font-weight:700;display:inline-block;min-width:30%;width:auto!important;text-align:left!important}.bootstrap-table .fixed-table-container .table tbody tr .card-view .card-view-value{width:100%!important}.bootstrap-table .fixed-table-container .table .bs-checkbox{text-align:center}.bootstrap-table .fixed-table-container .table .bs-checkbox label{margin-bottom:0}.bootstrap-table .fixed-table-container .table .bs-checkbox label input[type=checkbox],.bootstrap-table .fixed-table-container .table .bs-checkbox label input[type=radio]{margin:0 auto!important}.bootstrap-table .fixed-table-container .table.table-sm .th-inner{padding:.3rem}.bootstrap-table .fixed-table-container.fixed-height:not(.has-footer){border-bottom:1px solid #dee2e6}.bootstrap-table .fixed-table-container.fixed-height.has-card-view{border-top:1px solid #dee2e6;border-bottom:1px solid #dee2e6}.bootstrap-table .fixed-table-container.fixed-height .fixed-table-border{border-left:1px solid #dee2e6;border-right:1px solid #dee2e6}.bootstrap-table .fixed-table-container.fixed-height .table thead th{border-bottom:1px solid #dee2e6}.bootstrap-table .fixed-table-container.fixed-height .table-dark thead th{border-bottom:1px solid #32383e}.bootstrap-table .fixed-table-container .fixed-table-header{overflow:hidden}.bootstrap-table .fixed-table-container .fixed-table-body{overflow-x:auto;overflow-y:auto;height:100%}.bootstrap-table .fixed-table-container .fixed-table-body .fixed-table-loading{align-items:center;background:#fff;display:flex;justify-content:center;position:absolute;bottom:0;width:100%;max-width:100%;z-index:1000;transition:visibility 0s,opacity .15s ease-in-out;opacity:0;visibility:hidden}.bootstrap-table .fixed-table-container .fixed-table-body .fixed-table-loading.open{visibility:visible;opacity:1}.bootstrap-table .fixed-table-container .fixed-table-body .fixed-table-loading .loading-wrap{align-items:baseline;display:flex;justify-content:center}.bootstrap-table .fixed-table-container .fixed-table-body .fixed-table-loading .loading-wrap .loading-text{margin-right:6px}.bootstrap-table .fixed-table-container .fixed-table-body .fixed-table-loading .loading-wrap .animation-wrap{align-items:center;display:flex;justify-content:center}.bootstrap-table .fixed-table-container .fixed-table-body .fixed-table-loading .loading-wrap .animation-dot,.bootstrap-table .fixed-table-container .fixed-table-body .fixed-table-loading .loading-wrap .animation-wrap::after,.bootstrap-table .fixed-table-container .fixed-table-body .fixed-table-loading .loading-wrap .animation-wrap::before{content:"";animation-duration:1.5s;animation-iteration-count:infinite;animation-name:LOADING;background:#212529;border-radius:50%;display:block;height:5px;margin:0 4px;opacity:0;width:5px}.bootstrap-table .fixed-table-container .fixed-table-body .fixed-table-loading .loading-wrap .animation-dot{animation-delay:.3s}.bootstrap-table .fixed-table-container .fixed-table-body .fixed-table-loading .loading-wrap .animation-wrap::after{animation-delay:.6s}.bootstrap-table .fixed-table-container .fixed-table-body .fixed-table-loading.table-dark{background:#212529}.bootstrap-table .fixed-table-container .fixed-table-body .fixed-table-loading.table-dark .animation-dot,.bootstrap-table .fixed-table-container .fixed-table-body .fixed-table-loading.table-dark .animation-wrap::after,.bootstrap-table .fixed-table-container .fixed-table-body .fixed-table-loading.table-dark .animation-wrap::before{background:#fff}.bootstrap-table .fixed-table-container .fixed-table-footer{overflow:hidden}.bootstrap-table .fixed-table-pagination::after{content:"";display:block;clear:both}.bootstrap-table .fixed-table-pagination>.pagination,.bootstrap-table .fixed-table-pagination>.pagination-detail{margin-top:10px;margin-bottom:10px}.bootstrap-table .fixed-table-pagination>.pagination-detail .pagination-info{line-height:34px;margin-right:5px}.bootstrap-table .fixed-table-pagination>.pagination-detail .page-list{display:inline-block}.bootstrap-table .fixed-table-pagination>.pagination-detail .page-list .btn-group{position:relative;display:inline-block;vertical-align:middle}.bootstrap-table .fixed-table-pagination>.pagination-detail .page-list .btn-group .dropdown-menu{margin-bottom:0}.bootstrap-table .fixed-table-pagination>.pagination ul.pagination{margin:0}.bootstrap-table .fixed-table-pagination>.pagination ul.pagination li.page-intermediate a{color:#c8c8c8}.bootstrap-table .fixed-table-pagination>.pagination ul.pagination li.page-intermediate a::before{content:'\2B05'}.bootstrap-table .fixed-table-pagination>.pagination ul.pagination li.page-intermediate a::after{content:'\27A1'}.bootstrap-table .fixed-table-pagination>.pagination ul.pagination li.disabled a{pointer-events:none;cursor:default}.bootstrap-table.fullscreen{position:fixed;top:0;left:0;z-index:1050;width:100%!important;background:#fff;height:calc(100vh);overflow-y:scroll}.bootstrap-table.bootstrap4 .pagination-lg .page-link,.bootstrap-table.bootstrap5 .pagination-lg .page-link{padding:.5rem 1rem}.bootstrap-table.bootstrap5 .float-left{float:left}.bootstrap-table.bootstrap5 .float-right{float:right}div.fixed-table-scroll-inner{width:100%;height:200px}div.fixed-table-scroll-outer{top:0;left:0;visibility:hidden;width:200px;height:150px;overflow:hidden}@keyframes LOADING{0%{opacity:0}50%{opacity:1}to{opacity:0}}
</style>
<style type="text/css">
body {
    background: #e1e1e1;
    height: 100%;
    min-height: 100%;
}

html {
    height: 100%;
    min-height: 100%;
}

@media screen {
    body {
        padding-top: 50px;
        margin-top: 10px;
    }

    h1, h2, h3, h4 {
        color: #Fa9C1A;
    }

    a {
        color: #fa9c1a;
    }

        a:hover {
            color: #58595b;
        }
}

@media print {
    .card {
        border: none;
    }

    .card-header {
        border: none;
    }

    .navbar {
        display: none;
    }

    .container {
        max-width: initial;
    }

    .bootstrap-table .fixed-table-toolbar {
        display: none;
    }

    .sectionheader {
        color: rgb(250, 156, 26);
    }

    table {
        table-layout: fixed;
        width: 100%;
        height: 100%;
    }
}

#wrapper {
    box-shadow: 0 0 8px rgba(0,0,0,0.25);
}

    #wrapper.well {
        background: #fff;
        border-radius: 0;
    }

.ticked {
    color: #4CAF50;
}

.unticked {
    color: #FF1744;
}


.navbar-custom {
    background-color: #ffffff;
}

    .navbar-custom .navbar-toggler-icon {
        background-image: url("data:image/svg+xml;charset=utf8,%3Csvg viewBox='0 0 30 30' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath stroke='rgba(0, 0, 0, 0.5)' stroke-width='2' stroke-linecap='round' stroke-miterlimit='10' d='M4 7h22M4 15h22M4 23h22'/%3E%3C/svg%3E");
    }

    .navbar-custom .navbar-toggler {
        color: rgba(0, 0, 0, 0.5);
        border-color: rgba(0, 0, 0, 0.1);
    }

    /* change the brand and text color */
    .navbar-custom .navbar-brand, .navbar-custom .navbar-text {
        color: #fa9c1a;
    }
    /* change the link color */
    .navbar-custom .navbar-nav .nav-link {
        color: #58595b;
    }

    .navbar-custom .navbar-nav > .active > a,
    .navbar-custom .navbar-nav > .active > a:hover,
    .navbar-custom .navbar-nav > .active > a:focus {
        color: #fff;
        background-color: #fa9c1a;
    }

.nav-tabs .nav-link {
    border-color: #e9ecef #e9ecef #dee2e6;
    color: #58595b;
}

    .nav-tabs .nav-link.disabled {
        color: #6c757d;
        background-color: transparent;
        border-color: transparent;
    }

    .nav-tabs .nav-link.active,
    .nav-tabs .nav-item.show .nav-link {
        color: #fff;
        background-color: #fa9c1a;
        border-color: #dee2e6 #dee2e6 #fff;
    }

/* navbar */
.navbar-brand {
    margin: 0;
    padding: 0;
}

    .navbar-brand img {
        max-height: 100%;
    }

.dropdown-item.active, .dropdown-item:active {
    background-color: #fa9c1a;
}

.border-bottom {
    border-bottom-color: #fa9c1a !important;
}

.risk_model_none {
    background-color: #00AAFF;
    padding: 5px;
}

.risk_model_low {
    background-color: #ffd800;
    padding: 5px;
}

.risk_model_medium {
    background-color: #ff6a00;
    padding: 5px;
}

.risk_model_high {
    background-color: #f12828;
    padding: 5px;
}

.score_100 {
    background-color: #a856aa;
    padding: 5px;
}

.score_over75 {
    background-color: #f12828;
    padding: 5px;
}

.score_over50 {
    background-color: #ff6a00;
    padding: 5px;
}

.score_over25 {
    background-color: #ffd800;
    padding: 5px;
}

.score_below25 {
    background-color: #83e043;
    padding: 5px;
}

.modal-header {
    background-color: #FA9C1A;
}

    .modal-header h4 {
        color: #fff;
    }

/* no transition to be used in the carto mode */
.progress .progress-bar {
    -webkit-transition: none;
    -o-transition: none;
    transition: none;
}

.info-mark {
    display: inline-block;
    font-family: sans-serif;
    font-weight: bold;
    text-align: center;
    width: 20px;
    height: 20px;
    font-size: 16px;
    line-height: 20px;
    border-radius: 14px;
    margin-right: 4px;
    padding: 1px;
    color: #fa9c1a;
    background: white;
    border: 1px solid #fa9c1a;
    text-decoration: none;
}

    .info-mark:hover {
        color: white;
        background: #fa9c1a;
        border-color: white;
        text-decoration: none;
    }

.num {
    text-align: right !important;
}

@media screen {
    a[name] {
        padding-top: 80px;
        margin-top: -80px;
        display: inline-block; /* required for webkit browsers */
    }
}

.pagebreak {
    page-break-before: always;
}
/* page-break-after works, as well */


.btn-default {
    color: #58595B;
    background-color: transparent;
    background-image: none;
    border-color: #58595B;
}

    .btn-default:hover {
        color: #fff;
        background-color: #58595B;
        border-color: #58595B;
    }

    .btn-default:focus, .btn-outline-primary.focus {
        box-shadow: 0 0 0 0.2rem rgba(88, 89, 91, 0.5);
    }

    .btn-default.disabled, .btn-outline-primary:disabled {
        color: #58595B;
        background-color: transparent;
    }

    .btn-default:not(:disabled):not(.disabled):active, .btn-outline-primary:not(:disabled):not(.disabled).active,
    .show > .btn-default.dropdown-toggle {
        color: #fff;
        background-color: #58595B;
        border-color: #58595B;
    }

        .btn-default:not(:disabled):not(.disabled):active:focus, .btn-default:not(:disabled):not(.disabled).active:focus,
        .show > .btn-default.dropdown-toggle:focus {
            box-shadow: 0 0 0 0.2rem rgba(88, 89, 91, 0.5);
        }

.tooltip-wide {
    max-width: 100%;
    min-width: 80%;
}

.grade-1 {
    color: #fff;
    background-color: red;
}

.grade-2 {
    background-color: orange;
    color: #000;
}

.grade-3 {
    background-color: khaki;
    color: #000;
}

.grade-4 {
    color: #fff;
    background-color: #007bff;
}

.grade-5 {
    color: #fff;
    background-color: #28a745;
}

path.type0 {
    fill: #ff0029;
}

path.type1 {
    fill: #377eb8;
}

path.type2 {
    fill: #66a61e;
}

path.type3 {
    fill: #984ea3;
}

path.type4 {
    fill: #00d2d5;
}

path.type5 {
    fill: #ff7f00;
}

path.type6 {
    fill: #af8d00;
}

path.type7 {
    fill: #7f80cd;
}

path.type8 {
    fill: #b3e900;
}

path.type9 {
    fill: #c42e60;
}

path.type10 {
    fill: #a65628;
}

path.type11 {
    fill: #f781bf;
}

path.type12 {
    fill: #8dd3c7;
}

path.type13 {
    fill: #bebada;
}

path.type14 {
    fill: #fb8072;
}

path.type15 {
    fill: #80b1d3;
}

path.type16 {
    fill: #fdb462;
}

path.type17 {
    fill: #fccde5;
}

path.type18 {
    fill: #bc80bd;
}

path.type19 {
    fill: #ffed6f;
}

path.empty {
    fill: #f8f9fa;
}

g.sectors {
    stroke: white;
    stroke-width: 1px;
}

.font-pc-orange {
    color: #Fa9C1A;
    font-family: Futura-Book;
}

.bg-pc-orange {
    background-color: #Fa9C1A;
}

.border-pc-orange {
    border-color: #FA9C1A !important;
}

.bi-download::before {
    display: inline-block;
    content: "\00a0\00a0\00a0\00a0";
    vertical-align: -.125em;
    background-image: url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='white' class='bi bi-download' viewBox='0 0 16 16'> <path d='M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z'/> <path d='M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z'/> </svg>");
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
}

</style>
<style type="text/css">
.model_table {

}
.model_table th {
	padding: 5px;
}
.model_cell {
	border: 2px solid black;
	padding: 5px;
}
.model_empty_cell {
}
div_model {
	
}
.model_cell.model_good {

}
.model_cell.model_toimprove
{
	background-color: #ffd800;
}
.model_cell.model_info {
	background-color: #00AAFF;
color: #FFFFFF;
}
.model_cell.model_warning {
	background-color: #ff6a00;
color: #FFFFFF;
}
.model_cell.model_danger {
	background-color: #f12828;
color: #FFFFFF;
}
.model_cell  .popover{
    max-width: 100%;
}
.model_cell .popover-content {
	color: #000000;
}
.model_cell .popover-title {
	color: #000000;
}

</style>


</head>

<body>

<nav class="navbar py-0 navbar-expand-lg navbar-custom fixed-top border-bottom">
	<div class="container">
		<a href="https://www.pingcastle.com/PingCastleFiles/ad_hc_rules_list.html#" class="navbar-brand">
			<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFwAAAA8CAYAAADrG90CAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAAhdEVYdENyZWF0aW9uIFRpbWUAMjAxNzowNToxNCAxNToxMTozM7dcJkgAABA4SURBVHhe7ZwJdBVllsf/Ve/l5WVPyEYIkkQlQENCAhEBG3EaGgTZm0VtZbQ5IDrqOcNAs0g7Yw8O06dbGAe1tWlcEZAo2ixC6yjIvkhk36QJENaE7Ntbq+ber76X5CUv8F6YsSHmd847r7771atU3frqf++3VBSdQBs/GKr8buMHos3hPzBeDtfOroH725dkqY3/D7w0XK++APvbd0BR6E6kj4Gp5yyoif1lbRv/FzQJmvYlCpT4jtBdNUBtCXRVQVDWfJh6/1bu0cbN0NTh74ZCsURRjVQbXYPmrAIqqmBK+ylMGdTqU0YZdW0ETBOHOzbcD730GBRTsLR4UKC7bdBtxVDcIMc/C1PfV+i+WGR9G/7QxOGu3TPgPrUMSlC4tPiAfqK5a6CUlwNJP4E5czZMnSfLyuuTd+AgXA4XIiLC0a1bF2n98dDU4YcXw73/BSjBMdJyPSi6ag5o9lLA5oKpxxMw914AJSxZ1tdTUlqKFStyERkZCZXigtvtht1ux5QnJ8NkNsm9Wj9NHK4X7oF9bV+oYR2kxX90Vy30qlIokYkw9/pXqN2e5lsiWPLaW0hIiJclA03T4HK68fjjk6Sl9dOk46Mk3AvdIbZEORAUcwjU6GSRVjq/egb6+Q3CfuDAIURHUyBuhKqqsNlrUVFZKS2tH589TcPVXg0/AOh3iokyHdps10NYnC433QTfN9BsDkJ5GcWCHwm+HR7XmbJBlyy1EDM5uOyk2IwID4OLnO6LmpoaJCcHLl+3Kz4drsb1IoF1ylILCYqG+8SfxGbXrulwOp1CsxvCQTMtLVVIy48F3y08qispw804nHL2Cgqe4amyDEz51WMiMymnVLKmphbXrhUjLi4Ow4f9XNRrV7ZBO/6m2G7NNMlSGC1/DZybJ0IJSZSWANDd0IqvwvJoHtTYbGmsp7KySjidZaRe13XY3qR7b1Gh2DTqVE2Fqc9CSk1jZX3rwXcLT+xHkY4113egaw7dWQ29tgTWf7LXOXvd+g0YNHgIam02UeYOT8eOnMkYx9YufyOcrUa2hxrSHkpMB7jProZ9WRzsq1JIlpaK/VoLPls4Y1uikJZzB8afbEWBVnOR9s+BZfQ+aQPmznsBu3bvQfvERJw7dx69srPQpUs6nn/+OVHv/OtDcOd/DjXKV9AkWaI4ojvKoVTTDezxS5iz5kOJJrm7jWk2WikRodSD951ZeEPOLrmIoJ4veDl73C8m4ujRY0hqT62WWnNqagoKi4qwYtVqFBQUiH0UCs5KaITYbooORTVDtcZCie0AreBz2D/qBsd7kXAfXiT3uf1o3uHxOTfOVIReX0TwIwdhylkgTEXk1P73DaD82oSwsDBh82A2m9EuJgZHjx8XZbVdJsDDwH4gOlWRydCDQuHcPx/21xR6QkZAv7JV7nF70KzD1dje13W47qyCZiuD9RkHFHYcsX7D5xg2fCRSUlJgMvkeH7FYglBwTrbwhEBjBbV66lSpwTHU6pOhFe2CY91A2JYqcH87zy/x+3vTfAsP6wg4KqgR26XFA2lrzSVKHdNh/RUFQjVIWGfPmYdXXlmE9PTOotwcfCPOnT8vtvlvGMMILYGcb7JS6tkBalgSnEdfg4NavWNtf2jfvy/3ufVovoV3Gg417WHS2RzoZZeg2UvISnpNEmLOftFLr8eOG48TJ06gPel1MzG4DpaVU6dOyRIdMcIqpOmmoBihWiLoXDuS1u+C+2/LZcWtR7NZSmM4UDk3/QssUw6R9mYI29WrVzFm7ATccUdysxLSGA6gp0+fxt49u0TZsX4A3dDjPiY8AoQuQyu+DMvYTVA7DpXGW49mWzhjo663B1PGDFhn6XXOXrduPR4aOYayj05+O5vh+2u1WlFba+TlnEre7DACz0RplZdhnVZySzub8dnCN/31f6gV5osA53Q5kdO7F+7tQ0FUMnPWbOTl5fklIb4oLinBwpcXoDcd13VkEQU8yq/9mvBoDEmcrYg0PAWWifUydSvTpIUv//AjMc4RHx+LqKhIxMXG4tix49i2dafcA9i/fz8SEhJa5GzGGhyMkyeNkUQ14T5KDWvFdmBQ8C67CNNdj9w2zma8HH727DnYHQ4EBRmZh4fQ0FAcOHxUloCHJ00UI30thSXo6pWrYltNuJdn6YgAhhFYr69RZ2vUlwi6/11pvD3wcnhR0TUEW3zPwoeHheDChYtiOzIySoz8tRTOVE6e/l6WPK7272kRKwdIr4OfIr1OHiyttw9eDldUEzcen7g1DSEhIWKbB6Kam8HxB27hp042SA3j7vJjwoMkhPRaCY4jZ1MObmmJ5v/98XJ4r+xMlJWVNXEma7VODo+NbSfKPD955WohSktL4XK5AnY+TzjwTI8HNfZGmQoFx9KLUO+eDMsEQ/tvV7wczo4YOnQwCguLhCNZNpxOlwiijz4yQe4FjBs7Bnt2bcfcObPFTDzn1bW1tX4HUd6Px1nOe3qc0V3I2IzDWa+ps2UZ8zWCBvxZGm9ffKaF1VXV2P/dQfquEa25X797ZA1Jy6Hfw5Q5S5bqWbr0z1j50Wqoiip+0zjwNqaiogLPPfcsHhw6BFp+LhxfTKRuerxcyWWcku6mm1hdCuuTZQAvv2sF+N3TZJwb7of70jYolKCo3Xl8eh6UmJ/IWoO8vO+wOjcXX321mfL0RJHh+Jqz5F7q4EGDMW/ebOj2EsrF/w1a4Td0/EMwxSRCsxdDDb+bJMQYWWwt3NDhuqsa2ql34dz5HAWqSChBxpCrWPRTUwrFGg5z9kvU6mcIe0NWrvqI8voV4olpR/rPGRDr/Zkz+Zg7dzZGjxop92wA5Yj29+Mpvx4H84B3pLH1cEOHaxe/hP3TITC1S6K9GwdHKusu8lEFlMpaqOnDYer5a6jtB8p6gzN/O4MV5Py1a9eKmPDlFxvFBLIHTkfDwsMQKrOg1oxfkmJ7Q4Eac6PpNkrbSHPFmnIqmbPnwpzzH0ZVA44cPYoe3buL7V2791Kv9QDJTogI0lZrCCZNGktPwk0OZN3C+OfwP5LDowNYrEOH5DXlSmUllE59YaYgq6aOk5UGe/ftx+Ejx6hDVT8rxOtWysrK8fT0KdLS+mgazXygxPNKrABG9Eh6xPh0bDL0itNwfDVePCWuo3+UOwD79uV5OZvh4BpO0rKfAm9rxS+HG9NtLVn6xrMyFqihSZTyRQJlR4S1qroawcG+ZUOl3m5xMaWBrRT/HB51nY6Jv1B+rmvGGDi3bJutubk1nYKnVW63PvyTFDG73pIh1AaYgqmD87EsAB07tm8yAMYpY2lpGbKyjUnp1oh/Dk/o36KVWA1RlCDoRRWk6cYo4ZjRI8SsDw+EcYbipM/VwiIM+oeBTbS9NeF3TzOwlViN4DfhSq7AMnG3GP9uyNFjJ1BaUgZzkAnZWZnNantrwW+H298LB4Io8/C8Tugn4n1PezmCn6ik5Lz1tlx/8dvhjg0PQC89EsDsOq9fuQwlJgOWcQeEZdnb72DLli1wOpyIjYvH9OlTkdGjBx559Je488678fKCl2ANicDHuaswYsRD4jfM4sWvIveTT7Bzu7HKas+evZj3wnyxXtESbBEzUC/+Zr6oa8zXm7fh8GEjO+LG8uwzU6Ga6hvNjh27cd99fWXJgPsI28nudLiQ3KE9HntsEpa8/pYYkOPJEzfJXwk9lXPnzMDC3y3C0CGD0Cu7p/gtd+by8g5QfNLp40JSUiKd33hRx/jdXNXYQBbpG+sNTd2fr3M2U0PpIDtp/ITxqK6uxIQJDwu73e4gPa8W23365OC3/75AjLV74FdW7HL17c4duzBl6jTRW12zJhezfz2Lvj/FiNFjRH1DVud+ihPHT+CenN50Ax9EYvt4VFTVv09UUHARO3btlSUDHmbevXsf+vTOxsyZzyI+wRiCGDjgp3ScXnRlCrKyeuKh4UOEPSI8wmuWjCXRQj3lUaOGYdiwn6Nf3z6yxsBvhysRKWJg6YawXvP49aS9MPddLI0GQUEW0ZMc/4txeOP110QnZ+u2bWImydPq3G4NycnJGDl6rCgzrGKeEccZM2cKZ7/66mJkZmTgHyc/jlf+8Ht8snq1qPdw/nyBGMcfMKA/+vfvg7vuTMOkCeO8AvLmb7aJFszfHgqLrpHDLIhuFwMT9Qm49TKZmd3R+e47xcsEd3RMonIPca66j5jG872pKZ3QtUs6Uui7If47nGfXnUYraw7Wa622ENbp1RRg68fQPYiZIZnofP31ZlGOJ2nRNH7R1ngdhVvYM09PJ8eEY+q06cJmpgvnR5nVjwe/WEIaMmjQz6hlec/FcuvV6OZnZBjjNh74OMz5cwVCGrh8/Fj9LFJKJ/7nDgp27twtVjBcunRZ1lBmLF8Oc8lzFZC/G+ZufI4RkRHI/fgzfLhiNUmTseDJg98OV+NzZN/HV2pIElJzRbxiYp1C6aM5VNq9Ycemd+6MtLvSMZc0ODUlFd26daUWYaMHw9NSdFwtKsKmjevFTfnss78gPj5OXChPWhjdf+Mt6eLiEpgtVmT27IWu3Xpg46ZNws7w6gMe02mOLVu3183R8oTJ5i31rfypaU8ih2SIj7Hms3Xk9CvCzu2l8RH5JV8X6XUdtI+LGkVaaifx/lICnXtD/Ha4QPi68Z+k4Eh6bc74Z1jGXn8MhE/4woUL2LVjK77Y9DlyKTgyjY/ochqx4u1lSzH/Ny9S6nhcPL5RUVFiLvTg4UOivh099pcuFuCFeXMQERGBnF45ws5wHb+SyDelMfkUR7jTJZ44gie1j5PWN4Tnd6c8+bgYajgnV/sKWfO6ica2Ko/DsMbzU5pDet+/X58mi1sDcrgSn+49iFWn19/C3OcP0tg8fIF8MrxiKykpSVpJ28Wr356Trj/5gQPvp2A3AkeOHCGnGKc6cuQIrPhwJU6cOCmOlxAfj/c/WI7Y2Ni6AMdk9cyAW3Nj3fqNKC+vELZjlPOzvu7YtrOudXuIjo7GN1t3oIh0f9k7HwhbBf2OzyYkpD4zY996EjueTjQkxokaui6WO74pLFN8nfx3qyqrxL4eAnJ4wzXjPBOk116D9WkblLj6ZXDXg6WjqKhYlurhpW9l5caAVWFRIaobzOj/58KXxQVysPWU09LSMGHiw+jXfwB6ZGaJNytWrWy6YvaJyY/ShdvwwfJV+O8lb2Ltuo107FqUlJaJ4FddXVP34f1OnfperEywkbP+69U38N7ylSIVzKIOGcMaXl5RKdJaRqPz4idu+849eP31pSR/68UQM3/efOtt/GnpO/iUbA3xOw9nXHkvwX1kEWk5aSmliZYx+2WNf3BKmJ+fjwce8J4ROnjwkEinunbtQinZHhHZGz4BlZTKfUitevpT06QF+O67A/S7g0hMTKT060Fp9c2Z/LOoqqpGJwqI0VGRKC0rI6dS3JD1DDuJ9ZYzFObU96fpyTMLHfbArrLZ7GIfzxPHC145qPOxWFoU0vTGLm242DUgh2vn/gL76jGwPDAHpnsWSmsbgRCQw/kf1+jlp6Gmtv1HoJYSkMPbuHkCCppt3DxtDv9BAf4X7yWYGgWvSgUAAAAASUVORK5CYII=">
		</a>
		<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarToggler" aria-controls="navbarToggler" aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		</button>

		<div class="collapse navbar-collapse" id="navbarToggler">
			<ul class="navbar-nav mr-auto">
				<li class="nav-item active">
					<a class="nav-link p-3" href="https://www.pingcastle.com/PingCastleFiles/ad_hc_rules_list.html#" role="button">
Healthcheck Rules
					</a>
				</li>
				<li class="nav-item">
					<a class="nav-link p-3" href="https://www.pingcastle.com/PingCastleFiles/ad_hc_rules_list.html#" role="button">
2023-07-26
					</a>
				</li>
				<li class="nav-item">
					<a class="nav-link p-3" role="button" href="https://www.pingcastle.com/PingCastleFiles/ad_hc_rules_list.html#modalAbout" data-bs-toggle="modal">About</a>
				</li>
			</ul>
		</div>
	</div>
</nav>

<!-- Modal -->
<div class="modal" id="modalAbout" role="dialog">
    <div class="modal-dialog modal-lg">
        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">About</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="row">
                     <div class="col-lg-12">
<p><strong>Generated by <a href="https://www.pingcastle.com/">Ping Castle</a> all rights reserved</strong></p>
<p>Options:</p>
<div class="form-check">
  <input class="form-check-input" type="checkbox" value="" id="optionWideScreen">
  <label class="form-check-label" for="optionWideScreen">
    Enable wide mode
  </label>
</div>
<div class="form-check">
  <input class="form-check-input" type="checkbox" value="" id="optionPagination">
  <label class="form-check-label" for="optionPagination">
    Remove pagination in tables
  </label>
</div>
<div class="form-check">
  <input class="form-check-input" type="checkbox" value="" id="optionExpand">
  <label class="form-check-label" for="optionExpand">
    Expand all collpsed items
  </label>
</div>
<p>Open source components:</p>
<ul>
<li><a href="https://getbootstrap.com/">Bootstrap</a> licensed under the <a href="https://tldrlegal.com/license/mit-license">MIT license</a></li>
<li><a href="https://bootstrap-table.com/">Bootstrap Table </a> licensed under the <a href="https://tldrlegal.com/license/mit-license">MIT license</a></li>
<li><a href="https://popper.js.org/">Popper.js</a> licensed under the <a href="https://tldrlegal.com/license/mit-license">MIT license</a></li>
<li><a href="https://jquery.org/">JQuery</a> licensed under the <a href="https://tldrlegal.com/license/mit-license">MIT license</a></li>
</ul>
                     </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>

    </div>
</div>

<div id="wrapper" class="container well">
	<noscript>
		<div class="alert alert-warning">
			<p>PingCastle reports work best with Javascript enabled.</p>
		</div>
	</noscript>
<div class="row"><div class="col-lg-12"><h1>Rules evaluated during PingCastle Healthcheck</h1>
			<h3>Date: 2023-07-26 - Engine version: 3.1.0.0</h3>
</div></div>

		<div class="row"><div class="col-lg-12">
			<a data-bs-toggle="collapse" data-bs-target="#riskModel">
				<h2>Risk model</h2>
			</a>
		</div></div>
		<div class="row"><div class="col-lg-12">
		<p>This model regroup all rules per category. It summarize what checks are performed. Click on a cell to show all rules associated to a category.
		</p>
		</div></div>
		<div class="row collapse show" id="riskModel">
			<div class="col-md-12 table-responsive">
				<table class="model_table">
					<thead><tr><th>Stale Objects</th><th>Privileged accounts</th><th>Trusts</th><th>Anomalies</th></tr></thead>
					<tbody>
<tr><td class="model_cell model_good"><div class="div_model" placement="auto" data-bs-toggle="popover" title="Inactive user or computer [Rules: 6]" data-bs-html="true" data-bs-content="&lt;p&gt;By reusing existing objects, whose credentials may be the same among all objects or stored on configuration files or in memory, a third party can take them over.&lt;/p&gt;&lt;p&gt;&lt;ul&gt;&lt;li&gt;Check if all computers have changed their passwords in the last 3 months.&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if all computers are using regular password change practices.&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if all DC are using regular password change practices.&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if all DC are active.&lt;/li&gt;&lt;br&gt;&lt;li&gt;Inactive computer check&lt;/li&gt;&lt;br&gt;&lt;li&gt;Inactive account check&lt;/li&gt;&lt;br&gt;&lt;/ul&gt;&lt;/p&gt;"><span class="small">Inactive user or computer</span></div></td><td class="model_cell model_good"><div class="div_model" placement="auto" data-bs-toggle="popover" title="Account take over [Rules: 6]" data-bs-html="true" data-bs-content="&lt;p&gt;Members of administrators&#39; groups are a priority target. By misconfiguring their protection, the password of the account can be retrieved by an attacker, or it can leverage internal mechanisms of the AD such as authentication to act on its behalf.&lt;/p&gt;&lt;p&gt;&lt;ul&gt;&lt;li&gt;Ensure that custom Display Specifiers are stored in SYSVOL&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if all admin passwords are changed on the field.&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if all privileged accounts are in the special group Protected Users.&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if there is a policy preventing administrators to connect to lower tier systems.&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if admin accounts are vulnerable to the Kerberoast attack.&lt;/li&gt;&lt;br&gt;&lt;li&gt;At least one administrator account can be delegated&lt;/li&gt;&lt;br&gt;&lt;/ul&gt;&lt;/p&gt;"><span class="small">Account take over</span></div></td><td class="model_cell model_good"><div class="div_model" placement="auto" data-bs-toggle="popover" title="Old trust protocol [Rules: 2]" data-bs-html="true" data-bs-content="&lt;p&gt;NT4 like trusts do not provide an accurate level of security and by the use of its old protocols, put the domain at risk.&lt;/p&gt;&lt;p&gt;&lt;ul&gt;&lt;li&gt;Check if AES is enabled on trusts&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check for trusts compatible with NT4&lt;/li&gt;&lt;br&gt;&lt;/ul&gt;&lt;/p&gt;"><span class="small">Old trust protocol</span></div></td><td class="model_cell model_good"><div class="div_model" placement="auto" data-bs-toggle="popover" title="Audit [Rules: 2]" data-bs-html="true" data-bs-content="&lt;p&gt;The default audit policy of Windows does not collect key events to trace activities or discover past compromise.&lt;/p&gt;&lt;p&gt;&lt;ul&gt;&lt;li&gt;Check if PowerShell logging is enabled.&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if there is the expected audit policy on domain controllers.&lt;/li&gt;&lt;br&gt;&lt;/ul&gt;&lt;/p&gt;"><span class="small">Audit</span></div></td><td class="model_empty_cell"></td></tr><tr><td class="model_cell model_good"><div class="div_model" placement="auto" data-bs-toggle="popover" title="Network topography [Rules: 1]" data-bs-html="true" data-bs-content="&lt;p&gt;It is important to have a database of all the assets and control the physical security of the server. If one server is compromised physically, all the secrets of the domain can be exposed.&lt;/p&gt;&lt;p&gt;&lt;ul&gt;&lt;li&gt;Check for completeness of network declaration&lt;/li&gt;&lt;br&gt;&lt;/ul&gt;&lt;/p&gt;"><span class="small">Network topography</span></div></td><td class="model_cell model_good"><div class="div_model" placement="auto" data-bs-toggle="popover" title="ACL Check [Rules: 14]" data-bs-html="true" data-bs-content="&lt;p&gt;Delegation is used to perform day to day activities. It is important to control it.&lt;/p&gt;&lt;p&gt;&lt;ul&gt;&lt;li&gt;Check if the Dns Admins group is not empty&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if there is an explicit delegation on DNS servers.&lt;/li&gt;&lt;br&gt;&lt;li&gt;Ensure that files deployed by a GPO cannot be modified by everyone.&lt;/li&gt;&lt;br&gt;&lt;li&gt;Ensure the &quot;automatic administrative logon&quot; feature of the recovery mode is not enabled&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if the behavior DoListObject has been enabled&lt;/li&gt;&lt;br&gt;&lt;li&gt;Ensure that the AdminSDHolder protection has not been disabled for some critical groups&lt;/li&gt;&lt;br&gt;&lt;li&gt;Ensure that the privilege to log on Domain Controllers are not granted to everyone by GPO&lt;/li&gt;&lt;br&gt;&lt;li&gt;Ensure that Exchange did not introduce security vulnerabilities&lt;/li&gt;&lt;br&gt;&lt;li&gt;Ensure that GPO items cannot be modified by any user&lt;/li&gt;&lt;br&gt;&lt;li&gt;Ensure that bogus Windows Server 2016 AD prep did not introduce vulnerabilities&lt;/li&gt;&lt;br&gt;&lt;li&gt;Ensure that Exchange did not modify the AdminSDHolder object to introduce vulnerabilities&lt;/li&gt;&lt;br&gt;&lt;li&gt;Ensure that all login scripts cannot be modified by any user&lt;/li&gt;&lt;br&gt;&lt;li&gt;At least one domain controller is not owned correctly&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check for Dangerous rights found in OU delegation&lt;/li&gt;&lt;br&gt;&lt;/ul&gt;&lt;/p&gt;"><span class="small">ACL Check</span></div></td><td class="model_cell model_good"><div class="div_model" placement="auto" data-bs-toggle="popover" title="SID Filtering [Rules: 1]" data-bs-html="true" data-bs-content="&lt;p&gt;Isolation of domains is critical to avoid a global compromise.&lt;/p&gt;&lt;p&gt;&lt;ul&gt;&lt;li&gt;Check for Trusts whose security is not maximum&lt;/li&gt;&lt;br&gt;&lt;/ul&gt;&lt;/p&gt;"><span class="small">SID Filtering</span></div></td><td class="model_cell model_good"><div class="div_model" placement="auto" data-bs-toggle="popover" title="Backup [Rules: 2]" data-bs-html="true" data-bs-content="&lt;p&gt;Although Active Directory has been designed for redundancy, a backup process is key for a recovery plan.&lt;/p&gt;&lt;p&gt;&lt;ul&gt;&lt;li&gt;Ensure that there are enough DCs to provide basic redundancy&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check for the last backup date according to Microsoft standard&lt;/li&gt;&lt;br&gt;&lt;/ul&gt;&lt;/p&gt;"><span class="small">Backup</span></div></td><td class="model_empty_cell"></td></tr><tr><td class="model_cell model_good"><div class="div_model" placement="auto" data-bs-toggle="popover" title="Object configuration [Rules: 13]" data-bs-html="true" data-bs-content="&lt;p&gt;By abusing a misconfiguration, an attacker can gain the control of the domain.&lt;/p&gt;&lt;p&gt;&lt;ul&gt;&lt;li&gt;Check if default OU location has been changed within the domain.&lt;/li&gt;&lt;br&gt;&lt;li&gt;Ensure that clients support Kerberos armoring when the domain functional level is at least Windows Server 2012&lt;/li&gt;&lt;br&gt;&lt;li&gt;Ensure that DC supports Kerberos armoring when functional level is at least Windows Server 2012&lt;/li&gt;&lt;br&gt;&lt;li&gt;Search for Java schema extension RFC 2713&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if all admin accounts require Kerberos pre-authentication&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check that there is no account with never-expiring passwords&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if all accounts require Kerberos pre-authentication&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check for reversible passwords used for computer accounts&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check for reversible password used for user accounts&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check that every account requires a password&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check for hidden group membership for computer accounts&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check for hidden group membership for user accounts&lt;/li&gt;&lt;br&gt;&lt;li&gt;SIDHistory check&lt;/li&gt;&lt;br&gt;&lt;/ul&gt;&lt;/p&gt;"><span class="small">Object configuration</span></div></td><td class="model_cell model_good"><div class="div_model" placement="auto" data-bs-toggle="popover" title="Admin control [Rules: 4]" data-bs-html="true" data-bs-content="&lt;p&gt;It is important to know how much administrators are in place and to track the use of emergency accounts&lt;/p&gt;&lt;p&gt;&lt;ul&gt;&lt;li&gt;Check that the operator groups are empty&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check for inactive administrator accounts&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check for number of Administrator accounts above the baseline&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check for Native administrator usage&lt;/li&gt;&lt;br&gt;&lt;/ul&gt;&lt;/p&gt;"><span class="small">Admin control</span></div></td><td class="model_cell model_good"><div class="div_model" placement="auto" data-bs-toggle="popover" title="SIDHistory [Rules: 4]" data-bs-html="true" data-bs-content="&lt;p&gt;When doing migrations, a double identity may be attributed. It can have side effects up to the compromise of the domain.&lt;/p&gt;&lt;p&gt;&lt;ul&gt;&lt;li&gt;Check if dangerous SID are stored in the SIDHistory attribute.&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if the account has been migrated from a domain which doesn&#39;t exist anymore&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check for local backdoor stored in SID History&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if a migration is in progress&lt;/li&gt;&lt;br&gt;&lt;/ul&gt;&lt;/p&gt;"><span class="small">SIDHistory</span></div></td><td class="model_cell model_good"><div class="div_model" placement="auto" data-bs-toggle="popover" title="Certificate take over [Rules: 25]" data-bs-html="true" data-bs-content="&lt;p&gt;Certificates are an alternative to passwords. Their protection is crucial to avoid any backdoor.&lt;/p&gt;&lt;p&gt;&lt;ul&gt;&lt;li&gt;Check if LDAPS is using Tls 1.0 or Tls 1.1.&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check for Intermediate Certificates using unsafe hashing algorithm (MD4)&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check for Intermediate Certificates using unsafe hashing algorithm (MD2)&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check for Intermediate Certificates using unsafe hashing algorithm (SHA0)&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check for certificates using a weak signing algorithm (RSA under 1024 bits)&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check for Root Certificates using unsafe hashing algorithm (MD2)&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check for Root Certificates using unsafe hashing algorithm (MD4)&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check for Root Certificates using unsafe hashing algorithm (MD5)&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check for Root Certificates using unsafe hashing algorithm (SHA0)&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check for Root Certificates using unsafe hashing algorithm (SHA1)&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if LDAPS is used with weak SSL protocol.&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check for Intermediate Certificates using unsafe hashing algorithm (SHA1)&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check for the ROCA vulnerability in certificates&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check for Certificates using a weak RSA exponent&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check for Certificates using a relatively weak signing algorithm (RSA between 1024 bits and 2048 or expires after 2030)&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if authentication certificate templates allow users to control the subject&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check the purpose provided by certificate templates&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check the permission of agent certificate templates&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if certificate templates can be edited by everyone.&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if WSUS is used with weak SSL protocol.&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if certificate enrollment can be done with HTTP&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if Extended Protection is in place for certificate requests&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if authentication certificate templates disallow the tracking of the certificate requester&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check for Certificates using the DSA algorithm for signature&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check for Intermediate Certificates using unsafe hashing algorithm (MD5)&lt;/li&gt;&lt;br&gt;&lt;/ul&gt;&lt;/p&gt;"><span class="small">Certificate take over</span></div></td><td class="model_empty_cell"></td></tr><tr><td class="model_cell model_good"><div class="div_model" placement="auto" data-bs-toggle="popover" title="Obsolete OS [Rules: 15]" data-bs-html="true" data-bs-content="&lt;p&gt;Operating systems have a life-cycle where its manufacturer provides patches. If the operating system is not supported anymore, vulnerabilities are not fixed anymore.&lt;/p&gt;&lt;p&gt;&lt;ul&gt;&lt;li&gt;Ensure that the functional level of the domain and the forest are up to date to use the latest security features&lt;/li&gt;&lt;br&gt;&lt;li&gt;Ensure that the functional level of the domain and the forest are up to date to use the latest security features&lt;/li&gt;&lt;br&gt;&lt;li&gt;Ensure that the functional level of the domain and the forest are up to date to use the latest security features&lt;/li&gt;&lt;br&gt;&lt;li&gt;Obsolete OS (Windows 10 or Windows 11)&lt;/li&gt;&lt;br&gt;&lt;li&gt;Obsolete OS (Windows 8)&lt;/li&gt;&lt;br&gt;&lt;li&gt;Obsolete OS (Windows 7)&lt;/li&gt;&lt;br&gt;&lt;li&gt;Obsolete OS (Windows Server 2008)&lt;/li&gt;&lt;br&gt;&lt;li&gt;Obsolete Domain Controller (Windows Server 2008)&lt;/li&gt;&lt;br&gt;&lt;li&gt;Obsolete OS (Windows Vista)&lt;/li&gt;&lt;br&gt;&lt;li&gt;Obsolete Domain Controller (Windows Server 2003)&lt;/li&gt;&lt;br&gt;&lt;li&gt;Obsolete Domain Controller (Windows 2000)&lt;/li&gt;&lt;br&gt;&lt;li&gt;Obsolete OS (Windows Server 2003)&lt;/li&gt;&lt;br&gt;&lt;li&gt;Obsolete OS (Windows 2000)&lt;/li&gt;&lt;br&gt;&lt;li&gt;Obsolete OS (Windows XP)&lt;/li&gt;&lt;br&gt;&lt;li&gt;Obsolete OS (Windows NT)&lt;/li&gt;&lt;br&gt;&lt;/ul&gt;&lt;/p&gt;"><span class="small">Obsolete OS</span></div></td><td class="model_cell model_good"><div class="div_model" placement="auto" data-bs-toggle="popover" title="Control paths [Rules: 3]" data-bs-html="true" data-bs-content="&lt;p&gt;Permissions granted to someone can be difficult to analyze. Hackers use this fact to chain multiple permission leaks in order to gain control of the domain.&lt;/p&gt;&lt;p&gt;&lt;ul&gt;&lt;li&gt;Check if administrator accounts are email enabled.&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if there is a control path involving too many users or computers.&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if there is a control path involving everyone-like groups.&lt;/li&gt;&lt;br&gt;&lt;/ul&gt;&lt;/p&gt;"><span class="small">Control paths</span></div></td><td class="model_cell model_good"><div class="div_model" placement="auto" data-bs-toggle="popover" title="Trust impermeability [Rules: 3]" data-bs-html="true" data-bs-content="&lt;p&gt;A trust is a technical boundary which should not be altered.&lt;/p&gt;&lt;p&gt;&lt;ul&gt;&lt;li&gt;Check if Kerberos delegation can be used to take control of the forest from a trusted forest&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if files deployed may be located in a trusted domain&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if login scripts may be located in a trusted domain&lt;/li&gt;&lt;br&gt;&lt;/ul&gt;&lt;/p&gt;"><span class="small">Trust impermeability</span></div></td><td class="model_cell model_good"><div class="div_model" placement="auto" data-bs-toggle="popover" title="Golden ticket [Rules: 1]" data-bs-html="true" data-bs-content="&lt;p&gt;There are key secrets in Active Directory which provide seeds to the cryptographic processes. A leak could lead to a total compromise of the domain.&lt;/p&gt;&lt;p&gt;&lt;ul&gt;&lt;li&gt;Mitigate golden ticket attack via a regular change of the krbtgt password&lt;/li&gt;&lt;br&gt;&lt;/ul&gt;&lt;/p&gt;"><span class="small">Golden ticket</span></div></td><td class="model_empty_cell"></td></tr><tr><td class="model_cell model_good"><div class="div_model" placement="auto" data-bs-toggle="popover" title="Old authentication protocols [Rules: 3]" data-bs-html="true" data-bs-content="&lt;p&gt;Cryptography and computer power have evolved during the time and the oldest protocols do not provide the same level of security anymore. They can be broken and used to gain control of the domain.&lt;/p&gt;&lt;p&gt;&lt;ul&gt;&lt;li&gt;Ensure that the NTLMv1 and old LM protocols are banned&lt;/li&gt;&lt;br&gt;&lt;li&gt;DC vulnerability (SMB v1)&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check the use of Kerberos with weak encryption (DES algorithm)&lt;/li&gt;&lt;br&gt;&lt;/ul&gt;&lt;/p&gt;"><span class="small">Old authentication protocols</span></div></td><td class="model_cell model_good"><div class="div_model" placement="auto" data-bs-toggle="popover" title="Delegation Check [Rules: 6]" data-bs-html="true" data-bs-content="&lt;p&gt;Delegations are very complex to understand and may grant more privileges than initially thought.&lt;/p&gt;&lt;p&gt;&lt;ul&gt;&lt;li&gt;Check if all DC have no resource based constrained delegation.&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if all DC have no constrained delegation with protocol transition.&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if all DC have no constrained delegation.&lt;/li&gt;&lt;br&gt;&lt;li&gt;Ensure that no accounts are subject to unconstrained delegation&lt;/li&gt;&lt;br&gt;&lt;li&gt;A Delegation is granted to Everyone&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check delegations for the recipient&#39;s existence&lt;/li&gt;&lt;br&gt;&lt;/ul&gt;&lt;/p&gt;"><span class="small">Delegation Check</span></div></td><td class="model_cell model_good"><div class="div_model" placement="auto" data-bs-toggle="popover" title="Trust inactive [Rules: 1]" data-bs-html="true" data-bs-content="&lt;p&gt;Any trust introduces a risk. The secret used for the trust can be exposed to take control of the domain.&lt;/p&gt;&lt;p&gt;&lt;ul&gt;&lt;li&gt;Check for inactive trusts&lt;/li&gt;&lt;br&gt;&lt;/ul&gt;&lt;/p&gt;"><span class="small">Trust inactive</span></div></td><td class="model_cell model_good"><div class="div_model" placement="auto" data-bs-toggle="popover" title="Local group vulnerability [Rules: 1]" data-bs-html="true" data-bs-content="&lt;p&gt;The GPO deployed settings are applied to computers locally and they can be abused to take control of individual computers.&lt;/p&gt;&lt;p&gt;&lt;ul&gt;&lt;li&gt;Check if a GPO assigns everyone to a local group&lt;/li&gt;&lt;br&gt;&lt;/ul&gt;&lt;/p&gt;"><span class="small">Local group vulnerability</span></div></td><td class="model_empty_cell"></td></tr><tr><td class="model_cell model_good"><div class="div_model" placement="auto" data-bs-toggle="popover" title="Provisioning [Rules: 3]" data-bs-html="true" data-bs-content="&lt;p&gt;It is important to control who can create new objects in the Active Directory. Indeed, its owner may introduce an object in which it has a strong control.&lt;/p&gt;&lt;p&gt;&lt;ul&gt;&lt;li&gt;Vulnerable Schema Class check&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if all DC are well registered.&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check the process of registration of computers to the domain&lt;/li&gt;&lt;br&gt;&lt;/ul&gt;&lt;/p&gt;"><span class="small">Provisioning</span></div></td><td class="model_cell model_good"><div class="div_model" placement="auto" data-bs-toggle="popover" title="Irreversible change [Rules: 3]" data-bs-html="true" data-bs-content="&lt;p&gt;Most of the changes can be reversed. Some not, and it can break the domain.&lt;/p&gt;&lt;p&gt;&lt;ul&gt;&lt;li&gt;Check if OUs and Containers are protected from accidental deletion.&lt;/li&gt;&lt;br&gt;&lt;li&gt;Ensure that the Recycle Bin feature is enabled&lt;/li&gt;&lt;br&gt;&lt;li&gt;Avoid unexpected schema modifications which could result in domain rebuild&lt;/li&gt;&lt;br&gt;&lt;/ul&gt;&lt;/p&gt;"><span class="small">Irreversible change</span></div></td><td class="model_cell model_good"><div class="div_model" placement="auto" data-bs-toggle="popover" title="Trust with Azure [Rules: 1]" data-bs-html="true" data-bs-content="&lt;p&gt;The link with Azure Systems may create new compromise methods between the cloud and on-premise systems.&lt;/p&gt;&lt;p&gt;&lt;ul&gt;&lt;li&gt;Check if password rotation is in place with AzureAD SSO&lt;/li&gt;&lt;br&gt;&lt;/ul&gt;&lt;/p&gt;"><span class="small">Trust with Azure</span></div></td><td class="model_cell model_good"><div class="div_model" placement="auto" data-bs-toggle="popover" title="Network sniffing [Rules: 12]" data-bs-html="true" data-bs-content="&lt;p&gt;Network attacks such as interception or modification can be used to run commands on behalf an administrator.&lt;/p&gt;&lt;p&gt;&lt;ul&gt;&lt;li&gt;Check if signing is really required for LDAP&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if the Channel Binding is enabled for LDAPS&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if Authenticated Users can create DNS records&lt;/li&gt;&lt;br&gt;&lt;li&gt;Hardened Paths weakness&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if DNS Zones are configured with insecure update.&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if DNS Zones are configured with insecure update.&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if NTFRS is used to replicate SYSVOL&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if LLMNR can be used to steal credentials&lt;/li&gt;&lt;br&gt;&lt;li&gt;Ensure LDAP signing requirements is not set to None&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if the file share protocol can sign its network dialog&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if the file share protocol requires its client to sign its network dialog&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check for GPO enabling the unsafe algorithm LM hash&lt;/li&gt;&lt;br&gt;&lt;/ul&gt;&lt;/p&gt;"><span class="small">Network sniffing</span></div></td><td class="model_empty_cell"></td></tr><tr><td class="model_cell model_good"><div class="div_model" placement="auto" data-bs-toggle="popover" title="Replication [Rules: 1]" data-bs-html="true" data-bs-content="&lt;p&gt;Active Directory uses a distributed architecture to have a high-level of availability. This architecture replicates each change at a regular interval. Collision of changes can create unexpected objects which can be used later.&lt;/p&gt;&lt;p&gt;&lt;ul&gt;&lt;li&gt;Duplicate account check&lt;/li&gt;&lt;br&gt;&lt;/ul&gt;&lt;/p&gt;"><span class="small">Replication</span></div></td><td class="model_cell model_good"><div class="div_model" placement="auto" data-bs-toggle="popover" title="Privilege control [Rules: 3]" data-bs-html="true" data-bs-content="&lt;p&gt;Privileges are granted to special groups to perform their duty. Sometimes, these privileges can be used to take control of the domain.&lt;/p&gt;&lt;p&gt;&lt;ul&gt;&lt;li&gt;Check if there is the privilege &quot;Access Credential Manager&quot; has been explicitly granted to a user other than the &quot;Winlogon service&quot;.&lt;/li&gt;&lt;br&gt;&lt;li&gt;Ensure that dangerous privileges are not granted to everyone by GPO&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if Service Accounts (aka accounts with never expiring password) are domain administrators&lt;/li&gt;&lt;br&gt;&lt;/ul&gt;&lt;/p&gt;"><span class="small">Privilege control</span></div></td><td class="model_empty_cell"></td><td class="model_cell model_good"><div class="div_model" placement="auto" data-bs-toggle="popover" title="Pass-the-credential [Rules: 7]" data-bs-html="true" data-bs-content="&lt;p&gt;If the password is a secret, which protects its derivatives, such as the fingerprint named hash, it can be used as if it was the password itself.&lt;/p&gt;&lt;p&gt;&lt;ul&gt;&lt;li&gt;Ensure that the WebClient client cannot be abused to force a DC connection to a HTTP server&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if LAPS passwords can be retrieved from computers that have been added manually by users.&lt;/li&gt;&lt;br&gt;&lt;li&gt;Ensure that Domain Controllers don&#39;t deny the change of computer account passwords.&lt;/li&gt;&lt;br&gt;&lt;li&gt;Ensure that the Print Spooler service cannot be abused to get the DC credentials&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check for presence of the Protected Users group&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if the LAPS tool to handle the native local administrator passwords is installed&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check for accounts using smart card with unchanged password for a long time&lt;/li&gt;&lt;br&gt;&lt;/ul&gt;&lt;/p&gt;"><span class="small">Pass-the-credential</span></div></td><td class="model_empty_cell"></td></tr><tr><td class="model_cell model_good"><div class="div_model" placement="auto" data-bs-toggle="popover" title="Vulnerability management [Rules: 6]" data-bs-html="true" data-bs-content="&lt;p&gt;Patching computers is part of the security process. Unpatched vulnerability is a way to gain control of a computer.&lt;/p&gt;&lt;p&gt;&lt;ul&gt;&lt;li&gt;Search for WSUS configuration where certificate pinning has been disabled&lt;/li&gt;&lt;br&gt;&lt;li&gt;Search for WSUS configuration enabling the use of a user proxy&lt;/li&gt;&lt;br&gt;&lt;li&gt;Search for WSUS configuration using HTTP instead of HTTPS&lt;/li&gt;&lt;br&gt;&lt;li&gt;DC vulnerability (MS17-010) &lt;/li&gt;&lt;br&gt;&lt;li&gt;DC vulnerability (MS14-068) &lt;/li&gt;&lt;br&gt;&lt;li&gt;Domain controller update&lt;/li&gt;&lt;br&gt;&lt;/ul&gt;&lt;/p&gt;"><span class="small">Vulnerability management</span></div></td><td class="model_cell model_good"><div class="div_model" placement="auto" data-bs-toggle="popover" title="Read-Only Domain Controllers [Rules: 6]" data-bs-html="true" data-bs-content="&lt;p&gt;Read-Only Domain Controllers are used in poor physically secured zones. An incorrect protection level can leak sensitive data.&lt;/p&gt;&lt;p&gt;&lt;ul&gt;&lt;li&gt;Check if RODCs have write access to the SYSVOL volume&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if privileged users have been revealed on RODC&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if a privileged group can be revealed on a RODC&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if the protection against revealing privileged group is active&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check the Denied RODC Password Replication Group group&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check the Allowed RODC Password Replication Group group&lt;/li&gt;&lt;br&gt;&lt;/ul&gt;&lt;/p&gt;"><span class="small">Read-Only Domain Controllers</span></div></td><td class="model_empty_cell"></td><td class="model_cell model_good"><div class="div_model" placement="auto" data-bs-toggle="popover" title="Password retrieval [Rules: 3]" data-bs-html="true" data-bs-content="&lt;p&gt;Passwords stored in clear text or obfuscated can be retrieved. By reusing the user&#39;s identity, an attacker&#39;s login appears like from any legitimate user. There&#39;s no need to perform a potentially detectable exploit for intrusion or lateral movement.&lt;/p&gt;&lt;p&gt;&lt;ul&gt;&lt;li&gt;Check if attributes unixUserPassword and userPassword are set&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check for GPO which enables reversible passwords&lt;/li&gt;&lt;br&gt;&lt;li&gt;Find Password GPO&lt;/li&gt;&lt;br&gt;&lt;/ul&gt;&lt;/p&gt;"><span class="small">Password retrieval</span></div></td><td class="model_empty_cell"></td></tr><tr><td class="model_empty_cell"></td><td class="model_empty_cell"></td><td class="model_empty_cell"></td><td class="model_cell model_good"><div class="div_model" placement="auto" data-bs-toggle="popover" title="Reconnaissance [Rules: 11]" data-bs-html="true" data-bs-content="&lt;p&gt;At the beginning of an attack, a hacker tries to collect as much data as possible. Leaking information just reduces the time an attacker needs to gain control of the domain.&lt;/p&gt;&lt;p&gt;&lt;ul&gt;&lt;li&gt;Check if the mitigation for CVE-2021-42291 has been enabled&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if the UPN and SPN uniqueness check has been disabled&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check that the &quot;Pre-Windows 2000 Compatible Access&quot; group does not contain &quot;Authenticated Users&quot;&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if DNS Zones are configured with Zone Transfers.&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check if NetCease has been put in place to mitigate Bloodhound&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check that the &quot;Pre-Windows 2000 Compatible Access&quot; group has not been modified from its default&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check for access without any account to the Name Service Provider Interface (NSPI) protocol&lt;/li&gt;&lt;br&gt;&lt;li&gt;Retrieve data from the domain without any account&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check for Windows 2000 compatibility which allows access to the domain without any account&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check for GPO granting access to the domain without any account&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check for access without any account via a forest wide setting&lt;/li&gt;&lt;br&gt;&lt;/ul&gt;&lt;/p&gt;"><span class="small">Reconnaissance</span></div></td><td class="model_empty_cell"></td></tr><tr><td class="model_empty_cell"></td><td class="model_empty_cell"></td><td class="model_empty_cell"></td><td class="model_cell model_good"><div class="div_model" placement="auto" data-bs-toggle="popover" title="Temporary admins [Rules: 1]" data-bs-html="true" data-bs-content="&lt;p&gt;Administrators grant sometimes privileged rights to colleagues without any approval from a security officer.&lt;/p&gt;&lt;p&gt;&lt;ul&gt;&lt;li&gt;Check for suspicious account(s) used in administrator activities&lt;/li&gt;&lt;br&gt;&lt;/ul&gt;&lt;/p&gt;"><span class="small">Temporary admins</span></div></td><td class="model_empty_cell"></td></tr><tr><td class="model_empty_cell"></td><td class="model_empty_cell"></td><td class="model_empty_cell"></td><td class="model_cell model_good"><div class="div_model" placement="auto" data-bs-toggle="popover" title="Weak password [Rules: 4]" data-bs-html="true" data-bs-content="&lt;p&gt;Misprotected credentials can be abused to be retrieved in plain text and then, impersonate the user.&lt;/p&gt;&lt;p&gt;&lt;ul&gt;&lt;li&gt;Check if the guest account is enabled&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check the Password Policy for Service Accounts (Information)&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check for GPO allowing accounts without password to be accessed from the network&lt;/li&gt;&lt;br&gt;&lt;li&gt;Check for short password length in password policy&lt;/li&gt;&lt;br&gt;&lt;/ul&gt;&lt;/p&gt;"><span class="small">Weak password</span></div></td><td class="model_empty_cell"></td></tr>
					</tbody>
				</table>
			</div>
		</div>
		<!-- SubSection Stale Objects -->
		<div class="row"><div class="col-lg-12 mt-2">
			<h2>Stale Objects</h2>
		</div></div>
        <!-- SubSection Stale Objects end -->
		<div class="row"><div class="col-lg-12">
		<p>Each line represents a rule. Click on a rule to expand it and show the details of it.
		</p>

		<div class="row"><div class="col-lg-12 mt-3">
		<h3>Inactive user or computer
		</h3>

		<div class="row"><div class="col-lg-12">
		<p>By reusing existing objects, whose credentials may be the same among all objects or stored on configuration files or in memory, a third party can take them over.
		</p>

		<!-- Accordion rulesInactiveUserOrComputer -->
<div id="rulesInactiveUserOrComputer">
<div class="card">
    
    <div class="card-header" id="headingrulesS-PwdLastSet-45"><a name="anchorrulesS-PwdLastSet-45"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-PwdLastSet-45" aria-expanded="false" aria-controls="rulesS-PwdLastSet-45">
          [M]Check if all computers are using regular password change practices. (S-PwdLastSet-45)
        </button>
      </span>

    </div>

    <div id="rulesS-PwdLastSet-45" class="collapse" aria-labelledby="headingrulesS-PwdLastSet-45" data-parent="#rulesInactiveUserOrComputer">
      <div class="card-body">
        <h3>Check if all computers are using regular password change practices.</h3>
<strong>Rule ID:</strong><p class="text-justify">S-PwdLastSet-45</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that the regular change of computer account passwords is active</p>
<strong>Technical Explanation:</strong><p class="text-justify">By default, all computers automatically change their AD password every 30 days.<br>
    Changing regularly secrets like passwords ensures that they are not used in side channel attacks.<br>
    Also with the default possibility to create up to 10 computers accounts, these accounts may be seen as a backdoor.<br>
    <br>
    This audit program considers this as an anomaly between 45 days and 90 days.<br>
    Also this rule is the companion for the rule S-PwdLastSet-90<br>
    </p>
<strong>Advised Solution:</strong><p class="text-justify"><br>
      Some security agencies report the absence of password change as an indicator of compromise.<br>
      <br>
      If it is not the case, check the following registry keys:<br>
* HKLM\System\CurrentControlSet\Services\Netlogon\Parameters\DisablePasswordChange: must be set to 0 or inexistent;<br>
* HKLM\System\CurrentControlSet\Services\Netlogon\Parameters\MaximumPasswordAge: must be set to 30.<br>
<br>
For Linux systems, the password change may not be enabled by default - solutions exist, see the link in documentation, like a daily cron job to run msktutil --auto-update.<br>
    </p><strong>Introduced in:</strong><p class="text-justify">2.9.0.0</p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://support.microsoft.com/en-us/help/154501/how-to-disable-automatic-machine-account-password-changes">https://support.microsoft.com/en-us/help/154501/how-to-disable-automatic-machine-account-password-changes</a><br>
<a href="https://access.redhat.com/discussions/1283873">https://access.redhat.com/discussions/1283873</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#password_change_server_no_change_45">[FR]ANSSI - Servers with passwords unchanged for more than 45 days (vuln3_password_change_server_no_change_45)</a><span class="badge grade-3">3</span><br>
<a href="https://www.stigviewer.com/stig/windows_10/2018-04-06/finding/V-63653">[US]STIG V-63653 - The computer account password must not be prevented from being reset.</a><br>
<a href="https://www.stigviewer.com/stig/windows_7/2012-08-22/finding/V-3373">[US]STIG V-3373 - The maximum age for machine account passwords is not set to requirements.</a><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-PwdLastSet-90"><a name="anchorrulesS-PwdLastSet-90"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-PwdLastSet-90" aria-expanded="false" aria-controls="rulesS-PwdLastSet-90">
          [M]Check if all computers have changed their passwords in the last 3 months. (S-PwdLastSet-90)
        </button>
      </span>

    </div>

    <div id="rulesS-PwdLastSet-90" class="collapse" aria-labelledby="headingrulesS-PwdLastSet-90" data-parent="#rulesInactiveUserOrComputer">
      <div class="card-body">
        <h3>Check if all computers have changed their passwords in the last 3 months.</h3>
<strong>Rule ID:</strong><p class="text-justify">S-PwdLastSet-90</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that all computer accounts have their password changed in the last 3 months</p>
<strong>Technical Explanation:</strong><p class="text-justify">By default, all computers automatically change their AD password every 30 days.<br>
    Changing regularly secrets like passwords ensures that they are not used in side channel attacks.<br>
    Also with the default possibility to create up to 10 computers accounts, these accounts may be seen as a backdoor.<br>
    <br>
    This audit program considers this as an anomaly starting with 90 days.<br>
    Also this rule is the companion for the rule S-PwdLastSet-45 which does the same between 45 and 90 days<br>
    </p>
<strong>Advised Solution:</strong><p class="text-justify"><br>
      Some security agencies report the absence of password change as an indicator of compromise.<br>
      <br>
      If it is not the case, check the following registry keys:<br>
* HKLM\System\CurrentControlSet\Services\Netlogon\Parameters\DisablePasswordChange: must be set to 0 or inexistent;<br>
* HKLM\System\CurrentControlSet\Services\Netlogon\Parameters\MaximumPasswordAge: must be set to 30.<br>
<br>
For Linux systems, the password change may not be enabled by default - solutions exist, see the link in documentation, like a daily cron job to run msktutil --auto-update.<br>
    </p><strong>Introduced in:</strong><p class="text-justify">2.9.0.0</p><strong>Points:</strong><p>15 points if present</p>
<strong>Documentation:</strong><p><a href="https://support.microsoft.com/en-us/help/154501/how-to-disable-automatic-machine-account-password-changes">https://support.microsoft.com/en-us/help/154501/how-to-disable-automatic-machine-account-password-changes</a><br>
<a href="https://access.redhat.com/discussions/1283873">https://access.redhat.com/discussions/1283873</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#password_change_server_no_change_90">[FR]ANSSI - Servers with passwords unchanged for more than 90 days (vuln2_password_change_server_no_change_90)</a><span class="badge grade-2">2</span><br>
<a href="https://www.stigviewer.com/stig/windows_10/2018-04-06/finding/V-63653">[US]STIG V-63653 - The computer account password must not be prevented from being reset.</a><br>
<a href="https://www.stigviewer.com/stig/windows_7/2012-08-22/finding/V-3373">[US]STIG V-3373 - The maximum age for machine account passwords is not set to requirements.</a><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-DC-Inactive"><a name="anchorrulesS-DC-Inactive"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-DC-Inactive" aria-expanded="false" aria-controls="rulesS-DC-Inactive">
          [M]Check if all DC are active. (S-DC-Inactive)
        </button>
      </span>

    </div>

    <div id="rulesS-DC-Inactive" class="collapse" aria-labelledby="headingrulesS-DC-Inactive" data-parent="#rulesInactiveUserOrComputer">
      <div class="card-body">
        <h3>Check if all DC are active.</h3>
<strong>Rule ID:</strong><p class="text-justify">S-DC-Inactive</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that every DC is active.</p>
<strong>Technical Explanation:</strong><p class="text-justify">Domain Controllers are user accounts with powerful privileges.<br>
    While an active Domain Controller changes its password every 30 days, an inactive account can be involved in a domain compromise.<br>
    Indeed, another account, which has rights over this object, may reset the password of this account without being noticed.<br>
    </p>
<strong>Advised Solution:</strong><p class="text-justify">You have to demote the DC object using the procedure referenced in the documentation section.<br>
    </p><strong>Introduced in:</strong><p class="text-justify">2.9.0.0</p><strong>Points:</strong><p>5 points per discovery</p>
<strong>Documentation:</strong><p><a href="https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/deploy/demoting-domain-controllers-and-domains--level-200-">https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/deploy/demoting-domain-controllers-and-domains--level-200-</a><br>
<a href="https://www.ssi.gouv.fr/uploads/IMG/pdf/NP_ActiveDirectory_NoteTech.pdf#paragraph.3.6.6.2">[FR]ANSSI - Recommandations de sécurité relatives à Active Directory - R45 [paragraph.3.6.6.2]</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#password_change_inactive_dc">[FR]ANSSI - Inactive domain controllers (vuln1_password_change_inactive_dc)</a><span class="badge grade-1">1</span><br>
<a href="https://attack.mitre.org/mitigations/M1018">[MITRE]Mitre Att&amp;ck - Mitigation - User Account Management</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-PwdLastSet-DC"><a name="anchorrulesS-PwdLastSet-DC"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-PwdLastSet-DC" aria-expanded="false" aria-controls="rulesS-PwdLastSet-DC">
          [M]Check if all DC are using regular password change practices. (S-PwdLastSet-DC)
        </button>
      </span>

    </div>

    <div id="rulesS-PwdLastSet-DC" class="collapse" aria-labelledby="headingrulesS-PwdLastSet-DC" data-parent="#rulesInactiveUserOrComputer">
      <div class="card-body">
        <h3>Check if all DC are using regular password change practices.</h3>
<strong>Rule ID:</strong><p class="text-justify">S-PwdLastSet-DC</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that the regular change of computer account is active on Domain Controllers.</p>
<strong>Technical Explanation:</strong><p class="text-justify">By default, each computers automatically change its password every 30 days. This is the same case for domain controllers.<br>
    Changing regularly secrets like passwords ensures that they are not used in side channel attacks.<br>
    For exemple, using DCSync to export the hash of a domain controller password, then reusing it in a silver attack to create Kerberos tickets.<br>
    <br>
    This audit program considers this as an anomaly after 45 days.<br>
    </p>
<strong>Advised Solution:</strong><p class="text-justify"><br>
      Some security agencies report the absence of password change as an indicator of compromise.<br>
      <br>
      If it is not the case, check the following registry keys:<br>
* HKLM\System\CurrentControlSet\Services\Netlogon\Parameters\DisablePasswordChange: must be set to 0 or inexistent;<br>
* HKLM\System\CurrentControlSet\Services\Netlogon\Parameters\MaximumPasswordAge: must be set to 30.<br>
    </p><strong>Introduced in:</strong><p class="text-justify">2.9.0.0</p><strong>Points:</strong><p>5 points per discovery</p>
<strong>Documentation:</strong><p><a href="https://support.microsoft.com/en-us/help/154501/how-to-disable-automatic-machine-account-password-changes">https://support.microsoft.com/en-us/help/154501/how-to-disable-automatic-machine-account-password-changes</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#password_change_dc_no_change">[FR]ANSSI - Domain controllers with passwords unchanged for more than 45 days (vuln1_password_change_dc_no_change)</a><span class="badge grade-1">1</span><br>
<a href="https://www.stigviewer.com/stig/windows_10/2018-04-06/finding/V-63653">[US]STIG V-63653 - The computer account password must not be prevented from being reset.</a><br>
<a href="https://www.stigviewer.com/stig/windows_7/2012-08-22/finding/V-3373">[US]STIG V-3373 - The maximum age for machine account passwords is not set to requirements.</a><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-Inactive"><a name="anchorrulesS-Inactive"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-Inactive" aria-expanded="false" aria-controls="rulesS-Inactive">
          [M]Inactive account check (S-Inactive)
        </button>
      </span>

    </div>

    <div id="rulesS-Inactive" class="collapse" aria-labelledby="headingrulesS-Inactive" data-parent="#rulesInactiveUserOrComputer">
      <div class="card-body">
        <h3>Inactive account check</h3>
<strong>Rule ID:</strong><p class="text-justify">S-Inactive</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that there are as few inactive accounts as possible within the domain. Stale user accounts are a significant security issue, as former employees and external attackers could use those accounts to attack the organization.</p>
<strong>Technical Explanation:</strong><p class="text-justify">Inactive accounts often stay in the network because of weaknesses in the decommissioning process. These stale computer accounts can be used as backdoors and therefore represents a possible security breach. </p>
<strong>Advised Solution:</strong><p class="text-justify">To mitigate the risk, you should monitor the number of inactive accounts and reduce it as much as possible. A list of all inactive accounts is obtainable through the command: <i>Search-ADAccount –AccountInActive –UsersOnly –TimeSpan 180:00:00:00 –ResultPageSize 2000 –ResultSetSize $null | ?{$_.Enabled –eq $True} | Select-Object Name, SamAccountName, DistinguishedName</i>.</p><strong>Points:</strong><p>10 points if the occurence is greater than or equals than 25</p>
<strong>Documentation:</strong><p><a href="https://www.ssi.gouv.fr/uploads/IMG/pdf/NP_ActiveDirectory_NoteTech.pdf#paragraph.3.6.6.2">[FR]ANSSI - Recommandations de sécurité relatives à Active Directory - R45 [paragraph.3.6.6.2]</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#user_accounts_dormant">[FR]ANSSI - Dormant accounts (vuln1_user_accounts_dormant)</a><span class="badge grade-1">1</span><br>
<a href="https://attack.mitre.org/mitigations/M1018">[MITRE]Mitre Att&amp;ck - Mitigation - User Account Management</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-C-Inactive"><a name="anchorrulesS-C-Inactive"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-C-Inactive" aria-expanded="false" aria-controls="rulesS-C-Inactive">
          [M]Inactive computer check (S-C-Inactive)
        </button>
      </span>

    </div>

    <div id="rulesS-C-Inactive" class="collapse" aria-labelledby="headingrulesS-C-Inactive" data-parent="#rulesInactiveUserOrComputer">
      <div class="card-body">
        <h3>Inactive computer check</h3>
<strong>Rule ID:</strong><p class="text-justify">S-C-Inactive</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that there are as few inactive computers as possible within the domain.</p>
<strong>Technical Explanation:</strong><p class="text-justify">Inactive computers often stay in the network because of weaknesses in the decommissioning process. These stale computer accounts can be used as backdoors and therefore represents a possible security breach. </p>
<strong>Advised Solution:</strong><p class="text-justify">To mitigate the risk, you should monitor the number of inactive accounts and reduce it as much as possible. A list of all inactive accounts is obtainable through the command: <i>Search-ADAccount –AccountInActive –ComputersOnly –TimeSpan 180:00:00:00 –ResultPageSize 2000 –ResultSetSize $null | ?{$_.Enabled –eq $True} | Select-Object Name, SamAccountName, DistinguishedName</i>.</p><strong>Points:</strong><p>30 points if the occurence is greater than or equals than 30<br>
then 10 points if the occurence is greater than or equals than 20<br>
then 5 points if the occurence is greater than or equals than 15</p>
<strong>Documentation:</strong><p><a href="https://www.ssi.gouv.fr/uploads/IMG/pdf/NP_ActiveDirectory_NoteTech.pdf#paragraph.3.6.6.2">[FR]ANSSI - Recommandations de sécurité relatives à Active Directory - R45 [paragraph.3.6.6.2]</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#password_change_inactive_servers">[FR]ANSSI - Inactive servers (vuln3_password_change_inactive_servers)</a><span class="badge grade-3">3</span><br>
<a href="https://attack.mitre.org/mitigations/M1018">[MITRE]Mitre Att&amp;ck - Mitigation - User Account Management</a></p>
    </div>
  </div></div></div>
			<!-- Accordion rulesInactiveUserOrComputer end -->

		<div class="row"><div class="col-lg-12 mt-3">
		<h3>Network topography
		</h3>

		<div class="row"><div class="col-lg-12">
		<p>It is important to have a database of all the assets and control the physical security of the server. If one server is compromised physically, all the secrets of the domain can be exposed.
		</p>

		<!-- Accordion rulesNetworkTopography -->
<div id="rulesNetworkTopography">
<div class="card">
    
    <div class="card-header" id="headingrulesS-DC-SubnetMissing"><a name="anchorrulesS-DC-SubnetMissing"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-DC-SubnetMissing" aria-expanded="false" aria-controls="rulesS-DC-SubnetMissing">
          [M]Check for completeness of network declaration (S-DC-SubnetMissing)
        </button>
      </span>

    </div>

    <div id="rulesS-DC-SubnetMissing" class="collapse" aria-labelledby="headingrulesS-DC-SubnetMissing" data-parent="#rulesNetworkTopography">
      <div class="card-body">
        <h3>Check for completeness of network declaration</h3>
<strong>Rule ID:</strong><p class="text-justify">S-DC-SubnetMissing</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that the minimum set of subnet(s) has been configured in the domain</p>
<strong>Technical Explanation:</strong><p class="text-justify">When multiple sites are created in a domain, networks should be declared in the domain in order to optimize processes such as DC attribution. In addition, PingCastle can collect the information to be able to build a network map. This rule has been triggered because at least one domain controller has an IP address which was not found in subnet declaration. These IP addresses have been collected by querying the DC FQDN IP address in both IPv6 and IPv4 format.</p>
<strong>Advised Solution:</strong><p class="text-justify">Locate the IP address which was found as not being part of declared subnet, then add this subnet to the "Active Directory Sites" tool. If you have found IPv6 addresses and it was not expected, you should disable the IPv6 protocol on the network card.</p><strong>Introduced in:</strong><p class="text-justify">2.5.0.0</p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a></p>
    </div>
  </div></div></div>
			<!-- Accordion rulesNetworkTopography end -->

		<div class="row"><div class="col-lg-12 mt-3">
		<h3>Object configuration
		</h3>

		<div class="row"><div class="col-lg-12">
		<p>By abusing a misconfiguration, an attacker can gain the control of the domain.
		</p>

		<!-- Accordion rulesObjectConfig -->
<div id="rulesObjectConfig">
<div class="card">
    
    <div class="card-header" id="headingrulesS-C-PrimaryGroup"><a name="anchorrulesS-C-PrimaryGroup"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-C-PrimaryGroup" aria-expanded="false" aria-controls="rulesS-C-PrimaryGroup">
          [M]Check for hidden group membership for computer accounts (S-C-PrimaryGroup)
        </button>
      </span>

    </div>

    <div id="rulesS-C-PrimaryGroup" class="collapse" aria-labelledby="headingrulesS-C-PrimaryGroup" data-parent="#rulesObjectConfig">
      <div class="card-body">
        <h3>Check for hidden group membership for computer accounts</h3>
<strong>Rule ID:</strong><p class="text-justify">S-C-PrimaryGroup</p>
<strong>Description:</strong><p class="text-justify">The purpose is to check for unusual value in the primarygroupid attribute used to store group membership</p>
<strong>Technical Explanation:</strong><p class="text-justify">In Active Directory, group membership is stored on the "members" attribute and on the "primarygroupid" attribute.<br>
    The default primary group value is "Domain Users" for the users, "Domain Computers" for the computers and "Domain Controllers" for the domain controllers.<br>
    The primarygroupid contains the RID (last digits of a SID) of the group targeted. It can be used to store hidden membership as this attribute is not often analyzed.<br>
    This rule can also be triggered if one domain controller is not in the default container (named "Domain Controllers" and located at the root), which is not a recommended practice.<br>
  </p>
<strong>Advised Solution:</strong><p class="text-justify">Unless strongly justified, change the primary group id to its default: 513 or 514 for users, 516 or 521 for domain controllers, 514 or 515 for computers. The primary group can be edited in a friendly manner by editing the account with the "Active Directory Users and Computers" and after selecting the "Member Of" tab, "set primary group".</p><strong>Points:</strong><p>15 points if present</p>
<strong>Documentation:</strong><p><a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#primary_group_id_nochange">[FR]ANSSI - Accounts with modified PrimaryGroupID (vuln3_primary_group_id_nochange)</a><span class="badge grade-3">3</span><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-PrimaryGroup"><a name="anchorrulesS-PrimaryGroup"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-PrimaryGroup" aria-expanded="false" aria-controls="rulesS-PrimaryGroup">
          [M]Check for hidden group membership for user accounts (S-PrimaryGroup)
        </button>
      </span>

    </div>

    <div id="rulesS-PrimaryGroup" class="collapse" aria-labelledby="headingrulesS-PrimaryGroup" data-parent="#rulesObjectConfig">
      <div class="card-body">
        <h3>Check for hidden group membership for user accounts</h3>
<strong>Rule ID:</strong><p class="text-justify">S-PrimaryGroup</p>
<strong>Description:</strong><p class="text-justify">The purpose is to check for unusual values in the primarygroupid attribute used to store group memberships</p>
<strong>Technical Explanation:</strong><p class="text-justify">In Active Directory, group membership is stored on the "members" attribute and on the "primarygroupid" attribute. The default primary group value is "Domain Users" for the users, "Domain Computers" for the computers and "Domain Controllers" for the domain controllers. The primarygroupid contains the RID (last digits of a SID) of the group targeted. It can be used to store hidden membership as this attribute is not often analyzed.</p>
<strong>Advised Solution:</strong><p class="text-justify">Unless strongly justified, change the primary group id to its default: 513 or 514 for users, 516 or 521 for domain controllers, 514 or 515 for computers. The primary group can be edited in a friendly manner by editing the account with the "Active Directory Users and Computers" and after selecting the "Member Of" tab, "set primary group".<br>
    You can use the following script to list Users with a primary group id different from domain users:<br>
    <i>Get-ADUser -Filter * -Properties PrimaryGroup | Where-Object { $_.PrimaryGroup -ne (Get-ADGroup -Identity "Domain Users").DistinguishedName } | Select-Object UserPrincipalName,PrimaryGroup</i></p><strong>Points:</strong><p>15 points if present</p>
<strong>Documentation:</strong><p><a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#primary_group_id_nochange">[FR]ANSSI - Accounts with modified PrimaryGroupID (vuln3_primary_group_id_nochange)</a><span class="badge grade-3">3</span><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-Reversible"><a name="anchorrulesS-Reversible"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-Reversible" aria-expanded="false" aria-controls="rulesS-Reversible">
          [T]Check for reversible password used for user accounts (S-Reversible)
        </button>
      </span>

    </div>

    <div id="rulesS-Reversible" class="collapse" aria-labelledby="headingrulesS-Reversible" data-parent="#rulesObjectConfig">
      <div class="card-body">
        <h3>Check for reversible password used for user accounts</h3>
<strong>Rule ID:</strong><p class="text-justify">S-Reversible</p>
<strong>Description:</strong><p class="text-justify">The purpose is to verify if there are user accounts currently running with a reversible password</p>
<strong>Technical Explanation:</strong><p class="text-justify">It is possible that domains have accounts with an encryption that can be reversed. In this case, it means that the password is actually stored in clear text in the <i>supplementalCredential</i> attribute of the account and that it can be retrieved using a DCSync attack</p>
<strong>Advised Solution:</strong><p class="text-justify">To remove this risk, there should be no account(s) with reversible encryption. You should remove them by removing the flag "Store password using reversible encryption" on all accounts, so that the cleartext password is removed at the next password change. You can get a list of all the possibly compromised accounts running the following PowerShell command: <i>get-adobject -ldapfilter "(userAccountControl:1.2.840.113556.1.4.803:=128)" -properties useraccountcontrol</i></p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#reversible_password">[FR]ANSSI - Accounts with passwords stored using reversible encryption (vuln3_reversible_password)</a><span class="badge grade-3">3</span><br>
<a href="https://attack.mitre.org/techniques/T1110/002">[MITRE]T1110.002 Brute Force: Password Cracking</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-C-Reversible"><a name="anchorrulesS-C-Reversible"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-C-Reversible" aria-expanded="false" aria-controls="rulesS-C-Reversible">
          [T]Check for reversible passwords used for computer accounts (S-C-Reversible)
        </button>
      </span>

    </div>

    <div id="rulesS-C-Reversible" class="collapse" aria-labelledby="headingrulesS-C-Reversible" data-parent="#rulesObjectConfig">
      <div class="card-body">
        <h3>Check for reversible passwords used for computer accounts</h3>
<strong>Rule ID:</strong><p class="text-justify">S-C-Reversible</p>
<strong>Description:</strong><p class="text-justify">The purpose is to verify if there are accounts currently running with a reversible password</p>
<strong>Technical Explanation:</strong><p class="text-justify">It is possible that domains have accounts with an encryption that can be reversed. In this case, it means that the password is actually stored in clear text in the <i>supplementalCredential</i> attribute of the account and that it can be retrieved using a DCSync attack</p>
<strong>Advised Solution:</strong><p class="text-justify">To remove this risk, there should be no account(s) with reversible encryption for the password. You should remove them by removing the flag "Store password using reversible encryption" on all accounts, so that the cleartext password is removed at the next password change. You can get a list of all the possibly compromised accounts running the following PowerShell command: <i>get-adobject -ldapfilter "(userAccountControl:1.2.840.113556.1.4.803:=128)" -properties useraccountcontrol</i></p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#reversible_password">[FR]ANSSI - Accounts with passwords stored using reversible encryption (vuln3_reversible_password)</a><span class="badge grade-3">3</span><br>
<a href="https://attack.mitre.org/techniques/T1110/002">[MITRE]T1110.002 Brute Force: Password Cracking</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-NoPreAuth"><a name="anchorrulesS-NoPreAuth"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-NoPreAuth" aria-expanded="false" aria-controls="rulesS-NoPreAuth">
          [T]Check if all accounts require Kerberos pre-authentication (S-NoPreAuth)
        </button>
      </span>

    </div>

    <div id="rulesS-NoPreAuth" class="collapse" aria-labelledby="headingrulesS-NoPreAuth" data-parent="#rulesObjectConfig">
      <div class="card-body">
        <h3>Check if all accounts require Kerberos pre-authentication</h3>
<strong>Rule ID:</strong><p class="text-justify">S-NoPreAuth</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that all accounts require Kerberos pre-authentication</p>
<strong>Technical Explanation:</strong><p class="text-justify">Without Kerberos pre-authentication, an attacker can request Kerberos data from the domain controller and use this data to crack the account password. You can find which accounts don't require Kerberos pre-authentication with the PowerShell command: <i>Get-ADObject -LDAPFilter "(userAccountControl:1.2.840.113556.1.4.803:=4194304)"</i></p>
<strong>Advised Solution:</strong><p class="text-justify">Edit the property of the involved accounts and select the Account tab. Uncheck "Do not require Kerberos preauthentication". For computers, which don't have the Account tab, you have to manually edit the attribute useraccountcontrol. Subtract 4194304 the value of the attribute.</p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="http://www.harmj0y.net/blog/activedirectory/roasting-as-reps/">http://www.harmj0y.net/blog/activedirectory/roasting-as-reps/</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#kerberos_properties_preauth">[FR]ANSSI - Kerberos pre-authentication disabled (vuln2_kerberos_properties_preauth)</a><span class="badge grade-2">2</span><br>
<a href="https://attack.mitre.org/techniques/T1558/004">[MITRE]T1558.004 Steal or Forge Kerberos Tickets: AS-REP Roasting</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-NoPreAuthAdmin"><a name="anchorrulesS-NoPreAuthAdmin"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-NoPreAuthAdmin" aria-expanded="false" aria-controls="rulesS-NoPreAuthAdmin">
          [T]Check if all admin accounts require Kerberos pre-authentication (S-NoPreAuthAdmin)
        </button>
      </span>

    </div>

    <div id="rulesS-NoPreAuthAdmin" class="collapse" aria-labelledby="headingrulesS-NoPreAuthAdmin" data-parent="#rulesObjectConfig">
      <div class="card-body">
        <h3>Check if all admin accounts require Kerberos pre-authentication</h3>
<strong>Rule ID:</strong><p class="text-justify">S-NoPreAuthAdmin</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that all admin accounts require Kerberos pre-authentication</p>
<strong>Technical Explanation:</strong><p class="text-justify">Without Kerberos pre-authentication, an attacker can request Kerberos data from the domain controller and use this data to brute-force the account password. You can search accounts using the LDAP query <i>(userAccountControl:1.2.840.113556.1.4.803:=4194304)</i></p>
<strong>Advised Solution:</strong><p class="text-justify">Edit the property of the involved accounts and select the Account tab. Uncheck "Do not require Kerberos preauthentication". For computers, which don't have the Account tab, you have to manually edit the attribute useraccountcontrol. Subtract 4194304 from the value of the attribute.</p><strong>Introduced in:</strong><p class="text-justify">2.9.0.0</p><strong>Points:</strong><p>5 points per discovery</p>
<strong>Documentation:</strong><p><a href="http://www.harmj0y.net/blog/activedirectory/roasting-as-reps/">http://www.harmj0y.net/blog/activedirectory/roasting-as-reps/</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#kerberos_properties_preauth_priv">[FR]ANSSI - Kerberos pre-authentication disabled for privileged accounts (vuln1_kerberos_properties_preauth_priv)</a><span class="badge grade-1">1</span><br>
<a href="https://attack.mitre.org/techniques/T1558/004">[MITRE]T1558.004 Steal or Forge Kerberos Tickets: AS-REP Roasting</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-DefaultOUChanged"><a name="anchorrulesS-DefaultOUChanged"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-DefaultOUChanged" aria-expanded="false" aria-controls="rulesS-DefaultOUChanged">
          [M]Check if default OU location has been changed within the domain. (S-DefaultOUChanged)
        </button>
      </span>

    </div>

    <div id="rulesS-DefaultOUChanged" class="collapse" aria-labelledby="headingrulesS-DefaultOUChanged" data-parent="#rulesObjectConfig">
      <div class="card-body">
        <h3>Check if default OU location has been changed within the domain.</h3>
<strong>Rule ID:</strong><p class="text-justify">S-DefaultOUChanged</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that the default location of computers and user OU has not been changed.</p>
<strong>Technical Explanation:</strong><p class="text-justify">Default OU such as CN=Computers or CN=Users are stored within the wellKnownObjects attribute of the Domain object.<br>
    There are 12 default locations officialy defined.<br>
    They can be changed using the program redircmp.<br>
    Changing these default can alter the behavior of programs (such as security audit programs) as they may not check the modified objects.<br>
    </p>
<strong>Advised Solution:</strong><p class="text-justify">You have to use redircmp to set the value back to normal. See documentation for more details<br>
  </p><strong>Introduced in:</strong><p class="text-justify">3.1.0.0</p><strong>Points:</strong><p>Informative rule (0 point)</p>
<strong>Documentation:</strong><p><a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/5a00c890-6be5-4575-93c4-8bf8be0ca8d8">https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/5a00c890-6be5-4575-93c4-8bf8be0ca8d8</a><br>
<a href="https://rickardnobel.se/verify-redirected-computers-container-in-active-directory/">https://rickardnobel.se/verify-redirected-computers-container-in-active-directory/</a><br>
<a href="https://attack.mitre.org/mitigations/M1018">[MITRE]Mitre Att&amp;ck - Mitigation - User Account Management</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-PwdNotRequired"><a name="anchorrulesS-PwdNotRequired"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-PwdNotRequired" aria-expanded="false" aria-controls="rulesS-PwdNotRequired">
          [M]Check that every account requires a password (S-PwdNotRequired)
        </button>
      </span>

    </div>

    <div id="rulesS-PwdNotRequired" class="collapse" aria-labelledby="headingrulesS-PwdNotRequired" data-parent="#rulesObjectConfig">
      <div class="card-body">
        <h3>Check that every account requires a password</h3>
<strong>Rule ID:</strong><p class="text-justify">S-PwdNotRequired</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that every account requires a password</p>
<strong>Technical Explanation:</strong><p class="text-justify">An account can be set without a password if it has the flag "PASSWD_NOTREQD" set as "True" in the "useraccountcontrol" attribute. This represents a high security risk as the account is not protected at all without a password</p>
<strong>Advised Solution:</strong><p class="text-justify">The best solution to solve the problem is to change the "useraccountcontrol" attribute of all the accounts that have it and that are not used in trusts. If the flag is removed while there is no password set, you will have an error. You can use this to detect accounts without any passwords. Do note that you can manually check all the accounts that need to be worked on using the following PowerShell command: <i>get-adobject -ldapfilter "(&amp;(objectCategory=person)(objectClass=user)(userAccountControl:1.2.840.113556.1.4.803:=32))" -properties useraccountcontrol</i></p><strong>Points:</strong><p>15 points if present</p>
<strong>Documentation:</strong><p><a href="https://docs.microsoft.com/troubleshoot/windows-server/identity/useraccountcontrol-manipulate-account-properties">https://docs.microsoft.com/troubleshoot/windows-server/identity/useraccountcontrol-manipulate-account-properties</a><br>
<a href="https://www.ssi.gouv.fr/uploads/IMG/pdf/NP_ActiveDirectory_NoteTech.pdf#subsection.3.6">[FR]ANSSI - Recommandations de sécurité relatives à Active Directory - R36 [subsection.3.6]</a><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-PwdNeverExpires"><a name="anchorrulesS-PwdNeverExpires"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-PwdNeverExpires" aria-expanded="false" aria-controls="rulesS-PwdNeverExpires">
          [M]Check that there is no account with never-expiring passwords (S-PwdNeverExpires)
        </button>
      </span>

    </div>

    <div id="rulesS-PwdNeverExpires" class="collapse" aria-labelledby="headingrulesS-PwdNeverExpires" data-parent="#rulesObjectConfig">
      <div class="card-body">
        <h3>Check that there is no account with never-expiring passwords</h3>
<strong>Rule ID:</strong><p class="text-justify">S-PwdNeverExpires</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that every account has a password which is compliant with password expiration policies</p>
<strong>Technical Explanation:</strong><p class="text-justify">Some accounts have passwords which never expire. Should an attacker compromise one of these accounts, he would be able to maintain long-term access to the Active Directory domain.<br>
    <br>
We have noted that some Linux servers, domain joined, are configured with a password which never expires.<br>
This is a misconfiguration because a password change can be configured. It was however not the default on some plateform.<br>
See one of the link below for more information.</p>
<strong>Advised Solution:</strong><p class="text-justify">In order to make Active Directory enforce periodic password change, accounts must not have the "Password never expires" flag set in the "Account" tab of the user properties. Their passwords should then be rolled immediately.<br>
For services accounts, Windows provide the "managed service accounts" and "group managed service accounts" features to facilite the automatic change of passwords.<br>
Please note that there is a document in the section below which references solutions for service accounts of well known products.<br>
Also Linux servers should be configured with automatic machine account change.</p><strong>Introduced in:</strong><p class="text-justify">2.9.0.0</p><strong>Points:</strong><p>1 points if present</p>
<strong>Documentation:</strong><p><a href="https://adsecurity.org/?p=4115">https://adsecurity.org/?p=4115</a><br>
<a href="https://access.redhat.com/discussions/1283873">https://access.redhat.com/discussions/1283873</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#dont_expire">[FR]ANSSI - Accounts with never-expiring passwords (vuln2_dont_expire)</a><span class="badge grade-2">2</span><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-KerberosArmoring"><a name="anchorrulesS-KerberosArmoring"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-KerberosArmoring" aria-expanded="false" aria-controls="rulesS-KerberosArmoring">
          [T]Ensure that clients support Kerberos armoring when the domain functional level is at least Windows Server 2012 (S-KerberosArmoring)
        </button>
      </span>

    </div>

    <div id="rulesS-KerberosArmoring" class="collapse" aria-labelledby="headingrulesS-KerberosArmoring" data-parent="#rulesObjectConfig">
      <div class="card-body">
        <h3>Ensure that clients support Kerberos armoring when the domain functional level is at least Windows Server 2012</h3>
<strong>Rule ID:</strong><p class="text-justify">S-KerberosArmoring</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that clients support Kerberos armoring when domain functional level is at least Windows Server 2012</p>
<strong>Technical Explanation:</strong><p class="text-justify">Kerberos Armoring is an optimization of the Kerberos protocol. It avoids the pre-authentication steps thus prohibiting pre-authentication attacks;<br>
    It is supported only starting Windows Server 2012 DC and Windows 8 workstations.<br>
    If Kerberos armoring is requested for other operating systems (such as Windows 7 or Linux), the Kerberos authentication protocol may refuse to work.<br>
    </p>
<strong>Advised Solution:</strong><p class="text-justify">To enable Kerberos armoring for client, edit the GPO and go to Computer Configuration &gt; Administrative Templates &gt; System &gt; Kerberos<br>
    then enable the policy "Kerberos client support for claims, compound authentication and Kerberos armoring".</p><strong>Introduced in:</strong><p class="text-justify">2.11.1.0</p><strong>Points:</strong><p>Informative rule (0 point)</p>
<strong>Documentation:</strong><p><a href="https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/hh831747(v=ws.11)">https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/hh831747(v=ws.11)</a><br>
<a href="https://pupuweb.com/solved-how-enable-kerberos-armoring-eap-fast-ad/">    https://pupuweb.com/solved-how-enable-kerberos-armoring-eap-fast-ad/</a><br>
<a href="https://attack.mitre.org/techniques/T1558">[MITRE]T1558 Steal or Forge Kerberos Tickets</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-KerberosArmoringDC"><a name="anchorrulesS-KerberosArmoringDC"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-KerberosArmoringDC" aria-expanded="false" aria-controls="rulesS-KerberosArmoringDC">
          [T]Ensure that DC supports Kerberos armoring when functional level is at least Windows Server 2012 (S-KerberosArmoringDC)
        </button>
      </span>

    </div>

    <div id="rulesS-KerberosArmoringDC" class="collapse" aria-labelledby="headingrulesS-KerberosArmoringDC" data-parent="#rulesObjectConfig">
      <div class="card-body">
        <h3>Ensure that DC supports Kerberos armoring when functional level is at least Windows Server 2012</h3>
<strong>Rule ID:</strong><p class="text-justify">S-KerberosArmoringDC</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that DC supports Kerberos armoring when functional level is at least Windows Server 2012</p>
<strong>Technical Explanation:</strong><p class="text-justify">Kerberos Armoring is an optimization of the Kerberos protocol. It avoids the pre-authentication steps and thereby prevents pre-authentication attacks.<br>
    It is supported only starting Windows Server 2012 DC and Windows 8 workstations.<br>
    If Kerberos Armoring is requested for other operating systems (such as Windows 7 or Linux), the Kerberos authentication protocol may refuse to work.<br>
    </p>
<strong>Advised Solution:</strong><p class="text-justify">To enable Kerberos armoring for domain controllers, edit the GPO and go to Computer Configuration &gt; Administrative Templates &gt; System &gt; KDC<br>
    then enable the policy "KDC support for claims, compound authentication and Kerberos armoring".<br>
  The policy should be set to at least "Supported".<br>
  <br>
The safest settings is "Fail authentication requests when Kerberos armoring is not available" but it should be enabled only if the clients support Kerberos armoring.</p><strong>Introduced in:</strong><p class="text-justify">2.11.1.0</p><strong>Points:</strong><p>Informative rule (0 point)</p>
<strong>Documentation:</strong><p><a href="https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/hh831747(v=ws.11)">https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/hh831747(v=ws.11)</a><br>
<a href="https://pupuweb.com/solved-how-enable-kerberos-armoring-eap-fast-ad/">    https://pupuweb.com/solved-how-enable-kerberos-armoring-eap-fast-ad/</a><br>
<a href="https://attack.mitre.org/techniques/T1558">[MITRE]T1558 Steal or Forge Kerberos Tickets</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-JavaSchema"><a name="anchorrulesS-JavaSchema"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-JavaSchema" aria-expanded="false" aria-controls="rulesS-JavaSchema">
          [M]Search for Java schema extension RFC 2713 (S-JavaSchema)
        </button>
      </span>

    </div>

    <div id="rulesS-JavaSchema" class="collapse" aria-labelledby="headingrulesS-JavaSchema" data-parent="#rulesObjectConfig">
      <div class="card-body">
        <h3>Search for Java schema extension RFC 2713</h3>
<strong>Rule ID:</strong><p class="text-justify">S-JavaSchema</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that there is no Java schema extension</p>
<strong>Technical Explanation:</strong><p class="text-justify">The Log4shell vulnerability abused the fact that log4j could load objects via a special string containing JNDI load instructions.<br>
This load instruction refers to many protocols such as CORBA, DNS, ... but also LDAP.<br>
This rule checks if the RFC 2713 schema extension, which allows the representation of Java objects in the AD, has been applied.<br>
More precisely it checks if the schema contains the Java attributes javacodebase, javafactory, javaclassname, javaremotelocation or javaserializeddata.<br>
<br>
If the attributes have been found in the schema, the program reports if one of these attributes have been found on enabled user accounts.</p>
<strong>Advised Solution:</strong><p class="text-justify">Unfortuntaly there can be legit cases to use these Java attributes, that's why this rule is set to "informative" only.<br>
The recommended way to deal with this situation, is to either make sure that no objects are using these attributes, or to set the value com.sun.jndi.ldap.object.trustURLCodebase to "false" in ALL your Java code.<br>
PingCastle is displaying the active users having these Java attributes set in the Detail section.<br>
<br>
If you want to disable the Java extension you can proceed by setting each Java attributes to defunct.<br>
See the following procedure on how to disable existing schema attributes: https://docs.microsoft.com/en-us/windows/win32/ad/disabling-existing-classes-and-attributes<br>
</p><strong>Introduced in:</strong><p class="text-justify">2.10.1.0</p><strong>Points:</strong><p>Informative rule (0 point)</p>
<strong>Documentation:</strong><p><a href="https://www.pingcastle.com/PingCastleFiles/ad_hc_rules_list.html"></a><br>
<a href="https://www.blackhat.com/docs/us-16/materials/us-16-Munoz-A-Journey-From-JNDI-LDAP-Manipulation-To-RCE.pdf">https://www.blackhat.com/docs/us-16/materials/us-16-Munoz-A-Journey-From-JNDI-LDAP-Manipulation-To-RCE.pdf</a><br>
<a href="https://datatracker.ietf.org/doc/html/rfc2713">https://datatracker.ietf.org/doc/html/rfc2713</a><br>
<a href="https://docs.oracle.com/cd/E19424-01/820-4813/6ng8jv82s/index.html">https://docs.oracle.com/cd/E19424-01/820-4813/6ng8jv82s/index.html</a><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-SIDHistory"><a name="anchorrulesS-SIDHistory"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-SIDHistory" aria-expanded="false" aria-controls="rulesS-SIDHistory">
          [M][T]SIDHistory check (S-SIDHistory)
        </button>
      </span>

    </div>

    <div id="rulesS-SIDHistory" class="collapse" aria-labelledby="headingrulesS-SIDHistory" data-parent="#rulesObjectConfig">
      <div class="card-body">
        <h3>SIDHistory check</h3>
<strong>Rule ID:</strong><p class="text-justify">S-SIDHistory</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that a migration has been completed correctly and that the SIDHistory attribute has been cleared out from user and computer accounts. This attribute is indeed set when migrating a user or a computer from one domain to another</p>
<strong>Technical Explanation:</strong><p class="text-justify">The SIDHistory attribute is useful when doing a migration because it allows to keep the reference to the former account. On the other hand, once the migration is over, it is mandatory that this attribute is removed to evaluate the permissions in regards with the new account and not the former one.</p>
<strong>Advised Solution:</strong><p class="text-justify">To solve the security issue, you should remove all the SIDHistory attributes. To do so, you can list the objects having a SIDHistory attribute using the command: <i>get-ADObject -ldapfilter "(sidhistory=*)" -properties sidhistory</i>. <br>
Each security descriptor of the domain, including file shares for example, should be reviewed to be rewritten with the new SID of the account. Then, the attribute can be removed of these accounts using the migration tool or a PowerShell snippet <i>Remove-SIDHistory</i> once the migration is completed.<br>
<br>
Please note that once the SID History has been removed, it cannot be added back again without doing a real migration. Possibly hacking tools such as mimikatz could be used to undo a deletion with for example the lsadump::dcshadow attack.<br>
<br>
To remove the SIDHistory from a user account, run:<br>
<i>Get-ADUser USERNAME -properties sidhistory | foreach {Set-ADUser $_ -remove @{sidhistory=$_.sidhistory.value}}</i><br>
For a group, run:<br>
<i>Get-ADGroup GROUPNAME -properties sidhistory | foreach {Set-ADGroup $_ -remove @{sidhistory=$_.sidhistory.value}}</i><br>
For all users in a OU:<br>
<i>Get-ADUser -SearchBase "OU=Accounts,DC=mydomain,DC=com" -Filter {sidhistory -like '*'} -properties sidhistory | foreach {Set-ADUser $_ -remove @{sidhistory=$_.sidhistory.value}}</i><br>
</p><strong>Points:</strong><p>5 points per discovery with a minimal of 15 points</p>
<strong>Documentation:</strong><p><a href="https://www.ssi.gouv.fr/uploads/IMG/pdf/NP_ActiveDirectory_NoteTech.pdf#paragraph.3.3.1.5">[FR]ANSSI - Recommandations de sécurité relatives à Active Directory - R15 [paragraph.3.3.1.5]</a><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a><br>
<a href="https://attack.mitre.org/techniques/T1134/005">[MITRE]T1134.005 Access Token Manipulation: SID-History Injection</a></p>
    </div>
  </div></div></div>
			<!-- Accordion rulesObjectConfig end -->

		<div class="row"><div class="col-lg-12 mt-3">
		<h3>Obsolete OS
		</h3>

		<div class="row"><div class="col-lg-12">
		<p>Operating systems have a life-cycle where its manufacturer provides patches. If the operating system is not supported anymore, vulnerabilities are not fixed anymore.
		</p>

		<!-- Accordion rulesObsoleteOS -->
<div id="rulesObsoleteOS">
<div class="card">
    
    <div class="card-header" id="headingrulesS-FunctionalLevel1"><a name="anchorrulesS-FunctionalLevel1"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-FunctionalLevel1" aria-expanded="false" aria-controls="rulesS-FunctionalLevel1">
          [M]Ensure that the functional level of the domain and the forest are up to date to use the latest security features (S-FunctionalLevel1)
        </button>
      </span>

    </div>

    <div id="rulesS-FunctionalLevel1" class="collapse" aria-labelledby="headingrulesS-FunctionalLevel1" data-parent="#rulesObsoleteOS">
      <div class="card-body">
        <h3>Ensure that the functional level of the domain and the forest are up to date to use the latest security features</h3>
<strong>Rule ID:</strong><p class="text-justify">S-FunctionalLevel1</p>
<strong>Description:</strong><p class="text-justify">The purpose is checking the functional level of the domain and the forest, and ensure it is set to the latest secure version</p>
<strong>Technical Explanation:</strong><p class="text-justify"><br>
Each functional level brings new security features:<br>
*  functional level Windows Server 2003: brings forest trusts and read-only domain controller (RODC) support;<br>
*  functional level Windows Server 2008: brings support for modern cryptographic algorithms such as AES and DFS for SYSVOL shared replication;<br>
*  functional level Windows Server 2008R2: brings support for Active Directory Recycle Bin (protects objects against accidental deletion);<br>
*  functional level Windows Server 2012: brings advanced Kerberos features, such as compound authentication and claims support;<br>
*  functional level Windows Server 2012R2: brings numerous new security features such as authentication policies, authentication policy silos and the Protected users group;<br>
*  functional level Windows Server 2016 / 2019 / 2022: brings an upgraded smart card logon security and Privileged Identity Management (PIM) trust relationships between forests.<br>
    </p>
<strong>Advised Solution:</strong><p class="text-justify">You have to raise the functional level of the domain or the forest (see the details to know if the domain and/or forest is concerned).<br>
    The recommended level is the functional level 7 (Windows Server 2016 / 2019 / 2022)<br>
    <br>
    To upgrade the functional level, a requirement is that all domain controllers are running the right version.<br>
    Also, functional level needs to be upgraded level by level.<br>
    </p><strong>Introduced in:</strong><p class="text-justify">2.11.2.0</p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/active-directory-functional-levels">https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/active-directory-functional-levels</a><br>
<a href="https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/plan/identifying-your-functional-level-upgrade">https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/plan/identifying-your-functional-level-upgrade</a><br>
<a href="https://learn.microsoft.com/en-us/troubleshoot/windows-server/identity/raise-active-directory-domain-forest-functional-levels">https://learn.microsoft.com/en-us/troubleshoot/windows-server/identity/raise-active-directory-domain-forest-functional-levels</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#vuln_functional_level">[FR]ANSSI - Insufficient forest and domains functional levels (vuln1_vuln_functional_level)</a><span class="badge grade-1">1</span><br>
<a href="https://attack.mitre.org/mitigations/M1051">[MITRE]Mitre Att&amp;ck - Mitigation - Update Software</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-FunctionalLevel3"><a name="anchorrulesS-FunctionalLevel3"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-FunctionalLevel3" aria-expanded="false" aria-controls="rulesS-FunctionalLevel3">
          [M]Ensure that the functional level of the domain and the forest are up to date to use the latest security features (S-FunctionalLevel3)
        </button>
      </span>

    </div>

    <div id="rulesS-FunctionalLevel3" class="collapse" aria-labelledby="headingrulesS-FunctionalLevel3" data-parent="#rulesObsoleteOS">
      <div class="card-body">
        <h3>Ensure that the functional level of the domain and the forest are up to date to use the latest security features</h3>
<strong>Rule ID:</strong><p class="text-justify">S-FunctionalLevel3</p>
<strong>Description:</strong><p class="text-justify">The purpose is checking the functional level of the domain and the forest, and ensure it is set to the latest secure version</p>
<strong>Technical Explanation:</strong><p class="text-justify"><br>
Each functional level brings new security features:<br>
*  functional level Windows Server 2003: brings forest trusts and read-only domain controller (RODC) support;<br>
*  functional level Windows Server 2008: brings support for modern cryptographic algorithms such as AES and DFS for SYSVOL share replication;<br>
*  functional level Windows Server 2008R2: brings support for Active Directory Recycle Bin (protects objects against accidental deletion);<br>
*  functional level Windows Server 2012: brings advanced Kerberos features, such as compound authentication and claims support;<br>
*  functional level Windows Server 2012R2: brings numerous new security features such as authentication policies, authentication policy silos and the Protected users group;<br>
*  functional level Windows Server 2016 / 2019 / 2022: brings an upgraded smart card logon security and Privileged Identity Management (PIM) trust relationships between forests.<br>
    </p>
<strong>Advised Solution:</strong><p class="text-justify">You have to raise the functional level of the domain or the forest (see the details to know if the domain and/or forest is concerned).<br>
    The recommended level is the functional level 7 (Windows Server 2016 / 2019 / 2022)<br>
    <br>
    To upgrade the functional level, a requirement is that all domain controllers are running the right version.<br>
    Also, functional level needs to be upgraded level by level.<br>
    </p><strong>Introduced in:</strong><p class="text-justify">2.11.2.0</p><strong>Points:</strong><p>Informative rule (0 point)</p>
<strong>Documentation:</strong><p><a href="https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/active-directory-functional-levels">https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/active-directory-functional-levels</a><br>
<a href="https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/plan/identifying-your-functional-level-upgrade">https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/plan/identifying-your-functional-level-upgrade</a><br>
<a href="https://learn.microsoft.com/en-us/troubleshoot/windows-server/identity/raise-active-directory-domain-forest-functional-levels">https://learn.microsoft.com/en-us/troubleshoot/windows-server/identity/raise-active-directory-domain-forest-functional-levels</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#vuln_functional_level">[FR]ANSSI - Insufficient forest and domains functional levels (vuln3_vuln_functional_level)</a><span class="badge grade-3">3</span><br>
<a href="https://attack.mitre.org/mitigations/M1051">[MITRE]Mitre Att&amp;ck - Mitigation - Update Software</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-FunctionalLevel4"><a name="anchorrulesS-FunctionalLevel4"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-FunctionalLevel4" aria-expanded="false" aria-controls="rulesS-FunctionalLevel4">
          [M]Ensure that the functional level of the domain and the forest are up to date to use the latest security features (S-FunctionalLevel4)
        </button>
      </span>

    </div>

    <div id="rulesS-FunctionalLevel4" class="collapse" aria-labelledby="headingrulesS-FunctionalLevel4" data-parent="#rulesObsoleteOS">
      <div class="card-body">
        <h3>Ensure that the functional level of the domain and the forest are up to date to use the latest security features</h3>
<strong>Rule ID:</strong><p class="text-justify">S-FunctionalLevel4</p>
<strong>Description:</strong><p class="text-justify">The purpose is checking the functional level of the domain and the forest, and ensure it is set to the latest secure version</p>
<strong>Technical Explanation:</strong><p class="text-justify"><br>
Each functional level brings new security features:<br>
*  functional level Windows Server 2003: brings forest trusts and read-only domain controller (RODC) support;<br>
*  functional level Windows Server 2008: brings support for modern cryptographic algorithms such as AES and DFS for SYSVOL share replication;<br>
*  functional level Windows Server 2008R2: brings support for Active Directory Recycle Bin (protects objects against accidental deletion);<br>
*  functional level Windows Server 2012: brings advanced Kerberos features, such as compound authentication and claims support;<br>
*  functional level Windows Server 2012R2: brings numerous new security features such as authentication policies, authentication policy silos and the Protected users group;<br>
*  functional level Windows Server 2016 / 2019 / 2022: brings an upgraded smart card logon security and Privileged Identity Management (PIM) trust relationships between forests.<br>
    </p>
<strong>Advised Solution:</strong><p class="text-justify">You have to raise the functional level of the domain or the forest (see the details to know if the domain and/or forest is concerned).<br>
    The recommended level is the functional level 7 (Windows Server 2016 / 2019 / 2022)<br>
    <br>
    To upgrade the functional level, a requirement is that all domain controllers are running the right version.<br>
    Also, functional level needs to be upgraded level by level.<br>
    </p><strong>Introduced in:</strong><p class="text-justify">2.11.2.0</p><strong>Points:</strong><p>Informative rule (0 point)</p>
<strong>Documentation:</strong><p><a href="https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/active-directory-functional-levels">https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/active-directory-functional-levels</a><br>
<a href="https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/plan/identifying-your-functional-level-upgrade">https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/plan/identifying-your-functional-level-upgrade</a><br>
<a href="https://learn.microsoft.com/en-us/troubleshoot/windows-server/identity/raise-active-directory-domain-forest-functional-levels">https://learn.microsoft.com/en-us/troubleshoot/windows-server/identity/raise-active-directory-domain-forest-functional-levels</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#vuln_functional_level">[FR]ANSSI - Insufficient forest and domains functional levels (vuln3_vuln_functional_level)</a><span class="badge grade-3">3</span><br>
<a href="https://attack.mitre.org/mitigations/M1051">[MITRE]Mitre Att&amp;ck - Mitigation - Update Software</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-DC-2000"><a name="anchorrulesS-DC-2000"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-DC-2000" aria-expanded="false" aria-controls="rulesS-DC-2000">
          [M]Obsolete Domain Controller (Windows 2000) (S-DC-2000)
        </button>
      </span>

    </div>

    <div id="rulesS-DC-2000" class="collapse" aria-labelledby="headingrulesS-DC-2000" data-parent="#rulesObsoleteOS">
      <div class="card-body">
        <h3>Obsolete Domain Controller (Windows 2000)</h3>
<strong>Rule ID:</strong><p class="text-justify">S-DC-2000</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that there is no use of the obsolete and vulnerable OS Windows 2000 as Domain Controller within the domain</p>
<strong>Technical Explanation:</strong><p class="text-justify">The OS Windows 2000 as a DC is vulnerable to many publicly known exploits such as MS17-010 or MS14-068 and it can no longer be patched. A domain running this OS version should be considered compromised</p>
<strong>Advised Solution:</strong><p class="text-justify">To resolve this security risk, the only way is to decommission DC running Windows 2000 OS, in order to use new versions that are more secured and that are still being patched regarding new security threats</p><strong>Points:</strong><p>40 points if present</p>
<strong>Documentation:</strong><p><a href="https://www.stigviewer.com/stig/active_directory_domain/2017-12-15/finding/V-8551">[US]STIG V-8551 - The domain functional level must be at a Windows Server version still supported by Microsoft.</a><br>
<a href="https://www.ssi.gouv.fr/uploads/IMG/pdf/NP_ActiveDirectory_NoteTech.pdf#subsection.3.1">[FR]ANSSI - Recommandations de sécurité relatives à Active Directory - R12 [subsection.3.1]</a><br>
<a href="https://attack.mitre.org/mitigations/M1051">[MITRE]Mitre Att&amp;ck - Mitigation - Update Software</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-DC-2003"><a name="anchorrulesS-DC-2003"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-DC-2003" aria-expanded="false" aria-controls="rulesS-DC-2003">
          [M]Obsolete Domain Controller (Windows Server 2003) (S-DC-2003)
        </button>
      </span>

    </div>

    <div id="rulesS-DC-2003" class="collapse" aria-labelledby="headingrulesS-DC-2003" data-parent="#rulesObsoleteOS">
      <div class="card-body">
        <h3>Obsolete Domain Controller (Windows Server 2003)</h3>
<strong>Rule ID:</strong><p class="text-justify">S-DC-2003</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that there is no use of the obsolete and vulnerable OS Windows Server 2003 as Domain Controller within the domain</p>
<strong>Technical Explanation:</strong><p class="text-justify">The OS Windows Server 2003 as a DC is vulnerable to many publicly known exploits such as MS14-068 and it is very complicated to patch it at this date. A domain running this OS version should be considered compromised</p>
<strong>Advised Solution:</strong><p class="text-justify">To resolve this security risk, the only way is to decommission DC running Windows Server 2003 OS, in order to use new versions that are more secured and that are still being patched regarding new security threats</p><strong>Points:</strong><p>20 points if present</p>
<strong>Documentation:</strong><p><a href="https://www.stigviewer.com/stig/active_directory_domain/2017-12-15/finding/V-8551">[US]STIG V-8551 - The domain functional level must be at a Windows Server version still supported by Microsoft.</a><br>
<a href="https://www.ssi.gouv.fr/uploads/IMG/pdf/NP_ActiveDirectory_NoteTech.pdf#subsection.3.1">[FR]ANSSI - Recommandations de sécurité relatives à Active Directory - R12 [subsection.3.1]</a><br>
<a href="https://attack.mitre.org/mitigations/M1051">[MITRE]Mitre Att&amp;ck - Mitigation - Update Software</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-DC-2008"><a name="anchorrulesS-DC-2008"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-DC-2008" aria-expanded="false" aria-controls="rulesS-DC-2008">
          [M]Obsolete Domain Controller (Windows Server 2008) (S-DC-2008)
        </button>
      </span>

    </div>

    <div id="rulesS-DC-2008" class="collapse" aria-labelledby="headingrulesS-DC-2008" data-parent="#rulesObsoleteOS">
      <div class="card-body">
        <h3>Obsolete Domain Controller (Windows Server 2008)</h3>
<strong>Rule ID:</strong><p class="text-justify">S-DC-2008</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that there is no use of the obsolete and vulnerable OS Windows Server 2008 as Domain Controller within the domain</p>
<strong>Technical Explanation:</strong><p class="text-justify">The OS Windows Server 2008 is not supported anymore by Microsoft (except when migrated to Azure, until January 9, 2024) and any vulnerability found will not be patched.</p>
<strong>Advised Solution:</strong><p class="text-justify">To resolve this security risk, the only way is to decommission DCs running Windows Server 2008 OS, in order to use new versions that are more secure and that are still being patched regarding new security threats</p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://support.microsoft.com/en-us/help/4456235/end-of-support-for-windows-server-2008-and-windows-server-2008-r2">https://support.microsoft.com/en-us/help/4456235/end-of-support-for-windows-server-2008-and-windows-server-2008-r2</a><br>
<a href="https://www.stigviewer.com/stig/active_directory_domain/2017-12-15/finding/V-8551">[US]STIG V-8551 - The domain functional level must be at a Windows Server version still supported by Microsoft.</a><br>
<a href="https://www.ssi.gouv.fr/uploads/IMG/pdf/NP_ActiveDirectory_NoteTech.pdf#subsection.3.1">[FR]ANSSI - Recommandations de sécurité relatives à Active Directory - R12 [subsection.3.1]</a><br>
<a href="https://attack.mitre.org/mitigations/M1051">[MITRE]Mitre Att&amp;ck - Mitigation - Update Software</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-OS-W10"><a name="anchorrulesS-OS-W10"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-OS-W10" aria-expanded="false" aria-controls="rulesS-OS-W10">
          [M]Obsolete OS (Windows 10 or Windows 11) (S-OS-W10)
        </button>
      </span>

    </div>

    <div id="rulesS-OS-W10" class="collapse" aria-labelledby="headingrulesS-OS-W10" data-parent="#rulesObsoleteOS">
      <div class="card-body">
        <h3>Obsolete OS (Windows 10 or Windows 11)</h3>
<strong>Rule ID:</strong><p class="text-justify">S-OS-W10</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that there is no use of non-supported version of Windows 10 or Windows 11 within the domain</p>
<strong>Technical Explanation:</strong><p class="text-justify">Some versions of Windows 10 and Windows 11 OS are no longer supported, and may be vulnerable to exploits that are not patched anymore.</p>
<strong>Advised Solution:</strong><p class="text-justify">In order to solve this security issue, you should upgrade all the Windows 10 or Windows 11 to a more recent version.    <br>
    <i><strong>Use PingCastle.exe and select export on the main menu. Then choose to export computers. PingCastle will produce a list of all your computers with the OS version in a csv file. You can then use Excel to filter them.</strong></i>    <br>
    Do note that you can get the full details regarding the OS used with the following PowerShell command: <i>Get-ADComputer -Filter * -Property * | Format-Table Name,OperatingSystem,OperatingSystemServicePack,OperatingSystemVersion -Wrap -Auto </i><br>
	You can replace <i>-Filter *</i> with <i>-Filter {OperatingSystem -Like "Windows 1*"}</i><br>
    </p><strong>Introduced in:</strong><p class="text-justify">2.9.3.0</p><strong>Points:</strong><p>15 points if the occurence is greater than or equals than 15<br>
then 10 points if the occurence is greater than or equals than 6<br>
then 5 points if present</p>
<strong>Documentation:</strong><p><a href="https://docs.microsoft.com/en-us/windows/release-health/release-information">https://docs.microsoft.com/en-us/windows/release-health/release-information</a><br>
<a href="https://www.cert.ssi.gouv.fr/information/CERTFR-2005-INF-003/#SECTION00032400000000000000">[FR]ANSSI CERTFR-2005-INF-003</a><br>
<a href="https://attack.mitre.org/mitigations/M1051">[MITRE]Mitre Att&amp;ck - Mitigation - Update Software</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-OS-2000"><a name="anchorrulesS-OS-2000"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-OS-2000" aria-expanded="false" aria-controls="rulesS-OS-2000">
          [M]Obsolete OS (Windows 2000) (S-OS-2000)
        </button>
      </span>

    </div>

    <div id="rulesS-OS-2000" class="collapse" aria-labelledby="headingrulesS-OS-2000" data-parent="#rulesObsoleteOS">
      <div class="card-body">
        <h3>Obsolete OS (Windows 2000)</h3>
<strong>Rule ID:</strong><p class="text-justify">S-OS-2000</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that there is no use of the obsolete and vulnerable OS Windows 2000 for the workstations within the domain</p>
<strong>Technical Explanation:</strong><p class="text-justify">The Windows 2000 OS is no longer supported, as it is vulnerable to many publicly known exploits: Administrator's credentials can be captured, security protocols are weak, etc.</p>
<strong>Advised Solution:</strong><p class="text-justify">In order to solve this security issue, you should upgrade all the workstations to a more recent version of Windows, starting from Windows 10. <br>
    <i><strong>Use PingCastle.exe and select export on the main menu. Then choose to export computers. PingCastle will produce a list of all your computers with the OS version in a csv file. You can then use Excel to filter them.</strong></i><br>
    Do note that you can get the full details regarding the OS used with the following PowerShell command: <i>Get-ADComputer -Filter { operatingsystem -like "*Server 2000*" } -Property * | Format-Table Name,OperatingSystem,OperatingSystemServicePack,OperatingSystemVersion -Wrap -Auto</i></p><strong>Points:</strong><p>40 points if present</p>
<strong>Documentation:</strong><p><a href="https://www.cert.ssi.gouv.fr/information/CERTFR-2005-INF-003/#SECTION00032400000000000000">[FR]ANSSI CERTFR-2005-INF-003</a><br>
<a href="https://attack.mitre.org/mitigations/M1051">[MITRE]Mitre Att&amp;ck - Mitigation - Update Software</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-OS-Win7"><a name="anchorrulesS-OS-Win7"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-OS-Win7" aria-expanded="false" aria-controls="rulesS-OS-Win7">
          [M]Obsolete OS (Windows 7) (S-OS-Win7)
        </button>
      </span>

    </div>

    <div id="rulesS-OS-Win7" class="collapse" aria-labelledby="headingrulesS-OS-Win7" data-parent="#rulesObsoleteOS">
      <div class="card-body">
        <h3>Obsolete OS (Windows 7)</h3>
<strong>Rule ID:</strong><p class="text-justify">S-OS-Win7</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that there is no use of the obsolete and vulnerable OS Windows 7 for the workstations within the domain</p>
<strong>Technical Explanation:</strong><p class="text-justify">The Windows 7 OS is no longer supported, as it is vulnerable to many publicly known exploits: Administrator's credentials can be captured, security protocols are weak, etc.<br>
PingCastle is trying to guess if Extended Security Support (ESU) has been purchased from Microsoft. Based on the documentation referenced below, the program checks if the script Activate-ProductOnline.ps1 is present.<br>
If the script is detected, Windows 7 is considered as supported and this rule is not triggered.</p>
<strong>Advised Solution:</strong><p class="text-justify">In order to solve this security issue, you should upgrade all the workstations to a more recent version of Windows, starting from Windows 10. <br>
    <i><strong>Use PingCastle.exe and select export on the main menu. Then choose to export computers. PingCastle will produce a list of all your computers with the OS version in a csv file. You can then use Excel to filter them.</strong></i><br>
    Do note that you can get the full details regarding the OS used with the following PowerShell command: <i>Get-ADComputer -Filter * -Property * | Format-Table Name,OperatingSystem,OperatingSystemServicePack,OperatingSystemVersion -Wrap -Auto </i><br>
	You can replace <i>-Filter *</i> with <i>-Filter {OperatingSystem -Like "Windows Server*"}</i></p><strong>Introduced in:</strong><p class="text-justify">2.9.0.0</p><strong>Points:</strong><p>5 points if the occurence is greater than or equals than 15<br>
then 2 points if the occurence is greater than or equals than 6<br>
then 1 points if present</p>
<strong>Documentation:</strong><p><a href="https://techcommunity.microsoft.com/t5/windows-it-pro-blog/activate-windows-7-esus-on-multiple-devices-with-a-mak/ba-p/1167196">https://techcommunity.microsoft.com/t5/windows-it-pro-blog/activate-windows-7-esus-on-multiple-devices-with-a-mak/ba-p/1167196</a><br>
<a href="https://www.cert.ssi.gouv.fr/information/CERTFR-2005-INF-003/#SECTION00032400000000000000">[FR]ANSSI CERTFR-2005-INF-003</a><br>
<a href="https://attack.mitre.org/mitigations/M1051">[MITRE]Mitre Att&amp;ck - Mitigation - Update Software</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-OS-Win8"><a name="anchorrulesS-OS-Win8"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-OS-Win8" aria-expanded="false" aria-controls="rulesS-OS-Win8">
          [M]Obsolete OS (Windows 8) (S-OS-Win8)
        </button>
      </span>

    </div>

    <div id="rulesS-OS-Win8" class="collapse" aria-labelledby="headingrulesS-OS-Win8" data-parent="#rulesObsoleteOS">
      <div class="card-body">
        <h3>Obsolete OS (Windows 8)</h3>
<strong>Rule ID:</strong><p class="text-justify">S-OS-Win8</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that there is no use of the obsolete and vulnerable OS Windows 8 for the workstations within the domain</p>
<strong>Technical Explanation:</strong><p class="text-justify">The Windows 8 OS is no longer supported, as it is vulnerable to many publicly known exploits: Administrator's credentials can be captured, security protocols are weak, etc.</p>
<strong>Advised Solution:</strong><p class="text-justify">In order to solve this security issue, you should upgrade all the workstations to a more recent version of Windows, starting from Windows 10.     <br>
    <i><strong>Use PingCastle.exe and select export on the main menu. Then choose to export computers. PingCastle will produce a list of all your computers with the OS version in a csv file. You can then use Excel to filter them.</strong></i>        <br>
    Do note that you can get the full details regarding the OS used with the following PowerShell command: <i>Get-ADComputer -Filter * -Property * | Format-Table Name,OperatingSystem,OperatingSystemServicePack,OperatingSystemVersion -Wrap -Auto </i><br>
	You can replace <i>-Filter *</i> with <i>-Filter {OperatingSystem -Like "Windows Server*"}</i></p><strong>Introduced in:</strong><p class="text-justify">2.10.1.0</p><strong>Points:</strong><p>5 points if the occurence is greater than or equals than 15<br>
then 2 points if the occurence is greater than or equals than 6<br>
then 1 points if present</p>
<strong>Documentation:</strong><p><a href="https://www.cert.ssi.gouv.fr/information/CERTFR-2005-INF-003/#SECTION00032400000000000000">[FR]ANSSI CERTFR-2005-INF-003</a><br>
<a href="https://attack.mitre.org/mitigations/M1051">[MITRE]Mitre Att&amp;ck - Mitigation - Update Software</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-OS-NT"><a name="anchorrulesS-OS-NT"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-OS-NT" aria-expanded="false" aria-controls="rulesS-OS-NT">
          [M]Obsolete OS (Windows NT) (S-OS-NT)
        </button>
      </span>

    </div>

    <div id="rulesS-OS-NT" class="collapse" aria-labelledby="headingrulesS-OS-NT" data-parent="#rulesObsoleteOS">
      <div class="card-body">
        <h3>Obsolete OS (Windows NT)</h3>
<strong>Rule ID:</strong><p class="text-justify">S-OS-NT</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that there is no use of the obsolete and vulnerable OS Windows NT for the workstations within the domain</p>
<strong>Technical Explanation:</strong><p class="text-justify">The Windows NT OS is no longer supported, as it is vulnerable to many publicly known exploits: Administrator's credentials can be captured, security protocols are weak, etc.<br>
</p>
<strong>Advised Solution:</strong><p class="text-justify">In order to solve this security issue, you should upgrade all the workstations to a more recent version of Windows, starting from Windows 10. <br>
    <i><strong>Use PingCastle.exe and select export on the main menu. Then choose to export computers. PingCastle will produce a list of all your computers with the OS version in a csv file. You can then use Excel to filter them.</strong></i><br>
    Do note that you can get the full details regarding the OS used with the following PowerShell command: <i>Get-ADComputer -Filter { operatingsystem -like "* NT *" } -Property * | Format-Table Name,OperatingSystem,OperatingSystemServicePack,OperatingSystemVersion -Wrap -Auto</i></p><strong>Points:</strong><p>60 points if present</p>
<strong>Documentation:</strong><p><a href="https://www.cert.ssi.gouv.fr/information/CERTFR-2005-INF-003/#SECTION00032400000000000000">[FR]ANSSI CERTFR-2005-INF-003</a><br>
<a href="https://attack.mitre.org/mitigations/M1051">[MITRE]Mitre Att&amp;ck - Mitigation - Update Software</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-OS-2003"><a name="anchorrulesS-OS-2003"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-OS-2003" aria-expanded="false" aria-controls="rulesS-OS-2003">
          [M]Obsolete OS (Windows Server 2003) (S-OS-2003)
        </button>
      </span>

    </div>

    <div id="rulesS-OS-2003" class="collapse" aria-labelledby="headingrulesS-OS-2003" data-parent="#rulesObsoleteOS">
      <div class="card-body">
        <h3>Obsolete OS (Windows Server 2003)</h3>
<strong>Rule ID:</strong><p class="text-justify">S-OS-2003</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that there is no use of the obsolete and vulnerable OS Windows Server 2003 for the workstations within the domain</p>
<strong>Technical Explanation:</strong><p class="text-justify">The Windows Server 2003 OS is no longer supported, as it is vulnerable to many publicly known exploits: Administrator's credentials can be captured, security protocols are weak, etc.</p>
<strong>Advised Solution:</strong><p class="text-justify">In order to solve this security issue, you should upgrade all the workstations to a more recent version of Windows, starting from Windows 10.   <br>
    <i><strong>Use PingCastle.exe and select export on the main menu. Then choose to export computers. PingCastle will produce a list of all your computers with the OS version in a csv file. You can then use Excel to filter them.</strong></i><br>
    Do note that you can get the full details regarding the OS used with the following PowerShell command: <i>Get-ADComputer -Filter { operatingsystem -like "*Server 2003*" } -Property * | Format-Table Name,OperatingSystem,OperatingSystemServicePack,OperatingSystemVersion -Wrap -Auto</i></p><strong>Points:</strong><p>30 points if the occurence is greater than or equals than 15<br>
then 25 points if the occurence is greater than or equals than 6<br>
then 20 points if present</p>
<strong>Documentation:</strong><p><a href="https://www.cert.ssi.gouv.fr/information/CERTFR-2005-INF-003/#SECTION00032400000000000000">[FR]ANSSI CERTFR-2005-INF-003</a><br>
<a href="https://attack.mitre.org/mitigations/M1051">[MITRE]Mitre Att&amp;ck - Mitigation - Update Software</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-OS-2008"><a name="anchorrulesS-OS-2008"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-OS-2008" aria-expanded="false" aria-controls="rulesS-OS-2008">
          [M]Obsolete OS (Windows Server 2008) (S-OS-2008)
        </button>
      </span>

    </div>

    <div id="rulesS-OS-2008" class="collapse" aria-labelledby="headingrulesS-OS-2008" data-parent="#rulesObsoleteOS">
      <div class="card-body">
        <h3>Obsolete OS (Windows Server 2008)</h3>
<strong>Rule ID:</strong><p class="text-justify">S-OS-2008</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that there is no use of the obsolete and vulnerable OS Windows Server 2008 for the workstations within the domain</p>
<strong>Technical Explanation:</strong><p class="text-justify">The Windows Server 2008 OS is no longer supported, as it is vulnerable to many publicly known exploits: Administrator's credentials can be captured, security protocols are weak, etc.</p>
<strong>Advised Solution:</strong><p class="text-justify">In order to solve this security issue, you should upgrade all the servers to a more recent version of Windows, starting from Windows Server 2012. <br>
    <i><strong>Use PingCastle.exe and select export on the main menu. Then choose to export computers. PingCastle will produce a list of all your computers with the OS version in a csv file. You can then use Excel to filter them.</strong></i><br>
    Do note that you can get the full details regarding the OS used with the following PowerShell command: <i>Get-ADComputer -Filter * -Property * | Format-Table Name,OperatingSystem,OperatingSystemServicePack,OperatingSystemVersion -Wrap -Auto</i><br>
    You can replace <i>-Filter *</i> with <i>-Filter {OperatingSystem -Like "Windows Server*"}</i></p><strong>Points:</strong><p>15 points if the occurence is greater than or equals than 15<br>
then 10 points if the occurence is greater than or equals than 6<br>
then 5 points if present</p>
<strong>Documentation:</strong><p><a href="https://support.microsoft.com/en-us/help/4456235/end-of-support-for-windows-server-2008-and-windows-server-2008-r2">https://support.microsoft.com/en-us/help/4456235/end-of-support-for-windows-server-2008-and-windows-server-2008-r2</a><br>
<a href="https://www.cert.ssi.gouv.fr/information/CERTFR-2005-INF-003/#SECTION00032400000000000000">[FR]ANSSI CERTFR-2005-INF-003</a><br>
<a href="https://attack.mitre.org/mitigations/M1051">[MITRE]Mitre Att&amp;ck - Mitigation - Update Software</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-OS-Vista"><a name="anchorrulesS-OS-Vista"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-OS-Vista" aria-expanded="false" aria-controls="rulesS-OS-Vista">
          [M]Obsolete OS (Windows Vista) (S-OS-Vista)
        </button>
      </span>

    </div>

    <div id="rulesS-OS-Vista" class="collapse" aria-labelledby="headingrulesS-OS-Vista" data-parent="#rulesObsoleteOS">
      <div class="card-body">
        <h3>Obsolete OS (Windows Vista)</h3>
<strong>Rule ID:</strong><p class="text-justify">S-OS-Vista</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that there is no use of the obsolete and vulnerable OS Windows Vista for the workstations within the domain</p>
<strong>Technical Explanation:</strong><p class="text-justify">The Windows Vista OS is no longer supported, as it is vulnerable to many publicly known exploits: Administrator's credentials can be captured, security protocols are weak, etc.</p>
<strong>Advised Solution:</strong><p class="text-justify">In order to solve this security issue, you should upgrade all the workstations to a more recent version of Windows, starting from Windows 10. <br>
    <i><strong>Use PingCastle.exe and select export on the main menu. Then choose to export computers. PingCastle will produce a list of all your computers with the OS version in a csv file. You can then use Excel to filter them.</strong></i><br>
    Do note that you can get the full details regarding the OS used with the following PowerShell command: <i>Get-ADComputer -Filter * -Property * | Format-Table Name,OperatingSystem,OperatingSystemServicePack,OperatingSystemVersion -Wrap -Auto</i><br>
    You can replace <i>-Filter *</i> with <i>-Filter {OperatingSystem -Like "Windows Server*"}</i></p><strong>Introduced in:</strong><p class="text-justify">2.8.0.0</p><strong>Points:</strong><p>20 points if the occurence is greater than or equals than 15<br>
then 15 points if the occurence is greater than or equals than 6<br>
then 10 points if present</p>
<strong>Documentation:</strong><p><a href="https://www.cert.ssi.gouv.fr/information/CERTFR-2005-INF-003/#SECTION00032400000000000000">[FR]ANSSI CERTFR-2005-INF-003</a><br>
<a href="https://attack.mitre.org/mitigations/M1051">[MITRE]Mitre Att&amp;ck - Mitigation - Update Software</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-OS-XP"><a name="anchorrulesS-OS-XP"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-OS-XP" aria-expanded="false" aria-controls="rulesS-OS-XP">
          [M]Obsolete OS (Windows XP) (S-OS-XP)
        </button>
      </span>

    </div>

    <div id="rulesS-OS-XP" class="collapse" aria-labelledby="headingrulesS-OS-XP" data-parent="#rulesObsoleteOS">
      <div class="card-body">
        <h3>Obsolete OS (Windows XP)</h3>
<strong>Rule ID:</strong><p class="text-justify">S-OS-XP</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that there is no use of the obsolete and vulnerable OS Windows XP for the workstations within the domain</p>
<strong>Technical Explanation:</strong><p class="text-justify">The Windows XP OS is no longer supported, as it is vulnerable to many publicly known exploits: Administrator's credentials can be captured, security protocols are weak, etc.</p>
<strong>Advised Solution:</strong><p class="text-justify">In order to solve this security issue, you should upgrade all the workstations to a more recent version of Windows, starting from Windows 10. <br>
    <i><strong>Use PingCastle.exe and select export on the main menu. Then choose to export computers. PingCastle will produce a list of all your computers with the OS version in a csv file. You can then use Excel to filter them.</strong></i><br>
    Do note that you can get the full details regarding the OS used with the following PowerShell command: <i>Get-ADComputer -Filter { operatingsystem -like "*Windows XP*" } -Property * | Format-Table Name,OperatingSystem,OperatingSystemServicePack,OperatingSystemVersion -Wrap -Auto</i></p><strong>Points:</strong><p>20 points if the occurence is greater than or equals than 15<br>
then 15 points if the occurence is greater than or equals than 6<br>
then 10 points if present</p>
<strong>Documentation:</strong><p><a href="https://www.cert.ssi.gouv.fr/information/CERTFR-2005-INF-003/#SECTION00032400000000000000">[FR]ANSSI CERTFR-2005-INF-003</a><br>
<a href="https://attack.mitre.org/mitigations/M1051">[MITRE]Mitre Att&amp;ck - Mitigation - Update Software</a></p>
    </div>
  </div></div></div>
			<!-- Accordion rulesObsoleteOS end -->

		<div class="row"><div class="col-lg-12 mt-3">
		<h3>Old authentication protocols
		</h3>

		<div class="row"><div class="col-lg-12">
		<p>Cryptography and computer power have evolved during the time and the oldest protocols do not provide the same level of security anymore. They can be broken and used to gain control of the domain.
		</p>

		<!-- Accordion rulesOldAuthenticationProtocols -->
<div id="rulesOldAuthenticationProtocols">
<div class="card">
    
    <div class="card-header" id="headingrulesS-DesEnabled"><a name="anchorrulesS-DesEnabled"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-DesEnabled" aria-expanded="false" aria-controls="rulesS-DesEnabled">
          [T]Check the use of Kerberos with weak encryption (DES algorithm) (S-DesEnabled)
        </button>
      </span>

    </div>

    <div id="rulesS-DesEnabled" class="collapse" aria-labelledby="headingrulesS-DesEnabled" data-parent="#rulesOldAuthenticationProtocols">
      <div class="card-body">
        <h3>Check the use of Kerberos with weak encryption (DES algorithm)</h3>
<strong>Rule ID:</strong><p class="text-justify">S-DesEnabled</p>
<strong>Description:</strong><p class="text-justify">The purpose is to verify that no weak encryption algorithm such as DES is used for accounts.</p>
<strong>Technical Explanation:</strong><p class="text-justify">DES is a very weak algorithm and once assigned to an account, it can be used in Kerberos ticket requests, even though it is easily cracked. If the attacker cracks the Kerberos ticket, they can steal the token and compromise the user account.</p>
<strong>Advised Solution:</strong><p class="text-justify">It is recommended to disable DES as an encryption algorithm in the user configuration dialog or in the "msDSSupportedEncryptionTypes" attribute at LDAP level. It has to be disabled in the property of an account by unchecking the box "Use Kerberos DES encryption for this account". You can also detect which accounts support Kerberos DES encryption by running: <i>Get-ADObject -Filter {UserAccountControl -band 0x200000 -or msDs-supportedEncryptionTypes -band 3}</i>.</p><strong>Points:</strong><p>15 points if present</p>
<strong>Documentation:</strong><p><a href="https://docs.microsoft.com/en-us/archive/blogs/openspecification/msds-supportedencryptiontypes-episode-1-computer-accounts">https://docs.microsoft.com/en-us/archive/blogs/openspecification/msds-supportedencryptiontypes-episode-1-computer-accounts</a><br>
<a href="https://docs.microsoft.com/en-us/services-hub/health/remediation-steps-ad/remove-the-highly-insecure-des-encryption-from-user-accounts">https://docs.microsoft.com/en-us/services-hub/health/remediation-steps-ad/remove-the-highly-insecure-des-encryption-from-user-accounts</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#kerberos_properties_deskey">[FR]ANSSI - Use of Kerberos with weak encryption (vuln2_kerberos_properties_deskey)</a><span class="badge grade-2">2</span><br>
<a href="https://attack.mitre.org/techniques/T1558/004">[MITRE]T1558.004 Steal or Forge Kerberos Tickets: AS-REP Roasting</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-SMB-v1"><a name="anchorrulesS-SMB-v1"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-SMB-v1" aria-expanded="false" aria-controls="rulesS-SMB-v1">
          [T]DC vulnerability (SMB v1) (S-SMB-v1)
        </button>
      </span>

    </div>

    <div id="rulesS-SMB-v1" class="collapse" aria-labelledby="headingrulesS-SMB-v1" data-parent="#rulesOldAuthenticationProtocols">
      <div class="card-body">
        <h3>DC vulnerability (SMB v1)</h3>
<strong>Rule ID:</strong><p class="text-justify">S-SMB-v1</p>
<strong>Description:</strong><p class="text-justify">The purpose is to verify if Domain Controller(s) are vulnerable to the SMB v1 vulnerability</p>
<strong>Technical Explanation:</strong><p class="text-justify">The SMB downgrade attack is used to obtain credentials or executing commands on behalf of a user by using SMB v1 as protocol. Indeed, because SMB v1 supports old authentication protocol, the integrity can be bypassed</p>
<strong>Advised Solution:</strong><p class="text-justify">It is highly recommended by Microsoft to disable SMB v1 whenever it is possible on both client and server-side. <b>Do note that if you are still not following best practices regarding the usage of deprecated OS (Windows 2000, 2003, XP, CE), regarding Network printer using SMBv1 scan2shares functionalities, or regarding software accessing Windows share with a custom implementation relying on SMB v1, you should consider fixing these issues before disabling SMB v1, as it will generate additional errors</b>.</p><strong>Points:</strong><p>10 points if present</p>
<strong>Documentation:</strong><p><a href="https://github.com/lgandx/Responder-Windows">https://github.com/lgandx/Responder-Windows</a><br>
<a href="https://blogs.technet.microsoft.com/josebda/2015/04/21/the-deprecation-of-smb1-you-should-be-planning-to-get-rid-of-this-old-smb-dialect">https://blogs.technet.microsoft.com/josebda/2015/04/21/the-deprecation-of-smb1-you-should-be-planning-to-get-rid-of-this-old-smb-dialect</a><br>
<a href="https://docs.microsoft.com/windows-server/storage/file-server/troubleshoot/detect-enable-and-disable-smbv1-v2-v3">https://docs.microsoft.com/windows-server/storage/file-server/troubleshoot/detect-enable-and-disable-smbv1-v2-v3</a><br>
<a href="https://www.cert.ssi.gouv.fr/actualite/CERTFR-2017-ACT-019/#SECTION00010000000000000000">[FR]ANSSI CERTFR-2017-ACT-019</a><br>
<a href="https://www.cert.ssi.gouv.fr/actualite/CERTFR-2016-ACT-039/#SECTION00010000000000000000">[FR]ANSSI CERTFR-2016-ACT-039</a><br>
<a href="https://attack.mitre.org/techniques/T1557/001">[MITRE]T1557.001 Man-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-OldNtlm"><a name="anchorrulesS-OldNtlm"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-OldNtlm" aria-expanded="false" aria-controls="rulesS-OldNtlm">
          [T]Ensure that the NTLMv1 and old LM protocols are banned (S-OldNtlm)
        </button>
      </span>

    </div>

    <div id="rulesS-OldNtlm" class="collapse" aria-labelledby="headingrulesS-OldNtlm" data-parent="#rulesOldAuthenticationProtocols">
      <div class="card-body">
        <h3>Ensure that the NTLMv1 and old LM protocols are banned</h3>
<strong>Rule ID:</strong><p class="text-justify">S-OldNtlm</p>
<strong>Description:</strong><p class="text-justify">The purpose is to check if NTLMv1 or LM can be used by DC</p>
<strong>Technical Explanation:</strong><p class="text-justify">NTLMv1 is an old protocol which is known to be vulnerable to cryptographic attacks.<br>
    It is typically used when a hacker sniffs the network and tries to retrieve NTLM hashes which can then be used to impersonate users.<br>
    <br>
    This attack can be combined with coerced authentication attacks - a hacker forces the DC to connect to a controlled host.<br>
    In this case, NTLMv1 can be specified so the hacker can retrieve the NTLM hash of the DC, impersonates it and then take control of the domain.<br>
    This attack is still possible with NTLMv2 but this is more difficult.<br>
    <br>
    Windows has default security settings regarding LM/NTLM. Windows XP: Send LM &amp; NTLM responses, Windows Server 2003: Send NTLM response only, Vista/2008: Win7/2008 R2: Send NTLMv2 response only.<br>
    <br>
    However Domain Controllers have relaxed default settings to accept the connection of older operating systems.<br>
    That means that by default, NTLMv1 is accepted on domain controllers.<br>
    If no GPO defines the LAN Manager Authentication Level, the DC fall back to the non secure default.<br>
    </p>
<strong>Advised Solution:</strong><p class="text-justify">After an audit of NTLMv1 usage (see the links below), you need to raise the LAN Manager Authentication Level to "Send NTLMv2 response only. Refuse LM &amp; NTLM".<br>
    This can be done by editing the policy "Network security: LAN Manager authentication level" which can be accessed in Computer Configuration\Windows Settings\Security Settings\Local Policies\Security Options<br>
    The policy will be applied after a computer reboot.<br>
    <br>
    As an alternative, the well known script Get-NtlmV1LogonEvents.ps1 can be used to search for NTLMv1 logon events.<br>
    <br>
    Beware that you may break software which is not compatible with Ntlmv2 such as very old Linux stacks or very old Windows before Windows Vista.<br>
    But please note that Ntlmv2 can be activited on all Windows starting Windows 95 and other operating systems.<br>
    </p><strong>Introduced in:</strong><p class="text-justify">2.11.2.0</p><strong>Points:</strong><p>15 points if present</p>
<strong>Documentation:</strong><p><a href="https://learn.microsoft.com/en-us/troubleshoot/windows-server/windows-security/audit-domain-controller-ntlmv1">https://learn.microsoft.com/en-us/troubleshoot/windows-server/windows-security/audit-domain-controller-ntlmv1</a><br>
<a href="https://learn.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/network-security-restrict-ntlm-ntlm-authentication-in-this-domain">https://learn.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/network-security-restrict-ntlm-ntlm-authentication-in-this-domain</a><br>
<a href="https://learn.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/network-security-lan-manager-authentication-level">https://learn.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/network-security-lan-manager-authentication-level</a><br>
<a href="https://learn.microsoft.com/en-us/troubleshoot/windows-client/windows-security/enable-ntlm-2-authentication">https://learn.microsoft.com/en-us/troubleshoot/windows-client/windows-security/enable-ntlm-2-authentication</a><br>
<a href="https://attack.mitre.org/techniques/T1557/001">[MITRE]T1557.001 Man-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay</a><br>
<a href="https://www.ssi.gouv.fr/uploads/IMG/pdf/NP_ActiveDirectory_NoteTech.pdf#paragraph.3.6.2.1">[FR]ANSSI - Recommandations de sécurité relatives à Active Directory - R37 [paragraph.3.6.2.1]</a></p>
    </div>
  </div></div></div>
			<!-- Accordion rulesOldAuthenticationProtocols end -->

		<div class="row"><div class="col-lg-12 mt-3">
		<h3>Provisioning
		</h3>

		<div class="row"><div class="col-lg-12">
		<p>It is important to control who can create new objects in the Active Directory. Indeed, its owner may introduce an object in which it has a strong control.
		</p>

		<!-- Accordion rulesProvisioning -->
<div id="rulesProvisioning">
<div class="card">
    
    <div class="card-header" id="headingrulesS-DCRegistration"><a name="anchorrulesS-DCRegistration"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-DCRegistration" aria-expanded="false" aria-controls="rulesS-DCRegistration">
          [T]Check if all DC are well registered. (S-DCRegistration)
        </button>
      </span>

    </div>

    <div id="rulesS-DCRegistration" class="collapse" aria-labelledby="headingrulesS-DCRegistration" data-parent="#rulesProvisioning">
      <div class="card-body">
        <h3>Check if all DC are well registered.</h3>
<strong>Rule ID:</strong><p class="text-justify">S-DCRegistration</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that DC are well registered.</p>
<strong>Technical Explanation:</strong><p class="text-justify">To be registered as a domain controller, a computer must be a member of the domain controller group, but also has some specific settings.<br>
The settings are a change of the userAccountControl attribute and a couple of objects in the configuration partition.<br>
This rule is triggered when an inconsistency has been detected between the expected values and the real values.<br>
<br>
The user account control value for Read/Write DC is:<br>
SERVER_TRUST_ACCOUNT (0x00002000) | TRUSTED_FOR_DELEGATION (0x00080000) = 0x00082000<br>
The user account control value for Read Only DC is:<br>
PARTIAL_SECRETS_ACCOUNT (0x04000000) | TRUSTED_TO_AUTHENTICATE_FOR_DELEGATION (0x01000000) | WORKSTATION_TRUST_ACCOUNT (0x00001000) = 0x05001000<br>
</p>
<strong>Advised Solution:</strong><p class="text-justify">This rule result is either the result of a manual or software based misconfiguration. It can also be the sign of a compromise.<br>
      Depending on the anonamly reported, you have to perform the following actions:<br>
      - for InvalidUserAccount:<br>
      you have to check that the userAccountControl attribute of the AD object is either 0x00082000 for RW DC or 0x05001000 for RODC<br>
      - for NoConfiguration:<br>
      the DC registration in the Configuration partition is mising. The DC should not be active and need to be demoted.<br>
      - for NoNTDS:<br>
      the NTDS part of the DC Configuration is missing. Most probably the replication is not working. The DC should be demoted.<br>
    </p><strong>Introduced in:</strong><p class="text-justify">2.9.0.0</p><strong>Points:</strong><p>10 points if present</p>
<strong>Documentation:</strong><p><a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/9164e4e8-f892-4ca2-8067-059f6f9387a4">https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/9164e4e8-f892-4ca2-8067-059f6f9387a4</a><br>
<a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/8ebf2419-1169-4413-88e2-12a5ad499cf5">https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/8ebf2419-1169-4413-88e2-12a5ad499cf5</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#dc_inconsistent_uac">[FR]ANSSI - Domain controllers in inconsistent state (vuln1_dc_inconsistent_uac)</a><span class="badge grade-1">1</span><br>
<a href="https://attack.mitre.org/techniques/T1207">[MITRE]T1207 Rogue Domain Controller</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-ADRegistration"><a name="anchorrulesS-ADRegistration"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-ADRegistration" aria-expanded="false" aria-controls="rulesS-ADRegistration">
          [M]Check the process of registration of computers to the domain (S-ADRegistration)
        </button>
      </span>

    </div>

    <div id="rulesS-ADRegistration" class="collapse" aria-labelledby="headingrulesS-ADRegistration" data-parent="#rulesProvisioning">
      <div class="card-body">
        <h3>Check the process of registration of computers to the domain</h3>
<strong>Rule ID:</strong><p class="text-justify">S-ADRegistration</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that basic users cannot register extra computers in the domain</p>
<strong>Technical Explanation:</strong><p class="text-justify">By default, a basic user can register up to 10 computers within the domain. This default configuration represents a security issue as basic users shouldn't be able to create such accounts and this task should be handled by administrators.<br>
    <br>
    Note: this program checks also the GPO for SeMachineAccountPrivilege assignment. This assignment can be used to restrict the impact of the key ms-DS-MachineAccountQuota.</p>
<strong>Advised Solution:</strong><p class="text-justify">To solve the issue, limit the number of extra computers that can be registered by a basic user.  It can be reduced by modifying the value of <i>ms-DS-MachineAccountQuota</i> to zero (0). Another solution can be to remove the "Authenticated Users" group in the domain controllers policy altogether. Do note, that if you need to set delegation to an account, so it can add computers to the domain, it can be done through 2 methods: Delegation in the OU or by assigning the <i>SeMachineAccountPrivilege</i> to a special group</p><strong>Points:</strong><p>10 points if present</p>
<strong>Documentation:</strong><p><a href="https://docs.microsoft.com/troubleshoot/windows-server/identity/default-workstation-numbers-join-domain">https://docs.microsoft.com/troubleshoot/windows-server/identity/default-workstation-numbers-join-domain</a><br>
<a href="http://prajwaldesai.com/allow-domain-user-to-add-computer-to-domain/">http://prajwaldesai.com/allow-domain-user-to-add-computer-to-domain/</a><br>
<a href="http://blog.backslasher.net/preventing-users-from-adding-computers-to-a-domain.html">http://blog.backslasher.net/preventing-users-from-adding-computers-to-a-domain.html</a><br>
<a href="https://attack.mitre.org/mitigations/M1018">[MITRE]Mitre Att&amp;ck - Mitigation - User Account Management</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-ADRegistrationSchema"><a name="anchorrulesS-ADRegistrationSchema"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-ADRegistrationSchema" aria-expanded="false" aria-controls="rulesS-ADRegistrationSchema">
          [M]Vulnerable Schema Class check (S-ADRegistrationSchema)
        </button>
      </span>

    </div>

    <div id="rulesS-ADRegistrationSchema" class="collapse" aria-labelledby="headingrulesS-ADRegistrationSchema" data-parent="#rulesProvisioning">
      <div class="card-body">
        <h3>Vulnerable Schema Class check</h3>
<strong>Rule ID:</strong><p class="text-justify">S-ADRegistrationSchema</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that no schema class can be used to create arbitrary objects</p>
<strong>Technical Explanation:</strong><p class="text-justify">The classes added to the schema provide additional object types. If misconfigured, a class can be used to bypass a security restriction.<br>
    For the vulnerability PossSuperiorComputer:<br>
    A class has the attribute possSuperiors containing the class "computer" and this class inherits from "container".<br>
  That means that every computer can request this class to be added.<br>
  Once this class has been added, it can be used as a container to create additional users or computers without restrictions.<br>
<br>
    For the vulnerability PossSuperiorUser:<br>
    It is the same vulnerability as PossSuperiorComputer but with the "user" class instead of the "computer" class.<br>
    </p>
<strong>Advised Solution:</strong><p class="text-justify">For PossSuperiorComputer:<br>
    You have to edit the schema to change the value of the attribute possSuperior and remove the "computer" value.<br>
  A PowerShell script in the documentation provides a fix.<br>
<br>
For PossSuperiorUser:<br>
    You have to edit the schema to change the value of the attribute possSuperior and remove the "user" value.<br>
  A PowerShell script in the documentation provides a fix.<br>
  <br>
Also the class msExchStorageGroup is known to have this vulnerability via the CVE-2021-34470.<br>
In this case, the vulnerability is exploitable even if Exchange has been uninstalled.</p><strong>Introduced in:</strong><p class="text-justify">2.9.3.0</p><strong>Points:</strong><p>10 points if present</p>
<strong>Documentation:</strong><p><a href="https://www.pingcastle.com/PingCastleFiles/ad_hc_rules_list.html"></a><br>
<a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=2186">https://bugs.chromium.org/p/project-zero/issues/detail?id=2186</a><br>
<a href="https://gist.github.com/IISResetMe/399a75cfccabc1a17d0cc3b5ae29f3aa#file-update-msexchstoragegroupschema-ps1">https://gist.github.com/IISResetMe/399a75cfccabc1a17d0cc3b5ae29f3aa#file-update-msexchstoragegroupschema-ps1</a><br>
<a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34470">https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34470</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#warning_schema_posssuperiors">[FR]ANSSI - Schema class allowing dangerous object creation (vuln2_warning_schema_posssuperiors)</a><span class="badge grade-2">2</span><br>
<a href="https://attack.mitre.org/mitigations/M1018">[MITRE]Mitre Att&amp;ck - Mitigation - User Account Management</a></p>
    </div>
  </div></div></div>
			<!-- Accordion rulesProvisioning end -->

		<div class="row"><div class="col-lg-12 mt-3">
		<h3>Replication
		</h3>

		<div class="row"><div class="col-lg-12">
		<p>Active Directory uses a distributed architecture to have a high-level of availability. This architecture replicates each change at a regular interval. Collision of changes can create unexpected objects which can be used later.
		</p>

		<!-- Accordion rulesReplication -->
<div id="rulesReplication">
<div class="card">
    
    <div class="card-header" id="headingrulesS-Duplicate"><a name="anchorrulesS-Duplicate"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-Duplicate" aria-expanded="false" aria-controls="rulesS-Duplicate">
          [M]Duplicate account check (S-Duplicate)
        </button>
      </span>

    </div>

    <div id="rulesS-Duplicate" class="collapse" aria-labelledby="headingrulesS-Duplicate" data-parent="#rulesReplication">
      <div class="card-body">
        <h3>Duplicate account check</h3>
<strong>Rule ID:</strong><p class="text-justify">S-Duplicate</p>
<strong>Description:</strong><p class="text-justify">The purpose is to check if there are duplicate accounts within the domain. A duplicate account is essentially a duplicate of two objects having the same attributes.</p>
<strong>Technical Explanation:</strong><p class="text-justify">To identify a duplicate account, a check is performed on the "DN" and the "sAMAccountName". When a DC detects a conflict, there is a replacement performed on the second object.</p>
<strong>Advised Solution:</strong><p class="text-justify">Duplicate accounts being present often means there are process failures, and they should be identified and removed. To identify all duplicate accounts, you can use the following PowerShell commands: <i>get-adobject -ldapfilter "(cn=*cnf:*)"</i> ; <i>get-adobject -ldapfilter "(sAMAccountName=$duplicate)"</i></p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a></p>
    </div>
  </div></div></div>
			<!-- Accordion rulesReplication end -->

		<div class="row"><div class="col-lg-12 mt-3">
		<h3>Vulnerability management
		</h3>

		<div class="row"><div class="col-lg-12">
		<p>Patching computers is part of the security process. Unpatched vulnerability is a way to gain control of a computer.
		</p>

		<!-- Accordion rulesVulnerabilityManagement -->
<div id="rulesVulnerabilityManagement">
<div class="card">
    
    <div class="card-header" id="headingrulesS-Vuln-MS14-068"><a name="anchorrulesS-Vuln-MS14-068"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-Vuln-MS14-068" aria-expanded="false" aria-controls="rulesS-Vuln-MS14-068">
          [M]DC vulnerability (MS14-068)  (S-Vuln-MS14-068)
        </button>
      </span>

    </div>

    <div id="rulesS-Vuln-MS14-068" class="collapse" aria-labelledby="headingrulesS-Vuln-MS14-068" data-parent="#rulesVulnerabilityManagement">
      <div class="card-body">
        <h3>DC vulnerability (MS14-068) </h3>
<strong>Rule ID:</strong><p class="text-justify">S-Vuln-MS14-068</p>
<strong>Description:</strong><p class="text-justify">The purpose is to verify if Domain Controller(s) are vulnerable to the MS14-068 vulnerability</p>
<strong>Technical Explanation:</strong><p class="text-justify">MS14-068 is a critical vulnerability that was published on November, 18th 2014. It can be used to very quickly compromise an entire domain, which is why having DC still vulnerable to this publicly known vulnerability represents a high security risk.</p>
<strong>Advised Solution:</strong><p class="text-justify">To fix the security breach, you should patch the DC as soon as it has been established it was vulnerable. You can verify that using a program in the links: this program will check remotely the last startup time of the DC and evaluate the risk</p><strong>Points:</strong><p>100 points if present</p>
<strong>Documentation:</strong><p><a href="https://technet.microsoft.com/en-us/library/security/ms14-068.aspx">https://technet.microsoft.com/en-us/library/security/ms14-068.aspx </a><br>
<a href="https://www.cert.ssi.gouv.fr/alerte/CERTFR-2014-ALE-011">[FR]ANSSI CERTFR-2014-ALE-011</a><br>
<a href="https://attack.mitre.org/mitigations/M1051">[MITRE]Mitre Att&amp;ck - Mitigation - Update Software</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-Vuln-MS17_010"><a name="anchorrulesS-Vuln-MS17_010"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-Vuln-MS17_010" aria-expanded="false" aria-controls="rulesS-Vuln-MS17_010">
          [M]DC vulnerability (MS17-010)  (S-Vuln-MS17_010)
        </button>
      </span>

    </div>

    <div id="rulesS-Vuln-MS17_010" class="collapse" aria-labelledby="headingrulesS-Vuln-MS17_010" data-parent="#rulesVulnerabilityManagement">
      <div class="card-body">
        <h3>DC vulnerability (MS17-010) </h3>
<strong>Rule ID:</strong><p class="text-justify">S-Vuln-MS17_010</p>
<strong>Description:</strong><p class="text-justify">The purpose is to verify if Domain Controller(s) are vulnerable to the MS17-010 vulnerability</p>
<strong>Technical Explanation:</strong><p class="text-justify">MS17-010 is a critical vulnerability that was published on March, 14th 2017. It can be used to compromise an entire domain via DC compromise. This exploit has been revealed by the Shadow brokers (EternalBlue, EternalRomance, EternalSinergy) and it uses the SMB v1 vulnerability</p>
<strong>Advised Solution:</strong><p class="text-justify">To fix the security breach, you should patch the DC as soon as it has been established it was vulnerable. Another good remediation is to disable SMB v1 (see "DC Vulnerability (SMB v1)). You can verify that using the program from github in the links: this program will check remotely the last startup time of the DC and evaluate the risk</p><strong>Points:</strong><p>100 points if present</p>
<strong>Documentation:</strong><p><a href="https://blogs.technet.microsoft.com/msrc/2017/04/14/protecting-customers-and-evaluating-risk/">https://blogs.technet.microsoft.com/msrc/2017/04/14/protecting-customers-and-evaluating-risk/ </a><br>
<a href="https://github.com/misterch0c/shadowbroker/tree/master/windows/exploits">https://github.com/misterch0c/shadowbroker/tree/master/windows/exploits </a><br>
<a href="https://www.cert.ssi.gouv.fr/alerte/CERTFR-2017-ALE-010">[FR]ANSSI CERTFR-2017-ALE-010</a><br>
<a href="https://attack.mitre.org/mitigations/M1051">[MITRE]Mitre Att&amp;ck - Mitigation - Update Software</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-DC-NotUpdated"><a name="anchorrulesS-DC-NotUpdated"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-DC-NotUpdated" aria-expanded="false" aria-controls="rulesS-DC-NotUpdated">
          [M]Domain controller update (S-DC-NotUpdated)
        </button>
      </span>

    </div>

    <div id="rulesS-DC-NotUpdated" class="collapse" aria-labelledby="headingrulesS-DC-NotUpdated" data-parent="#rulesVulnerabilityManagement">
      <div class="card-body">
        <h3>Domain controller update</h3>
<strong>Rule ID:</strong><p class="text-justify">S-DC-NotUpdated</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that all the Domain Controllers are updated regularly. This is done by checking if a DC has been rebooted in the past 6 months. If not, it means it has not been patched as well in these 6 months</p>
<strong>Technical Explanation:</strong><p class="text-justify">Domain Controller needs to be updated regularly because threats to the AD evolve all the time, so assets in the AD should evolve accordingly. The date of last update is computed by getting the <i>StatisticsStartTime</i> from <i>[net statistics workstation]</i>. If not available, the PingCastle solution will use the <i>lastLogonTimestamp</i> attribute which is refreshed based on the LastLogon attribute. Do note that there is a maximum delay for refresh: 14 days.</p>
<strong>Advised Solution:</strong><p class="text-justify">Frequently updating the DC should be part of the AD policies, as there should be a dedicated time-slot for the servers to reboot and apply security patches</p><strong>Points:</strong><p>15 points if present</p>
<strong>Documentation:</strong><p><a href="https://attack.mitre.org/mitigations/M1051">[MITRE]Mitre Att&amp;ck - Mitigation - Update Software</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-WSUS-UserProxy"><a name="anchorrulesS-WSUS-UserProxy"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-WSUS-UserProxy" aria-expanded="false" aria-controls="rulesS-WSUS-UserProxy">
          [M]Search for WSUS configuration enabling the use of a user proxy (S-WSUS-UserProxy)
        </button>
      </span>

    </div>

    <div id="rulesS-WSUS-UserProxy" class="collapse" aria-labelledby="headingrulesS-WSUS-UserProxy" data-parent="#rulesVulnerabilityManagement">
      <div class="card-body">
        <h3>Search for WSUS configuration enabling the use of a user proxy</h3>
<strong>Rule ID:</strong><p class="text-justify">S-WSUS-UserProxy</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that there is no user proxy possibility for WSUS</p>
<strong>Technical Explanation:</strong><p class="text-justify">Unprivileged domain users may set a user proxy that is used for Windows Update if it is being allowed by a GPO.<br>
    Since the cumulative updates from September 2020 and January 2021, WSUS clients do not use the user proxy to connect to the server by default.<br>
    However, it is possible to configure a GPO setting that allows the connection via user proxy as a fallback to the system proxy.<br>
  <br>
    This program consider as an anomaly if the setting SetProxyBehaviorForUpdateDetection is set, combined with a HTTP WSUS server.</p>
<strong>Advised Solution:</strong><p class="text-justify">The use of a user proxy needs to be disabled.<br>
    This program is looking at element named "Select the proxy behavior" defined in GPO Computer Configuration\Policies\Administrative Templates\Windows Components\Windows Update\Specify intranet Microsoft update service location<br>
(refers to registry key HKLM\Software\Policies\Microsoft\Windows\WindowsUpdate\SetProxyBehaviorForUpdateDetection)<br>
<br>
Or WSUS needs to be configured with HTTPS.<br>
See this guide for more information:<br>
https://docs.microsoft.com/en-us/windows-server/administration/windows-server-update-services/deploy/2-configure-wsus#23-secure-wsus-with-the-secure-sockets-layer-protocol<br>
</p><strong>Introduced in:</strong><p class="text-justify">2.10.1.0</p><strong>Points:</strong><p>1 points if present</p>
<strong>Documentation:</strong><p><a href="https://www.pingcastle.com/PingCastleFiles/ad_hc_rules_list.html"></a><br>
<a href="https://www.gosecure.net/blog/2021/11/22/gosecure-investigates-abusing-windows-server-update-services-wsus-to-enable-ntlm-relaying-attacks/">https://www.gosecure.net/blog/2021/11/22/gosecure-investigates-abusing-windows-server-update-services-wsus-to-enable-ntlm-relaying-attacks/</a><br>
<a href="https://github.com/pimps/wsuxploit">https://github.com/pimps/wsuxploit</a><br>
<a href="https://github.com/GoSecure/WSuspicious">https://github.com/GoSecure/WSuspicious</a><br>
<a href="https://docs.microsoft.com/en-us/windows/client-management/mdm/policy-csp-update#update-setproxybehaviorforupdatedetection">https://docs.microsoft.com/en-us/windows/client-management/mdm/policy-csp-update#update-setproxybehaviorforupdatedetection</a><br>
<a href="https://www.pingcastle.com/PingCastleFiles/ad_hc_rules_list.html">  </a><br>
<a href="https://attack.mitre.org/mitigations/M1051">[MITRE]Mitre Att&amp;ck - Mitigation - Update Software</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-WSUS-HTTP"><a name="anchorrulesS-WSUS-HTTP"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-WSUS-HTTP" aria-expanded="false" aria-controls="rulesS-WSUS-HTTP">
          [M]Search for WSUS configuration using HTTP instead of HTTPS (S-WSUS-HTTP)
        </button>
      </span>

    </div>

    <div id="rulesS-WSUS-HTTP" class="collapse" aria-labelledby="headingrulesS-WSUS-HTTP" data-parent="#rulesVulnerabilityManagement">
      <div class="card-body">
        <h3>Search for WSUS configuration using HTTP instead of HTTPS</h3>
<strong>Rule ID:</strong><p class="text-justify">S-WSUS-HTTP</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that there is no access of WSUS server via HTTP</p>
<strong>Technical Explanation:</strong><p class="text-justify">WSUS is the component used on the intranet to deliver Windows updates. The recommendation of Microsoft is to use HTTPS for transport but for convenience or tests, HTTP can be configured.<br>
The HTTP protocol can be intercepted on the network with tools such as wsuxploit or WSuspicious (see below for links) and malicious updates can be delivered.<br>
The attacker can then take control of many assets.</p>
<strong>Advised Solution:</strong><p class="text-justify">WSUS needs to be configured with HTTPS.<br>
See this guide for more information:<br>
https://docs.microsoft.com/en-us/windows-server/administration/windows-server-update-services/deploy/2-configure-wsus#23-secure-wsus-with-the-secure-sockets-layer-protocol<br>
    <br>
Then all GPO which reference the HTTP path should be changed to the HTTPS path.<br>
This program is looking at the settings defined in "Set the intranet update service for detecting updates" and "Set the alternate download server" in GPO Computer Configuration\Policies\Administrative Templates\Windows Components\Windows Update\Specify intranet Microsoft update service location<br>
(refers to registry key HKLM\Software\Policies\Microsoft\Windows\WindowsUpdate\WUServer and HKLM\Software\Policies\Microsoft\Windows\WindowsUpdate\UpdateServiceUrlAlternate)<br>
</p><strong>Introduced in:</strong><p class="text-justify">2.10.1.0</p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://www.pingcastle.com/PingCastleFiles/ad_hc_rules_list.html"></a><br>
<a href="https://www.gosecure.net/blog/2021/11/22/gosecure-investigates-abusing-windows-server-update-services-wsus-to-enable-ntlm-relaying-attacks/">https://www.gosecure.net/blog/2021/11/22/gosecure-investigates-abusing-windows-server-update-services-wsus-to-enable-ntlm-relaying-attacks/</a><br>
<a href="https://github.com/pimps/wsuxploit">https://github.com/pimps/wsuxploit</a><br>
<a href="https://github.com/GoSecure/WSuspicious">https://github.com/GoSecure/WSuspicious</a><br>
<a href="https://docs.microsoft.com/en-us/windows/deployment/update/waas-wu-settings">https://docs.microsoft.com/en-us/windows/deployment/update/waas-wu-settings</a><br>
<a href="https://attack.mitre.org/mitigations/M1051">[MITRE]Mitre Att&amp;ck - Mitigation - Update Software</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-WSUS-NoPinning"><a name="anchorrulesS-WSUS-NoPinning"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-WSUS-NoPinning" aria-expanded="false" aria-controls="rulesS-WSUS-NoPinning">
          [M]Search for WSUS configuration where certificate pinning has been disabled (S-WSUS-NoPinning)
        </button>
      </span>

    </div>

    <div id="rulesS-WSUS-NoPinning" class="collapse" aria-labelledby="headingrulesS-WSUS-NoPinning" data-parent="#rulesVulnerabilityManagement">
      <div class="card-body">
        <h3>Search for WSUS configuration where certificate pinning has been disabled</h3>
<strong>Rule ID:</strong><p class="text-justify">S-WSUS-NoPinning</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that WSUS Certificate Pinning has not been disabled</p>
<strong>Technical Explanation:</strong><p class="text-justify">Even though HTTPS makes it harder for attackers to intercept WSUS responses, it it still possible with a specific configuration.<br>
    HTTPS connections may be intercepted by a proxy that signs the response again with a self-signed certificate after receiving it from the WSUS server.<br>
    The certificate can be installed in a user cert store so responses from the HTTPS proxy can still be validated.<br>
In the cumulative update of January 2021, Microsoft implemented a certificate pinning mechanism where the certificate served by the WSUS' IIS server is installed in a system certificate store specifically for WSUS (WindowsServerUpdateServices) that an unauthenticated user cannot control.<br>
Certificates in this store are enforced by default to mitigate HTTPS-intercepting proxy attacks but this pinning mechanism can also be disabled via GPO.<br>
<br>
If the WSUS cert store does not contain any certificates, the pinning will not be enforced, too.<br>
<br>
PingCastle cannot check if the certificate is present to enforce the certificate pinning, but it checks if a GPO disable this security.</p>
<strong>Advised Solution:</strong><p class="text-justify">Remove the setting which disables the certificate pinning for WSUS.<br>
    <br>
    It is located in: Computer Configuration\Policies\Administrative Templates\Windows Components\Windows Update\Specify intranet Microsoft update service location<br>
  This is the setting "Allow user proxy to be used as a fallback if detection using system proxy fails".<br>
  <br>
  It refers to the registry key: HKLM\Software\Policies\Microsoft\Windows\WindowsUpdate\DoNotEnforceEnterpriseTLSCertPinningForUpdateDetection<br>
</p><strong>Introduced in:</strong><p class="text-justify">2.10.1.0</p><strong>Points:</strong><p>2 points if present</p>
<strong>Documentation:</strong><p><a href="https://www.pingcastle.com/PingCastleFiles/ad_hc_rules_list.html"></a><br>
<a href="https://www.gosecure.net/blog/2021/11/22/gosecure-investigates-abusing-windows-server-update-services-wsus-to-enable-ntlm-relaying-attacks/">https://www.gosecure.net/blog/2021/11/22/gosecure-investigates-abusing-windows-server-update-services-wsus-to-enable-ntlm-relaying-attacks/</a><br>
<a href="https://github.com/pimps/wsuxploit">https://github.com/pimps/wsuxploit</a><br>
<a href="https://github.com/GoSecure/WSuspicious">https://github.com/GoSecure/WSuspicious</a><br>
<a href="https://docs.microsoft.com/en-us/windows/client-management/mdm/policy-csp-update#update-donotenforceenterprisetlscertpinningforupdatedetection">https://docs.microsoft.com/en-us/windows/client-management/mdm/policy-csp-update#update-donotenforceenterprisetlscertpinningforupdatedetection</a><br>
<a href="https://www.pingcastle.com/PingCastleFiles/ad_hc_rules_list.html">  </a><br>
<a href="https://attack.mitre.org/mitigations/M1051">[MITRE]Mitre Att&amp;ck - Mitigation - Update Software</a></p>
    </div>
  </div></div></div>
			<!-- Accordion rulesVulnerabilityManagement end -->

		<!-- SubSection Privileged Accounts -->
		<div class="row"><div class="col-lg-12 mt-2">
			<h2>Privileged Accounts</h2>
		</div></div>
        <!-- SubSection Privileged Accounts end -->
		<div class="row"><div class="col-lg-12">
		<p>Each line represents a rule. Click on a rule to expand it and show the details of it.
		</p>

		<div class="row"><div class="col-lg-12 mt-3">
		<h3>Account take over
		</h3>

		<div class="row"><div class="col-lg-12">
		<p>Members of administrators' groups are a priority target. By misconfiguring their protection, the password of the account can be retrieved by an attacker, or it can leverage internal mechanisms of the AD such as authentication to act on its behalf.
		</p>

		<!-- Accordion rulesAccountTakeOver -->
<div id="rulesAccountTakeOver">
<div class="card">
    
    <div class="card-header" id="headingrulesP-Delegated"><a name="anchorrulesP-Delegated"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-Delegated" aria-expanded="false" aria-controls="rulesP-Delegated">
          [M]At least one administrator account can be delegated (P-Delegated)
        </button>
      </span>

    </div>

    <div id="rulesP-Delegated" class="collapse" aria-labelledby="headingrulesP-Delegated" data-parent="#rulesAccountTakeOver">
      <div class="card-body">
        <h3>At least one administrator account can be delegated</h3>
<strong>Rule ID:</strong><p class="text-justify">P-Delegated</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that all Administrator Accounts have the configuration flag "this account is sensitive and cannot be delegated" (or are members of the built-in group "Protected Users" when your domain functional level is at least Windows Server 2012 R2).</p>
<strong>Technical Explanation:</strong><p class="text-justify">Without the flag "This account is sensitive and cannot be delegated" any account can be impersonated by some service account. It is a best practice to enforce this flag on administrators accounts.</p>
<strong>Advised Solution:</strong><p class="text-justify">To correct the situation, you should make sure that all your Administrator Accounts have the check-box "This account is sensitive and cannot be delegated" active or add your Administrator Accounts to the built-in group "Protected Users" if your domain functional level is at least Windows Server 2012 R2 (some functionalities may not work properly afterwards, you should check the <a href="https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/manage/how-to-configure-protected-accounts">official documentation</a>).<br>
	If you want to enable the check-box "This account is sensitive and cannot be delegated" but this is not possible because the box is not present (typically for GMSA accounts), you can add the flag manually by adding the number 1048576 to the attribute useraccountcontrol of the account.<br>
	Please note that there is a section below in this report named "Admin Groups" which gives more information.</p><strong>Points:</strong><p>20 points if present</p>
<strong>Documentation:</strong><p><a href="https://www.stigviewer.com/stig/active_directory_domain/2017-12-15/finding/V-36435">[US]STIG V-36435 - Delegation of privileged accounts must be prohibited.</a><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesP-Kerberoasting"><a name="anchorrulesP-Kerberoasting"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-Kerberoasting" aria-expanded="false" aria-controls="rulesP-Kerberoasting">
          [T]Check if admin accounts are vulnerable to the Kerberoast attack. (P-Kerberoasting)
        </button>
      </span>

    </div>

    <div id="rulesP-Kerberoasting" class="collapse" aria-labelledby="headingrulesP-Kerberoasting" data-parent="#rulesAccountTakeOver">
      <div class="card-body">
        <h3>Check if admin accounts are vulnerable to the Kerberoast attack.</h3>
<strong>Rule ID:</strong><p class="text-justify">P-Kerberoasting</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that the password of admin accounts cannot be retrieved using the Kerberoast attack.</p>
<strong>Technical Explanation:</strong><p class="text-justify">To access a service using Kerberos, a user requests a ticket (named TGS) to the DC specific to the service.<br>
This ticket is encrypted using a derivative of the service password, but can be brute-forced to retrieve the original password.<br>
Any account having the attribute SPN populated is considered as a service account.<br>
Given that any user can request a ticket for a service account, these accounts can have their password retrieved.<br>
In addition, services are known to have their password not changed at a regular basis and to use well-known words.<br>
<br>
Please note that this program ignores service accounts that had their password changed in the last 40 days ago to support using password rotation as a mitigation.</p>
<strong>Advised Solution:</strong><p class="text-justify">If the account is a service account, the service should be removed from the privileged group or have a process to change its password at a regular basis.<br>
If the user is a person, the SPN attribute of the account should be removed.</p><strong>Introduced in:</strong><p class="text-justify">2.7.0.0</p><strong>Points:</strong><p>5 points per discovery</p>
<strong>Documentation:</strong><p><a href="https://adsecurity.org/?p=3466">https://adsecurity.org/?p=3466</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#spn_priv">[FR]ANSSI - Privileged accounts with SPN (vuln1_spn_priv)</a><span class="badge grade-1">1</span><br>
<a href="https://attack.mitre.org/techniques/T1558/003">[MITRE]T1558.003 Steal or Forge Kerberos Tickets: Kerberoasting</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesP-AdminPwdTooOld"><a name="anchorrulesP-AdminPwdTooOld"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-AdminPwdTooOld" aria-expanded="false" aria-controls="rulesP-AdminPwdTooOld">
          [M]Check if all admin passwords are changed on the field. (P-AdminPwdTooOld)
        </button>
      </span>

    </div>

    <div id="rulesP-AdminPwdTooOld" class="collapse" aria-labelledby="headingrulesP-AdminPwdTooOld" data-parent="#rulesAccountTakeOver">
      <div class="card-body">
        <h3>Check if all admin passwords are changed on the field.</h3>
<strong>Rule ID:</strong><p class="text-justify">P-AdminPwdTooOld</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that all admins are changing their passwords at least every 3 years</p>
<strong>Technical Explanation:</strong><p class="text-justify">This rule ensure that passwords of administrator are well managed.</p>
<strong>Advised Solution:</strong><p class="text-justify">We advised to read the ANSSI guidelines about this, which is quoted in the documentation section below.<br>
    </p><strong>Introduced in:</strong><p class="text-justify">2.9.0.0</p><strong>Points:</strong><p>10 points if present</p>
<strong>Documentation:</strong><p><a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#password_change_priv">[FR]ANSSI - Privileged account passwords age too old (vuln1_password_change_priv)</a><span class="badge grade-1">1</span><br>
<a href="https://attack.mitre.org/mitigations/M1026">[MITRE]Mitre Att&amp;ck - Mitigation - Privileged Account Management</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesP-ProtectedUsers"><a name="anchorrulesP-ProtectedUsers"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-ProtectedUsers" aria-expanded="false" aria-controls="rulesP-ProtectedUsers">
          [M]Check if all privileged accounts are in the special group Protected Users. (P-ProtectedUsers)
        </button>
      </span>

    </div>

    <div id="rulesP-ProtectedUsers" class="collapse" aria-labelledby="headingrulesP-ProtectedUsers" data-parent="#rulesAccountTakeOver">
      <div class="card-body">
        <h3>Check if all privileged accounts are in the special group Protected Users.</h3>
<strong>Rule ID:</strong><p class="text-justify">P-ProtectedUsers</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that all privileged accounts are in the Protected User security group</p>
<strong>Technical Explanation:</strong><p class="text-justify">The Protected User group is a special security group which automatically applies protections to minimize credential exposure. Starting with Windows 8.1. Older Operating System must be updated to take this protection in account such as the Windows 7 KB2871997 patch.<br>
    For admins, it:<br>
- Disables NTLM authentication<br>
- Reduces Kerberos ticket lifetime<br>
- Mandates strong encryption algorithms, such as AES<br>
- Prevents password caching on workstations<br>
- Prevents any type of Kerberos delegation<br>
<br>
Please also note that a few links (see below) recommends that at least one account is kept outside of the group Protected Users in case there is a permission problem.<br>
That's why this rule is not triggered if only one account is not protected.</p>
<strong>Advised Solution:</strong><p class="text-justify">After having reviewed the potential impact on adding users to this group, add the missing privileged accounts to this group.</p><strong>Introduced in:</strong><p class="text-justify">2.9.0.0</p><strong>Points:</strong><p>10 points if the occurence is greater than or equals than 2</p>
<strong>Documentation:</strong><p><a href="https://docs.microsoft.com/en-us/windows-server/security/credentials-protection-and-management/protected-users-security-group">https://docs.microsoft.com/en-us/windows-server/security/credentials-protection-and-management/protected-users-security-group</a><br>
<a href="https://blog.netwrix.com/2015/02/20/add-sensitive-user-accounts-to-active-directory-protected-users-group/">https://blog.netwrix.com/2015/02/20/add-sensitive-user-accounts-to-active-directory-protected-users-group/</a><br>
<a href="https://dirteam.com/sander/2014/11/25/ten-things-you-need-to-be-aware-of-before-using-the-protected-users-group/">https://dirteam.com/sander/2014/11/25/ten-things-you-need-to-be-aware-of-before-using-the-protected-users-group/</a><br>
<a href="https://blog.andreas-schreiner.de/2018/09/07/active-directory-sicherheit-teil-1-privilegierte-benutzer/">https://blog.andreas-schreiner.de/2018/09/07/active-directory-sicherheit-teil-1-privilegierte-benutzer/</a><br>
<a href="https://www.stigviewer.com/stig/active_directory_domain/2017-12-15/finding/V-78131">[US]STIG V-78131 - Accounts with domain level administrative privileges must be members of the Protected Users group in domains with a domain functional level of Windows 2012 R2 or higher.</a><br>
<a href="https://www.cert.ssi.gouv.fr/alerte/CERTFR-2017-ALE-012">[FR]ANSSI CERTFR-2017-ALE-012</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#protected_users">[FR]ANSSI - Privileged accounts outside of the Protected Users group (vuln3_protected_users)</a><span class="badge grade-3">3</span><br>
<a href="https://attack.mitre.org/mitigations/M1025">[MITRE]Mitre Att&amp;ck - Mitigation - Privileged Process Integrity</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesP-LogonDenied"><a name="anchorrulesP-LogonDenied"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-LogonDenied" aria-expanded="false" aria-controls="rulesP-LogonDenied">
          [M]Check if there is a policy preventing administrators to connect to lower tier systems. (P-LogonDenied)
        </button>
      </span>

    </div>

    <div id="rulesP-LogonDenied" class="collapse" aria-labelledby="headingrulesP-LogonDenied" data-parent="#rulesAccountTakeOver">
      <div class="card-body">
        <h3>Check if there is a policy preventing administrators to connect to lower tier systems.</h3>
<strong>Rule ID:</strong><p class="text-justify">P-LogonDenied</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that there is a tier isolation.</p>
<strong>Technical Explanation:</strong><p class="text-justify">A way to collect an administrator credential is to take control of a workstation or server in the unsecured tiers and expect that an administrator will connect to it.<br>
    An attack such as credential theft or Kerberos delegation is then performed.<br>
    To reduce the impact of such compromise, the best practice is to isolate components (such as admins, DC) in tiers.<br>
    Typically, a domain admin should not be allowed to connect to any workstation or lower tier server but login only to perform highly privileged operations on tier 0 systems.<br>
    <br>
    To check for this policy, PingCastle looks at all GPOs and checks, if there is a GPO denying logon (SeDenyRemoteInteractiveLogonRight, SeDenyInteractiveLogonRight) of admins (Domain Admins or Administrators) to a specific scope.<br>
    <br>
    False positives can occurs for this rule:<br>
    * if the expected GPO is hidden due to ACL checks<br>
    * if the targeted group is not "checked" when saving the GPO. Indeed, the group will be saved as is without a conversion to its technical name and it will prohibit a match if there are groups internationalized, aka renamed given a specific language.<br>
    <br>
    As a consequence, only one deny policy on one group will fulfill this requirements. The program also does not check if the GPO is applied on an Organizational Unit or a Container.<br>
    Also this rule is enforced only if there are more than 200 users and 200 computers.<br>
    </p>
<strong>Advised Solution:</strong><p class="text-justify">You should add a GPO to prohibit the logon of specific groups Domain Admins and Administrators.<br>
    <br>
The setting is located in Computer Policy -&gt; Computer Configuration -&gt; Windows Settings -&gt; Security Settings -&gt; Local Policies -&gt; User Rights Assignment.<br>
Then "Deny" logon locally and "Deny" logon through Remote Desktop Services.</p><strong>Introduced in:</strong><p class="text-justify">2.8.0.0</p><strong>Points:</strong><p>1 points if present</p>
<strong>Documentation:</strong><p><a href="https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices/appendix-f--securing-domain-admins-groups-in-active-directory">https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices/appendix-f--securing-domain-admins-groups-in-active-directory</a><br>
<a href="https://attack.mitre.org/mitigations/M1026">[MITRE]Mitre Att&amp;ck - Mitigation - Privileged Account Management</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesP-DisplaySpecifier"><a name="anchorrulesP-DisplaySpecifier"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-DisplaySpecifier" aria-expanded="false" aria-controls="rulesP-DisplaySpecifier">
          [T]Ensure that custom Display Specifiers are stored in SYSVOL (P-DisplaySpecifier)
        </button>
      </span>

    </div>

    <div id="rulesP-DisplaySpecifier" class="collapse" aria-labelledby="headingrulesP-DisplaySpecifier" data-parent="#rulesAccountTakeOver">
      <div class="card-body">
        <h3>Ensure that custom Display Specifiers are stored in SYSVOL</h3>
<strong>Rule ID:</strong><p class="text-justify">P-DisplaySpecifier</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that scripts used for the customization of admin UI are stored safely</p>
<strong>Technical Explanation:</strong><p class="text-justify">DisplaySpecifier are Active Directory objects stored in the DisplaySpecifier container of the Configuration naming context.<br>
    They are used to customize the user interface.<br>
    Specifically the attribute adminContextMenu is used to customize administration actions, where COM objects or scripts can be called.<br>
    If the script is stored outside the SYSVOL directory, it can be used to execute custom actions and it is run under the administrator context.<br>
    </p>
<strong>Advised Solution:</strong><p class="text-justify">The scripts identified by this rule should be moved to the SYSVOL and properly secured.</p><strong>Introduced in:</strong><p class="text-justify">2.11.2.0</p><strong>Points:</strong><p>10 points if present</p>
<strong>Documentation:</strong><p><a href="https://www.semperis.com/blog/active-directory-security-abusing-display-specifiers/">https://www.semperis.com/blog/active-directory-security-abusing-display-specifiers/</a><br>
<a href="https://learn.microsoft.com/en-us/windows/win32/ad/display-specifiers">https://learn.microsoft.com/en-us/windows/win32/ad/display-specifiers</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#vuln_display_specifier">[FR]ANSSI - Dangerous Display Specifiers (vuln1_vuln_display_specifier)</a><span class="badge grade-1">1</span><br>
<a href="https://attack.mitre.org/techniques/T1569">[MITRE]T1569 System Services</a></p>
    </div>
  </div></div></div>
			<!-- Accordion rulesAccountTakeOver end -->

		<div class="row"><div class="col-lg-12 mt-3">
		<h3>ACL Check
		</h3>

		<div class="row"><div class="col-lg-12">
		<p>Delegation is used to perform day to day activities. It is important to control it.
		</p>

		<!-- Accordion rulesACLCheck -->
<div id="rulesACLCheck">
<div class="card">
    
    <div class="card-header" id="headingrulesP-DCOwner"><a name="anchorrulesP-DCOwner"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-DCOwner" aria-expanded="false" aria-controls="rulesP-DCOwner">
          [M]At least one domain controller is not owned correctly (P-DCOwner)
        </button>
      </span>

    </div>

    <div id="rulesP-DCOwner" class="collapse" aria-labelledby="headingrulesP-DCOwner" data-parent="#rulesACLCheck">
      <div class="card-body">
        <h3>At least one domain controller is not owned correctly</h3>
<strong>Rule ID:</strong><p class="text-justify">P-DCOwner</p>
<strong>Description:</strong><p class="text-justify">The purpose is to perform a review of which accounts have ownership rights on a domain controller and can then modify their permissions</p>
<strong>Technical Explanation:</strong><p class="text-justify">By default, the "Domain Administrators" group or the "Enterprise Administrators" group are set as owners for "Domain Controllers". Nonetheless, in some cases (for instance when the server has been promoted from an existing server), the owner can be a non-admin person which joined the server to the domain. If this person has still rights over this account, it can be used to take ownership over the whole domain. A chain of compromising events can be designed to take control of the domain by including this account.</p>
<strong>Advised Solution:</strong><p class="text-justify">To solve this security issue, you should change the ownership of the domain controller to match the "Domain Administrators" group.<br>
To control the ownership of domain controller objects, you can use the following PowerShell command: <br>
<i>Get-ADComputer -server my.domain.to.check -LDAPFilter "(&amp;(objectCategory=computer)(|(primarygroupid=521)(primarygroupid=516)))" -properties name, ntsecuritydescriptor | select name,{$_.ntsecuritydescriptor.Owner}</i>.<br>
To change it you can edit the owner of an object using <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/adexplorer">adexplorer.exe</a>. First, locate the DC object then right click to select properties. Open the security tab and press the advanced button. You then have a new dialog with an owner tab. Select the owner and change it for the domain administrators group. Youâ€™re done (no reboot needed).</p><strong>Points:</strong><p>10 points if present</p>
<strong>Documentation:</strong><p><a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#owner">[FR]ANSSI - Incorrect object owners (vuln3_owner)</a><span class="badge grade-3">3</span><br>
<a href="https://attack.mitre.org/mitigations/M1026">[MITRE]Mitre Att&amp;ck - Mitigation - Privileged Account Management</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesP-DangerousExtendedRight"><a name="anchorrulesP-DangerousExtendedRight"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-DangerousExtendedRight" aria-expanded="false" aria-controls="rulesP-DangerousExtendedRight">
          [M]Check for Dangerous rights found in OU delegation (P-DangerousExtendedRight)
        </button>
      </span>

    </div>

    <div id="rulesP-DangerousExtendedRight" class="collapse" aria-labelledby="headingrulesP-DangerousExtendedRight" data-parent="#rulesACLCheck">
      <div class="card-body">
        <h3>Check for Dangerous rights found in OU delegation</h3>
<strong>Rule ID:</strong><p class="text-justify">P-DangerousExtendedRight</p>
<strong>Description:</strong><p class="text-justify">The purpose is to verify the presence of dangerous rights when a part of the domain is delegated to a third party</p>
<strong>Technical Explanation:</strong><p class="text-justify">The right "REANIMATE_TOMBSTONE" used to undelete objects, "UNEXPIRE_PASSWORD" used to undo the expiration of a password, or "SID_HISTORY" used to create an alternate identity is considered dangerous. Indeed, this right can be used to trigger a backdoor.</p>
<strong>Advised Solution:</strong><p class="text-justify">Unless there is a strong justification of their presence, these delegations should be removed. In addition, if the origin of this delegation cannot be found, their creation should be investigated as it could be related to a compromise of the domain</p><strong>Points:</strong><p>5 points per discovery</p>
<strong>Documentation:</strong><p><a href="https://technet.microsoft.com/en-us/library/ff405676.aspx">https://technet.microsoft.com/en-us/library/ff405676.aspx</a><br>
<a href="https://www.ssi.gouv.fr/uploads/IMG/pdf/NP_ActiveDirectory_NoteTech.pdf#subsubsection.3.3.2">[FR]ANSSI - Recommandations de sécurité relatives à Active Directory - R18 [subsubsection.3.3.2]</a><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesP-DsHeuristicsDoListObject"><a name="anchorrulesP-DsHeuristicsDoListObject"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-DsHeuristicsDoListObject" aria-expanded="false" aria-controls="rulesP-DsHeuristicsDoListObject">
          [M]Check if the behavior DoListObject has been enabled (P-DsHeuristicsDoListObject)
        </button>
      </span>

    </div>

    <div id="rulesP-DsHeuristicsDoListObject" class="collapse" aria-labelledby="headingrulesP-DsHeuristicsDoListObject" data-parent="#rulesACLCheck">
      <div class="card-body">
        <h3>Check if the behavior DoListObject has been enabled</h3>
<strong>Rule ID:</strong><p class="text-justify">P-DsHeuristicsDoListObject</p>
<strong>Description:</strong><p class="text-justify">The purpose is to check if the DoListObject feature has been enabled</p>
<strong>Technical Explanation:</strong><p class="text-justify">The DoListObject is a feature to probihit account located in an OU to look at another OU. It proceeds by checking a special ACL named RIGHT_DS_LIST_OBJECT.<br>
</p>
<strong>Advised Solution:</strong><p class="text-justify">This is an informative rule.<br>
If you want to reverse this behavior to its default value, find the dsHeuristics configuration which is located in CN=Directory Service,CN=Windows NT,CN=Services,CN=Configuration,DC=ad,DC=contoso,DC=com.<br>
Then edit the 3rd character and set it to zero.</p><strong>Introduced in:</strong><p class="text-justify">2.7.0.0</p><strong>Points:</strong><p>Informative rule (0 point)</p>
<strong>Documentation:</strong><p><a href="https://dirteam.com/sander/2008/12/09/active-directory-visibility-modes/">https://dirteam.com/sander/2008/12/09/active-directory-visibility-modes/</a><br>
<a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/e5899be4-862e-496f-9a38-33950617d2c5">https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/e5899be4-862e-496f-9a38-33950617d2c5</a><br>
<a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/990fb975-ab31-4bc1-8b75-5da132cd4584">https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/990fb975-ab31-4bc1-8b75-5da132cd4584</a><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesP-DNSAdmin"><a name="anchorrulesP-DNSAdmin"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-DNSAdmin" aria-expanded="false" aria-controls="rulesP-DNSAdmin">
          [M]Check if the Dns Admins group is not empty (P-DNSAdmin)
        </button>
      </span>

    </div>

    <div id="rulesP-DNSAdmin" class="collapse" aria-labelledby="headingrulesP-DNSAdmin" data-parent="#rulesACLCheck">
      <div class="card-body">
        <h3>Check if the Dns Admins group is not empty</h3>
<strong>Rule ID:</strong><p class="text-justify">P-DNSAdmin</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that the Dns Admins group is not used</p>
<strong>Technical Explanation:</strong><p class="text-justify">Administrators of the DNS Service have the possibility to inject a DLL in this service.<br>
However this service is hosted most of the time in the domain controller and is running as SYSTEM.<br>
That means that DNS admins are potentially domain admins.<br>
<br>
The security descriptor used to grant admin rights is located on the nTSecurityDescriptor attribute of the object CN=MicrosoftDNS,CN=System.<br>
The "Write All Prop" access right induces the vulnerability.<br>
<br>
In this case, the DnsAdmins group is not empty and grant to its user the possibility to interact with the DNS Service.</p>
<strong>Advised Solution:</strong><p class="text-justify">Rule update:<br>
The Patch Tuesday of October 2021 fixed this vulnerability and assigned it the identifier CVE-2021-40469.<br>
If the patch has been applied, there is no additional mitigation to perform.<br>
<br>
This rule is transformed into an informative rule in PingCastle 2.10.1 and will be removed in future versions of PingCastle.<br>
<br>
You should remove the members of the Dns Admins group and do a proper delegation to the specific DNS Zones.<br>
<br>
First, grant only "Read Property", "List", "List object" and "Read permssions" to CN=MicrosoftDNS,CN=System to enable access to the RPC service.<br>
<br>
Then on each zone (the object in the tree below with the class dnsZone), grant "Read Property", "List", "List object", "Read permissions", "Create Child", "Delete Child", "Delete", "Delete Tree".      <br>
    </p><strong>Introduced in:</strong><p class="text-justify">2.9.0.0</p><strong>Points:</strong><p>Informative rule (0 point)</p>
<strong>Documentation:</strong><p><a href="https://medium.com/@esnesenon/feature-not-bug-dnsadmin-to-dc-compromise-in-one-line-a0f779b8dc83">https://medium.com/@esnesenon/feature-not-bug-dnsadmin-to-dc-compromise-in-one-line-a0f779b8dc83</a><br>
<a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-dnsp/007efcd2-2955-46dd-a59e-f83ae88f4678">https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-dnsp/007efcd2-2955-46dd-a59e-f83ae88f4678</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#dnsadmins">[FR]ANSSI - DnsAdmins group members (vuln4_dnsadmins)</a><span class="badge grade-4">4</span><br>
<a href="https://attack.mitre.org/mitigations/M1026">[MITRE]Mitre Att&amp;ck - Mitigation - Privileged Account Management</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesP-DNSDelegation"><a name="anchorrulesP-DNSDelegation"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-DNSDelegation" aria-expanded="false" aria-controls="rulesP-DNSDelegation">
          [M]Check if there is an explicit delegation on DNS servers. (P-DNSDelegation)
        </button>
      </span>

    </div>

    <div id="rulesP-DNSDelegation" class="collapse" aria-labelledby="headingrulesP-DNSDelegation" data-parent="#rulesACLCheck">
      <div class="card-body">
        <h3>Check if there is an explicit delegation on DNS servers.</h3>
<strong>Rule ID:</strong><p class="text-justify">P-DNSDelegation</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that no specific delegation has been setup to manage the Microsoft DNS.</p>
<strong>Technical Explanation:</strong><p class="text-justify">Administrators of the DNS Service have the possibility to inject a DLL in this service.<br>
However this service is hosted most of the time in the domain controller and is running as SYSTEM.<br>
That means that DNS Admins are potentially domain admins.<br>
<br>
The security descriptor used to grant admin rights is located on the nTSecurityDescriptor attribute of the object CN=MicrosoftDNS,CN=System.<br>
The "Write All Prop" access right induces the vulnerability.<br>
<br>
In this case, an explicit delegation has been setup and this delegation is not using the existing DnsAdmins group.</p>
<strong>Advised Solution:</strong><p class="text-justify">Rule update:<br>
The Patch Tuesday of October 2021 fixed this vulnerability and assigned it the identifier CVE-2021-40469.<br>
If the patch has been applied, there is no additional mitigation to perform.<br>
<br>
This rule is transformed into an informative rule in PingCastle 2.10.1 and will be removed in future versions of PingCastle.<br>
      <br>
      You should remove the explicit write delegation located in the CN=MicrosoftDNS,CN=System container and do a proper delegation.<br>
    First, grant only "Read Property", "List", "List object" and "Read permssions" to CN=MicrosoftDNS,CN=System to enable access to the RPC service.<br>
  Then on each zone (the object in the tree below with the class dnsZone), grant "Read Property", "List", "List object", "Read permissions", "Create Child", "Delete Child", "Delete", "Delete Tree".<br>
<br>
<br>
<br>
After the Patch day the key does exist. <br>
    </p><strong>Introduced in:</strong><p class="text-justify">2.8.0.0</p><strong>Points:</strong><p>Informative rule (0 point)</p>
<strong>Documentation:</strong><p><a href="https://medium.com/@esnesenon/feature-not-bug-dnsadmin-to-dc-compromise-in-one-line-a0f779b8dc83">https://medium.com/@esnesenon/feature-not-bug-dnsadmin-to-dc-compromise-in-one-line-a0f779b8dc83</a><br>
<a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-dnsp/007efcd2-2955-46dd-a59e-f83ae88f4678">https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-dnsp/007efcd2-2955-46dd-a59e-f83ae88f4678</a><br>
<a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-40469">https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-40469</a><br>
<a href="https://blog.0patch.com/2021/11/micropatch-for-remote-code-execution-by.html">https://blog.0patch.com/2021/11/micropatch-for-remote-code-execution-by.html</a><br>
<a href="https://attack.mitre.org/mitigations/M1026">[MITRE]Mitre Att&amp;ck - Mitigation - Privileged Account Management</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesP-DelegationLoginScript"><a name="anchorrulesP-DelegationLoginScript"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-DelegationLoginScript" aria-expanded="false" aria-controls="rulesP-DelegationLoginScript">
          [M]Ensure that all login scripts cannot be modified by any user (P-DelegationLoginScript)
        </button>
      </span>

    </div>

    <div id="rulesP-DelegationLoginScript" class="collapse" aria-labelledby="headingrulesP-DelegationLoginScript" data-parent="#rulesACLCheck">
      <div class="card-body">
        <h3>Ensure that all login scripts cannot be modified by any user</h3>
<strong>Rule ID:</strong><p class="text-justify">P-DelegationLoginScript</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that standard users cannot modify login scripts</p>
<strong>Technical Explanation:</strong><p class="text-justify">When the group Authenticated Users, Everyone or any similar groups have permission to modify a login script, it can be abused to take control of the accounts using this script. It can potentially lead to the compromise of the domain</p>
<strong>Advised Solution:</strong><p class="text-justify">Edit the Access Control List (ACL) of the script object or the directory where the file is located. Then remove any write permission given to the group.</p><strong>Introduced in:</strong><p class="text-justify">2.5.0.0</p><strong>Points:</strong><p>15 points per discovery</p>
<strong>Documentation:</strong><p><a href="https://www.ssi.gouv.fr/uploads/IMG/pdf/NP_ActiveDirectory_NoteTech.pdf#subsubsection.3.3.2">[FR]ANSSI - Recommandations de sécurité relatives à Active Directory - R18 [subsubsection.3.3.2]</a><br>
<a href="https://www.stigviewer.com/stig/active_directory_service_2003/2011-05-20/finding/V-2370">[US]STIG V-2370 - The access control permissions for the directory service site group policy must be configured to use the required access permissions.</a><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesP-DelegationKeyAdmin"><a name="anchorrulesP-DelegationKeyAdmin"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-DelegationKeyAdmin" aria-expanded="false" aria-controls="rulesP-DelegationKeyAdmin">
          [M][T]Ensure that bogus Windows Server 2016 AD prep did not introduce vulnerabilities (P-DelegationKeyAdmin)
        </button>
      </span>

    </div>

    <div id="rulesP-DelegationKeyAdmin" class="collapse" aria-labelledby="headingrulesP-DelegationKeyAdmin" data-parent="#rulesACLCheck">
      <div class="card-body">
        <h3>Ensure that bogus Windows Server 2016 AD prep did not introduce vulnerabilities</h3>
<strong>Rule ID:</strong><p class="text-justify">P-DelegationKeyAdmin</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that no weaknesses have been introduced following a Windows Server 2016 installation.</p>
<strong>Technical Explanation:</strong><p class="text-justify">After performing adprep /domainprep from Windows Server 2016 sources there may be an unwanted AccessControlEntry (ACE) in the DiscretionaryACL (DACL) of the targeted domain-naming-context's SecurityDescriptor (SD) that grants FullControl permission to the Enterprise Key Admins group ( SID = ending with -527 ).<br>
This is s a bug in ADPREP that was fixed in Windows Server 2016 RS3/1709. No official fix for those who used pre-1709.<br>
Note: The SID will only be resolvable after the PDC emulator role is transferred to a Windows Server 2016 domain controller.<br>
  </p>
<strong>Advised Solution:</strong><p class="text-justify">After having carefully studied the possible impact of the following change, apply the script made by MSRC and referenced in the documentation below to alter the permission.</p><strong>Introduced in:</strong><p class="text-justify">2.6.0.0</p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://itpro-tips.com/wp-content/uploads/files/TechnetGallery/Enterprise-Key-Admins-720eb270.zip">https://itpro-tips.com/wp-content/uploads/files/TechnetGallery/Enterprise-Key-Admins-720eb270.zip</a><br>
<a href="https://secureidentity.se/adprep-bug-in-windows-server-2016/">https://secureidentity.se/adprep-bug-in-windows-server-2016/</a><br>
<a href="https://www.ssi.gouv.fr/uploads/IMG/pdf/NP_ActiveDirectory_NoteTech.pdf#subsubsection.3.3.2">[FR]ANSSI - Recommandations de sécurité relatives à Active Directory - R18 [subsubsection.3.3.2]</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#adupdate_bad">[FR]ANSSI - Bad Active Directory versions (vuln2_adupdate_bad)</a><span class="badge grade-2">2</span><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a><br>
<a href="https://attack.mitre.org/techniques/T111">[MITRE]T111 Two-Factor Authentication Interception</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesP-ExchangePrivEsc"><a name="anchorrulesP-ExchangePrivEsc"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-ExchangePrivEsc" aria-expanded="false" aria-controls="rulesP-ExchangePrivEsc">
          [M]Ensure that Exchange did not introduce security vulnerabilities (P-ExchangePrivEsc)
        </button>
      </span>

    </div>

    <div id="rulesP-ExchangePrivEsc" class="collapse" aria-labelledby="headingrulesP-ExchangePrivEsc" data-parent="#rulesACLCheck">
      <div class="card-body">
        <h3>Ensure that Exchange did not introduce security vulnerabilities</h3>
<strong>Rule ID:</strong><p class="text-justify">P-ExchangePrivEsc</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that Exchange installation did not introduce privilege escalation vulnerabilities by modifying domain permissions</p>
<strong>Technical Explanation:</strong><p class="text-justify">When Exchange is installed, a set of permissions is modified to allow a deep Windows integration. A dependency analysis has shown that the permissions, that Exchange has set, introduced a possibility for privilege escalation.<br>
    The most basic exploitation is that a member of the group Exchange Windows Permissions can modify the security permission of the domain, granting itself the right Ds-Replication-Get-Changes-All.<br>
    This right allows the account to perform an attack named DCSync, which retrieves the hash of the krbtgt account. With this hash the attacker can then create a golden ticket and impersonate silently any user of the domain, including domain admins.<br>
    </p>
<strong>Advised Solution:</strong><p class="text-justify">Edit the root domain security descriptor. Identify the ACE giving the right ModifyDACL to the principal Exchange Windows Permissions. Go to the advanced settings and set the inheritance to Inherit Only.<br>
    <br>
Or run the PowerShell script Fix-DomainObjectDACL.ps1 referenced below.</p><strong>Introduced in:</strong><p class="text-justify">2.7.0.0</p><strong>Points:</strong><p>15 points per discovery</p>
<strong>Documentation:</strong><p><a href="https://github.com/gdedrouas/Exchange-AD-Privesc/blob/master/DomainObject/Fix-DomainObjectDACL.ps1">https://github.com/gdedrouas/Exchange-AD-Privesc/blob/master/DomainObject/Fix-DomainObjectDACL.ps1</a><br>
<a href="https://blogs.technet.microsoft.com/exchange/2019/02/12/released-february-2019-quarterly-exchange-updates/">https://blogs.technet.microsoft.com/exchange/2019/02/12/released-february-2019-quarterly-exchange-updates/</a><br>
<a href="https://support.microsoft.com/en-us/help/4490059/using-shared-permissions-model-to-run-exchange-server">https://support.microsoft.com/en-us/help/4490059/using-shared-permissions-model-to-run-exchange-server</a><br>
<a href="https://www.ssi.gouv.fr/uploads/IMG/pdf/NP_ActiveDirectory_NoteTech.pdf#subsubsection.3.3.2">[FR]ANSSI - Recommandations de sécurité relatives à Active Directory - R18 [subsubsection.3.3.2]</a><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesP-ExchangeAdminSDHolder"><a name="anchorrulesP-ExchangeAdminSDHolder"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-ExchangeAdminSDHolder" aria-expanded="false" aria-controls="rulesP-ExchangeAdminSDHolder">
          [M]Ensure that Exchange did not modify the AdminSDHolder object to introduce vulnerabilities (P-ExchangeAdminSDHolder)
        </button>
      </span>

    </div>

    <div id="rulesP-ExchangeAdminSDHolder" class="collapse" aria-labelledby="headingrulesP-ExchangeAdminSDHolder" data-parent="#rulesACLCheck">
      <div class="card-body">
        <h3>Ensure that Exchange did not modify the AdminSDHolder object to introduce vulnerabilities</h3>
<strong>Rule ID:</strong><p class="text-justify">P-ExchangeAdminSDHolder</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that no weakness has been introduced at Exchange installation.</p>
<strong>Technical Explanation:</strong><p class="text-justify">At install time, the Exchange Windows Permissions universal security group (USG) was granted the ability to modify the members attribute, the ability to change and reset passwords, and the ability to modify the permissions of any object protected by the AdminSDHolder role.<br>
    This security group includes all the Exchange servers.<br>
    As a consequence, a malicious administrator could elevate their privileges on one of the servers and thus gain control of the Active Directory forest.<br>
    Newest versions of Exchange do not introduce this security vulnerability.</p>
<strong>Advised Solution:</strong><p class="text-justify">After having carefully studied the possible impact of the following change, alter the AdminSDHolder permissions to remove the Exchange objects.</p><strong>Introduced in:</strong><p class="text-justify">2.6.0.0</p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://blogs.technet.microsoft.com/exchange/2009/09/23/exchange-2010-and-resolution-of-the-adminsdholder-elevation-issue/">https://blogs.technet.microsoft.com/exchange/2009/09/23/exchange-2010-and-resolution-of-the-adminsdholder-elevation-issue/</a><br>
<a href="https://www.ssi.gouv.fr/uploads/IMG/pdf/NP_ActiveDirectory_NoteTech.pdf#subsubsection.3.3.2">[FR]ANSSI - Recommandations de sécurité relatives à Active Directory - R18 [subsubsection.3.3.2]</a><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesP-DelegationFileDeployed"><a name="anchorrulesP-DelegationFileDeployed"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-DelegationFileDeployed" aria-expanded="false" aria-controls="rulesP-DelegationFileDeployed">
          [M]Ensure that files deployed by a GPO cannot be modified by everyone. (P-DelegationFileDeployed)
        </button>
      </span>

    </div>

    <div id="rulesP-DelegationFileDeployed" class="collapse" aria-labelledby="headingrulesP-DelegationFileDeployed" data-parent="#rulesACLCheck">
      <div class="card-body">
        <h3>Ensure that files deployed by a GPO cannot be modified by everyone.</h3>
<strong>Rule ID:</strong><p class="text-justify">P-DelegationFileDeployed</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that files deployed to computers cannot be changed by everyone.</p>
<strong>Technical Explanation:</strong><p class="text-justify">Applications and other files can be deployed by a GPO. If an attacker can modify one of these files, they may be able to compromise the user's account.</p>
<strong>Advised Solution:</strong><p class="text-justify">Locate the file mentioned by the GPO specified in Details and change its permissions.</p><strong>Introduced in:</strong><p class="text-justify">2.7.0.0</p><strong>Points:</strong><p>5 points per discovery</p>
<strong>Documentation:</strong><p><a href="https://www.ssi.gouv.fr/uploads/IMG/pdf/NP_ActiveDirectory_NoteTech.pdf#subsubsection.3.3.2">[FR]ANSSI - Recommandations de sécurité relatives à Active Directory - R18 [subsubsection.3.3.2]</a><br>
<a href="https://www.stigviewer.com/stig/active_directory_service_2003/2011-05-20/finding/V-2370">[US]STIG V-2370 - The access control permissions for the directory service site group policy must be configured to use the required access permissions.</a><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesP-DelegationGPOData"><a name="anchorrulesP-DelegationGPOData"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-DelegationGPOData" aria-expanded="false" aria-controls="rulesP-DelegationGPOData">
          [M]Ensure that GPO items cannot be modified by any user (P-DelegationGPOData)
        </button>
      </span>

    </div>

    <div id="rulesP-DelegationGPOData" class="collapse" aria-labelledby="headingrulesP-DelegationGPOData" data-parent="#rulesACLCheck">
      <div class="card-body">
        <h3>Ensure that GPO items cannot be modified by any user</h3>
<strong>Rule ID:</strong><p class="text-justify">P-DelegationGPOData</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that standard users cannot modify GPO</p>
<strong>Technical Explanation:</strong><p class="text-justify">When the group Authenticated Users, Everyone or any similar groups have permission to modify a GPO, it can be abused to take control of the accounts where this GPO applies. It can potentially lead to the compromise of the domain</p>
<strong>Advised Solution:</strong><p class="text-justify">Edit the Access Control List (ACL) of the GPO object or the directory where the items is located. Then remove any write permission given to the group.</p><strong>Introduced in:</strong><p class="text-justify">2.6.0.0</p><strong>Points:</strong><p>15 points per discovery</p>
<strong>Documentation:</strong><p><a href="https://www.ssi.gouv.fr/uploads/IMG/pdf/NP_ActiveDirectory_NoteTech.pdf#subsubsection.3.3.2">[FR]ANSSI - Recommandations de sécurité relatives à Active Directory - R18 [subsubsection.3.3.2]</a><br>
<a href="https://www.stigviewer.com/stig/active_directory_service_2003/2011-05-20/finding/V-2370">[US]STIG V-2370 - The access control permissions for the directory service site group policy must be configured to use the required access permissions.</a><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesP-DsHeuristicsAdminSDExMask"><a name="anchorrulesP-DsHeuristicsAdminSDExMask"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-DsHeuristicsAdminSDExMask" aria-expanded="false" aria-controls="rulesP-DsHeuristicsAdminSDExMask">
          [M]Ensure that the AdminSDHolder protection has not been disabled for some critical groups (P-DsHeuristicsAdminSDExMask)
        </button>
      </span>

    </div>

    <div id="rulesP-DsHeuristicsAdminSDExMask" class="collapse" aria-labelledby="headingrulesP-DsHeuristicsAdminSDExMask" data-parent="#rulesACLCheck">
      <div class="card-body">
        <h3>Ensure that the AdminSDHolder protection has not been disabled for some critical groups</h3>
<strong>Rule ID:</strong><p class="text-justify">P-DsHeuristicsAdminSDExMask</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that the AdminSDHolder mechanism has not been altered</p>
<strong>Technical Explanation:</strong><p class="text-justify">The AdminSDHolder service is a protection which prohibits an admin to lose control of the domain after a permission change or to introduce a weakness in the permissions.<br>
It proceeds by rewriting every 60 minutes the security descriptor of critical objects.<br>
<br>
By modifying the dsHeuristics attribute, this protection can be disabled for one or more critical group.<br>
Each critical group is associated with a value:<br>
Account Operators: 1,<br>
Server Operators: 2,<br>
Print Operators:4,<br>
Backup Operators: 8.<br>
The 16th character of dsHeuristics represents the sum of the values associated to the groups where the AdminSDHolder has been disabled.<br>
To disable it for the 'Backup Operators' and the 'Server Operators', the value is 8 + 2 = 0x0A = 'a'.<br>
</p>
<strong>Advised Solution:</strong><p class="text-justify">Find the dsHeuristics configuration which is located in CN=Directory Service,CN=Windows NT,CN=Services,CN=Configuration,DC=ad,DC=contoso,DC=com.<br>
    Then edit the 16th character and set it to zero.</p><strong>Introduced in:</strong><p class="text-justify">2.7.0.0</p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://www.petri.com/active-directory-security-understanding-adminsdholder-object">https://www.petri.com/active-directory-security-understanding-adminsdholder-object</a><br>
<a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/e5899be4-862e-496f-9a38-33950617d2c5">https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/e5899be4-862e-496f-9a38-33950617d2c5</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#dsheuristics_bad">[FR]ANSSI - Dangerous dsHeuristics settings (vuln1_dsheuristics_bad)</a><span class="badge grade-1">1</span><br>
<a href="https://attack.mitre.org/mitigations/M1026">[MITRE]Mitre Att&amp;ck - Mitigation - Privileged Account Management</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesP-LoginDCEveryone"><a name="anchorrulesP-LoginDCEveryone"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-LoginDCEveryone" aria-expanded="false" aria-controls="rulesP-LoginDCEveryone">
          [M]Ensure that the privilege to log on Domain Controllers are not granted to everyone by GPO (P-LoginDCEveryone)
        </button>
      </span>

    </div>

    <div id="rulesP-LoginDCEveryone" class="collapse" aria-labelledby="headingrulesP-LoginDCEveryone" data-parent="#rulesACLCheck">
      <div class="card-body">
        <h3>Ensure that the privilege to log on Domain Controllers are not granted to everyone by GPO</h3>
<strong>Rule ID:</strong><p class="text-justify">P-LoginDCEveryone</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that standard users cannot login to domain controllers</p>
<strong>Technical Explanation:</strong><p class="text-justify">Domain Controllers are critical components of the Active Directory. If an attacker is able to open a session, he will be able to discover insecure backup media or perform a local privilege escalation to become the DC admin and thus the AD admin.<br>
    Local logon requires usually physical interaction, which explains why network seggregation is a best practice, but this can be bypassed. Indeed, VNC or remote server management software is a way to perform local logon remotely.<br>
    In addition, remote server management software have been the subject of many vulnerabilites, some of them can be exploited even if this software is disabled.</p>
<strong>Advised Solution:</strong><p class="text-justify">Locate the GPO specified in Details and remove the privilege "Allow log on locally" or "Allow log on through Remote Desktop Services" to "Everyone", "Authenticated Users", "Domain Users" or "Domain Computers".<br>
The settings are located in :<br>
    Computer configuration -&gt; Policies -&gt; Windows Settings -&gt;Security Settings -&gt; Local Policies -&gt; User Rights Assignment.<br>
As an alternative, the file GptTmpl.inf can be manually edited.</p><strong>Introduced in:</strong><p class="text-justify">2.7.0.0</p><strong>Points:</strong><p>15 points per discovery</p>
<strong>Documentation:</strong><p><a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/allow-log-on-locally">https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/allow-log-on-locally</a><br>
<a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/allow-log-on-through-remote-desktop-services">https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/allow-log-on-through-remote-desktop-services</a><br>
<a href="https://support.hpe.com/hpsc/doc/public/display?docId=emr_na-c04197764-1">https://support.hpe.com/hpsc/doc/public/display?docId=emr_na-c04197764-1</a><br>
<a href="https://www.ssi.gouv.fr/uploads/IMG/pdf/NP_ActiveDirectory_NoteTech.pdf#subsubsection.3.3.2">[FR]ANSSI - Recommandations de sécurité relatives à Active Directory - R18 [subsubsection.3.3.2]</a><br>
<a href="https://attack.mitre.org/mitigations/M1026">[MITRE]Mitre Att&amp;ck - Mitigation - Privileged Account Management</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesP-RecoveryModeUnprotected"><a name="anchorrulesP-RecoveryModeUnprotected"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-RecoveryModeUnprotected" aria-expanded="false" aria-controls="rulesP-RecoveryModeUnprotected">
          [M]Ensure the "automatic administrative logon" feature of the recovery mode is not enabled (P-RecoveryModeUnprotected)
        </button>
      </span>

    </div>

    <div id="rulesP-RecoveryModeUnprotected" class="collapse" aria-labelledby="headingrulesP-RecoveryModeUnprotected" data-parent="#rulesACLCheck">
      <div class="card-body">
        <h3>Ensure the "automatic administrative logon" feature of the recovery mode is not enabled</h3>
<strong>Rule ID:</strong><p class="text-justify">P-RecoveryModeUnprotected</p>
<strong>Description:</strong><p class="text-justify">The purpose is to check that it is not possible to go into recovery mode without the administrator password</p>
<strong>Technical Explanation:</strong><p class="text-justify">The recovery mode is a special mode allowing an admin to fix an issue preventing the computer to boot. By pressing F8 in the short time span allowed, the computer boots with just a simple command line.<br>
    Usually, the administrator password is requested to avoid that people having physical access get control of it. It can typically be done by creating a new user account and add this account as member of the administrators group. This rule checks if there are GPOs which disable this password prompt.</p>
<strong>Advised Solution:</strong><p class="text-justify">Locate the GPO specified in Details and turn off the setting "Recovery console: Allow automatic administrative logon"<br>
The setting is located in :<br>
    Computer configuration -&gt; Policies -&gt; Windows Settings -&gt;Security Settings -&gt; Local Policies -&gt; Security Options.<br>
As an alternative, the file GptTmpl.inf can be manually edited.</p><strong>Introduced in:</strong><p class="text-justify">2.7.0.0</p><strong>Points:</strong><p>15 points if present</p>
<strong>Documentation:</strong><p><a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/recovery-console-allow-automatic-administrative-logon">https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/recovery-console-allow-automatic-administrative-logon</a><br>
<a href="https://www.stigviewer.com/stig/windows_7/2012-08-22/finding/V-1159">[US]STIG V-1159 - The Recovery Console option is set to permit automatic logon to the system.</a><br>
<a href="https://attack.mitre.org/mitigations/M1026">[MITRE]Mitre Att&amp;ck - Mitigation - Privileged Account Management</a></p>
    </div>
  </div></div></div>
			<!-- Accordion rulesACLCheck end -->

		<div class="row"><div class="col-lg-12 mt-3">
		<h3>Admin control
		</h3>

		<div class="row"><div class="col-lg-12">
		<p>It is important to know how much administrators are in place and to track the use of emergency accounts
		</p>

		<!-- Accordion rulesAdminControl -->
<div id="rulesAdminControl">
<div class="card">
    
    <div class="card-header" id="headingrulesP-Inactive"><a name="anchorrulesP-Inactive"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-Inactive" aria-expanded="false" aria-controls="rulesP-Inactive">
          [M]Check for inactive administrator accounts (P-Inactive)
        </button>
      </span>

    </div>

    <div id="rulesP-Inactive" class="collapse" aria-labelledby="headingrulesP-Inactive" data-parent="#rulesAdminControl">
      <div class="card-body">
        <h3>Check for inactive administrator accounts</h3>
<strong>Rule ID:</strong><p class="text-justify">P-Inactive</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that all Administrator Accounts in the AD are necessary and used</p>
<strong>Technical Explanation:</strong><p class="text-justify">Accounts within the AD have attributes indicating the creation date of the account and the last login of this account. Accounts which haven't have a login since 6 months or created more than 6 months ago without any login are considered inactive. If an Administrator Account is set as inactive, the reason for having Administrator rights should be strongly justified.</p>
<strong>Advised Solution:</strong><p class="text-justify">To correct the situation, you should make sure that all your Administrator Account(s) are "Active", meaning that you should remove Administrator rights if an account is set as not "Active"</p><strong>Points:</strong><p>30 points if the occurence is greater than or equals than 30<br>
then 20 points if the occurence is greater than or equals than 15</p>
<strong>Documentation:</strong><p><a href="https://www.ssi.gouv.fr/uploads/IMG/pdf/NP_ActiveDirectory_NoteTech.pdf#subsection.3.6">[FR]ANSSI - Recommandations de sécurité relatives à Active Directory - R36 [subsection.3.6]</a><br>
<a href="https://attack.mitre.org/mitigations/M1026">[MITRE]Mitre Att&amp;ck - Mitigation - Privileged Account Management</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesP-AdminLogin"><a name="anchorrulesP-AdminLogin"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-AdminLogin" aria-expanded="false" aria-controls="rulesP-AdminLogin">
          [M]Check for Native administrator usage (P-AdminLogin)
        </button>
      </span>

    </div>

    <div id="rulesP-AdminLogin" class="collapse" aria-labelledby="headingrulesP-AdminLogin" data-parent="#rulesAdminControl">
      <div class="card-body">
        <h3>Check for Native administrator usage</h3>
<strong>Rule ID:</strong><p class="text-justify">P-AdminLogin</p>
<strong>Description:</strong><p class="text-justify">The purpose is to verify if the Native Administrator account is used.</p>
<strong>Technical Explanation:</strong><p class="text-justify">The Native Administrator account is the main administrator account, and it is sharing its password with Directory Services Restore Mode password. Since it is the same password, it can be used to take control of the domain even if the account is disabled, notably through a DCSync attack. The last login date is retrieved through the LastLogonTimestamp LDAP attribute retrieved from the Active Directory. There is an exception for 35 days to avoid this rule to be triggered at the domain creation.</p>
<strong>Advised Solution:</strong><p class="text-justify">To mitigate the security risk, a good practice is to use the Native Administrator account only for emergency, while the daily work is performed through other accounts.<br>
    It is indeed strongly recommended to not use this account but to use nominative account for administrators and dedicated account for services.<br>
    Do note that the anomaly will be removed 35 days after the last native administrator login.<br>
  <br>
  To track where the administrator account has been used for the last time, we recommend to extract the attribute LastLogon of the administrator account on ALL domain controllers.<br>
  It can be done with tools such as ADSIEdit or ADExplorer.<br>
  Then, for each domain controller, extract the event ID 4624 at the date matching the LastLogon date. You will identify the computer and the process at the origin of the logon event.<br>
  <br>
  If the LastLogon attribute is older for ALL domain controllers than the LastLogonTimestamp, the LastLogonTimestamp attribute (that PingCastle relies on) may be updated by the Kerberos S4u2Self mechanism.<br>
  This can be triggered in the Advanced Security Settings properties of any securable objects such as a file, then select the Effective Access tab and click on View effective access.<br>
  You have to use replication metadata info to find which DC updated this attribute and look for the event IDs 4769 and 4624 on this DC to know who has run this action.<br>
  Read the page referenced in the documentation section for more information.<br>
  <br>
  Please note that PingCastle relies on the attribute LastLogonTimestamp to perform this check. The LastLogonTimestamp attribute is replicated but has a latency of a maximum of 14 days, while LastLogon is updated at each logon and is more accurate but not replicated.<br>
  The attribute ms-DS-Logon-Time-Sync-Interval can be used to lower or increase the replication delay.<br>
    </p><strong>Points:</strong><p>20 points if the occurence is strictly lower than 35</p>
<strong>Documentation:</strong><p><a href="https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices/implementing-least-privilege-administrative-models">https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices/implementing-least-privilege-administrative-models</a><br>
<a href="https://techcommunity.microsoft.com/t5/core-infrastructure-and-security/how-lastlogontimestamp-is-updated-with-kerberos-s4u2self/ba-p/257135">https://techcommunity.microsoft.com/t5/core-infrastructure-and-security/how-lastlogontimestamp-is-updated-with-kerberos-s4u2self/ba-p/257135</a><br>
<a href="https://attack.mitre.org/mitigations/M1026">[MITRE]Mitre Att&amp;ck - Mitigation - Privileged Account Management</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesP-AdminNum"><a name="anchorrulesP-AdminNum"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-AdminNum" aria-expanded="false" aria-controls="rulesP-AdminNum">
          [M]Check for number of Administrator accounts above the baseline (P-AdminNum)
        </button>
      </span>

    </div>

    <div id="rulesP-AdminNum" class="collapse" aria-labelledby="headingrulesP-AdminNum" data-parent="#rulesAdminControl">
      <div class="card-body">
        <h3>Check for number of Administrator accounts above the baseline</h3>
<strong>Rule ID:</strong><p class="text-justify">P-AdminNum</p>
<strong>Description:</strong><p class="text-justify">The purpose is to verify if the number of administrator accounts is not disproportionate. Very few users should have domain admin accounts.</p>
<strong>Technical Explanation:</strong><p class="text-justify">Every domain administrator represents a possible security breach, this is why it is strongly advised to have as few domain administrator accounts as possible</p>
<strong>Advised Solution:</strong><p class="text-justify">It is strongly advised to perform a review of which users have domain administrator rights, and to ensure that these rights are actually needed. Indeed, the end goal is to remove as much domain administrator as possible, as very few users actually need these high-level rights.<br>
    The rule is triggered if the number of cumulated privileged members is more than 50 accounts or if it represents more than 10 percent of the user accounts.<br>
  This rule is enabled only if the domain has more than 100 active users.</p><strong>Points:</strong><p>10 points if present</p>
<strong>Documentation:</strong><p><a href="https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices/implementing-least-privilege-administrative-models">https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices/implementing-least-privilege-administrative-models</a><br>
<a href="https://www.ssi.gouv.fr/uploads/IMG/pdf/NP_ActiveDirectory_NoteTech.pdf#subsection.3.5">[FR]ANSSI - Recommandations de sécurité relatives à Active Directory - R26 [subsection.3.5]</a><br>
<a href="https://www.ssi.gouv.fr/uploads/IMG/pdf/NP_ActiveDirectory_NoteTech.pdf#subsubsection.3.5.7">[FR]ANSSI - Recommandations de sécurité relatives à Active Directory - R30 [subsubsection.3.5.7]</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#privileged_members">[FR]ANSSI - Large privileged group member count (vuln1_privileged_members)</a><span class="badge grade-1">1</span><br>
<a href="https://attack.mitre.org/mitigations/M1026">[MITRE]Mitre Att&amp;ck - Mitigation - Privileged Account Management</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesP-OperatorsEmpty"><a name="anchorrulesP-OperatorsEmpty"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-OperatorsEmpty" aria-expanded="false" aria-controls="rulesP-OperatorsEmpty">
          [M]Check that the operator groups are empty (P-OperatorsEmpty)
        </button>
      </span>

    </div>

    <div id="rulesP-OperatorsEmpty" class="collapse" aria-labelledby="headingrulesP-OperatorsEmpty" data-parent="#rulesAdminControl">
      <div class="card-body">
        <h3>Check that the operator groups are empty</h3>
<strong>Rule ID:</strong><p class="text-justify">P-OperatorsEmpty</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that the operator groups, which can have indirect control to the domain, are empty</p>
<strong>Technical Explanation:</strong><p class="text-justify">Operator groups (Account Operators, Server Operators, ...) can take indirect control of the domain. Indeed, these groups have write access to critical resources of the domain.</p>
<strong>Advised Solution:</strong><p class="text-justify">It is recommended to have these groups empty. Assign administrators into administrators group. Other accounts should have proper delegation rights in an OU or in the scope they are managing.</p><strong>Points:</strong><p>Informative rule (0 point)</p>
<strong>Documentation:</strong><p><a href="https://www.ssi.gouv.fr/uploads/IMG/pdf/NP_ActiveDirectory_NoteTech.pdf#subsection.3.5">[FR]ANSSI - Recommandations de sécurité relatives à Active Directory - R27 [subsection.3.5]</a><br>
<a href="https://attack.mitre.org/mitigations/M1026">[MITRE]Mitre Att&amp;ck - Mitigation - Privileged Account Management</a></p>
    </div>
  </div></div></div>
			<!-- Accordion rulesAdminControl end -->

		<div class="row"><div class="col-lg-12 mt-3">
		<h3>Control paths
		</h3>

		<div class="row"><div class="col-lg-12">
		<p>Permissions granted to someone can be difficult to analyze. Hackers use this fact to chain multiple permission leaks in order to gain control of the domain.
		</p>

		<!-- Accordion rulesControlPath -->
<div id="rulesControlPath">
<div class="card">
    
    <div class="card-header" id="headingrulesP-AdminEmailOn"><a name="anchorrulesP-AdminEmailOn"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-AdminEmailOn" aria-expanded="false" aria-controls="rulesP-AdminEmailOn">
          [M]Check if administrator accounts are email enabled. (P-AdminEmailOn)
        </button>
      </span>

    </div>

    <div id="rulesP-AdminEmailOn" class="collapse" aria-labelledby="headingrulesP-AdminEmailOn" data-parent="#rulesControlPath">
      <div class="card-body">
        <h3>Check if administrator accounts are email enabled.</h3>
<strong>Rule ID:</strong><p class="text-justify">P-AdminEmailOn</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure proper isolation of administrative activities and to prevent any admin from having an email address configured in the domain.</p>
<strong>Technical Explanation:</strong><p class="text-justify">The recommended approach for secure administration is to implement a Tier Zero model.<br>
    In this model, low privileged actions cannot be made by highly privileged accounts such as admins.<br>
    This means that, in practice, administrators should have two separate Windows accounts: one for regular activities and one for performing privileged actions.<br>
    </p>
<strong>Advised Solution:</strong><p class="text-justify">Ensure that administrators do not use the privileged account for browsing the internet or receiving emails.<br>
    We highly recommend that you implement this practice to lower the risk of an admin compromise.<br>
    <br>
      To remove this alert, you have to edit the properties of the user account and clear the email attribute.<br>
      Keep in mind that this action will silence the alert, but the risk may still be present.<br>
  </p><strong>Introduced in:</strong><p class="text-justify">3.1.0.0</p><strong>Points:</strong><p>Informative rule (0 point)</p>
<strong>Documentation:</strong><p><a href="https://techcommunity.microsoft.com/t5/core-infrastructure-and-security/securing-privileged-access-for-the-ad-admin-part-1/ba-p/259166">https://techcommunity.microsoft.com/t5/core-infrastructure-and-security/securing-privileged-access-for-the-ad-admin-part-1/ba-p/259166</a><br>
<a href="https://attack.mitre.org/mitigations/M1026">[MITRE]Mitre Att&amp;ck - Mitigation - Privileged Account Management</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesP-ControlPathIndirectEveryone"><a name="anchorrulesP-ControlPathIndirectEveryone"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-ControlPathIndirectEveryone" aria-expanded="false" aria-controls="rulesP-ControlPathIndirectEveryone">
          [T]Check if there is a control path involving everyone-like groups. (P-ControlPathIndirectEveryone)
        </button>
      </span>

    </div>

    <div id="rulesP-ControlPathIndirectEveryone" class="collapse" aria-labelledby="headingrulesP-ControlPathIndirectEveryone" data-parent="#rulesControlPath">
      <div class="card-body">
        <h3>Check if there is a control path involving everyone-like groups.</h3>
<strong>Rule ID:</strong><p class="text-justify">P-ControlPathIndirectEveryone</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that there is no control path involving everyone.</p>
<strong>Technical Explanation:</strong><p class="text-justify"><br>
      If you have access to a key server and the helpdesk can reset your password, then the helpdesk has access to the key server.<br>
This is the kind of logic used by hackers to take control of the domain using key infrastructure objects (domain root, ...) or groups (domain administrators, ...).<br>
Permissions are collected and analyzed to produce a control paths analysis.<br>
Only write permissions (and specific ones) are used for this analysis.<br>
Then the program identifies which users or computers, that are not members of known groups, can take control of this object.<br>
To be fast, some tradeoffs have been selected. For example, logged on users on servers are ignored.<br>
The program may also select paths which are not exploitable and ignore paths if it cannot read every permissions.<br>
[Everyone] includes the user groups Anonymous, Everyone, Authenticated Users, Domain Users, Domain Computers and Builtin.<br>
    </p>
<strong>Advised Solution:</strong><p class="text-justify">You should analyze the chart and determine which underlying object is involved and grants write permissions to everyone.<br>
    Then edit the permissions and locate the write permission involved.<br>
    Then delete it or replace it according to your delegation model.</p><strong>Introduced in:</strong><p class="text-justify">2.8.0.0</p><strong>Points:</strong><p>25 points if present</p>
<strong>Documentation:</strong><p><a href="https://github.com/BloodHoundAD/BloodHound">https://github.com/BloodHoundAD/BloodHound</a><br>
<a href="https://github.com/ANSSI-FR/AD-control-paths">https://github.com/ANSSI-FR/AD-control-paths</a><br>
<a href="https://attack.mitre.org/techniques/T1069/002">[MITRE]T1069.002 Permission Groups Discovery: Domain Groups</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesP-ControlPathIndirectMany"><a name="anchorrulesP-ControlPathIndirectMany"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-ControlPathIndirectMany" aria-expanded="false" aria-controls="rulesP-ControlPathIndirectMany">
          [T]Check if there is a control path involving too many users or computers. (P-ControlPathIndirectMany)
        </button>
      </span>

    </div>

    <div id="rulesP-ControlPathIndirectMany" class="collapse" aria-labelledby="headingrulesP-ControlPathIndirectMany" data-parent="#rulesControlPath">
      <div class="card-body">
        <h3>Check if there is a control path involving too many users or computers.</h3>
<strong>Rule ID:</strong><p class="text-justify">P-ControlPathIndirectMany</p>
<strong>Description:</strong><p class="text-justify">The purpose is to check if users can abuse their write access to obtain additional privileges.</p>
<strong>Technical Explanation:</strong><p class="text-justify"><br>
      If you have access to a key server and the helpdesk can reset your password, then the helpdesk has access to the key server.<br>
This is the kind of logic used by hackers to take control of the domain using key infrastructure objects (domain root, ...) or groups (domain administrators, ...).<br>
Permissions are collected and analyzed to produce a control paths analysis.<br>
Only write permissions (and specific ones) are used for this analysis.<br>
Then the program identifies which users or computers, that are not members of known groups, can take control of this object.<br>
To be fast, some tradeoffs have been selected. For example, logged on users on servers are ignored.<br>
The program may also select paths which are not exploitable and ignore paths if it cannot read every permissions.<br>
    </p>
<strong>Advised Solution:</strong><p class="text-justify">You should analyze the chart and determine which underlying object is involved and grants too much write permissions.<br>
    Then edit the permissions and locate the write permission involved.<br>
    Then delete it or replace it according to your delegation model.</p><strong>Introduced in:</strong><p class="text-justify">2.8.0.0</p><strong>Points:</strong><p>25 points if the occurence is greater than or equals than 200<br>
then 15 points if the occurence is greater than or equals than 100<br>
then 10 points if the occurence is greater than or equals than 50<br>
then 5 points if the occurence is greater than or equals than 20</p>
<strong>Documentation:</strong><p><a href="https://github.com/BloodHoundAD/BloodHound">https://github.com/BloodHoundAD/BloodHound</a><br>
<a href="https://github.com/ANSSI-FR/AD-control-paths">https://github.com/ANSSI-FR/AD-control-paths</a><br>
<a href="https://attack.mitre.org/techniques/T1069/002">[MITRE]T1069.002 Permission Groups Discovery: Domain Groups</a></p>
    </div>
  </div></div></div>
			<!-- Accordion rulesControlPath end -->

		<div class="row"><div class="col-lg-12 mt-3">
		<h3>Delegation Check
		</h3>

		<div class="row"><div class="col-lg-12">
		<p>Delegations are very complex to understand and may grant more privileges than initially thought.
		</p>

		<!-- Accordion rulesDelegationCheck -->
<div id="rulesDelegationCheck">
<div class="card">
    
    <div class="card-header" id="headingrulesP-DelegationEveryone"><a name="anchorrulesP-DelegationEveryone"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-DelegationEveryone" aria-expanded="false" aria-controls="rulesP-DelegationEveryone">
          [M][T]A Delegation is granted to Everyone (P-DelegationEveryone)
        </button>
      </span>

    </div>

    <div id="rulesP-DelegationEveryone" class="collapse" aria-labelledby="headingrulesP-DelegationEveryone" data-parent="#rulesDelegationCheck">
      <div class="card-body">
        <h3>A Delegation is granted to Everyone</h3>
<strong>Rule ID:</strong><p class="text-justify">P-DelegationEveryone</p>
<strong>Description:</strong><p class="text-justify">The purpose is to verify that there is no delegation granted to "Everyone" or to "Authenticated Users"</p>
<strong>Technical Explanation:</strong><p class="text-justify">To delegate control to a OU, access checks can be modified. In case of a misconfiguration, access can be granted to the group "Everyone" or "Authenticated Users".</p>
<strong>Advised Solution:</strong><p class="text-justify">Review the delegation to remove this permission and if needed, set a more targeted group as recipient of the delegation.</p><strong>Points:</strong><p>15 points per discovery</p>
<strong>Documentation:</strong><p><a href="https://www.ssi.gouv.fr/uploads/IMG/pdf/NP_ActiveDirectory_NoteTech.pdf#subsubsection.3.3.2">[FR]ANSSI - Recommandations de sécurité relatives à Active Directory - R18 [subsubsection.3.3.2]</a><br>
<a href="https://www.stigviewer.com/stig/active_directory_service_2003/2011-05-20/finding/V-2370">[US]STIG V-2370 - The access control permissions for the directory service site group policy must be configured to use the required access permissions.</a><br>
<a href="https://attack.mitre.org/techniques/T1187">[MITRE]T1187 Forced Authentication</a><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesP-UnkownDelegation"><a name="anchorrulesP-UnkownDelegation"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-UnkownDelegation" aria-expanded="false" aria-controls="rulesP-UnkownDelegation">
          [M][T]Check delegations for the recipient's existence (P-UnkownDelegation)
        </button>
      </span>

    </div>

    <div id="rulesP-UnkownDelegation" class="collapse" aria-labelledby="headingrulesP-UnkownDelegation" data-parent="#rulesDelegationCheck">
      <div class="card-body">
        <h3>Check delegations for the recipient's existence</h3>
<strong>Rule ID:</strong><p class="text-justify">P-UnkownDelegation</p>
<strong>Description:</strong><p class="text-justify">The purpose is to verify that each delegation is linked to an account which exists</p>
<strong>Technical Explanation:</strong><p class="text-justify">In the case where a delegation has been created, where the account can't be translated to a NT account, it means that the delegation is actually from another domain or that the user has been deleted. </p>
<strong>Advised Solution:</strong><p class="text-justify">To reduce the risk, the easiest way is essentially to remove the delegation</p><strong>Points:</strong><p>15 points if present</p>
<strong>Documentation:</strong><p><a href="https://www.stigviewer.com/stig/active_directory_service_2003/2011-05-20/finding/V-2370">[US]STIG V-2370 - The access control permissions for the directory service site group policy must be configured to use the required access permissions.</a><br>
<a href="https://attack.mitre.org/techniques/T1187">[MITRE]T1187 Forced Authentication</a><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesP-DelegationDCt2a4d"><a name="anchorrulesP-DelegationDCt2a4d"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-DelegationDCt2a4d" aria-expanded="false" aria-controls="rulesP-DelegationDCt2a4d">
          [M][T]Check if all DC have no constrained delegation with protocol transition. (P-DelegationDCt2a4d)
        </button>
      </span>

    </div>

    <div id="rulesP-DelegationDCt2a4d" class="collapse" aria-labelledby="headingrulesP-DelegationDCt2a4d" data-parent="#rulesDelegationCheck">
      <div class="card-body">
        <h3>Check if all DC have no constrained delegation with protocol transition.</h3>
<strong>Rule ID:</strong><p class="text-justify">P-DelegationDCt2a4d</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that no constrained delegations with protocol transition are applied to DC</p>
<strong>Technical Explanation:</strong><p class="text-justify">A constrained delegation with protocol transition is a delegation with some limitation.<br>
    In this case, it is a limitation of the technical service a delegate can call (SPN).<br>
    But in practice, the specific service name is not checked and the delegate can impersonate anyone on all services of a computer.<br>
    For the case of a domain controller, that means that the delegate can take the control of the domain by impersonating a domain admin and doing modifications with the LDAP service.<br>
    This delegation is set via the attribute msDS-AllowedToDelegateTo.<br>
    The protocol transition is a special feature set in the userAccountControl which does not limit the delegation to the Kerberos protocol.<br>
    Note: this rule is a companion of the rule P-DelegationDCa2d2<br>
</p>
<strong>Advised Solution:</strong><p class="text-justify">You should edit the msDS-AllowedToDelegateTo attribute of the accounts listed below to remove the SPN of the domain controllers involved.<br>
    </p><strong>Introduced in:</strong><p class="text-justify">2.9.0.0</p><strong>Points:</strong><p>25 points per discovery</p>
<strong>Documentation:</strong><p><a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#delegation_t2a4d">[FR]ANSSI - Constrained delegation with protocol transition to a domain controller service (vuln1_delegation_t2a4d)</a><span class="badge grade-1">1</span><br>
<a href="https://attack.mitre.org/techniques/T1187">[MITRE]T1187 Forced Authentication</a><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesP-DelegationDCa2d2"><a name="anchorrulesP-DelegationDCa2d2"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-DelegationDCa2d2" aria-expanded="false" aria-controls="rulesP-DelegationDCa2d2">
          [M][T]Check if all DC have no constrained delegation. (P-DelegationDCa2d2)
        </button>
      </span>

    </div>

    <div id="rulesP-DelegationDCa2d2" class="collapse" aria-labelledby="headingrulesP-DelegationDCa2d2" data-parent="#rulesDelegationCheck">
      <div class="card-body">
        <h3>Check if all DC have no constrained delegation.</h3>
<strong>Rule ID:</strong><p class="text-justify">P-DelegationDCa2d2</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that no constrained delegations are applied to DC</p>
<strong>Technical Explanation:</strong><p class="text-justify">A constrained delegation is a delegation with some limitation.<br>
    In this case, it is a limitation of the technical service a delegate can call (SPN).<br>
    But in practice, the specific service name is not checked and the delegate can impersonate anyone on all services of a computer.<br>
    For the case of a domain controller, that means that the delegate can take the control of the domain by impersonating a domain admin and doing modifications with the LDAP service.<br>
    This delegation is set via the attribute msDS-AllowedToDelegateTo and is limited to Kerberos<br>
    Note: this rule is a companion of the rule P-DelegationDCt2a4d<br>
</p>
<strong>Advised Solution:</strong><p class="text-justify">You should edit the msDS-AllowedToDelegateTo attribute of the accounts listed below to remove the SPN of the domain controllers involved.<br>
    </p><strong>Introduced in:</strong><p class="text-justify">2.9.0.0</p><strong>Points:</strong><p>25 points per discovery</p>
<strong>Documentation:</strong><p><a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#delegation_a2d2">[FR]ANSSI - Constrained authentication delegation to a domain controller service (vuln1_delegation_a2d2)</a><span class="badge grade-1">1</span><br>
<a href="https://attack.mitre.org/techniques/T1187">[MITRE]T1187 Forced Authentication</a><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesP-DelegationDCsourcedeleg"><a name="anchorrulesP-DelegationDCsourcedeleg"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-DelegationDCsourcedeleg" aria-expanded="false" aria-controls="rulesP-DelegationDCsourcedeleg">
          [M][T]Check if all DC have no resource based constrained delegation. (P-DelegationDCsourcedeleg)
        </button>
      </span>

    </div>

    <div id="rulesP-DelegationDCsourcedeleg" class="collapse" aria-labelledby="headingrulesP-DelegationDCsourcedeleg" data-parent="#rulesDelegationCheck">
      <div class="card-body">
        <h3>Check if all DC have no resource based constrained delegation.</h3>
<strong>Rule ID:</strong><p class="text-justify">P-DelegationDCsourcedeleg</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that no resource based constrained delegations are applied to DC</p>
<strong>Technical Explanation:</strong><p class="text-justify">Resource based constrained delegation are a new feature of Windows Server 2012 which tries to handle the limitation of Constrained delegations.<br>
    This delegation is defined by setting the msDS-AllowedToDelegateToattribute attribute either using the GUI or a PowerShell command.<br>
</p>
<strong>Advised Solution:</strong><p class="text-justify">You should edit the msDS-AllowedToDelegateToattribute attribute of the domain controllers and remove the account involved.<br>
    You can do this with the PowerShell command:<br>
    Set-ADComputer COMPUTER -PrincipalsAllowedToDelegateToAccount $Null<br>
    </p><strong>Introduced in:</strong><p class="text-justify">2.9.0.0</p><strong>Points:</strong><p>25 points per discovery</p>
<strong>Documentation:</strong><p><a href="https://blog.stealthbits.com/resource-based-constrained-delegation-abuse/">https://blog.stealthbits.com/resource-based-constrained-delegation-abuse/</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#delegation_sourcedeleg">[FR]ANSSI - Resource-based constrained delegation on domain controlers (vuln1_delegation_sourcedeleg)</a><span class="badge grade-1">1</span><br>
<a href="https://attack.mitre.org/techniques/T1187">[MITRE]T1187 Forced Authentication</a><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesP-UnconstrainedDelegation"><a name="anchorrulesP-UnconstrainedDelegation"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-UnconstrainedDelegation" aria-expanded="false" aria-controls="rulesP-UnconstrainedDelegation">
          [M][T]Ensure that no accounts are subject to unconstrained delegation (P-UnconstrainedDelegation)
        </button>
      </span>

    </div>

    <div id="rulesP-UnconstrainedDelegation" class="collapse" aria-labelledby="headingrulesP-UnconstrainedDelegation" data-parent="#rulesDelegationCheck">
      <div class="card-body">
        <h3>Ensure that no accounts are subject to unconstrained delegation</h3>
<strong>Rule ID:</strong><p class="text-justify">P-UnconstrainedDelegation</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that no account can impersonate any account.</p>
<strong>Technical Explanation:</strong><p class="text-justify">When an unconstrained delegation is configured, the Kerberos ticket TGT can be captured. This TGT grant then access to any service the user has access. If the user is an administrator or a domain controller (a connection can be forced using the spooler service), the domain can be compromised.</p>
<strong>Advised Solution:</strong><p class="text-justify">Replace unconstrained delegation by constrained delegation. In practice, on the account object, tab "delegation", replace "trust this computer for delegation to any service" by "trust this computer for delegation to specified services only".</p><strong>Introduced in:</strong><p class="text-justify">2.6.0.0</p><strong>Points:</strong><p>5 points per discovery</p>
<strong>Documentation:</strong><p><a href="https://blogs.technet.microsoft.com/389thoughts/2017/04/18/get-rid-of-accounts-that-use-kerberos-unconstrained-delegation/">https://blogs.technet.microsoft.com/389thoughts/2017/04/18/get-rid-of-accounts-that-use-kerberos-unconstrained-delegation/</a><br>
<a href="https://adsecurity.org/?p=1667">https://adsecurity.org/?p=1667</a><br>
<a href="https://www.ssi.gouv.fr/uploads/IMG/pdf/NP_ActiveDirectory_NoteTech.pdf#subsubsection.3.3.2">[FR]ANSSI - Recommandations de sécurité relatives à Active Directory - R18 [subsubsection.3.3.2]</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#delegation_t4d">[FR]ANSSI - Unconstrained authentication delegation (vuln2_delegation_t4d)</a><span class="badge grade-2">2</span><br>
<a href="https://attack.mitre.org/techniques/T1187">[MITRE]T1187 Forced Authentication</a><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a></p>
    </div>
  </div></div></div>
			<!-- Accordion rulesDelegationCheck end -->

		<div class="row"><div class="col-lg-12 mt-3">
		<h3>Irreversible change
		</h3>

		<div class="row"><div class="col-lg-12">
		<p>Most of the changes can be reversed. Some not, and it can break the domain.
		</p>

		<!-- Accordion rulesIrreversibleChange -->
<div id="rulesIrreversibleChange">
<div class="card">
    
    <div class="card-header" id="headingrulesP-SchemaAdmin"><a name="anchorrulesP-SchemaAdmin"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-SchemaAdmin" aria-expanded="false" aria-controls="rulesP-SchemaAdmin">
          [M]Avoid unexpected schema modifications which could result in domain rebuild (P-SchemaAdmin)
        </button>
      </span>

    </div>

    <div id="rulesP-SchemaAdmin" class="collapse" aria-labelledby="headingrulesP-SchemaAdmin" data-parent="#rulesIrreversibleChange">
      <div class="card-body">
        <h3>Avoid unexpected schema modifications which could result in domain rebuild</h3>
<strong>Rule ID:</strong><p class="text-justify">P-SchemaAdmin</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that no account can make unexpected modifications to the schema</p>
<strong>Technical Explanation:</strong><p class="text-justify">The group "Schema Admins" is used to give permissions to alter the schema. Once a modification is performed on the schema such as new objects, it cannot be undone. This can result in a rebuild of the domain. The best practice is to have this group empty and to add an administrator when a schema update is required, then remove this group membership.</p>
<strong>Advised Solution:</strong><p class="text-justify">Remove the accounts or groups belonging to the "schema administrators" group.</p><strong>Points:</strong><p>10 points if present</p>
<strong>Documentation:</strong><p><a href="https://www.stigviewer.com/stig/active_directory_forest/2016-12-19/finding/V-72835">[US]STIG V-72835 - Membership to the Schema Admins group must be limited</a><br>
<a href="https://www.ssi.gouv.fr/uploads/IMG/pdf/NP_ActiveDirectory_NoteTech.pdf#subsection.3.2">[FR]ANSSI - Recommandations de sécurité relatives à Active Directory - R13 [subsection.3.2]</a><br>
<a href="https://attack.mitre.org/mitigations/M1026">[MITRE]Mitre Att&amp;ck - Mitigation - Privileged Account Management</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesP-UnprotectedOU"><a name="anchorrulesP-UnprotectedOU"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-UnprotectedOU" aria-expanded="false" aria-controls="rulesP-UnprotectedOU">
          [M]Check if OUs and Containers are protected from accidental deletion. (P-UnprotectedOU)
        </button>
      </span>

    </div>

    <div id="rulesP-UnprotectedOU" class="collapse" aria-labelledby="headingrulesP-UnprotectedOU" data-parent="#rulesIrreversibleChange">
      <div class="card-body">
        <h3>Check if OUs and Containers are protected from accidental deletion.</h3>
<strong>Rule ID:</strong><p class="text-justify">P-UnprotectedOU</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that Organizational Units (OUs) and Containers in Active Directory are protected to prevent accidental deletion, which could lead to data loss and disruptions in the network infrastructure.</p>
<strong>Technical Explanation:</strong><p class="text-justify">In Active Directory, Organizational Units can be protected from accidental deletion (reads: using the del key in the wrong place at the wrong time).<br>
    This way these objects cannot be deleted, unless the protection is removed. This Active Directory feature was first introduced in Windows Server 2008.<br>
    <br>
    This protection consists of a Deny ACE added to the NTSecurityDescriptor attribute applied to Everyone with the flag set to Delete and DeleteTree.<br>
    </p>
<strong>Advised Solution:</strong><p class="text-justify">To safeguard against accidental deletions, it is essential to enable the "Protect object from accidental deletion" option for critical OUs and Containers.<br>
    When this option is enabled, it adds an additional layer of security, preventing unintended deletions.<br>
  To implement this protection:<br>
<br>
* Open the Active Directory Users and Computers management console.<br>
* Locate the OU or Container that requires protection.<br>
* Right-click on the OU or Container, select "Properties."<br>
* In the "Object" tab, check the "Protect object from accidental deletion" option.<br>
* Click "Apply" and then "OK" to save the changes.<br>
    <br>
    You can list unprotected OU using the PowerShell command:<br>
  <i>Get-ADOrganizationalUnit -filter {name -like "*"} -Properties ProtectedFromAccidentalDeletion | format-table Name,ProtectedFromAccidentalDeletion</i><br>
  and protect them using the command:<br>
  <i>Get-ADOrganizationalUnit -filter {name -like "*"} -Properties ProtectedFromAccidentalDeletion | where {$_.ProtectedFromAccidentalDeletion -eq $false} | Set-ADOrganizationalUnit -ProtectedFromAccidentalDeletion $true</i><br>
  <br>
      Note: only 10 will be listed below. Checkout the Delegations section for the complete list.<br>
  </p><strong>Introduced in:</strong><p class="text-justify">3.1.0.0</p><strong>Points:</strong><p>Informative rule (0 point)</p>
<strong>Documentation:</strong><p><a href="https://dirteam.com/sander/2011/07/13/preventing-ous-and-containers-from-accidental-deletion/">https://dirteam.com/sander/2011/07/13/preventing-ous-and-containers-from-accidental-deletion/</a><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesP-RecycleBin"><a name="anchorrulesP-RecycleBin"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-RecycleBin" aria-expanded="false" aria-controls="rulesP-RecycleBin">
          [M]Ensure that the Recycle Bin feature is enabled (P-RecycleBin)
        </button>
      </span>

    </div>

    <div id="rulesP-RecycleBin" class="collapse" aria-labelledby="headingrulesP-RecycleBin" data-parent="#rulesIrreversibleChange">
      <div class="card-body">
        <h3>Ensure that the Recycle Bin feature is enabled</h3>
<strong>Rule ID:</strong><p class="text-justify">P-RecycleBin</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that the Recycle Bin feature is enabled</p>
<strong>Technical Explanation:</strong><p class="text-justify">The Recycle Bin avoids immediate deletion of objects (which can still be partially recovered by its tombstone). This lowers the administration work needed to restore. It also extends the period where traces are available when an investigation is needed.</p>
<strong>Advised Solution:</strong><p class="text-justify">First, be sure that the forest level is at least Windows Server 2008 R2.<br>
    You can check it with Get-ADForest or in the <a href="https://www.pingcastle.com/PingCastleFiles/ad_hc_rules_list.html#domaininformation">Domain Information</a> section.<br>
  Then you can enable it using the PowerShell command:<br>
Enable-ADOptionalFeature -Identity 'Recycle Bin Feature' -Scope ForestOrConfigurationSet -Target 'test.mysmartlogon.com'</p><strong>Introduced in:</strong><p class="text-justify">2.7.0.0</p><strong>Points:</strong><p>10 points if present</p>
<strong>Documentation:</strong><p><a href="https://enterinit.com/powershell-enable-active-directory-recycle-bin">https://enterinit.com/powershell-enable-active-directory-recycle-bin</a><br>
<a href="https://attack.mitre.org/mitigations/M1047">[MITRE]Mitre Att&amp;ck - Mitigation - Audit</a></p>
    </div>
  </div></div></div>
			<!-- Accordion rulesIrreversibleChange end -->

		<div class="row"><div class="col-lg-12 mt-3">
		<h3>Privilege control
		</h3>

		<div class="row"><div class="col-lg-12">
		<p>Privileges are granted to special groups to perform their duty. Sometimes, these privileges can be used to take control of the domain.
		</p>

		<!-- Accordion rulesPrivilegeControl -->
<div id="rulesPrivilegeControl">
<div class="card">
    
    <div class="card-header" id="headingrulesP-ServiceDomainAdmin"><a name="anchorrulesP-ServiceDomainAdmin"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-ServiceDomainAdmin" aria-expanded="false" aria-controls="rulesP-ServiceDomainAdmin">
          [M][T]Check if Service Accounts (aka accounts with never expiring password) are domain administrators (P-ServiceDomainAdmin)
        </button>
      </span>

    </div>

    <div id="rulesP-ServiceDomainAdmin" class="collapse" aria-labelledby="headingrulesP-ServiceDomainAdmin" data-parent="#rulesPrivilegeControl">
      <div class="card-body">
        <h3>Check if Service Accounts (aka accounts with never expiring password) are domain administrators</h3>
<strong>Rule ID:</strong><p class="text-justify">P-ServiceDomainAdmin</p>
<strong>Description:</strong><p class="text-justify">The purpose is to check for accounts with non-expiring passwords in the "Domain Administrator" group</p>
<strong>Technical Explanation:</strong><p class="text-justify">PingCastle is checking accounts with never expiring password, that are mostly used as service accounts.<br>
    "Service Accounts" can imply a high security risk as their password are stored in clear text in the LSA database, which can then be easily exploited using Mimikatz or Cain&amp;Abel for instance. In addition, their passwords don't change and can be used in Kerberoast attacks.</p>
<strong>Advised Solution:</strong><p class="text-justify">Accounts with never expiring passwords are mostly service accounts. <br>
    To mitigate the security risk, it is strongly advised to lower the privileges of the "Service Accounts", meaning that they should be removed from the "Domain Administrator" group, while ensuring that the password of each and every "Service Account" is longer than 20 characters</p><strong>Points:</strong><p>15 points if the occurence is greater than or equals than 2</p>
<strong>Documentation:</strong><p><a href="https://www.stigviewer.com/stig/active_directory_domain/2017-12-15/finding/V-36432">[US]STIG V-36432 - Membership to the Domain Admins group must be restricted to accounts used only to manage the Active Directory domain and domain controllers.</a><br>
<a href="https://www.ssi.gouv.fr/uploads/IMG/pdf/NP_ActiveDirectory_NoteTech.pdf#subsection.2.5">[FR]ANSSI - Recommandations de sécurité relatives à Active Directory - R11 [subsection.2.5]</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#dont_expire_priv">[FR]ANSSI - Privileged accounts with never-expiring passwords (vuln1_dont_expire_priv)</a><span class="badge grade-1">1</span><br>
<a href="https://attack.mitre.org/mitigations/M1026">[MITRE]Mitre Att&amp;ck - Mitigation - Privileged Account Management</a><br>
<a href="https://attack.mitre.org/techniques/T1003/004">[MITRE]T1003.004 OS Credential Dumping: LSA Secrets</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesP-TrustedCredManAccessPrivilege"><a name="anchorrulesP-TrustedCredManAccessPrivilege"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-TrustedCredManAccessPrivilege" aria-expanded="false" aria-controls="rulesP-TrustedCredManAccessPrivilege">
          [M]Check if there is the privilege "Access Credential Manager" has been explicitly granted to a user other than the "Winlogon service". (P-TrustedCredManAccessPrivilege)
        </button>
      </span>

    </div>

    <div id="rulesP-TrustedCredManAccessPrivilege" class="collapse" aria-labelledby="headingrulesP-TrustedCredManAccessPrivilege" data-parent="#rulesPrivilegeControl">
      <div class="card-body">
        <h3>Check if there is the privilege "Access Credential Manager" has been explicitly granted to a user other than the "Winlogon service".</h3>
<strong>Rule ID:</strong><p class="text-justify">P-TrustedCredManAccessPrivilege</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that there is no assignment of the SeTrustedCredManAccessPrivilege privilege.</p>
<strong>Technical Explanation:</strong><p class="text-justify">The Credential Manger is a vault where credentials are being stored.<br>
This privilege can be used to retrieve the secret data.<br>
<br>
A POC to exploit this privilege is available in the documents linked below.<br>
    </p>
<strong>Advised Solution:</strong><p class="text-justify">You should edit the GPO and remove the GPO right assignment.<br>
    <br>
The setting is located in Computer Policy -&gt; Computer Configuration -&gt; Windows Settings -&gt; Security Settings -&gt; Local Policies -&gt; User Rights Assignment.</p><strong>Introduced in:</strong><p class="text-justify">2.8.0.0</p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://docs.microsoft.com/en-us/windows/win32/secauthn/credentials-management">https://docs.microsoft.com/en-us/windows/win32/secauthn/credentials-management</a><br>
<a href="https://github.com/daem0nc0re/PrivFu#privilegedoperations">https://github.com/daem0nc0re/PrivFu#privilegedoperations</a><br>
<a href="https://github.com/daem0nc0re/PrivFu/blob/main/PrivilegedOperations/SeTrustedCredManAccessPrivilegePoC/SeTrustedCredManAccessPrivilegePoC.cs">https://github.com/daem0nc0re/PrivFu/blob/main/PrivilegedOperations/SeTrustedCredManAccessPrivilegePoC/SeTrustedCredManAccessPrivilegePoC.cs</a><br>
<a href="https://www.stigviewer.com/stig/windows_10/2018-04-06/finding/V-63843">[US]STIG V-63843 - The Access Credential Manager as a trusted caller user right must not be assigned to any groups or accounts</a><br>
<a href="https://attack.mitre.org/mitigations/M1026">[MITRE]Mitre Att&amp;ck - Mitigation - Privileged Account Management</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesP-PrivilegeEveryone"><a name="anchorrulesP-PrivilegeEveryone"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-PrivilegeEveryone" aria-expanded="false" aria-controls="rulesP-PrivilegeEveryone">
          [M]Ensure that dangerous privileges are not granted to everyone by GPO (P-PrivilegeEveryone)
        </button>
      </span>

    </div>

    <div id="rulesP-PrivilegeEveryone" class="collapse" aria-labelledby="headingrulesP-PrivilegeEveryone" data-parent="#rulesPrivilegeControl">
      <div class="card-body">
        <h3>Ensure that dangerous privileges are not granted to everyone by GPO</h3>
<strong>Rule ID:</strong><p class="text-justify">P-PrivilegeEveryone</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that standard users are not granted dangerous privileges</p>
<strong>Technical Explanation:</strong><p class="text-justify">To perform special operations, the operating system relies on privileges. They can be displayed by running the command: whoami /all.<br>
SeLoadDriverPrivilege can be used to take control of the system by loading a specifically designed driver. This procedure can be performed by low privileged users as the driver can be defined in HKCU.<br>
SeTcbPrivilege is the privilege used to "Act on behalf the operating system". This is the privilege reserved to the SYSTEM user. This procedure allows any user to act as SYSTEM.<br>
SeDebugPrivilege is the privilege used to debug program and to access any program's memory. It can be used to create a new process and set the parent process to a privileged one.<br>
SeRestorePrivilege can be used to modify a service running as local system and startable by all users to a chosen one.<br>
SeBackupPrivilege can be used to backup Windows registry and use third party tools for extracting local NTLM hashes.<br>
SeTakeOwnershipPrivilege can be used to take ownership of any secureable object in the system including a service registry key. Then to change its ACL to define its own service running as LocalSystem.<br>
SeCreateTokenPrivilege can be used to create a custom token with all privileges and thus be abused like SeTcbPrivilege <br>
SeImpersonatePrivilege and SeAssignPrimaryTokenPrivilege can be abused to impersonate privileged tokens. These tokens can be retrieved by establishing security context such as Local DCOM DCE/RPC reflection.<br>
SeSecurityPrivilege can be used to clear the Windows Security Event Log and shrink it to make events flushed soon. Also read security log and view events where the user inverted the login and its password.<br>
SeManageVolumePrivilege can be used to reset the security descriptor on the C volume and thus, change the inherited permissions to critical files</p>
<strong>Advised Solution:</strong><p class="text-justify">Locate the GPO specified in Details and remove the privilege.<br>
Most of the settings are located in :<br>
    Computer configuration -&gt; Policies -&gt; Windows Settings -&gt;Security Settings -&gt; Local Policies -&gt; User Rights Assignment.<br>
As an alternative, the file GptTmpl.inf can be manually edited.</p><strong>Introduced in:</strong><p class="text-justify">2.6.0.0</p><strong>Points:</strong><p>15 points per discovery</p>
<strong>Documentation:</strong><p><a href="https://www.romhack.io/slides/RomHack%202018%20-%20Andrea%20Pierini%20-%20whoami%20priv%20-%20show%20me%20your%20Windows%20privileges%20and%20I%20will%20lead%20you%20to%20SYSTEM.pdf">https://www.romhack.io/slides/RomHack%202018%20-%20Andrea%20Pierini%20-%20whoami%20priv%20-%20show%20me%20your%20Windows%20privileges%20and%20I%20will%20lead%20you%20to%20SYSTEM.pdf</a><br>
<a href="https://www.tarlogic.com/en/blog/abusing-seloaddriverprivilege-for-privilege-escalation/">https://www.tarlogic.com/en/blog/abusing-seloaddriverprivilege-for-privilege-escalation/</a><br>
<a href="https://github.com/decoder-it/psgetsystem">https://github.com/decoder-it/psgetsystem</a><br>
<a href="https://twitter.com/0gtweet/status/1303427935647531018?s=20">https://twitter.com/0gtweet/status/1303427935647531018?s=20</a><br>
<a href="https://www.ssi.gouv.fr/uploads/IMG/pdf/NP_ActiveDirectory_NoteTech.pdf#subsubsection.3.3.2">[FR]ANSSI - Recommandations de sécurité relatives à Active Directory - R18 [subsubsection.3.3.2]</a><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a></p>
    </div>
  </div></div></div>
			<!-- Accordion rulesPrivilegeControl end -->

		<div class="row"><div class="col-lg-12 mt-3">
		<h3>Read-Only Domain Controllers
		</h3>

		<div class="row"><div class="col-lg-12">
		<p>Read-Only Domain Controllers are used in poor physically secured zones. An incorrect protection level can leak sensitive data.
		</p>

		<!-- Accordion rulesRODC -->
<div id="rulesRODC">
<div class="card">
    
    <div class="card-header" id="headingrulesP-RODCRevealOnDemand"><a name="anchorrulesP-RODCRevealOnDemand"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-RODCRevealOnDemand" aria-expanded="false" aria-controls="rulesP-RODCRevealOnDemand">
          [M]Check if a privileged group can be revealed on a RODC (P-RODCRevealOnDemand)
        </button>
      </span>

    </div>

    <div id="rulesP-RODCRevealOnDemand" class="collapse" aria-labelledby="headingrulesP-RODCRevealOnDemand" data-parent="#rulesRODC">
      <div class="card-body">
        <h3>Check if a privileged group can be revealed on a RODC</h3>
<strong>Rule ID:</strong><p class="text-justify">P-RODCRevealOnDemand</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that no privileged group can be revealed on RODC</p>
<strong>Technical Explanation:</strong><p class="text-justify">There is an attribute on each RODC which enumerates the groups that the RODC can retrieve.<br>
    When the RODC retrieve the user account, all secrets are integrated into the data, meaning that the RODC can impersonate the user account.<br>
  In this case, a user or a group has been identified that have a RID (the last part of the SID) lower than 1000.<br>
All privileged groups have a RID lower than 1000, than means that the RODC can get access at any time to that privileged information.</p>
<strong>Advised Solution:</strong><p class="text-justify">Edit the attribute msDS-RevealOnDemandGroup and remove the privileged user or group identified.<br>
    <br>
    This can be managed in the Password Replication Policy tab of the computer objecct in the Active Directory Users and Computers console.</p><strong>Introduced in:</strong><p class="text-justify">2.9.0.0</p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/8dfc81be-7461-48f2-8caf-07402bccb0ea">https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/8dfc81be-7461-48f2-8caf-07402bccb0ea</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#rodc_reveal">[FR]ANSSI - Dangerous configuration of read-only domain controllers (RODC) (reveal) (vuln3_rodc_reveal)</a><span class="badge grade-3">3</span><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesP-RODCAdminRevealed"><a name="anchorrulesP-RODCAdminRevealed"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-RODCAdminRevealed" aria-expanded="false" aria-controls="rulesP-RODCAdminRevealed">
          [M]Check if privileged users have been revealed on RODC (P-RODCAdminRevealed)
        </button>
      </span>

    </div>

    <div id="rulesP-RODCAdminRevealed" class="collapse" aria-labelledby="headingrulesP-RODCAdminRevealed" data-parent="#rulesRODC">
      <div class="card-body">
        <h3>Check if privileged users have been revealed on RODC</h3>
<strong>Rule ID:</strong><p class="text-justify">P-RODCAdminRevealed</p>
<strong>Description:</strong><p class="text-justify">The purpose is to check if privileged users have already been revealed</p>
<strong>Technical Explanation:</strong><p class="text-justify">On Active Directory, all users revealed to a RODC are tracked by an attribute set on the computer object of the RODC named msDS-RevealedUsers.<br>
    The program checks on the list of revealed users if one of them is known as a privileged user.<br>
  Indeed, the RODC is caching the authentication secrets related of this user, which can then be used to impersonate it.<br>
In addition to that, RODC are placed in general on more riskier environment.</p>
<strong>Advised Solution:</strong><p class="text-justify">The admin account should have its secrets change (a password reset) and be sure that the account will not be revealed anymore.</p><strong>Introduced in:</strong><p class="text-justify">2.9.0.0</p><strong>Points:</strong><p>5 points per discovery</p>
<strong>Documentation:</strong><p><a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/8dfc81be-7461-48f2-8caf-07402bccb0ea">https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/8dfc81be-7461-48f2-8caf-07402bccb0ea</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#rodc_priv_revealed">[FR]ANSSI - Privileged users revealed on RODC (vuln2_rodc_priv_revealed)</a><span class="badge grade-2">2</span><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesP-RODCSYSVOLWrite"><a name="anchorrulesP-RODCSYSVOLWrite"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-RODCSYSVOLWrite" aria-expanded="false" aria-controls="rulesP-RODCSYSVOLWrite">
          [M][T]Check if RODCs have write access to the SYSVOL volume (P-RODCSYSVOLWrite)
        </button>
      </span>

    </div>

    <div id="rulesP-RODCSYSVOLWrite" class="collapse" aria-labelledby="headingrulesP-RODCSYSVOLWrite" data-parent="#rulesRODC">
      <div class="card-body">
        <h3>Check if RODCs have write access to the SYSVOL volume</h3>
<strong>Rule ID:</strong><p class="text-justify">P-RODCSYSVOLWrite</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that no RODC has write access to the SYSVOL</p>
<strong>Technical Explanation:</strong><p class="text-justify">The SYSVOL Volume is a special DFS volume used to store system files such as GPO.<br>
    Read Only Domain Controllers (RODC) have read-only access to it.<br>
  If it has write access, it can change the file locally and propagate them to all writable domain controllers.<br>
And thus enable an attacker to take control of the domain by modifying a GPO applied to Domain Controllers.</p>
<strong>Advised Solution:</strong><p class="text-justify">Locate the domain controller object related to the RODC in ADSIEdit.<br>
    Then zoom on CN=DFSR-LocalSettings then CN=Domain System Volume.<br>
    Edit the attribute msDFSR-ReadOnly and change it from false to true.<br>
    </p><strong>Introduced in:</strong><p class="text-justify">2.9.0.0</p><strong>Points:</strong><p>5 points per discovery</p>
<strong>Documentation:</strong><p><a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-frs2/3588b343-4076-4776-b5c0-78e2b3d91ed3">https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-frs2/3588b343-4076-4776-b5c0-78e2b3d91ed3</a><br>
<a href="https://attack.mitre.org/techniques/T1207">[MITRE]T1207 Rogue Domain Controller</a><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesP-RODCNeverReveal"><a name="anchorrulesP-RODCNeverReveal"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-RODCNeverReveal" aria-expanded="false" aria-controls="rulesP-RODCNeverReveal">
          [M]Check if the protection against revealing privileged group is active (P-RODCNeverReveal)
        </button>
      </span>

    </div>

    <div id="rulesP-RODCNeverReveal" class="collapse" aria-labelledby="headingrulesP-RODCNeverReveal" data-parent="#rulesRODC">
      <div class="card-body">
        <h3>Check if the protection against revealing privileged group is active</h3>
<strong>Rule ID:</strong><p class="text-justify">P-RODCNeverReveal</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that the protection against revealing privileged group is active</p>
<strong>Technical Explanation:</strong><p class="text-justify">In addition to the group Denied RODC Password Replication Group there is a custom setting set for RODC in an attribute named msDS-NeverRevealGroup.<br>
    This rule checks the current value against the default one.</p>
<strong>Advised Solution:</strong><p class="text-justify">Check the value of the attribute msDS-NeverRevealGroup and the presence of the following expected groups:<br>
- Administrators;<br>
- Server Operators;<br>
- Account Operators;<br>
- Backup Operators;<br>
- Denied RODC Password Replication Group<br>
<br>
    This can be managed in the Password Replication Policy tab of the computer objecct in the Active Directory Users and Computers console.</p><strong>Introduced in:</strong><p class="text-justify">2.9.0.0</p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/8dfc81be-7461-48f2-8caf-07402bccb0ea">https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/8dfc81be-7461-48f2-8caf-07402bccb0ea</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#rodc_never_reveal">[FR]ANSSI - Dangerous configuration of read-only domain controllers (RODC) (neverReveal) (vuln3_rodc_never_reveal)</a><span class="badge grade-3">3</span><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesP-RODCAllowedGroup"><a name="anchorrulesP-RODCAllowedGroup"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-RODCAllowedGroup" aria-expanded="false" aria-controls="rulesP-RODCAllowedGroup">
          [M]Check the Allowed RODC Password Replication Group group (P-RODCAllowedGroup)
        </button>
      </span>

    </div>

    <div id="rulesP-RODCAllowedGroup" class="collapse" aria-labelledby="headingrulesP-RODCAllowedGroup" data-parent="#rulesRODC">
      <div class="card-body">
        <h3>Check the Allowed RODC Password Replication Group group</h3>
<strong>Rule ID:</strong><p class="text-justify">P-RODCAllowedGroup</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that the Allowed RODC Password Replication Group group is empty.</p>
<strong>Technical Explanation:</strong><p class="text-justify">Accounts belonging to the Allowed RODC Password Replication Group group have their password hashes revealed on all RODCs.</p>
<strong>Advised Solution:</strong><p class="text-justify">This group should be emptied, and dedicated groups should only be added to the Password Replication Policy of each relevant RODC.</p><strong>Introduced in:</strong><p class="text-justify">2.9.0.0</p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#rodc_allowed_group">[FR]ANSSI - Dangerous configuration of replication groups for read-only domain controllers (RODCs) (allow) (vuln3_rodc_allowed_group)</a><span class="badge grade-3">3</span><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesP-RODCDeniedGroup"><a name="anchorrulesP-RODCDeniedGroup"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesP-RODCDeniedGroup" aria-expanded="false" aria-controls="rulesP-RODCDeniedGroup">
          [M]Check the Denied RODC Password Replication Group group (P-RODCDeniedGroup)
        </button>
      </span>

    </div>

    <div id="rulesP-RODCDeniedGroup" class="collapse" aria-labelledby="headingrulesP-RODCDeniedGroup" data-parent="#rulesRODC">
      <div class="card-body">
        <h3>Check the Denied RODC Password Replication Group group</h3>
<strong>Rule ID:</strong><p class="text-justify">P-RODCDeniedGroup</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that the Denied RODC Password Replication Group group has at least its default members.</p>
<strong>Technical Explanation:</strong><p class="text-justify">A set of critical objects are being forbidden to replicate in RODC for security reasons.<br>
    This permission is set using the Denied RODC Password Replication Group group.<br>
    Removing one of the default members of this group remove this protection, and thus, the isolation of RODC.</p>
<strong>Advised Solution:</strong><p class="text-justify">Add the items which have been identified as missing to the Denied RODC Password Replication Group group.<br>
    </p><strong>Introduced in:</strong><p class="text-justify">2.9.0.0</p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://docs.microsoft.com/en-us/services-hub/health/remediation-steps-ad/review-the-removal-of-default-members-from-the-denied-rodc-password-replication-group">https://docs.microsoft.com/en-us/services-hub/health/remediation-steps-ad/review-the-removal-of-default-members-from-the-denied-rodc-password-replication-group</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#rodc_denied_group">[FR]ANSSI - Dangerous configuration of replication groups for read-only domain controllers (RODCs) (denied) (vuln3_rodc_denied_group)</a><span class="badge grade-3">3</span><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a></p>
    </div>
  </div></div></div>
			<!-- Accordion rulesRODC end -->

		<!-- SubSection Trusts -->
		<div class="row"><div class="col-lg-12 mt-2">
			<h2>Trusts</h2>
		</div></div>
        <!-- SubSection Trusts end -->
		<div class="row"><div class="col-lg-12">
		<p>Each line represents a rule. Click on a rule to expand it and show the details of it.
		</p>

		<div class="row"><div class="col-lg-12 mt-3">
		<h3>Old trust protocol
		</h3>

		<div class="row"><div class="col-lg-12">
		<p>NT4 like trusts do not provide an accurate level of security and by the use of its old protocols, put the domain at risk.
		</p>

		<!-- Accordion rulesOldTrustProtocol -->
<div id="rulesOldTrustProtocol">
<div class="card">
    
    <div class="card-header" id="headingrulesT-Downlevel"><a name="anchorrulesT-Downlevel"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesT-Downlevel" aria-expanded="false" aria-controls="rulesT-Downlevel">
          [M]Check for trusts compatible with NT4 (T-Downlevel)
        </button>
      </span>

    </div>

    <div id="rulesT-Downlevel" class="collapse" aria-labelledby="headingrulesT-Downlevel" data-parent="#rulesOldTrustProtocol">
      <div class="card-body">
        <h3>Check for trusts compatible with NT4</h3>
<strong>Rule ID:</strong><p class="text-justify">T-Downlevel</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that there is no NT4 compatible trust</p>
<strong>Technical Explanation:</strong><p class="text-justify">A Downlevel trust is a special kind of trust compatible with NT4. The kind of trust can be displayed in the "Active Directory Domains and Trusts" tool.</p>
<strong>Advised Solution:</strong><p class="text-justify">Unless the remote party of the trust is a NT4 domain, this trust shouldn't exist. It should be recreated.</p><strong>Points:</strong><p>20 points if present</p>
<strong>Documentation:</strong><p><a href="https://msdn.microsoft.com/en-us/library/cc223771.aspx">https://msdn.microsoft.com/en-us/library/cc223771.aspx</a><br>
<a href="https://attack.mitre.org/mitigations/M1026">[MITRE]Mitre Att&amp;ck - Mitigation - Privileged Account Management</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesT-AlgsAES"><a name="anchorrulesT-AlgsAES"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesT-AlgsAES" aria-expanded="false" aria-controls="rulesT-AlgsAES">
          [M]Check if AES is enabled on trusts (T-AlgsAES)
        </button>
      </span>

    </div>

    <div id="rulesT-AlgsAES" class="collapse" aria-labelledby="headingrulesT-AlgsAES" data-parent="#rulesOldTrustProtocol">
      <div class="card-body">
        <h3>Check if AES is enabled on trusts</h3>
<strong>Rule ID:</strong><p class="text-justify">T-AlgsAES</p>
<strong>Description:</strong><p class="text-justify">The purpose is to check if AES can be used with Kerberos on trusts</p>
<strong>Technical Explanation:</strong><p class="text-justify">By default, RC4 is used as the signature algorithm on Kerberos tickets.<br>
    If AES is enabled on a domain and AES is not enabled on trust, AES tickets will not be usable on the trust. The Kerberos tickets sent to the trust will fail or the trusted domain will fallback to NTLM.<br>
    <br>
    The encryption algorithms allowed for a trust are stored in an attribute named msDS-SupportedEncryptionTypes.<br>
    If this attribute is not set (or has a value of zero), RC4 will be applied by default.<br>
    Else, it defines the algorithm to use for Kerberos signature.<br>
</p>
<strong>Advised Solution:</strong><p class="text-justify">Enable AES on the domain.<br>
    <br>
    Beware: there is a checkbox in the trust properties named "The other domain supports Kerberos AES Encryption".<br>
    If you enable this setting, AES will be enabled but RC4 will also be disabled.<br>
    <br>
    The recommended way is to enable both RC4 and AES as a transition. It can be done by running the command:<br>
    <i>ksetup /setenctypeattr mytrust.com RC4-HMAC-MD5 AES128-CTS-HMAC-SHA1-96 AES256-CTS-HMAC-SHA1-96</i><br>
    <br>
      This way, the attribute msDS-SupportedEncryptionTypes of the trust will be modified to support both RC4 and AES.<br>
  </p><strong>Introduced in:</strong><p class="text-justify">2.11.0.0</p><strong>Points:</strong><p>1 points if present</p>
<strong>Documentation:</strong><p><a href="https://techcommunity.microsoft.com/t5/itops-talk-blog/tough-questions-answered-can-i-disable-rc4-etype-for-kerberos-on/ba-p/382718">https://techcommunity.microsoft.com/t5/itops-talk-blog/tough-questions-answered-can-i-disable-rc4-etype-for-kerberos-on/ba-p/382718</a><br>
<a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-kile/6cfc7b50-11ed-4b4d-846d-6f08f0812919">https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-kile/6cfc7b50-11ed-4b4d-846d-6f08f0812919</a><br>
<a href="https://techcommunity.microsoft.com/t5/core-infrastructure-and-security/decrypting-the-selection-of-supported-kerberos-encryption-types/ba-p/1628797">https://techcommunity.microsoft.com/t5/core-infrastructure-and-security/decrypting-the-selection-of-supported-kerberos-encryption-types/ba-p/1628797</a><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a></p>
    </div>
  </div></div></div>
			<!-- Accordion rulesOldTrustProtocol end -->

		<div class="row"><div class="col-lg-12 mt-3">
		<h3>SID Filtering
		</h3>

		<div class="row"><div class="col-lg-12">
		<p>Isolation of domains is critical to avoid a global compromise.
		</p>

		<!-- Accordion rulesSIDFiltering -->
<div id="rulesSIDFiltering">
<div class="card">
    
    <div class="card-header" id="headingrulesT-SIDFiltering"><a name="anchorrulesT-SIDFiltering"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesT-SIDFiltering" aria-expanded="false" aria-controls="rulesT-SIDFiltering">
          [M][T]Check for Trusts whose security is not maximum (T-SIDFiltering)
        </button>
      </span>

    </div>

    <div id="rulesT-SIDFiltering" class="collapse" aria-labelledby="headingrulesT-SIDFiltering" data-parent="#rulesSIDFiltering">
      <div class="card-body">
        <h3>Check for Trusts whose security is not maximum</h3>
<strong>Rule ID:</strong><p class="text-justify">T-SIDFiltering</p>
<strong>Description:</strong><p class="text-justify">The purpose is to check if all trusts are protected using the functionality named SID Filtering</p>
<strong>Technical Explanation:</strong><p class="text-justify">SID Filtering is a mechanism used to block account presenting a SID History property. SID History is used to link an existing account to another account and can be used to propagate a compromise through trusts. SID Filtering for domain-to-domain trust is called a quarantine and is disabled by default. SID Filtering to a forest is enabled by default and disabling it is called "enabling SID History".<br>
<br>
The algorithm to compute the SID Filtering is:<br>
get the attribute trustDirection and TrustAttributes of the trust object.<br>
if the direction is 0 or 1 or if the trust is intra forest (trustattributes &amp; 32 != 0) then SID Filtering is not applicable.<br>
Then, if the trust is a forest trust (trusattributes &amp; 8 != 0) then<br>
check if /enablesidhistory has been enabled - trustattributes &amp; 64 != 0.<br>
If enabled: SID Filtering is deactivated.<br>
Else if not a forest trust (trustattributes &amp; 8 == 0) then check for the quarantined attribute (trustattributes &amp; 4 != 0).<br>
If the quarantine flag is set, SID Filtering is enabled.<br>
<br>
You can use the PowerShell command to get its status:<br>
<i>[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain().GetSidFilteringStatus('my.domain.to.test.local')</i><br>
</p>
<strong>Advised Solution:</strong><p class="text-justify">A trust without SID Filtering means either that a migration is in progress or that the domain can be compromised instantly via the trust.<br>
The solution is to complete existing migration ASAP and enable the SID Filtering feature.<br>
<br>
If the trust is a domain trust, you should use netdom /quarantine and set it to yes.<br>
If the trust is a forest trust, you should use netdom /enablesidhistory and set it to no.<br>
Do not apply /quarantine on a forest trust: you will break the transitivity of the trust.</p><strong>Points:</strong><p>100 points if the occurence is greater than or equals than 4<br>
then 80 points if the occurence is greater than or equals than 2<br>
then 50 points if present</p>
<strong>Documentation:</strong><p><a href="https://msdn.microsoft.com/en-us/library/cc237940.aspx">https://msdn.microsoft.com/en-us/library/cc237940.aspx</a><br>
<a href="https://www.stigviewer.com/stig/active_directory_domain/2017-12-15/finding/V-8538">[US]STIG V-8538 - Security identifiers (SIDs) must be configured to use only authentication data of directly trusted external or forest trust. </a><br>
<a href="https://www.ssi.gouv.fr/uploads/IMG/pdf/NP_ActiveDirectory_NoteTech.pdf#paragraph.3.3.1.6">[FR]ANSSI - Recommandations de sécurité relatives à Active Directory - R16 [paragraph.3.3.1.6]</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#trusts_forest_sidhistory">[FR]ANSSI - Outbound forest trust relationships with sID History enabled (vuln1_trusts_forest_sidhistory)</a><span class="badge grade-1">1</span><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#trusts_domain_notfiltered">[FR]ANSSI - Unfiltered outbound domain trust relationship (vuln1_trusts_domain_notfiltered)</a><span class="badge grade-1">1</span><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a><br>
<a href="https://attack.mitre.org/techniques/T1134/005">[MITRE]T1134.005 Access Token Manipulation: SID-History Injection</a></p>
    </div>
  </div></div></div>
			<!-- Accordion rulesSIDFiltering end -->

		<div class="row"><div class="col-lg-12 mt-3">
		<h3>SIDHistory
		</h3>

		<div class="row"><div class="col-lg-12">
		<p>When doing migrations, a double identity may be attributed. It can have side effects up to the compromise of the domain.
		</p>

		<!-- Accordion rulesSIDHistory -->
<div id="rulesSIDHistory">
<div class="card">
    
    <div class="card-header" id="headingrulesT-SIDHistorySameDomain"><a name="anchorrulesT-SIDHistorySameDomain"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesT-SIDHistorySameDomain" aria-expanded="false" aria-controls="rulesT-SIDHistorySameDomain">
          [M][T]Check for local backdoor stored in SID History (T-SIDHistorySameDomain)
        </button>
      </span>

    </div>

    <div id="rulesT-SIDHistorySameDomain" class="collapse" aria-labelledby="headingrulesT-SIDHistorySameDomain" data-parent="#rulesSIDHistory">
      <div class="card-body">
        <h3>Check for local backdoor stored in SID History</h3>
<strong>Rule ID:</strong><p class="text-justify">T-SIDHistorySameDomain</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that accounts are not linked for more privileged accounts in the same domain</p>
<strong>Technical Explanation:</strong><p class="text-justify">SID History is an attribute used in migration to link with a former account. It is not possible to have an account linked with an account belonging to the same domain. This can be analyzed by comparing the domain part of the SID History with the domain SID.</p>
<strong>Advised Solution:</strong><p class="text-justify">It is not possible to have this occurrence except if a user from domain A has been migrated to domain B and then migrated again to domain A. This should be strongly investigated as it may be linked to a compromise of the domain.<br>
    <br>
To remove the SIDHistory from a user account, run:<br>
<i>Get-ADUser USERNAME -properties sidhistory | foreach {Set-ADUser $_ -remove @{sidhistory=$_.sidhistory.value}}</i><br>
For a group, run:<br>
<i>Get-ADGroup GROUPNAME -properties sidhistory | foreach {Set-ADGroup $_ -remove @{sidhistory=$_.sidhistory.value}}</i><br>
For all users in a OU:<br>
<i>Get-ADUser -SearchBase "OU=Accounts,DC=mydomain,DC=com" -Filter {sidhistory -like '*'} -properties sidhistory | foreach {Set-ADUser $_ -remove @{sidhistory=$_.sidhistory.value}}</i><br>
    </p><strong>Points:</strong><p>50 points if present</p>
<strong>Documentation:</strong><p><a href="https://www.ssi.gouv.fr/uploads/IMG/pdf/NP_ActiveDirectory_NoteTech.pdf#paragraph.3.3.1.5">[FR]ANSSI - Recommandations de sécurité relatives à Active Directory - R15 [paragraph.3.3.1.5]</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#sidhistory_present">[FR]ANSSI - Accounts or groups with SID history set (vuln3_sidhistory_present)</a><span class="badge grade-3">3</span><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a><br>
<a href="https://attack.mitre.org/techniques/T1134/005">[MITRE]T1134.005 Access Token Manipulation: SID-History Injection</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesS-Domaindollardollardollar"><a name="anchorrulesS-Domaindollardollardollar"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesS-Domaindollardollardollar" aria-expanded="false" aria-controls="rulesS-Domaindollardollardollar">
          [M]Check if a migration is in progress (S-Domain$$$)
        </button>
      </span>

    </div>

    <div id="rulesS-Domaindollardollardollar" class="collapse" aria-labelledby="headingrulesS-Domaindollardollardollar" data-parent="#rulesSIDHistory">
      <div class="card-body">
        <h3>Check if a migration is in progress</h3>
<strong>Rule ID:</strong><p class="text-justify">S-Domain$$$</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that the SID History creation is not enabled</p>
<strong>Technical Explanation:</strong><p class="text-justify">To migrate accounts to another domain, the attribute SID History should be added to the new account. Despite the fact that numerous hacking tools such as mimikatz allows the creation of the SID History attribute, its official creation requires the presence of a special auditing group named DOMAIN-$$$, for example TEST-$$$ for the TEST domain.</p>
<strong>Advised Solution:</strong><p class="text-justify">If a migration is in progress, declare it in PingCastle so this rule won't be triggered. Else, remove this auditing group. You can locate it by using the LDAP query (sAMAccountName=*$$$)</p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://www.ssi.gouv.fr/uploads/IMG/pdf/NP_ActiveDirectory_NoteTech.pdf#paragraph.3.3.1.5">[FR]ANSSI - Recommandations de sécurité relatives à Active Directory - R15 [paragraph.3.3.1.5]</a><br>
<a href="https://attack.mitre.org/mitigations/M1026">[MITRE]Mitre Att&amp;ck - Mitigation - Privileged Account Management</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesT-SIDHistoryDangerous"><a name="anchorrulesT-SIDHistoryDangerous"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesT-SIDHistoryDangerous" aria-expanded="false" aria-controls="rulesT-SIDHistoryDangerous">
          [M][T]Check if dangerous SID are stored in the SIDHistory attribute. (T-SIDHistoryDangerous)
        </button>
      </span>

    </div>

    <div id="rulesT-SIDHistoryDangerous" class="collapse" aria-labelledby="headingrulesT-SIDHistoryDangerous" data-parent="#rulesSIDHistory">
      <div class="card-body">
        <h3>Check if dangerous SID are stored in the SIDHistory attribute.</h3>
<strong>Rule ID:</strong><p class="text-justify">T-SIDHistoryDangerous</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that the dangerous SID are not stored in the SIDHistory attribute.</p>
<strong>Technical Explanation:</strong><p class="text-justify">SID History is an attribute used in migration to link with a former account.<br>
    This rule checks for SID not coming from a former domain (such as SYSTEM) or from a former domain but having a RID (the last part of the SID) lower than 1000.<br>
    Indeed, native privileged accounts have a SID lower than 1000.<br>
    A list of Well Known SID is referenced in the documentation below.<br>
    </p>
<strong>Advised Solution:</strong><p class="text-justify"><br>
      Identify the account, computer or group having these dangerous SID set in SID History, then clean it up by editing directly the SIDHistory attribute of the underlying AD object.<br>
      <br>
To remove the SIDHistory from a user account, run:<br>
<i>Get-ADUser USERNAME -properties sidhistory | foreach {Set-ADUser $_ -remove @{sidhistory=$_.sidhistory.value}}</i><br>
For a group, run:<br>
<i>Get-ADGroup GROUPNAME -properties sidhistory | foreach {Set-ADGroup $_ -remove @{sidhistory=$_.sidhistory.value}}</i><br>
For all users in a OU:<br>
<i>Get-ADUser -SearchBase "OU=Accounts,DC=mydomain,DC=com" -Filter {sidhistory -like '*'} -properties sidhistory | foreach {Set-ADUser $_ -remove @{sidhistory=$_.sidhistory.value}}</i><br>
    </p><strong>Introduced in:</strong><p class="text-justify">2.9.0.0</p><strong>Points:</strong><p>10 points if present</p>
<strong>Documentation:</strong><p><a href="https://support.microsoft.com/en-us/help/243330/well-known-security-identifiers-in-windows-operating-systems">https://support.microsoft.com/en-us/help/243330/well-known-security-identifiers-in-windows-operating-systems</a><br>
<a href="https://www.ssi.gouv.fr/uploads/IMG/pdf/NP_ActiveDirectory_NoteTech.pdf#paragraph.3.3.1.5">[FR]ANSSI - Recommandations de sécurité relatives à Active Directory - R15 [paragraph.3.3.1.5]</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#sidhistory_dangerous">[FR]ANSSI - Accounts or groups with unexpected SID history (vuln2_sidhistory_dangerous)</a><span class="badge grade-2">2</span><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a><br>
<a href="https://attack.mitre.org/techniques/T1134/005">[MITRE]T1134.005 Access Token Manipulation: SID-History Injection</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesT-SIDHistoryUnknownDomain"><a name="anchorrulesT-SIDHistoryUnknownDomain"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesT-SIDHistoryUnknownDomain" aria-expanded="false" aria-controls="rulesT-SIDHistoryUnknownDomain">
          [M][T]Check if the account has been migrated from a domain which doesn't exist anymore (T-SIDHistoryUnknownDomain)
        </button>
      </span>

    </div>

    <div id="rulesT-SIDHistoryUnknownDomain" class="collapse" aria-labelledby="headingrulesT-SIDHistoryUnknownDomain" data-parent="#rulesSIDHistory">
      <div class="card-body">
        <h3>Check if the account has been migrated from a domain which doesn't exist anymore</h3>
<strong>Rule ID:</strong><p class="text-justify">T-SIDHistoryUnknownDomain</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that every account having an SID History is part of an active migration.</p>
<strong>Technical Explanation:</strong><p class="text-justify">When accounts are migrated from one domain to another, the attribute SID History can be appended to the new account to keep track of its former account. The origin can be tracked by removing the last digit of the SID to guess the SID of the origin domain. If the SID of the origin domain cannot be resolved, that means that the domain has been removed and as consequence that the SID History is not needed. This SID History information can be used to give additional rights and thus alter the real security rights.</p>
<strong>Advised Solution:</strong><p class="text-justify">Each security descriptor of the domain (including file shares for example) should be reviewed to be rewritten with the new SID of the account. Then the SID History attribute should be removed. <br>
    <br>
    Please note that once the SID History has been removed, it cannot be added back again without doing a real migration. Possibly hacking tools such as mimikatz could be used to undo a deletion with for example the lsadump::dcshadow attack.<br>
  <br>
To remove the SIDHistory from a user account, run:<br>
<i>Get-ADUser USERNAME -properties sidhistory | foreach {Set-ADUser $_ -remove @{sidhistory=$_.sidhistory.value}}</i><br>
For a group, run:<br>
<i>Get-ADGroup GROUPNAME -properties sidhistory | foreach {Set-ADGroup $_ -remove @{sidhistory=$_.sidhistory.value}}</i><br>
For all users in a OU:<br>
<i>Get-ADUser -SearchBase "OU=Accounts,DC=mydomain,DC=com" -Filter {sidhistory -like '*'} -properties sidhistory | foreach {Set-ADUser $_ -remove @{sidhistory=$_.sidhistory.value}}</i><br>
    </p><strong>Points:</strong><p>10 points per discovery</p>
<strong>Documentation:</strong><p><a href="https://www.ssi.gouv.fr/uploads/IMG/pdf/NP_ActiveDirectory_NoteTech.pdf#paragraph.3.3.1.5">[FR]ANSSI - Recommandations de sécurité relatives à Active Directory - R15 [paragraph.3.3.1.5]</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#sidhistory_present">[FR]ANSSI - Accounts or groups with SID history set (vuln3_sidhistory_present)</a><span class="badge grade-3">3</span><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a><br>
<a href="https://attack.mitre.org/techniques/T1134/005">[MITRE]T1134.005 Access Token Manipulation: SID-History Injection</a></p>
    </div>
  </div></div></div>
			<!-- Accordion rulesSIDHistory end -->

		<div class="row"><div class="col-lg-12 mt-3">
		<h3>Trust impermeability
		</h3>

		<div class="row"><div class="col-lg-12">
		<p>A trust is a technical boundary which should not be altered.
		</p>

		<!-- Accordion rulesTrustImpermeability -->
<div id="rulesTrustImpermeability">
<div class="card">
    
    <div class="card-header" id="headingrulesT-FileDeployedOutOfDomain"><a name="anchorrulesT-FileDeployedOutOfDomain"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesT-FileDeployedOutOfDomain" aria-expanded="false" aria-controls="rulesT-FileDeployedOutOfDomain">
          [T]Check if files deployed may be located in a trusted domain (T-FileDeployedOutOfDomain)
        </button>
      </span>

    </div>

    <div id="rulesT-FileDeployedOutOfDomain" class="collapse" aria-labelledby="headingrulesT-FileDeployedOutOfDomain" data-parent="#rulesTrustImpermeability">
      <div class="card-body">
        <h3>Check if files deployed may be located in a trusted domain</h3>
<strong>Rule ID:</strong><p class="text-justify">T-FileDeployedOutOfDomain</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that a compromised domain cannot use file deployed by GPO to compromise other domains</p>
<strong>Technical Explanation:</strong><p class="text-justify">Files deployed (Applications as msi, file copied by GPO, ...) can be stored in any file share available in the network and that includes trusted domains shares. If such file is located in a compromised domain, it can be used to compromise other domains.</p>
<strong>Advised Solution:</strong><p class="text-justify">Copy the file to a share located inside the domain and not in trusted domains.</p><strong>Introduced in:</strong><p class="text-justify">2.7.0.0</p><strong>Points:</strong><p>10 points if present</p>
<strong>Documentation:</strong><p><a href="https://attack.mitre.org/techniques/T1210">[MITRE]T1210 Exploitation of Remote Services</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesT-TGTDelegation"><a name="anchorrulesT-TGTDelegation"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesT-TGTDelegation" aria-expanded="false" aria-controls="rulesT-TGTDelegation">
          [M][T]Check if Kerberos delegation can be used to take control of the forest from a trusted forest (T-TGTDelegation)
        </button>
      </span>

    </div>

    <div id="rulesT-TGTDelegation" class="collapse" aria-labelledby="headingrulesT-TGTDelegation" data-parent="#rulesTrustImpermeability">
      <div class="card-body">
        <h3>Check if Kerberos delegation can be used to take control of the forest from a trusted forest</h3>
<strong>Rule ID:</strong><p class="text-justify">T-TGTDelegation</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that a forest cannot be used to compromise another forest using Kerberos delegation</p>
<strong>Technical Explanation:</strong><p class="text-justify">A Forest trust is a link between two forests. By default, this trust is secure and prohibits SID History attacks.<br>
However, it allows Kerberos delegation by default.<br>
By configuring an uncontrainst delegation on forest A, an attacker located in forest A can collect admin or domain controller credentials, the TGT of the session, of the forest B.<br>
This collection can be forced by using services such as the Print Spooler, enabled by default on all domain controllers.<br>
Having collected this TGT, the attacker can then request access to other systems in forest B, by asking for a TGS given the TGT, and then gain control of the whole forest.</p>
<strong>Advised Solution:</strong><p class="text-justify">TGT Delegation on forest trusts should be disabled, except for migrations.<br>
You can use netdom to turn the TGT delegation on forest trust OFF.<br>
Example: netdom.exe trust fabrikam.com /domain:contoso.com /EnableTGTDelegation:No<br>
As an alternative, you can locate the forest trust and change its LDAP trustattribute from the value 8 to the value 520.<br>
<br>
The impact is to have non working services which relies on unconstrained delegation. Resource based delegation is not impacted.<br>
<br>
See the official Microsoft recommendations and a script to find potentially impacted services in the links below.</p><strong>Introduced in:</strong><p class="text-justify">2.7.0.0</p><strong>Points:</strong><p>10 points per discovery</p>
<strong>Documentation:</strong><p><a href="http://www.harmj0y.net/blog/redteaming/not-a-security-boundary-breaking-forest-trusts/">http://www.harmj0y.net/blog/redteaming/not-a-security-boundary-breaking-forest-trusts/</a><br>
<a href="https://techcommunity.microsoft.com/t5/Premier-Field-Engineering/Changes-to-Ticket-Granting-Ticket-TGT-Delegation-Across-Trusts/ba-p/440283/tab/rich">https://techcommunity.microsoft.com/t5/Premier-Field-Engineering/Changes-to-Ticket-Granting-Ticket-TGT-Delegation-Across-Trusts/ba-p/440283/tab/rich</a><br>
<a href="https://support.microsoft.com/en-us/help/4490425/updates-to-tgt-delegation-across-incoming-trusts-in-windows-server">https://support.microsoft.com/en-us/help/4490425/updates-to-tgt-delegation-across-incoming-trusts-in-windows-server</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#trusts_tgt_deleg">[FR]ANSSI - Inbound trust relationships with delegation (vuln3_trusts_tgt_deleg)</a><span class="badge grade-3">3</span><br>
<a href="https://attack.mitre.org/techniques/T1187">[MITRE]T1187 Forced Authentication</a><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesT-ScriptOutOfDomain"><a name="anchorrulesT-ScriptOutOfDomain"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesT-ScriptOutOfDomain" aria-expanded="false" aria-controls="rulesT-ScriptOutOfDomain">
          [T]Check if login scripts may be located in a trusted domain (T-ScriptOutOfDomain)
        </button>
      </span>

    </div>

    <div id="rulesT-ScriptOutOfDomain" class="collapse" aria-labelledby="headingrulesT-ScriptOutOfDomain" data-parent="#rulesTrustImpermeability">
      <div class="card-body">
        <h3>Check if login scripts may be located in a trusted domain</h3>
<strong>Rule ID:</strong><p class="text-justify">T-ScriptOutOfDomain</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that a compromised domain cannot use scripts located in it to compromise other domains</p>
<strong>Technical Explanation:</strong><p class="text-justify">Login scripts can be stored in any file share available in the network and that includes trusted domains shares. If a login script is located in a compromise domain, it can be used to compromise other domains.</p>
<strong>Advised Solution:</strong><p class="text-justify">Copy the login script to a share located inside the domain and not in trusted domains.</p><strong>Points:</strong><p>10 points if present</p>
<strong>Documentation:</strong><p><a href="https://attack.mitre.org/techniques/T1210">[MITRE]T1210 Exploitation of Remote Services</a></p>
    </div>
  </div></div></div>
			<!-- Accordion rulesTrustImpermeability end -->

		<div class="row"><div class="col-lg-12 mt-3">
		<h3>Trust inactive
		</h3>

		<div class="row"><div class="col-lg-12">
		<p>Any trust introduces a risk. The secret used for the trust can be exposed to take control of the domain.
		</p>

		<!-- Accordion rulesTrustInactive -->
<div id="rulesTrustInactive">
<div class="card">
    
    <div class="card-header" id="headingrulesT-Inactive"><a name="anchorrulesT-Inactive"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesT-Inactive" aria-expanded="false" aria-controls="rulesT-Inactive">
          [T]Check for inactive trusts (T-Inactive)
        </button>
      </span>

    </div>

    <div id="rulesT-Inactive" class="collapse" aria-labelledby="headingrulesT-Inactive" data-parent="#rulesTrustInactive">
      <div class="card-body">
        <h3>Check for inactive trusts</h3>
<strong>Rule ID:</strong><p class="text-justify">T-Inactive</p>
<strong>Description:</strong><p class="text-justify">The purpose is to verify that every trust has a remote domain which is active.</p>
<strong>Technical Explanation:</strong><p class="text-justify">When a trust is active, it is using a shared secret to communicate to a domain. This secret is hold in a special account whose name is the remote domain name. This password is changed every month and as consequence the whenChanged attribute of this account is changed. When there is no modification of the whenChanged attribute, it can be guessed that the secret has not been changed and that there was either a problem with the remote domain or that the remote domain does not exist anymore.</p>
<strong>Advised Solution:</strong><p class="text-justify">Check for network connectivity issues from the remote domain or if the remote domain still exists. If it doesn't exist anymore, the trust should be removed. Otherwise, the secret used by the trust can be used to issue fake Kerberos tickets and be used as a backdoor.</p><strong>Points:</strong><p>20 points if present</p>
<strong>Documentation:</strong><p><a href="https://msdn.microsoft.com/fr-fr/library/ms680921(v=vs.85).aspx">https://msdn.microsoft.com/fr-fr/library/ms680921(v=vs.85).aspx</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#trusts_accounts">[FR]ANSSI - Trust account passwords unchanged for more than a year (vuln2_trusts_accounts)</a><span class="badge grade-2">2</span><br>
<a href="https://attack.mitre.org/techniques/T1557">[MITRE]T1557 Man-in-the-Middle</a></p>
    </div>
  </div></div></div>
			<!-- Accordion rulesTrustInactive end -->

		<div class="row"><div class="col-lg-12 mt-3">
		<h3>Trust with Azure
		</h3>

		<div class="row"><div class="col-lg-12">
		<p>The link with Azure Systems may create new compromise methods between the cloud and on-premise systems.
		</p>

		<!-- Accordion rulesTrustAzure -->
<div id="rulesTrustAzure">
<div class="card">
    
    <div class="card-header" id="headingrulesT-AzureADSSO"><a name="anchorrulesT-AzureADSSO"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesT-AzureADSSO" aria-expanded="false" aria-controls="rulesT-AzureADSSO">
          [T]Check if password rotation is in place with AzureAD SSO (T-AzureADSSO)
        </button>
      </span>

    </div>

    <div id="rulesT-AzureADSSO" class="collapse" aria-labelledby="headingrulesT-AzureADSSO" data-parent="#rulesTrustAzure">
      <div class="card-body">
        <h3>Check if password rotation is in place with AzureAD SSO</h3>
<strong>Rule ID:</strong><p class="text-justify">T-AzureADSSO</p>
<strong>Description:</strong><p class="text-justify">The purpose is to check that password rotation is in place with Azure AD SSO</p>
<strong>Technical Explanation:</strong><p class="text-justify">AzureAD SSO is performed using a gateway. This gateway converts a Kerberos TGS ticket to a SAML ticket.<br>
    In short, a connection is made to the computer account AZUREADSSOACC and the secret of this user account is used as a shared secret with AzureAD.<br>
  Despite the fact that this computer account should have its password automatically changed every 30 days, it did not happen.<br>
That means that an extraction of its password (using DCSync for example) can lead to an AzureAD compromise.</p>
<strong>Advised Solution:</strong><p class="text-justify">Run the script referenced in the documentation below to change the password of the account AZUREADSSOACC.</p><strong>Points:</strong><p>20 points if present</p>
<strong>Documentation:</strong><p><a href="https://docs.microsoft.com/en-us/azure/active-directory/hybrid/how-to-connect-sso-faq#how-can-i-roll-over-the-kerberos-decryption-key-of-the-azureadssoacc-computer-account">https://docs.microsoft.com/en-us/azure/active-directory/hybrid/how-to-connect-sso-faq#how-can-i-roll-over-the-kerberos-decryption-key-of-the-azureadssoacc-computer-account</a><br>
<a href="https://itpro-tips.com/wp-content/uploads/files/TechnetGallery/Azure-AD-SSO-Key-Rollover-d2f1604a.zip">https://itpro-tips.com/wp-content/uploads/files/TechnetGallery/Azure-AD-SSO-Key-Rollover-d2f1604a.zip</a><br>
<a href="https://www.dsinternals.com/en/impersonating-office-365-users-mimikatz/">https://www.dsinternals.com/en/impersonating-office-365-users-mimikatz/</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#trusts_accounts">[FR]ANSSI - Trust account passwords unchanged for more than a year (vuln2_trusts_accounts)</a><span class="badge grade-2">2</span><br>
<a href="https://attack.mitre.org/techniques/T1003">[MITRE]T1003 OS Credential Dumping</a></p>
    </div>
  </div></div></div>
			<!-- Accordion rulesTrustAzure end -->

		<!-- SubSection Anomalies -->
		<div class="row"><div class="col-lg-12 mt-2">
			<h2>Anomalies</h2>
		</div></div>
        <!-- SubSection Anomalies end -->
		<div class="row"><div class="col-lg-12">
		<p>Each line represents a rule. Click on a rule to expand it and show the details of it.
		</p>

		<div class="row"><div class="col-lg-12 mt-3">
		<h3>Audit
		</h3>

		<div class="row"><div class="col-lg-12">
		<p>The default audit policy of Windows does not collect key events to trace activities or discover past compromise.
		</p>

		<!-- Accordion rulesAudit -->
<div id="rulesAudit">
<div class="card">
    
    <div class="card-header" id="headingrulesA-AuditPowershell"><a name="anchorrulesA-AuditPowershell"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-AuditPowershell" aria-expanded="false" aria-controls="rulesA-AuditPowershell">
          [M]Check if PowerShell logging is enabled. (A-AuditPowershell)
        </button>
      </span>

    </div>

    <div id="rulesA-AuditPowershell" class="collapse" aria-labelledby="headingrulesA-AuditPowershell" data-parent="#rulesAudit">
      <div class="card-body">
        <h3>Check if PowerShell logging is enabled.</h3>
<strong>Rule ID:</strong><p class="text-justify">A-AuditPowershell</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that PowerShell logging is enabled.</p>
<strong>Technical Explanation:</strong><p class="text-justify">PowerShell is a powerful language, also used by hackers because of this quality. Hackers are able to run programs such as mimikatz in memory using obfuscated commands such as Invoke–Mimikatz.<br>
    Because there is no artefact on the disk, the incident response task is difficult for the forensic analysts.<br>
    For this reason, we recommend to enable PowerShell logging via a group policy, despite the fact that these security settings may be part of the workstation or server images.<br>
    </p>
<strong>Advised Solution:</strong><p class="text-justify">Go to Computer Configuration -&gt; Administrative Templates -&gt; Windows Components -&gt; Windows PowerShell<br>
And enable "Turn on Module logging" and "Turn on PowerShell Script Block logging"<br>
We recommend to set "*" as the module list.<br>
  </p><strong>Introduced in:</strong><p class="text-justify">2.8.0.0</p><strong>Points:</strong><p>Informative rule (0 point)</p>
<strong>Documentation:</strong><p><a href="https://adsecurity.org/?p=2604">https://adsecurity.org/?p=2604</a><br>
<a href="https://docs.microsoft.com/en-us/powershell/scripting/wmf/whats-new/script-logging?view=powershell-6">https://docs.microsoft.com/en-us/powershell/scripting/wmf/whats-new/script-logging?view=powershell-6</a><br>
<a href="https://www.stigviewer.com/stig/windows_10/2018-04-06/finding/V-68819">[US]STIG V-68819 - PowerShell script block logging must be enabled</a><br>
<a href="https://attack.mitre.org/mitigations/M1047">[MITRE]Mitre Att&amp;ck - Mitigation - Audit</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-AuditDC"><a name="anchorrulesA-AuditDC"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-AuditDC" aria-expanded="false" aria-controls="rulesA-AuditDC">
          [M]Check if there is the expected audit policy on domain controllers. (A-AuditDC)
        </button>
      </span>

    </div>

    <div id="rulesA-AuditDC" class="collapse" aria-labelledby="headingrulesA-AuditDC" data-parent="#rulesAudit">
      <div class="card-body">
        <h3>Check if there is the expected audit policy on domain controllers.</h3>
<strong>Rule ID:</strong><p class="text-justify">A-AuditDC</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that the audit policy on domain controllers collects the right set of events.</p>
<strong>Technical Explanation:</strong><p class="text-justify">To detect and mitigate an attack, the right set of events need to be collected.<br>
      The audit policy is a compromise between too much and too few events to collect.<br>
      To solve this problem, the suggested audit policy from adsecurity.org is checked against the audit policy in place.<br>
    </p>
<strong>Advised Solution:</strong><p class="text-justify">Identify the Audit settings to apply and fix them.<br>
    Be aware that there are two places for audit settings.<br>
    For "Simple" audit configuration:<br>
    in Computer Configuration -&gt; Policies -&gt; Windows Settings -&gt; Security Settings -&gt; Local Policies -&gt; Audit Policies<br>
    For "Advanced" audit configuration:<br>
    in Computer Configuration -&gt; Policies -&gt; Windows Settings -&gt; Security Settings -&gt; Advanced Audit Policy Configuration<br>
    Also be sure that the audit GPO is applied to all domain controllers, as the underlying object may be in a OU where the GPO is not applied.<br>
  </p><strong>Introduced in:</strong><p class="text-justify">2.8.0.0</p><strong>Points:</strong><p>10 points if present</p>
<strong>Documentation:</strong><p><a href="https://adsecurity.org/?p=3299">https://adsecurity.org/?p=3299</a><br>
<a href="https://adsecurity.org/?p=3377">https://adsecurity.org/?p=3377</a><br>
<a href="https://attack.mitre.org/mitigations/M1047">[MITRE]Mitre Att&amp;ck - Mitigation - Audit</a></p>
    </div>
  </div></div></div>
			<!-- Accordion rulesAudit end -->

		<div class="row"><div class="col-lg-12 mt-3">
		<h3>Backup
		</h3>

		<div class="row"><div class="col-lg-12">
		<p>Although Active Directory has been designed for redundancy, a backup process is key for a recovery plan.
		</p>

		<!-- Accordion rulesBackup -->
<div id="rulesBackup">
<div class="card">
    
    <div class="card-header" id="headingrulesA-BackupMetadata"><a name="anchorrulesA-BackupMetadata"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-BackupMetadata" aria-expanded="false" aria-controls="rulesA-BackupMetadata">
          [M]Check for the last backup date according to Microsoft standard (A-BackupMetadata)
        </button>
      </span>

    </div>

    <div id="rulesA-BackupMetadata" class="collapse" aria-labelledby="headingrulesA-BackupMetadata" data-parent="#rulesBackup">
      <div class="card-body">
        <h3>Check for the last backup date according to Microsoft standard</h3>
<strong>Rule ID:</strong><p class="text-justify">A-BackupMetadata</p>
<strong>Description:</strong><p class="text-justify">The purpose is to check if the backups are actually up to date in case they are needed. The alert can be triggered when a domain is backed up using non-recommended methods</p>
<strong>Technical Explanation:</strong><p class="text-justify">A verification is done on the backups, ensuring that the backup is performed according to Microsoft standards. Indeed, at each backup the DIT Database Partition Backup Signature is updated. If for any reasons, backups are needed to perform a rollback (rebuild a domain) or to track past changes, the backups will actually be up to date. This check is equivalent to a <i>REPADMIN /showbackup *</i>.</p>
<strong>Advised Solution:</strong><p class="text-justify">Plan AD backups based on Microsoft standards. These standards depend on the Operating System. For example with the wbadmin utility: <i>wbadmin start systemstatebackup -backuptarget:d:</i></p><strong>Points:</strong><p>15 points if the occurence is greater than or equals than 7</p>
<strong>Documentation:</strong><p><a href="https://technet.microsoft.com/en-us/library/jj130668(v=ws.10).aspx">https://technet.microsoft.com/en-us/library/jj130668(v=ws.10).aspx</a><br>
<a href="https://www.stigviewer.com/stig/active_directory_domain/2017-12-15/finding/V-25385">[US]STIG V-25385 - Active Directory data must be backed up daily for systems with a Risk Management Framework categorization for Availability of moderate or high. Systems with a categorization of low must be backed up weekly.</a><br>
<a href="https://attack.mitre.org/mitigations/M1053">[MITRE]Mitre Att&amp;ck - Mitigation - Data Backup</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-NotEnoughDC"><a name="anchorrulesA-NotEnoughDC"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-NotEnoughDC" aria-expanded="false" aria-controls="rulesA-NotEnoughDC">
          [M]Ensure that there are enough DCs to provide basic redundancy (A-NotEnoughDC)
        </button>
      </span>

    </div>

    <div id="rulesA-NotEnoughDC" class="collapse" aria-labelledby="headingrulesA-NotEnoughDC" data-parent="#rulesBackup">
      <div class="card-body">
        <h3>Ensure that there are enough DCs to provide basic redundancy</h3>
<strong>Rule ID:</strong><p class="text-justify">A-NotEnoughDC</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure the failure of one domain controller will not stop the domain.</p>
<strong>Technical Explanation:</strong><p class="text-justify">A single domain controller failure can lead to a lack of availability of the domain if the number of servers is too low. To have a minimum redundancy, the number of DC should be at least 2. For Labs, this rule can be ignored, and you can add this rule into the exception list.</p>
<strong>Advised Solution:</strong><p class="text-justify">Increase the number of domain controllers by installing new ones.</p><strong>Introduced in:</strong><p class="text-justify">2.6.0.0</p><strong>Points:</strong><p>5 points if the occurence is strictly lower than 2</p>
<strong>Documentation:</strong><p><a href="https://social.technet.microsoft.com/wiki/contents/articles/14355.capacity-planning-for-active-directory-domain-services.aspx">https://social.technet.microsoft.com/wiki/contents/articles/14355.capacity-planning-for-active-directory-domain-services.aspx</a><br>
<a href="https://attack.mitre.org/mitigations/M1053">[MITRE]Mitre Att&amp;ck - Mitigation - Data Backup</a></p>
    </div>
  </div></div></div>
			<!-- Accordion rulesBackup end -->

		<div class="row"><div class="col-lg-12 mt-3">
		<h3>Certificate take over
		</h3>

		<div class="row"><div class="col-lg-12">
		<p>Certificates are an alternative to passwords. Their protection is crucial to avoid any backdoor.
		</p>

		<!-- Accordion rulesCertificateTakeOver -->
<div id="rulesCertificateTakeOver">
<div class="card">
    
    <div class="card-header" id="headingrulesA-WeakRSARootCert2"><a name="anchorrulesA-WeakRSARootCert2"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-WeakRSARootCert2" aria-expanded="false" aria-controls="rulesA-WeakRSARootCert2">
          [T]Check for Certificates using a relatively weak signing algorithm (RSA between 1024 bits and 2048 or expires after 2030) (A-WeakRSARootCert2)
        </button>
      </span>

    </div>

    <div id="rulesA-WeakRSARootCert2" class="collapse" aria-labelledby="headingrulesA-WeakRSARootCert2" data-parent="#rulesCertificateTakeOver">
      <div class="card-body">
        <h3>Check for Certificates using a relatively weak signing algorithm (RSA between 1024 bits and 2048 or expires after 2030)</h3>
<strong>Rule ID:</strong><p class="text-justify">A-WeakRSARootCert2</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that there is no use of a certificate using a relatively weak RSA key</p>
<strong>Technical Explanation:</strong><p class="text-justify">A RSA key certificate with a modulus under 1024 bits is considered as not safe. This is checked by the rule A-WeakRSARootCert.<br>
    This rule checks for certificates having a key under 2048 bits which is considered as having a lower level of security and under 3072 bits for certificates valid after 2030.</p>
<strong>Advised Solution:</strong><p class="text-justify">To solve the matter, the certificate should be removed from the GPO and if needed, certificates depending on it should be reissued.<br>
    <br>
    Please note that this rule is the companion of the rule A-WeakRSARootCert which checks for unsecured certificates (key lower than 1024 bits).</p><strong>Introduced in:</strong><p class="text-justify">2.9.0.0</p><strong>Points:</strong><p>1 points if present</p>
<strong>Documentation:</strong><p><a href="https://www.iad.gov/iad/library/ia-guidance/ia-solutions-for-classified/algorithm-guidance/commercial-national-security-algorithm-suite-factsheet.cfm">https://www.iad.gov/iad/library/ia-guidance/ia-solutions-for-classified/algorithm-guidance/commercial-national-security-algorithm-suite-factsheet.cfm</a><br>
<a href="https://www.ssi.gouv.fr/guide/cryptographie-les-regles-du-rgs/">    https://www.ssi.gouv.fr/guide/cryptographie-les-regles-du-rgs/</a><br>
<a href="https://www.stigviewer.com/stig/active_directory_service_2003/2011-05-20/finding/V-14820">[US]STIG V-14820 - PKI certificates (server and clients) must be issued by the DoD PKI or an approved External Certificate Authority (ECA).</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#certificates_vuln">[FR]ANSSI - Weak or vulnerable certificates (vuln3_certificates_vuln)</a><span class="badge grade-3">3</span><br>
<a href="https://attack.mitre.org/techniques/T1600/001">[MITRE]T1600.001 Weaken Encryption: Reduce Key Space</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-CertWeakRsaComponent"><a name="anchorrulesA-CertWeakRsaComponent"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-CertWeakRsaComponent" aria-expanded="false" aria-controls="rulesA-CertWeakRsaComponent">
          [T]Check for Certificates using a weak RSA exponent (A-CertWeakRsaComponent)
        </button>
      </span>

    </div>

    <div id="rulesA-CertWeakRsaComponent" class="collapse" aria-labelledby="headingrulesA-CertWeakRsaComponent" data-parent="#rulesCertificateTakeOver">
      <div class="card-body">
        <h3>Check for Certificates using a weak RSA exponent</h3>
<strong>Rule ID:</strong><p class="text-justify">A-CertWeakRsaComponent</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that there is no use of a certificate with a weak RSA exponent</p>
<strong>Technical Explanation:</strong><p class="text-justify">The RSA public key is composed of two parts: The modulus and the exponent. The exponent must be a prime number and its value is usually 65537.<br>
    It is not recommended to have a exponent larger than 65537 for compatibility reasons as for example older Windows handle the exponent in 4 bytes.<br>
  Having a lower exponent, such as 3, give a significant performance boost (up to 8 times), but it is considered less secure.</p>
<strong>Advised Solution:</strong><p class="text-justify">To solve the matter, the certificate should be removed from the GPO and if needed, certificates depending on it should be reissued.</p><strong>Introduced in:</strong><p class="text-justify">2.9.0.0</p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#certificates_vuln">[FR]ANSSI - Weak or vulnerable certificates (vuln3_certificates_vuln)</a><span class="badge grade-3">3</span><br>
<a href="https://attack.mitre.org/techniques/T1600/001">[MITRE]T1600.001 Weaken Encryption: Reduce Key Space</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-WeakRSARootCert"><a name="anchorrulesA-WeakRSARootCert"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-WeakRSARootCert" aria-expanded="false" aria-controls="rulesA-WeakRSARootCert">
          [T]Check for certificates using a weak signing algorithm (RSA under 1024 bits) (A-WeakRSARootCert)
        </button>
      </span>

    </div>

    <div id="rulesA-WeakRSARootCert" class="collapse" aria-labelledby="headingrulesA-WeakRSARootCert" data-parent="#rulesCertificateTakeOver">
      <div class="card-body">
        <h3>Check for certificates using a weak signing algorithm (RSA under 1024 bits)</h3>
<strong>Rule ID:</strong><p class="text-justify">A-WeakRSARootCert</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that there is no use of a certificate using a weak RSA key</p>
<strong>Technical Explanation:</strong><p class="text-justify">A RSA key certificate with a modulus under 1024 bits is considered unsafe</p>
<strong>Advised Solution:</strong><p class="text-justify">To solve the matter, the certificate should be removed from the GPO and if needed, certificates depending on it should be reissued.</p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://www.iad.gov/iad/library/ia-guidance/ia-solutions-for-classified/algorithm-guidance/commercial-national-security-algorithm-suite-factsheet.cfm">https://www.iad.gov/iad/library/ia-guidance/ia-solutions-for-classified/algorithm-guidance/commercial-national-security-algorithm-suite-factsheet.cfm</a><br>
<a href="https://www.ssi.gouv.fr/guide/cryptographie-les-regles-du-rgs/">    https://www.ssi.gouv.fr/guide/cryptographie-les-regles-du-rgs/</a><br>
<a href="https://www.stigviewer.com/stig/active_directory_service_2003/2011-05-20/finding/V-14820">[US]STIG V-14820 - PKI certificates (server and clients) must be issued by the DoD PKI or an approved External Certificate Authority (ECA).</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#certificates_vuln">[FR]ANSSI - Weak or vulnerable certificates (vuln1_certificates_vuln)</a><span class="badge grade-1">1</span><br>
<a href="https://attack.mitre.org/techniques/T1600/001">[MITRE]T1600.001 Weaken Encryption: Reduce Key Space</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-CertWeakDSA"><a name="anchorrulesA-CertWeakDSA"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-CertWeakDSA" aria-expanded="false" aria-controls="rulesA-CertWeakDSA">
          [T]Check for Certificates using the DSA algorithm for signature (A-CertWeakDSA)
        </button>
      </span>

    </div>

    <div id="rulesA-CertWeakDSA" class="collapse" aria-labelledby="headingrulesA-CertWeakDSA" data-parent="#rulesCertificateTakeOver">
      <div class="card-body">
        <h3>Check for Certificates using the DSA algorithm for signature</h3>
<strong>Rule ID:</strong><p class="text-justify">A-CertWeakDSA</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that there is no use of a certificate using a DSA key for signature</p>
<strong>Technical Explanation:</strong><p class="text-justify">Digital Signature Algorithm (DSA), is a NIST standard signature algorithm, part of the 1993 Digital Signature Standard(FIPS 186). The proposed FIPS 186-5 draft deprecates the use of DSA and will forbid its usage for digital signature purposes.<br>
    The annex E of FIPS 186-5 specifies: DSA is no longer approved for digital signature generation. DSA may be used to verify signatures generated prior to the implementation date of this standard.</p>
<strong>Advised Solution:</strong><p class="text-justify">To solve the matter, the certificate should be removed from the GPO and if needed, certificates depending on it should be reissued.</p><strong>Introduced in:</strong><p class="text-justify">2.9.0.0</p><strong>Points:</strong><p>Informative rule (0 point)</p>
<strong>Documentation:</strong><p><a href="https://csrc.nist.gov/publications/detail/fips/186/5/draft">https://csrc.nist.gov/publications/detail/fips/186/5/draft</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#certificates_vuln">[FR]ANSSI - Weak or vulnerable certificates (vuln1_certificates_vuln)</a><span class="badge grade-1">1</span><br>
<a href="https://attack.mitre.org/techniques/T1600/001">[MITRE]T1600.001 Weaken Encryption: Reduce Key Space</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-MD2IntermediateCert"><a name="anchorrulesA-MD2IntermediateCert"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-MD2IntermediateCert" aria-expanded="false" aria-controls="rulesA-MD2IntermediateCert">
          [T]Check for Intermediate Certificates using unsafe hashing algorithm (MD2) (A-MD2IntermediateCert)
        </button>
      </span>

    </div>

    <div id="rulesA-MD2IntermediateCert" class="collapse" aria-labelledby="headingrulesA-MD2IntermediateCert" data-parent="#rulesCertificateTakeOver">
      <div class="card-body">
        <h3>Check for Intermediate Certificates using unsafe hashing algorithm (MD2)</h3>
<strong>Rule ID:</strong><p class="text-justify">A-MD2IntermediateCert</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that there is no use of the deprecated MD2 hashing algorithm in Intermediate Certificate</p>
<strong>Technical Explanation:</strong><p class="text-justify">The MD2 hashing algorithm is not considered safe. There are design flaws inherent to the algorithm that allow an attacker to generate a hash collision in less than a brute-force time</p>
<strong>Advised Solution:</strong><p class="text-justify">To solve the matter, the certificate should be removed from the GPO and if needed, certificates depending on it should be reissued.</p><strong>Points:</strong><p>10 points if present</p>
<strong>Documentation:</strong><p><a href="https://www.ssi.gouv.fr/archive/fr/sciences/fichiers/lcr/mu04c.pdf">https://www.ssi.gouv.fr/archive/fr/sciences/fichiers/lcr/mu04c.pdf</a><br>
<a href="https://www.stigviewer.com/stig/active_directory_service_2003/2011-05-20/finding/V-14820">[US]STIG V-14820 - PKI certificates (server and clients) must be issued by the DoD PKI or an approved External Certificate Authority (ECA).</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#certificates_vuln">[FR]ANSSI - Weak or vulnerable certificates (vuln3_certificates_vuln)</a><span class="badge grade-3">3</span><br>
<a href="https://attack.mitre.org/techniques/T1600/001">[MITRE]T1600.001 Weaken Encryption: Reduce Key Space</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-MD4IntermediateCert"><a name="anchorrulesA-MD4IntermediateCert"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-MD4IntermediateCert" aria-expanded="false" aria-controls="rulesA-MD4IntermediateCert">
          [T]Check for Intermediate Certificates using unsafe hashing algorithm (MD4) (A-MD4IntermediateCert)
        </button>
      </span>

    </div>

    <div id="rulesA-MD4IntermediateCert" class="collapse" aria-labelledby="headingrulesA-MD4IntermediateCert" data-parent="#rulesCertificateTakeOver">
      <div class="card-body">
        <h3>Check for Intermediate Certificates using unsafe hashing algorithm (MD4)</h3>
<strong>Rule ID:</strong><p class="text-justify">A-MD4IntermediateCert</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that there is no use of the deprecated MD4 hashing algorithm in Intermediate Certificate</p>
<strong>Technical Explanation:</strong><p class="text-justify">The MD4 hashing algorithm is not considered safe. There are design flaws inherent to the algorithm that allow an attacker to generate a hash collision in less than a brute-force time</p>
<strong>Advised Solution:</strong><p class="text-justify">To solve the matter, the certificate should be removed from the GPO and if needed, certificates depending on it should be reissued.</p><strong>Points:</strong><p>10 points if present</p>
<strong>Documentation:</strong><p><a href="https://tools.ietf.org/html/rfc6150">https://tools.ietf.org/html/rfc6150</a><br>
<a href="https://www.stigviewer.com/stig/active_directory_service_2003/2011-05-20/finding/V-14820">[US]STIG V-14820 - PKI certificates (server and clients) must be issued by the DoD PKI or an approved External Certificate Authority (ECA).</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#certificates_vuln">[FR]ANSSI - Weak or vulnerable certificates (vuln3_certificates_vuln)</a><span class="badge grade-3">3</span><br>
<a href="https://attack.mitre.org/techniques/T1600/001">[MITRE]T1600.001 Weaken Encryption: Reduce Key Space</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-MD5IntermediateCert"><a name="anchorrulesA-MD5IntermediateCert"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-MD5IntermediateCert" aria-expanded="false" aria-controls="rulesA-MD5IntermediateCert">
          [T]Check for Intermediate Certificates using unsafe hashing algorithm (MD5) (A-MD5IntermediateCert)
        </button>
      </span>

    </div>

    <div id="rulesA-MD5IntermediateCert" class="collapse" aria-labelledby="headingrulesA-MD5IntermediateCert" data-parent="#rulesCertificateTakeOver">
      <div class="card-body">
        <h3>Check for Intermediate Certificates using unsafe hashing algorithm (MD5)</h3>
<strong>Rule ID:</strong><p class="text-justify">A-MD5IntermediateCert</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that there is no use of the deprecated MD5 hashing algorithm in Intermediate Certificate</p>
<strong>Technical Explanation:</strong><p class="text-justify">The MD5 hashing algorithm is not considered safe. There are design flaws inherent to the algorithm that allow an attacker to generate a hash collision in less than a brute-force time</p>
<strong>Advised Solution:</strong><p class="text-justify">To solve the matter, the certificate should be removed from the GPO and if needed, certificates depending on it should be reissued.</p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://www.kb.cert.org/vuls/id/836068">https://www.kb.cert.org/vuls/id/836068</a><br>
<a href="https://www.stigviewer.com/stig/active_directory_service_2003/2011-05-20/finding/V-14820">[US]STIG V-14820 - PKI certificates (server and clients) must be issued by the DoD PKI or an approved External Certificate Authority (ECA).</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#certificates_vuln">[FR]ANSSI - Weak or vulnerable certificates (vuln3_certificates_vuln)</a><span class="badge grade-3">3</span><br>
<a href="https://attack.mitre.org/techniques/T1600/001">[MITRE]T1600.001 Weaken Encryption: Reduce Key Space</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-SHA0IntermediateCert"><a name="anchorrulesA-SHA0IntermediateCert"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-SHA0IntermediateCert" aria-expanded="false" aria-controls="rulesA-SHA0IntermediateCert">
          [T]Check for Intermediate Certificates using unsafe hashing algorithm (SHA0) (A-SHA0IntermediateCert)
        </button>
      </span>

    </div>

    <div id="rulesA-SHA0IntermediateCert" class="collapse" aria-labelledby="headingrulesA-SHA0IntermediateCert" data-parent="#rulesCertificateTakeOver">
      <div class="card-body">
        <h3>Check for Intermediate Certificates using unsafe hashing algorithm (SHA0)</h3>
<strong>Rule ID:</strong><p class="text-justify">A-SHA0IntermediateCert</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that there is no use of the deprecated SHA0 hashing algorithm in Intermediate Certificate</p>
<strong>Technical Explanation:</strong><p class="text-justify">The SHA0 hashing algorithm is not considered as safe. There are design flaws inherent to the algorithm that allow an attacker to generate a hash collision in less than a brute-force time</p>
<strong>Advised Solution:</strong><p class="text-justify">To solve the matter, the certificate should be removed from the GPO and if needed, certificates depending on it should be reissued.</p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://tools.ietf.org/html/rfc6194">https://tools.ietf.org/html/rfc6194</a><br>
<a href="https://www.stigviewer.com/stig/active_directory_service_2003/2011-05-20/finding/V-14820">[US]STIG V-14820 - PKI certificates (server and clients) must be issued by the DoD PKI or an approved External Certificate Authority (ECA).</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#certificates_vuln">[FR]ANSSI - Weak or vulnerable certificates (vuln3_certificates_vuln)</a><span class="badge grade-3">3</span><br>
<a href="https://attack.mitre.org/techniques/T1600/001">[MITRE]T1600.001 Weaken Encryption: Reduce Key Space</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-SHA1IntermediateCert"><a name="anchorrulesA-SHA1IntermediateCert"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-SHA1IntermediateCert" aria-expanded="false" aria-controls="rulesA-SHA1IntermediateCert">
          [T]Check for Intermediate Certificates using unsafe hashing algorithm (SHA1) (A-SHA1IntermediateCert)
        </button>
      </span>

    </div>

    <div id="rulesA-SHA1IntermediateCert" class="collapse" aria-labelledby="headingrulesA-SHA1IntermediateCert" data-parent="#rulesCertificateTakeOver">
      <div class="card-body">
        <h3>Check for Intermediate Certificates using unsafe hashing algorithm (SHA1)</h3>
<strong>Rule ID:</strong><p class="text-justify">A-SHA1IntermediateCert</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that there is no use of the deprecated SHA1 hashing algorithm in Intermediate Certificate</p>
<strong>Technical Explanation:</strong><p class="text-justify">The SHA1 hashing algorithm is not considered as safe. There are design flaws inherent to the algorithm that allow an attacker to generate a hash collision in less than a brute-force time</p>
<strong>Advised Solution:</strong><p class="text-justify">To solve the matter, the certificate should be removed from the GPO and if needed, certificates depending on it should be reissued.</p><strong>Points:</strong><p>1 points if present</p>
<strong>Documentation:</strong><p><a href="https://tools.ietf.org/html/rfc6194">https://tools.ietf.org/html/rfc6194</a><br>
<a href="https://www.stigviewer.com/stig/active_directory_service_2003/2011-05-20/finding/V-14820">[US]STIG V-14820 - PKI certificates (server and clients) must be issued by the DoD PKI or an approved External Certificate Authority (ECA).</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#certificates_vuln">[FR]ANSSI - Weak or vulnerable certificates (vuln3_certificates_vuln)</a><span class="badge grade-3">3</span><br>
<a href="https://attack.mitre.org/techniques/T1600/001">[MITRE]T1600.001 Weaken Encryption: Reduce Key Space</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-MD2RootCert"><a name="anchorrulesA-MD2RootCert"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-MD2RootCert" aria-expanded="false" aria-controls="rulesA-MD2RootCert">
          [T]Check for Root Certificates using unsafe hashing algorithm (MD2) (A-MD2RootCert)
        </button>
      </span>

    </div>

    <div id="rulesA-MD2RootCert" class="collapse" aria-labelledby="headingrulesA-MD2RootCert" data-parent="#rulesCertificateTakeOver">
      <div class="card-body">
        <h3>Check for Root Certificates using unsafe hashing algorithm (MD2)</h3>
<strong>Rule ID:</strong><p class="text-justify">A-MD2RootCert</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that no Root Certificates use the deprecated MD2 hashing algorithm</p>
<strong>Technical Explanation:</strong><p class="text-justify">The MD2 hashing algorithm is not considered safe. There are design flaws inherent to the algorithm that allow an attacker to generate a hash collision in less than a brute-force time. Nevertheless, the root certificate algorithm has no direct impact on the security, but it can be used indirectly to force the use of this algorithm in the issued certificate</p>
<strong>Advised Solution:</strong><p class="text-justify">To solve the matter, the certificate should be removed from the GPO and if needed, certificates depending on it should be reissued.</p><strong>Points:</strong><p>Informative rule (0 point)</p>
<strong>Documentation:</strong><p><a href="https://www.ssi.gouv.fr/archive/fr/sciences/fichiers/lcr/mu04c.pdf">https://www.ssi.gouv.fr/archive/fr/sciences/fichiers/lcr/mu04c.pdf</a><br>
<a href="https://www.stigviewer.com/stig/active_directory_service_2003/2011-05-20/finding/V-14820">[US]STIG V-14820 - PKI certificates (server and clients) must be issued by the DoD PKI or an approved External Certificate Authority (ECA).</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#certificates_vuln">[FR]ANSSI - Weak or vulnerable certificates (vuln3_certificates_vuln)</a><span class="badge grade-3">3</span><br>
<a href="https://attack.mitre.org/techniques/T1600/001">[MITRE]T1600.001 Weaken Encryption: Reduce Key Space</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-MD4RootCert"><a name="anchorrulesA-MD4RootCert"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-MD4RootCert" aria-expanded="false" aria-controls="rulesA-MD4RootCert">
          [T]Check for Root Certificates using unsafe hashing algorithm (MD4) (A-MD4RootCert)
        </button>
      </span>

    </div>

    <div id="rulesA-MD4RootCert" class="collapse" aria-labelledby="headingrulesA-MD4RootCert" data-parent="#rulesCertificateTakeOver">
      <div class="card-body">
        <h3>Check for Root Certificates using unsafe hashing algorithm (MD4)</h3>
<strong>Rule ID:</strong><p class="text-justify">A-MD4RootCert</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that no Root Certificates use the deprecated MD4 hashing algorithm</p>
<strong>Technical Explanation:</strong><p class="text-justify">The MD4 hashing algorithm is not considered safe. There are design flaws inherent to the algorithm that allow an attacker to generate a hash collision in less than a brute-force time. Nevertheless, the root certificate algorithm has no direct impact on the security, but it can be used indirectly to force the use of this algorithm in the issued certificate</p>
<strong>Advised Solution:</strong><p class="text-justify">To solve the matter, the certificate should be removed from the GPO and if needed, certificates depending on it should be reissued.</p><strong>Points:</strong><p>Informative rule (0 point)</p>
<strong>Documentation:</strong><p><a href="https://tools.ietf.org/html/rfc6150">https://tools.ietf.org/html/rfc6150</a><br>
<a href="https://www.stigviewer.com/stig/active_directory_service_2003/2011-05-20/finding/V-14820">[US]STIG V-14820 - PKI certificates (server and clients) must be issued by the DoD PKI or an approved External Certificate Authority (ECA).</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#certificates_vuln">[FR]ANSSI - Weak or vulnerable certificates (vuln3_certificates_vuln)</a><span class="badge grade-3">3</span><br>
<a href="https://attack.mitre.org/techniques/T1600/001">[MITRE]T1600.001 Weaken Encryption: Reduce Key Space</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-MD5RootCert"><a name="anchorrulesA-MD5RootCert"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-MD5RootCert" aria-expanded="false" aria-controls="rulesA-MD5RootCert">
          [T]Check for Root Certificates using unsafe hashing algorithm (MD5) (A-MD5RootCert)
        </button>
      </span>

    </div>

    <div id="rulesA-MD5RootCert" class="collapse" aria-labelledby="headingrulesA-MD5RootCert" data-parent="#rulesCertificateTakeOver">
      <div class="card-body">
        <h3>Check for Root Certificates using unsafe hashing algorithm (MD5)</h3>
<strong>Rule ID:</strong><p class="text-justify">A-MD5RootCert</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that no Root Certificates use the deprecated MD5 hashing algorithm</p>
<strong>Technical Explanation:</strong><p class="text-justify">The MD5 hashing algorithm is not considered safe. There are design flaws inherent to the algorithm that allow an attacker to generate a hash collision in less than a brute-force time. Nevertheless, the root certificate algorithm has no direct impact on the security, but it can be used indirectly to force the use of this algorithm in the issued certificate</p>
<strong>Advised Solution:</strong><p class="text-justify">To solve the matter, the certificate should be removed from the GPO and if needed, certificates depending on it should be reissued.</p><strong>Points:</strong><p>Informative rule (0 point)</p>
<strong>Documentation:</strong><p><a href="https://www.kb.cert.org/vuls/id/836068">https://www.kb.cert.org/vuls/id/836068</a><br>
<a href="https://www.stigviewer.com/stig/active_directory_service_2003/2011-05-20/finding/V-14820">[US]STIG V-14820 - PKI certificates (server and clients) must be issued by the DoD PKI or an approved External Certificate Authority (ECA).</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#certificates_vuln">[FR]ANSSI - Weak or vulnerable certificates (vuln3_certificates_vuln)</a><span class="badge grade-3">3</span><br>
<a href="https://attack.mitre.org/techniques/T1600/001">[MITRE]T1600.001 Weaken Encryption: Reduce Key Space</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-SHA0RootCert"><a name="anchorrulesA-SHA0RootCert"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-SHA0RootCert" aria-expanded="false" aria-controls="rulesA-SHA0RootCert">
          [T]Check for Root Certificates using unsafe hashing algorithm (SHA0) (A-SHA0RootCert)
        </button>
      </span>

    </div>

    <div id="rulesA-SHA0RootCert" class="collapse" aria-labelledby="headingrulesA-SHA0RootCert" data-parent="#rulesCertificateTakeOver">
      <div class="card-body">
        <h3>Check for Root Certificates using unsafe hashing algorithm (SHA0)</h3>
<strong>Rule ID:</strong><p class="text-justify">A-SHA0RootCert</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that no Root Certificates use the deprecated SHA-0 hashing algorithm</p>
<strong>Technical Explanation:</strong><p class="text-justify">The SHA0 hashing algorithm is not considered as safe. There are design flaws inherent to the algorithm that allow an attacker to generate a hash collision in less than a brute-force time</p>
<strong>Advised Solution:</strong><p class="text-justify">To solve the matter, the certificate should be removed from the GPO and if needed, certificates depending on it should be reissued.</p><strong>Points:</strong><p>Informative rule (0 point)</p>
<strong>Documentation:</strong><p><a href="https://tools.ietf.org/html/rfc6194">https://tools.ietf.org/html/rfc6194</a><br>
<a href="https://www.stigviewer.com/stig/active_directory_service_2003/2011-05-20/finding/V-14820">[US]STIG V-14820 - PKI certificates (server and clients) must be issued by the DoD PKI or an approved External Certificate Authority (ECA).</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#certificates_vuln">[FR]ANSSI - Weak or vulnerable certificates (vuln3_certificates_vuln)</a><span class="badge grade-3">3</span><br>
<a href="https://attack.mitre.org/techniques/T1600/001">[MITRE]T1600.001 Weaken Encryption: Reduce Key Space</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-SHA1RootCert"><a name="anchorrulesA-SHA1RootCert"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-SHA1RootCert" aria-expanded="false" aria-controls="rulesA-SHA1RootCert">
          [T]Check for Root Certificates using unsafe hashing algorithm (SHA1) (A-SHA1RootCert)
        </button>
      </span>

    </div>

    <div id="rulesA-SHA1RootCert" class="collapse" aria-labelledby="headingrulesA-SHA1RootCert" data-parent="#rulesCertificateTakeOver">
      <div class="card-body">
        <h3>Check for Root Certificates using unsafe hashing algorithm (SHA1)</h3>
<strong>Rule ID:</strong><p class="text-justify">A-SHA1RootCert</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that no Root Certificates use the deprecated SHA-1 hashing algorithm</p>
<strong>Technical Explanation:</strong><p class="text-justify">The SHA1 hashing algorithm is not considered as safe. There are design flaws inherent to the algorithm that allow an attacker to generate a hash collision in less than a brute-force time</p>
<strong>Advised Solution:</strong><p class="text-justify">To solve the matter, the certificate should be removed from the GPO and if needed, certificates depending on it should be reissued.</p><strong>Points:</strong><p>Informative rule (0 point)</p>
<strong>Documentation:</strong><p><a href="https://tools.ietf.org/html/rfc6194">https://tools.ietf.org/html/rfc6194</a><br>
<a href="https://www.stigviewer.com/stig/active_directory_service_2003/2011-05-20/finding/V-14820">[US]STIG V-14820 - PKI certificates (server and clients) must be issued by the DoD PKI or an approved External Certificate Authority (ECA).</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#certificates_vuln">[FR]ANSSI - Weak or vulnerable certificates (vuln3_certificates_vuln)</a><span class="badge grade-3">3</span><br>
<a href="https://attack.mitre.org/techniques/T1600/001">[MITRE]T1600.001 Weaken Encryption: Reduce Key Space</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-CertROCA"><a name="anchorrulesA-CertROCA"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-CertROCA" aria-expanded="false" aria-controls="rulesA-CertROCA">
          [T]Check for the ROCA vulnerability in certificates (A-CertROCA)
        </button>
      </span>

    </div>

    <div id="rulesA-CertROCA" class="collapse" aria-labelledby="headingrulesA-CertROCA" data-parent="#rulesCertificateTakeOver">
      <div class="card-body">
        <h3>Check for the ROCA vulnerability in certificates</h3>
<strong>Rule ID:</strong><p class="text-justify">A-CertROCA</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that there is no private key that can be recovered from a certificate</p>
<strong>Technical Explanation:</strong><p class="text-justify">"ROCA" is an acronym for "Return of Coppersmith's attack" which enables an attacker to retrieve the private key from a public key.<br>
    It is due by a library named RSALib, provided by Infineon Technologies which is incorporated into many smart cards, Trusted Platform Module (TPM), and Hardware Security Modules (HSM) implementations, including YubiKey 4 tokens and used to generate public RSA keys.<br>
  This library was generating data in a limited number space, which decreased the number of values that an attacker has to guess.</p>
<strong>Advised Solution:</strong><p class="text-justify">If the certificates listed below are still valid, you have to revoke and re-issue them. If other certificates depend on them, they should be revoked and replaced too.<br>
    If the certificates have been expired, they should be removed.</p><strong>Introduced in:</strong><p class="text-justify">2.9.0.0</p><strong>Points:</strong><p>15 points if present</p>
<strong>Documentation:</strong><p><a href="https://crocs.fi.muni.cz/public/papers/rsa_ccs17">https://crocs.fi.muni.cz/public/papers/rsa_ccs17</a><br>
<a href="https://github.com/crocs-muni/roca">https://github.com/crocs-muni/roca</a><br>
<a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/ADV190026">https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/ADV190026</a><br>
<a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/ADV170012">https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/ADV170012</a><br>
<a href="https://keychest.net/roca">https://keychest.net/roca</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#certificates_vuln">[FR]ANSSI - Weak or vulnerable certificates (vuln1_certificates_vuln)</a><span class="badge grade-1">1</span><br>
<a href="https://attack.mitre.org/techniques/T1600/001">[MITRE]T1600.001 Weaken Encryption: Reduce Key Space</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-CertTempCustomSubject"><a name="anchorrulesA-CertTempCustomSubject"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-CertTempCustomSubject" aria-expanded="false" aria-controls="rulesA-CertTempCustomSubject">
          [T]Check if authentication certificate templates allow users to control the subject (A-CertTempCustomSubject)
        </button>
      </span>

    </div>

    <div id="rulesA-CertTempCustomSubject" class="collapse" aria-labelledby="headingrulesA-CertTempCustomSubject" data-parent="#rulesCertificateTakeOver">
      <div class="card-body">
        <h3>Check if authentication certificate templates allow users to control the subject</h3>
<strong>Rule ID:</strong><p class="text-justify">A-CertTempCustomSubject</p>
<strong>Description:</strong><p class="text-justify">The purpose of this rule is to ensure that no certificate request templates allow users to control the subject</p>
<strong>Technical Explanation:</strong><p class="text-justify">Usually, the subject of a certificate is generated automatically by the certification authority.<br>
    By allowing editing before its issuance, a malicious user can set the subject to an administrator account, and thus get a certificate representing them.<br>
  This certificate can be abused later to impersonate them.</p>
<strong>Advised Solution:</strong><p class="text-justify">On the certificate template properties, uncheck in the property sheet "Subject Name" the field "Supply in the request".<br>
     Alternatively, restrict this template to a specific group.<br>
    </p><strong>Introduced in:</strong><p class="text-justify">2.9.3.0</p><strong>Points:</strong><p>15 points if present</p>
<strong>Documentation:</strong><p><a href="https://posts.specterops.io/certified-pre-owned-d95910965cd2">https://posts.specterops.io/certified-pre-owned-d95910965cd2</a><br>
<a href="https://www.riskinsight-wavestone.com/en/2021/06/microsoft-adcs-abusing-pki-in-active-directory-environment/">https://www.riskinsight-wavestone.com/en/2021/06/microsoft-adcs-abusing-pki-in-active-directory-environment/</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#vuln_adcs_template_auth_enroll_with_name">[FR]ANSSI - Dangerous enrollment permission on authentication certificate templates (vuln1_vuln_adcs_template_auth_enroll_with_name)</a><span class="badge grade-1">1</span><br>
<a href="https://attack.mitre.org/techniques/T1558">[MITRE]T1558 Steal or Forge Kerberos Tickets</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-CertTempNoSecurity"><a name="anchorrulesA-CertTempNoSecurity"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-CertTempNoSecurity" aria-expanded="false" aria-controls="rulesA-CertTempNoSecurity">
          [T]Check if authentication certificate templates disallow the tracking of the certificate requester (A-CertTempNoSecurity)
        </button>
      </span>

    </div>

    <div id="rulesA-CertTempNoSecurity" class="collapse" aria-labelledby="headingrulesA-CertTempNoSecurity" data-parent="#rulesCertificateTakeOver">
      <div class="card-body">
        <h3>Check if authentication certificate templates disallow the tracking of the certificate requester</h3>
<strong>Rule ID:</strong><p class="text-justify">A-CertTempNoSecurity</p>
<strong>Description:</strong><p class="text-justify">The purpose of this rule is to ensure that no certificate request templates allow users to control the subject</p>
<strong>Technical Explanation:</strong><p class="text-justify">Certificate requests are tracked by UPN and dnsHost name for computers.<br>
    Usually, editing dnsHost change the value of the attribute servicePrincipalName and duplications are prohibited.<br>
  But there is no constraint on the dnsHost attribute and a controlled change of this attribute (without changing the SPN) can lead to duplicates.<br>
An attacker can then change the DNS of a compromise host to the DC DNS and request a certificate on behalf the DC, thus impersonating it and controlling the domain.</p>
<strong>Advised Solution:</strong><p class="text-justify">Edit the certificate template object and specifically the attribute msPKI-Enrollment-Flag.<br>
     Unset the flag CT_FLAG_NO_SECURITY_EXTENSION (0x80000) aka substract the value 524288 from the attribute msPKI-Enrollment-Flag.<br>
    </p><strong>Introduced in:</strong><p class="text-justify">2.11.0.0</p><strong>Points:</strong><p>15 points if present</p>
<strong>Documentation:</strong><p><a href="https://research.ifcr.dk/certifried-active-directory-domain-privilege-escalation-cve-2022-26923-9e098fe298f4">https://research.ifcr.dk/certifried-active-directory-domain-privilege-escalation-cve-2022-26923-9e098fe298f4</a><br>
<a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-26931">https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-26931</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#vuln_adcs_template_auth_enroll_with_name">[FR]ANSSI - Dangerous enrollment permission on authentication certificate templates (vuln1_vuln_adcs_template_auth_enroll_with_name)</a><span class="badge grade-1">1</span><br>
<a href="https://attack.mitre.org/techniques/T1558">[MITRE]T1558 Steal or Forge Kerberos Tickets</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-CertEnrollHttp"><a name="anchorrulesA-CertEnrollHttp"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-CertEnrollHttp" aria-expanded="false" aria-controls="rulesA-CertEnrollHttp">
          [T]Check if certificate enrollment can be done with HTTP (A-CertEnrollHttp)
        </button>
      </span>

    </div>

    <div id="rulesA-CertEnrollHttp" class="collapse" aria-labelledby="headingrulesA-CertEnrollHttp" data-parent="#rulesCertificateTakeOver">
      <div class="card-body">
        <h3>Check if certificate enrollment can be done with HTTP</h3>
<strong>Rule ID:</strong><p class="text-justify">A-CertEnrollHttp</p>
<strong>Description:</strong><p class="text-justify">The purpose is to check if HTTP can be used to access the certificate enrollment interface</p>
<strong>Technical Explanation:</strong><p class="text-justify">The Windows PKI, also named Active Directory Certificate Services (ADCS), can be used to request certificates.<br>
Two services can be used: Certification Authority Web Enrollment (WebEnrollment) and Certificate Enrollment Web Service (CES).<br>
The certificates provided by these services can be used with Kerberos to login.<br>
    <br>
Because this service can deliver certificates for Domain Controllers, it can be considered as part of Tier 0.<br>
As a legacy service, the mechanisms to prohibit credential relay are not enforced by default.<br>
If an attacker is able to relay privileged credentials (for example with the PetitPotam attack), it can be used to take control of the domain.<br>
        <br>
PingCastle is looking for enrollment servers registered in the Active Directory (pKIEnrollmentService objects).<br>
It then connects to the special page http://xxx/certsrv/certrqxt.asp and http://xxx/yyy_CES_Kerberos/services.svc and tries to access the page with authentication.<br>
    <br>
If the authentication succeed and no error is returned,the program considers the interface accessible.<br>
    <br>
False positives may exists if the PingCastle program is run on the server tested. That's why, if PingCastle is run on the server, the server will not be tested.<br>
</p>
<strong>Advised Solution:</strong><p class="text-justify">The access to certificate enrollment with HTTP should be disabled.<br>
    <br>
This can be achieved by opening the IIS console on the enrollment server.<br>
If the service quoted in detail is WebEnrollment, the url is certsrv, else it is ending by CES_Keberos.<br>
<br>
In the Binding setting (link at the right), keep the HTTPS binding and remove the HTTP binding.<br>
See the link to KB5005413 in references for more information.<br>
    <br>
Note: By default, the CES service is not accessible by HTTP.<br>
  </p><strong>Introduced in:</strong><p class="text-justify">2.11.0.0</p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://support.microsoft.com/en-us/topic/kb5005413-mitigating-ntlm-relay-attacks-on-active-directory-certificate-services-ad-cs-3612b773-4043-4aa9-b23d-b87910cd3429">https://support.microsoft.com/en-us/topic/kb5005413-mitigating-ntlm-relay-attacks-on-active-directory-certificate-services-ad-cs-3612b773-4043-4aa9-b23d-b87910cd3429</a><br>
<a href="https://dirkjanm.io/ntlm-relaying-to-ad-certificate-services/">https://dirkjanm.io/ntlm-relaying-to-ad-certificate-services/</a><br>
<a href="https://www.riskinsight-wavestone.com/en/2021/06/microsoft-adcs-abusing-pki-in-active-directory-environment/">https://www.riskinsight-wavestone.com/en/2021/06/microsoft-adcs-abusing-pki-in-active-directory-environment/</a><br>
<a href="https://www.vkernel.ro/blog/installing-and-configuring-cep-and-ces-for-certificate-enrolling-on-non-domain-joined-computers">https://www.vkernel.ro/blog/installing-and-configuring-cep-and-ces-for-certificate-enrolling-on-non-domain-joined-computers</a><br>
<a href="https://attack.mitre.org/techniques/T1557">[MITRE]T1557 Man-in-the-Middle</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-CertTempAnyone"><a name="anchorrulesA-CertTempAnyone"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-CertTempAnyone" aria-expanded="false" aria-controls="rulesA-CertTempAnyone">
          [T]Check if certificate templates can be edited by everyone. (A-CertTempAnyone)
        </button>
      </span>

    </div>

    <div id="rulesA-CertTempAnyone" class="collapse" aria-labelledby="headingrulesA-CertTempAnyone" data-parent="#rulesCertificateTakeOver">
      <div class="card-body">
        <h3>Check if certificate templates can be edited by everyone.</h3>
<strong>Rule ID:</strong><p class="text-justify">A-CertTempAnyone</p>
<strong>Description:</strong><p class="text-justify">The purpose of this rule is to ensure that there is no certificate template that can be edited by anyone</p>
<strong>Technical Explanation:</strong><p class="text-justify">A certificate template is an object whose definition serves as a base to issue certificates.<br>
    If a user has the right to edit it, it can manually change obscure attributes such as msPKI-Certificate-Name-Flag.<br>
    Doing so will enable him to provide the subject of the certificate and thus having a certificate on behalf other users such as admins.<br>
  It can be used to impersonate them and take control of the domain.<br>
  <br>
Note: the program regards the group "Domain Computers" like "Everyone" if ms-DS-MachineAccountQuota is non zero.</p>
<strong>Advised Solution:</strong><p class="text-justify">Review the security permissions of this certificate template and remove the write access to everyone-like groups such as Domain Users, Domain Computers, Everyone, Authenticated Users, ...<br>
    </p><strong>Introduced in:</strong><p class="text-justify">2.9.3.0</p><strong>Points:</strong><p>15 points if present</p>
<strong>Documentation:</strong><p><a href="https://posts.specterops.io/certified-pre-owned-d95910965cd2">https://posts.specterops.io/certified-pre-owned-d95910965cd2</a><br>
<a href="https://www.riskinsight-wavestone.com/en/2021/06/microsoft-adcs-abusing-pki-in-active-directory-environment/">https://www.riskinsight-wavestone.com/en/2021/06/microsoft-adcs-abusing-pki-in-active-directory-environment/</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#vuln_adcs_template_auth_enroll_with_name">[FR]ANSSI - Dangerous enrollment permission on authentication certificate templates (vuln1_vuln_adcs_template_auth_enroll_with_name)</a><span class="badge grade-1">1</span><br>
<a href="https://attack.mitre.org/techniques/T1558">[MITRE]T1558 Steal or Forge Kerberos Tickets</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-CertEnrollChannelBinding"><a name="anchorrulesA-CertEnrollChannelBinding"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-CertEnrollChannelBinding" aria-expanded="false" aria-controls="rulesA-CertEnrollChannelBinding">
          [T]Check if Extended Protection is in place for certificate requests (A-CertEnrollChannelBinding)
        </button>
      </span>

    </div>

    <div id="rulesA-CertEnrollChannelBinding" class="collapse" aria-labelledby="headingrulesA-CertEnrollChannelBinding" data-parent="#rulesCertificateTakeOver">
      <div class="card-body">
        <h3>Check if Extended Protection is in place for certificate requests</h3>
<strong>Rule ID:</strong><p class="text-justify">A-CertEnrollChannelBinding</p>
<strong>Description:</strong><p class="text-justify">The purpose is to check if the Extended protection for HTTPS access to the certificate enrollment interface is in place</p>
<strong>Technical Explanation:</strong><p class="text-justify">The Windows PKI, also named Active Directory Certificate Services (ADCS), can be used to request certificates.<br>
Two services can be used: Certification Authority Web Enrollment (WebEnrollment) and Certificate Enrollment Web Service (CES).<br>
The certificates provided by these services can be used with Kerberos to login.<br>
    <br>
 Because this service can deliver certificates for Domain Controller, it can be considered as part of Tier 0.<br>
As a legacy service, the mechanisms to prohibit credential relay are not enforced by default.<br>
If an attacker is able to relay privileged credentials (for example with the PetitPotam attack), it can be used to take control of the domain.<br>
    <br>
To avoid this attack with HTTPS, a feature named Channel Binding exists. It consists of passing to the authentication layer a property of the TLS channel (typically a hash of the server certificate) to bind the outer channel (TLS) and the inner channel (HTTP).<br>
This protection is also called "Extended Protection". See rfc5929 for more details.<br>
    <br>
PingCastle is looking for enrollment servers registered in the Active Directory.<br>
It then connect to the special page https://xxx/certsrv/certrqxt.asp and https://xxx/yyy_CES_Kerberos/service.svc<br>
An authentication is attempted with and without Channel Binding.<br>
    <br>
False positives may exists if the PingCastle program is run on the server tested. That's why, if PingCastle is run on the server, the server will not be tested.<br>
</p>
<strong>Advised Solution:</strong><p class="text-justify">The Extended Protection for Authentication (EPA, also called Channel Binding) should be activated on the enrollment server.<br>
    <br>
    This can be achieved by opening the IIS console on the enrollment server.<br>
    In the Authentcation settings, open the Advanced Settings for the Windows Authentication.<br>
    Set "Extended Protection" to "Required".<br>
    <br>
    Do this operation for the Certification Authority Web Enrollment (WebEnrollment) and Certificate Enrollment Web Service (CES).<br>
    <br>
    See the link to KB5005413 below for more information. This KB also suggest to restrict the authentication to Kerberos only.<br>
  </p><strong>Introduced in:</strong><p class="text-justify">2.11.0.0</p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://support.microsoft.com/en-us/topic/kb5005413-mitigating-ntlm-relay-attacks-on-active-directory-certificate-services-ad-cs-3612b773-4043-4aa9-b23d-b87910cd3429">https://support.microsoft.com/en-us/topic/kb5005413-mitigating-ntlm-relay-attacks-on-active-directory-certificate-services-ad-cs-3612b773-4043-4aa9-b23d-b87910cd3429</a><br>
<a href="https://dirkjanm.io/ntlm-relaying-to-ad-certificate-services/">https://dirkjanm.io/ntlm-relaying-to-ad-certificate-services/</a><br>
<a href="https://www.riskinsight-wavestone.com/en/2021/06/microsoft-adcs-abusing-pki-in-active-directory-environment/">https://www.riskinsight-wavestone.com/en/2021/06/microsoft-adcs-abusing-pki-in-active-directory-environment/</a><br>
<a href="https://attack.mitre.org/techniques/T1557">[MITRE]T1557 Man-in-the-Middle</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-DCLdapsProtocol"><a name="anchorrulesA-DCLdapsProtocol"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-DCLdapsProtocol" aria-expanded="false" aria-controls="rulesA-DCLdapsProtocol">
          [T]Check if LDAPS is used with weak SSL protocol. (A-DCLdapsProtocol)
        </button>
      </span>

    </div>

    <div id="rulesA-DCLdapsProtocol" class="collapse" aria-labelledby="headingrulesA-DCLdapsProtocol" data-parent="#rulesCertificateTakeOver">
      <div class="card-body">
        <h3>Check if LDAPS is used with weak SSL protocol.</h3>
<strong>Rule ID:</strong><p class="text-justify">A-DCLdapsProtocol</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that all DC don't use weak SSL protocols when acting as server.</p>
<strong>Technical Explanation:</strong><p class="text-justify">SSL version 2 and SSL version 3 are considered broken and it is strongly advised to disable them.<br>
    The SSL protocols in Windows is provided by the SChannel component.<br>
The SChannel component needs to be tuned in order to not propose these weak protocols. Many guidelines to handle this problem issued by Microsoft do not talk about SChannel but rather IIS. These guidlines are quoted in the documentation section below.<br>
<br>
PingCastle is able to check the SSL version if LDAPS is exposed. LDAPS is automatically exposed once a certificate is available for the DC and the service restarted.<br>
Please note that PingCastle is using the native .Net SSL stack to perform this test. .Net begins to ignore these weak protocols starting the version 4.7 of the framework and as a consequence, PingCasle may miss some weak protocol detection.<br>
<br>
To test for these protocols, you can use a version of openssl with the deprecated protocols still compiled in, e.g. openssl-unsafe from Kali Linux, with the following commands:<br>
openssl-unsafe s_client -connect dc.domain.local:636 -ssl2<br>
openssl-unsafe s_client -connect dc.domain.local:636 -ssl3<br>
    </p>
<strong>Advised Solution:</strong><p class="text-justify">Apply Windows updates and registry tweaks described in the documentation section to disable the weak SSL protocols.<br>
  </p><strong>Introduced in:</strong><p class="text-justify">2.8.0.0</p><strong>Points:</strong><p>10 points if present</p>
<strong>Documentation:</strong><p><a href="https://social.technet.microsoft.com/wiki/contents/articles/2249.windows-server-20082008r2-how-to-disable-sslv2-on-domain-controller-dsforum2wiki.aspx">https://social.technet.microsoft.com/wiki/contents/articles/2249.windows-server-20082008r2-how-to-disable-sslv2-on-domain-controller-dsforum2wiki.aspx</a><br>
<a href="https://support.microsoft.com/en-us/help/187498/how-to-disable-pct-1-0-ssl-2-0-ssl-3-0-or-tls-1-0-in-internet-informat">https://support.microsoft.com/en-us/help/187498/how-to-disable-pct-1-0-ssl-2-0-ssl-3-0-or-tls-1-0-in-internet-informat</a><br>
<a href="https://adsecurity.org/?p=376">https://adsecurity.org/?p=376</a><br>
<a href="https://attack.mitre.org/techniques/T1600/001">[MITRE]T1600.001 Weaken Encryption: Reduce Key Space</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-DCLdapsProtocolAdvanced"><a name="anchorrulesA-DCLdapsProtocolAdvanced"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-DCLdapsProtocolAdvanced" aria-expanded="false" aria-controls="rulesA-DCLdapsProtocolAdvanced">
          [T]Check if LDAPS is using Tls 1.0 or Tls 1.1. (A-DCLdapsProtocolAdvanced)
        </button>
      </span>

    </div>

    <div id="rulesA-DCLdapsProtocolAdvanced" class="collapse" aria-labelledby="headingrulesA-DCLdapsProtocolAdvanced" data-parent="#rulesCertificateTakeOver">
      <div class="card-body">
        <h3>Check if LDAPS is using Tls 1.0 or Tls 1.1.</h3>
<strong>Rule ID:</strong><p class="text-justify">A-DCLdapsProtocolAdvanced</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that all DC are using the most advanced protocols when acting as server.</p>
<strong>Technical Explanation:</strong><p class="text-justify">TLS 1.0 and TLS 1.1 are no longer recommended to use, even if there is no pratical attack to could lead to an immediate compromise of the DC.<br>
The SChannel component needs to be tuned in order to not propose these protocols. Many guidelines to handle this problem issued by Microsoft do not talk about SChannel but rather IIS. These guidlines are quoted in the documentation section below.<br>
<br>
PingCastle is able to check the SSL version if LDAPS is exposed. LDAPS is automatically exposed once a certificate is available for the DC and the service restarted.<br>
Please note that PingCastle is using the native .Net SSL stack to perform this test. .Net begins to ignore these weak protocols starting the version 4.7 of the framework and as a consequence, PingCasle may miss some weak protocol detection.<br>
<br>
To test for these protocols, you can use a version of openssl with the deprecated protocols still compiled in, e.g. openssl-unsafe from Kali Linux, with the following commands:<br>
openssl-unsafe s_client -connect dc.domain.local:636 -tls1 <br>
openssl-unsafe s_client -connect dc.domain.local:636 -tls1_1<br>
    </p>
<strong>Advised Solution:</strong><p class="text-justify">Apply Windows updates and registry tweaks described in the documentation section to use Tls 1.2 and later.<br>
  </p><strong>Introduced in:</strong><p class="text-justify">3.1.0.0</p><strong>Points:</strong><p>Informative rule (0 point)</p>
<strong>Documentation:</strong><p><a href="https://support.microsoft.com/en-us/topic/kb5017811-manage-transport-layer-security-tls-1-0-and-1-1-after-default-behavior-change-on-september-20-2022-e95b1b47-9c7c-4d64-9baf-610604a64c3e">https://support.microsoft.com/en-us/topic/kb5017811-manage-transport-layer-security-tls-1-0-and-1-1-after-default-behavior-change-on-september-20-2022-e95b1b47-9c7c-4d64-9baf-610604a64c3e</a><br>
<a href="https://support.microsoft.com/en-us/help/187498/how-to-disable-pct-1-0-ssl-2-0-ssl-3-0-or-tls-1-0-in-internet-informat">https://support.microsoft.com/en-us/help/187498/how-to-disable-pct-1-0-ssl-2-0-ssl-3-0-or-tls-1-0-in-internet-informat</a><br>
<a href="https://attack.mitre.org/techniques/T1600/001">[MITRE]T1600.001 Weaken Encryption: Reduce Key Space</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-WSUS-SslProtocol"><a name="anchorrulesA-WSUS-SslProtocol"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-WSUS-SslProtocol" aria-expanded="false" aria-controls="rulesA-WSUS-SslProtocol">
          [T]Check if WSUS is used with weak SSL protocol. (A-WSUS-SslProtocol)
        </button>
      </span>

    </div>

    <div id="rulesA-WSUS-SslProtocol" class="collapse" aria-labelledby="headingrulesA-WSUS-SslProtocol" data-parent="#rulesCertificateTakeOver">
      <div class="card-body">
        <h3>Check if WSUS is used with weak SSL protocol.</h3>
<strong>Rule ID:</strong><p class="text-justify">A-WSUS-SslProtocol</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that all WSUS servers don't use weak SSL protocols.</p>
<strong>Technical Explanation:</strong><p class="text-justify">SSL version 2 and SSL version 3 are considered weak and it is strongly advised to disable them.<br>
    The SSL protocols in Windows is provided by the Schannel component.<br>
The Schannel component needs to be tuned in order to not propose these weak protocols. Many guidelines to handle this problem issued by Microsoft do not talk about Schannel but rather IIS. These guidlines are quoted in the documentation section below.<br>
<br>
PingCastle is able to check the SSL version if SSL is exposed.<br>
Please note that PingCastle is using the native .Net SSL stack to perform this test. .Net begins to ignore these weak protocols starting the version 4.7 of the framework and as a consequence, PingCasle may miss some weak protocol detection.<br>
<br>
To test for these protocols, you can use a version of openssl with the deprecated protocols still compiled in, e.g. openssl-unsafe from Kali Linux, with the following commands:<br>
openssl-unsafe s_client -connect dc.domain.local:636 -ssl2<br>
openssl-unsafe s_client -connect dc.domain.local:636 -ssl3<br>
    </p>
<strong>Advised Solution:</strong><p class="text-justify">Apply Windows updates and registry tweaks described in the documentation section to disable the weak SSL protocols.<br>
  </p><strong>Introduced in:</strong><p class="text-justify">2.10.1.0</p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://social.technet.microsoft.com/wiki/contents/articles/2249.windows-server-20082008r2-how-to-disable-sslv2-on-domain-controller-dsforum2wiki.aspx">https://social.technet.microsoft.com/wiki/contents/articles/2249.windows-server-20082008r2-how-to-disable-sslv2-on-domain-controller-dsforum2wiki.aspx</a><br>
<a href="https://support.microsoft.com/en-us/help/187498/how-to-disable-pct-1-0-ssl-2-0-ssl-3-0-or-tls-1-0-in-internet-informat">https://support.microsoft.com/en-us/help/187498/how-to-disable-pct-1-0-ssl-2-0-ssl-3-0-or-tls-1-0-in-internet-informat</a><br>
<a href="https://adsecurity.org/?p=376">https://adsecurity.org/?p=376</a><br>
<a href="https://attack.mitre.org/techniques/T1600/001">[MITRE]T1600.001 Weaken Encryption: Reduce Key Space</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-CertTempAgent"><a name="anchorrulesA-CertTempAgent"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-CertTempAgent" aria-expanded="false" aria-controls="rulesA-CertTempAgent">
          [T]Check the permission of agent certificate templates (A-CertTempAgent)
        </button>
      </span>

    </div>

    <div id="rulesA-CertTempAgent" class="collapse" aria-labelledby="headingrulesA-CertTempAgent" data-parent="#rulesCertificateTakeOver">
      <div class="card-body">
        <h3>Check the permission of agent certificate templates</h3>
<strong>Rule ID:</strong><p class="text-justify">A-CertTempAgent</p>
<strong>Description:</strong><p class="text-justify">The purpose of this rule is to ensure that there is no agent certificate that can be requested by anyone</p>
<strong>Technical Explanation:</strong><p class="text-justify">An Agent certificate is a special certificate used to request certificates on behalf of other users.<br>
    A template has been detected with the agent EKU and that can be enrolled by a large number of users.</p>
<strong>Advised Solution:</strong><p class="text-justify">Review the permissions that allow a wide enrollment of this certificate template<br>
    </p><strong>Introduced in:</strong><p class="text-justify">2.9.3.0</p><strong>Points:</strong><p>15 points if present</p>
<strong>Documentation:</strong><p><a href="https://posts.specterops.io/certified-pre-owned-d95910965cd2">https://posts.specterops.io/certified-pre-owned-d95910965cd2</a><br>
<a href="https://www.riskinsight-wavestone.com/en/2021/06/microsoft-adcs-abusing-pki-in-active-directory-environment/">https://www.riskinsight-wavestone.com/en/2021/06/microsoft-adcs-abusing-pki-in-active-directory-environment/</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#vuln_adcs_template_auth_enroll_with_name">[FR]ANSSI - Dangerous enrollment permission on authentication certificate templates (vuln1_vuln_adcs_template_auth_enroll_with_name)</a><span class="badge grade-1">1</span><br>
<a href="https://attack.mitre.org/techniques/T1558">[MITRE]T1558 Steal or Forge Kerberos Tickets</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-CertTempAnyPurpose"><a name="anchorrulesA-CertTempAnyPurpose"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-CertTempAnyPurpose" aria-expanded="false" aria-controls="rulesA-CertTempAnyPurpose">
          [T]Check the purpose provided by certificate templates (A-CertTempAnyPurpose)
        </button>
      </span>

    </div>

    <div id="rulesA-CertTempAnyPurpose" class="collapse" aria-labelledby="headingrulesA-CertTempAnyPurpose" data-parent="#rulesCertificateTakeOver">
      <div class="card-body">
        <h3>Check the purpose provided by certificate templates</h3>
<strong>Rule ID:</strong><p class="text-justify">A-CertTempAnyPurpose</p>
<strong>Description:</strong><p class="text-justify">The purpose of this rule is to ensure that there is no certificate template with any purpose that can be requested by everyone</p>
<strong>Technical Explanation:</strong><p class="text-justify">A certificate should define restrictions of its use. It is done via extensions known as EKU (extended key usage).<br>
    Without a proper purpose or with the global purpose "Any Purpose" it can be used to enroll certificates on behalf of other users and impersonate them using it.</p>
<strong>Advised Solution:</strong><p class="text-justify">Review the permissions that allow a wide enrollment of this certificate template automatically or specify a specific purpose (EKU)<br>
    </p><strong>Introduced in:</strong><p class="text-justify">2.9.3.0</p><strong>Points:</strong><p>15 points if present</p>
<strong>Documentation:</strong><p><a href="https://posts.specterops.io/certified-pre-owned-d95910965cd2">https://posts.specterops.io/certified-pre-owned-d95910965cd2</a><br>
<a href="https://www.riskinsight-wavestone.com/en/2021/06/microsoft-adcs-abusing-pki-in-active-directory-environment/">https://www.riskinsight-wavestone.com/en/2021/06/microsoft-adcs-abusing-pki-in-active-directory-environment/</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#vuln_adcs_template_auth_enroll_with_name">[FR]ANSSI - Dangerous enrollment permission on authentication certificate templates (vuln1_vuln_adcs_template_auth_enroll_with_name)</a><span class="badge grade-1">1</span><br>
<a href="https://attack.mitre.org/techniques/T1558">[MITRE]T1558 Steal or Forge Kerberos Tickets</a></p>
    </div>
  </div></div></div>
			<!-- Accordion rulesCertificateTakeOver end -->

		<div class="row"><div class="col-lg-12 mt-3">
		<h3>Golden ticket
		</h3>

		<div class="row"><div class="col-lg-12">
		<p>There are key secrets in Active Directory which provide seeds to the cryptographic processes. A leak could lead to a total compromise of the domain.
		</p>

		<!-- Accordion rulesGoldenTicket -->
<div id="rulesGoldenTicket">
<div class="card">
    
    <div class="card-header" id="headingrulesA-Krbtgt"><a name="anchorrulesA-Krbtgt"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-Krbtgt" aria-expanded="false" aria-controls="rulesA-Krbtgt">
          [T]Mitigate golden ticket attack via a regular change of the krbtgt password (A-Krbtgt)
        </button>
      </span>

    </div>

    <div id="rulesA-Krbtgt" class="collapse" aria-labelledby="headingrulesA-Krbtgt" data-parent="#rulesGoldenTicket">
      <div class="card-body">
        <h3>Mitigate golden ticket attack via a regular change of the krbtgt password</h3>
<strong>Rule ID:</strong><p class="text-justify">A-Krbtgt</p>
<strong>Description:</strong><p class="text-justify">The purpose is to alert when the password for the krbtgt account can be used to compromise the whole domain. This password can be used to sign every Kerberos ticket. Monitoring it closely often mitigates the risk of golden ticket attacks greatly.</p>
<strong>Technical Explanation:</strong><p class="text-justify">Kerberos is an authentication protocol. It is using a secret, stored as the password of the krbtgt account, to sign its tickets. If the hash of the password of the krbtgt account is retrieved, it can be used to generate authentication tickets at will.<br>
To mitigate this attack, it is recommended to change the krbtgt password between 40 days and 6 months. If this is not the case, every backup done until the last password change of the krbtgt account can be used to emit Golden tickets, compromising the entire domain.<br>
Retrieval of this secret is one of the highest priority in an attack, as this password is rarely changed and offer a long term backdoor.<br>
Also this attack can be performed using the former password of the krbtgt account. That's why the krbtgt password should be changed twice to invalidate its leak.</p>
<strong>Advised Solution:</strong><p class="text-justify">The password of the krbtgt account should be changed twice to invalidate the golden ticket attack.<br>
<b>Beware: two changes of the krbtgt password not replicated to domain controllers can break these domain controllers</b> You should wait at least 10 hours between each krbtgt password change (this is the duration of a ticket life).<br>
<br>
There are several possibilities to change the krbtgt password.<br>
First, a <a href="https://github.com/microsoft/New-KrbtgtKeys.ps1/blob/master/New-KrbtgtKeys.ps1">Microsoft script</a> can be run in order to guarantee the correct replication of these secrets.<br>
Second, a more manual way is to essentially reset the password manually once, then to wait 3 days (this is a replication safety delay), then to reset it again. This is the safest way as it ensures the password is no longer usable by the Golden ticket attack.<br>
   </p><strong>Points:</strong><p>50 points if the occurence is greater than or equals than 1464<br>
then 40 points if the occurence is greater than or equals than 1098<br>
then 30 points if the occurence is greater than or equals than 732<br>
then 20 points if the occurence is greater than or equals than 366</p>
<strong>Documentation:</strong><p><a href="https://techcommunity.microsoft.com/t5/core-infrastructure-and-security/faqs-from-the-field-on-krbtgt-reset/ba-p/2367838">https://techcommunity.microsoft.com/t5/core-infrastructure-and-security/faqs-from-the-field-on-krbtgt-reset/ba-p/2367838</a><br>
<a href="https://github.com/microsoft/New-KrbtgtKeys.ps1">https://github.com/microsoft/New-KrbtgtKeys.ps1</a><br>
<a href="https://github.com/PSSecTools/Krbtgt">https://github.com/PSSecTools/Krbtgt</a><br>
<a href="https://www.cert.ssi.gouv.fr/actualite/CERTFR-2014-ACT-032/#SECTION00030000000000000000">[FR]ANSSI CERTFR-2014-ACT-032</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#krbtgt">[FR]ANSSI - Krbtgt account password unchanged for more than a year (vuln2_krbtgt)</a><span class="badge grade-2">2</span><br>
<a href="https://attack.mitre.org/techniques/T1558/001">[MITRE]T1558.001 Steal or Forge Kerberos Tickets: Golden Ticket</a></p>
    </div>
  </div></div></div>
			<!-- Accordion rulesGoldenTicket end -->

		<div class="row"><div class="col-lg-12 mt-3">
		<h3>Local group vulnerability
		</h3>

		<div class="row"><div class="col-lg-12">
		<p>The GPO deployed settings are applied to computers locally and they can be abused to take control of individual computers.
		</p>

		<!-- Accordion rulesLocalGroupVulnerability -->
<div id="rulesLocalGroupVulnerability">
<div class="card">
    
    <div class="card-header" id="headingrulesA-MembershipEveryone"><a name="anchorrulesA-MembershipEveryone"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-MembershipEveryone" aria-expanded="false" aria-controls="rulesA-MembershipEveryone">
          [M]Check if a GPO assigns everyone to a local group (A-MembershipEveryone)
        </button>
      </span>

    </div>

    <div id="rulesA-MembershipEveryone" class="collapse" aria-labelledby="headingrulesA-MembershipEveryone" data-parent="#rulesLocalGroupVulnerability">
      <div class="card-body">
        <h3>Check if a GPO assigns everyone to a local group</h3>
<strong>Rule ID:</strong><p class="text-justify">A-MembershipEveryone</p>
<strong>Description:</strong><p class="text-justify">The purpose is to identify if there are local groups such as local administrators, terminal server access, where Authenticated Users or Everyone is being granted access by a GPO</p>
<strong>Technical Explanation:</strong><p class="text-justify">It is possible that a GPO adds local membership using a GPO.<br>
    In this case the rule triggers if one is found with "Everyone" or "Authenticated Users" or "Domain Users", ... as members.<br>
    It basically means that the local Group has no restriction on belongs to it. This represents a security risk as Local Group are supposed to have more accesses or rights.<br>
    The GPO configuration is located in Computer Configuration / Policies / Windows Settings / Security Settings / Restricted Group<br>
    <br>
    This rule checks also the membership set in Computer Configuration / Preferences / Control Panel Settings / Local Users and group.</p>
<strong>Advised Solution:</strong><p class="text-justify">In order to correct the issue, you should edit the GPO and change the local group assignation. Another solution is to change the group to a more targeted one containing a limited set of users.</p><strong>Points:</strong><p>15 points per discovery</p>
<strong>Documentation:</strong><p><a href="http://social.technet.microsoft.com/wiki/contents/articles/20402.active-directory-group-policy-restricted-groups.aspx">http://social.technet.microsoft.com/wiki/contents/articles/20402.active-directory-group-policy-restricted-groups.aspx</a><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a></p>
    </div>
  </div></div></div>
			<!-- Accordion rulesLocalGroupVulnerability end -->

		<div class="row"><div class="col-lg-12 mt-3">
		<h3>Network sniffing
		</h3>

		<div class="row"><div class="col-lg-12">
		<p>Network attacks such as interception or modification can be used to run commands on behalf an administrator.
		</p>

		<!-- Accordion rulesNetworkSniffing -->
<div id="rulesNetworkSniffing">
<div class="card">
    
    <div class="card-header" id="headingrulesA-LMHashAuthorized"><a name="anchorrulesA-LMHashAuthorized"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-LMHashAuthorized" aria-expanded="false" aria-controls="rulesA-LMHashAuthorized">
          [T]Check for GPO enabling the unsafe algorithm LM hash (A-LMHashAuthorized)
        </button>
      </span>

    </div>

    <div id="rulesA-LMHashAuthorized" class="collapse" aria-labelledby="headingrulesA-LMHashAuthorized" data-parent="#rulesNetworkSniffing">
      <div class="card-body">
        <h3>Check for GPO enabling the unsafe algorithm LM hash</h3>
<strong>Rule ID:</strong><p class="text-justify">A-LMHashAuthorized</p>
<strong>Description:</strong><p class="text-justify">The authentication protocol NTLM v1 can use the LM password hash algorithm which is very weak if enabled by a GPO.</p>
<strong>Technical Explanation:</strong><p class="text-justify">LM hash, or LAN Manager hash is a hash algorithm developed by Microsoft since Windows 3.1. Due to a flawed design, hashes retrieved from the network can be reverted to the clear text password in a matter of seconds.</p>
<strong>Advised Solution:</strong><p class="text-justify">A GPO explicitly disabled the default security policy LmCompatibilityLevel or NoLMHash. Using the information provided, identify the setting modified in the GPO and fix it.<br>
All security settings should be modified in the Domain GPO Editor and are located in Computer Configuration / Policies / Windows Settings / Security Settings / Local Policies / Security Options<br>
For NoLMHash the setting is located in: Network security: Do not store LAN Manager hash value on next password change<br>
For LmCompatibilityLevel the setting is located in: Network security: LAN Manager authentication level</p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://www.ssi.gouv.fr/uploads/IMG/pdf/NP_ActiveDirectory_NoteTech.pdf#paragraph.3.6.2.1">[FR]ANSSI - Recommandations de sécurité relatives à Active Directory - R37 [paragraph.3.6.2.1]</a><br>
<a href="https://www.stigviewer.com/stig/windows_2008_member_server/2018-03-07/finding/V-3379">[US]STIG V-3379 - The system is configured to store the LAN Manager hash of the password in the SAM.</a><br>
<a href="https://attack.mitre.org/techniques/T1110/002">[MITRE]T1110.002 Brute Force: Password Cracking</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-DnsZoneAUCreateChild"><a name="anchorrulesA-DnsZoneAUCreateChild"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-DnsZoneAUCreateChild" aria-expanded="false" aria-controls="rulesA-DnsZoneAUCreateChild">
          [T]Check if Authenticated Users can create DNS records (A-DnsZoneAUCreateChild)
        </button>
      </span>

    </div>

    <div id="rulesA-DnsZoneAUCreateChild" class="collapse" aria-labelledby="headingrulesA-DnsZoneAUCreateChild" data-parent="#rulesNetworkSniffing">
      <div class="card-body">
        <h3>Check if Authenticated Users can create DNS records</h3>
<strong>Rule ID:</strong><p class="text-justify">A-DnsZoneAUCreateChild</p>
<strong>Description:</strong><p class="text-justify">The purpose is to check if Authenticated Users has the right to create DNS records</p>
<strong>Technical Explanation:</strong><p class="text-justify">When a computer is joined to a domain, a DNS record is created in the DnsZone to allow the computer to update its DNS settings.<br>
    By design, Microsoft choose to grant to the group Authenticated Users (aka every computers and users) the right to create DNS records.<br>
    Once created, only the owner keeps the right to edit the new object.<br>
    <br>
    The vulnerability is that specific DNS records can be created to perform man-in-the-middle attacks.<br>
    One example is to create a wildcard record (a record with the name "*"), a failover DNS record or anticipating the creation of a DNS record with the right permissions.<br>
</p>
<strong>Advised Solution:</strong><p class="text-justify">As of today, this rule is considered "informative" because the default configuration where Authenticated Users can create DNS records is considered safe.<br>
  The reason for this classification is that no exploitation of that vulnerability has been reported.<br>
    <br>
The proposed enhancement is to replace the identity who has been granted the right to create DNS Records (permission CreateChild) from Authenticated Users to Domain Computers.<br>
To perform this change, you have to edit the permission of the DNSZone whose object is located in the container CN=MicrosoftDNS,DC=DomainDnsZones.<br>
<br>
It should be noticed that if there is a privilege escalation on a computer, an attacker can impersonate the computer account and bypass this mitigation.<br>
<br>
The best mitigation is to create the DNS records manually as part as the domain join process and to revoke the permission granted to Authenticated Users.<br>
    </p><strong>Introduced in:</strong><p class="text-justify">2.10.1.0</p><strong>Points:</strong><p>Informative rule (0 point)</p>
<strong>Documentation:</strong><p><a href="https://www.ws-its.de/gegenmassnahme-zum-angriff-dns-wildcard/">https://www.ws-its.de/gegenmassnahme-zum-angriff-dns-wildcard/</a><br>
<a href="https://www.netspi.com/blog/technical/network-penetration-testing/exploiting-adidns/">https://www.netspi.com/blog/technical/network-penetration-testing/exploiting-adidns/</a><br>
<a href="https://attack.mitre.org/techniques/T1557">[MITRE]T1557 Man-in-the-Middle</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-DnsZoneUpdate1"><a name="anchorrulesA-DnsZoneUpdate1"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-DnsZoneUpdate1" aria-expanded="false" aria-controls="rulesA-DnsZoneUpdate1">
          [T]Check if DNS Zones are configured with insecure update. (A-DnsZoneUpdate1)
        </button>
      </span>

    </div>

    <div id="rulesA-DnsZoneUpdate1" class="collapse" aria-labelledby="headingrulesA-DnsZoneUpdate1" data-parent="#rulesNetworkSniffing">
      <div class="card-body">
        <h3>Check if DNS Zones are configured with insecure update.</h3>
<strong>Rule ID:</strong><p class="text-justify">A-DnsZoneUpdate1</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that the DNS Zones are configured to accept only secure update.</p>
<strong>Technical Explanation:</strong><p class="text-justify">When the insecure update mechanism is enabled, an attacker can update a DNS record anonymously.<br>
    He can then use this feature to add new entries or perform a man in the middle attack to capture credentials.<br>
  <br>
    Please note that the rule A-DnsZoneUpdate1 is the companion of A-DnsZoneUpdate2 and it is used to report anomalies related to the local domain zone or the main _msdcs zone. A-DnsZoneUpdate2 reports all the other zones.<br>
    </p>
<strong>Advised Solution:</strong><p class="text-justify">You have to enable secure updates. <br>
    Identify the faulty zone in the details below.<br>
    Go to the DNS console and select a zone in the "Forward Lookup Zones".<br>
    Right click on it and switch to the "General" tab.<br>
    Then change Dynamic updates from "Nonsecure and secure" to "Secure only".<br>
    You can also run: dnscmd servername /Config zone /AllowUpdate 2<br>
    </p><strong>Introduced in:</strong><p class="text-justify">2.9.0.0</p><strong>Points:</strong><p>15 points if present</p>
<strong>Documentation:</strong><p><a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-dnsp/f97756c9-3783-428b-9451-b376f877319a">https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-dnsp/f97756c9-3783-428b-9451-b376f877319a</a><br>
<a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/dnscmd">    https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/dnscmd</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#dnszone_bad_prop">[FR]ANSSI - Misconfigured DNS zones (vuln1_dnszone_bad_prop)</a><span class="badge grade-1">1</span><br>
<a href="https://attack.mitre.org/techniques/T1557">[MITRE]T1557 Man-in-the-Middle</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-DnsZoneUpdate2"><a name="anchorrulesA-DnsZoneUpdate2"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-DnsZoneUpdate2" aria-expanded="false" aria-controls="rulesA-DnsZoneUpdate2">
          [T]Check if DNS Zones are configured with insecure update. (A-DnsZoneUpdate2)
        </button>
      </span>

    </div>

    <div id="rulesA-DnsZoneUpdate2" class="collapse" aria-labelledby="headingrulesA-DnsZoneUpdate2" data-parent="#rulesNetworkSniffing">
      <div class="card-body">
        <h3>Check if DNS Zones are configured with insecure update.</h3>
<strong>Rule ID:</strong><p class="text-justify">A-DnsZoneUpdate2</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that the DNS Zones are configured to accept only secure update.</p>
<strong>Technical Explanation:</strong><p class="text-justify">When the insecure update mechanism is enabled, an attacker can update a DNS record anonymously.<br>
    He can then use this feature to add new entries or perform a man in the middle attack to capture credentials.<br>
  <br>
    Please note that the rule A-DnsZoneUpdate1 is the companion of A-DnsZoneUpdate2 and it is used to report anomalies related to the local domain zone or the main _msdcs zone. A-DnsZoneUpdate2 reports all the other zones.<br>
    </p>
<strong>Advised Solution:</strong><p class="text-justify">You have to enable secure updates. <br>
    Identify the faulty zone in the details below.<br>
    Go to the DNS console and select a zone in the "Forward Lookup Zones".<br>
    Right click on it and switch to the "General" tab.<br>
    Then change Dynamic updates from "Nonsecure and secure" to "Secure only".<br>
    You can also run: dnscmd servername /Config zone /AllowUpdate 2<br>
    </p><strong>Introduced in:</strong><p class="text-justify">2.9.0.0</p><strong>Points:</strong><p>1 points if present</p>
<strong>Documentation:</strong><p><a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-dnsp/f97756c9-3783-428b-9451-b376f877319a">https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-dnsp/f97756c9-3783-428b-9451-b376f877319a</a><br>
<a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/dnscmd">    https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/dnscmd</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#dnszone_bad_prop">[FR]ANSSI - Misconfigured DNS zones (vuln3_dnszone_bad_prop)</a><span class="badge grade-3">3</span><br>
<a href="https://attack.mitre.org/techniques/T1557">[MITRE]T1557 Man-in-the-Middle</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-NoGPOLLMNR"><a name="anchorrulesA-NoGPOLLMNR"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-NoGPOLLMNR" aria-expanded="false" aria-controls="rulesA-NoGPOLLMNR">
          [T]Check if LLMNR can be used to steal credentials (A-NoGPOLLMNR)
        </button>
      </span>

    </div>

    <div id="rulesA-NoGPOLLMNR" class="collapse" aria-labelledby="headingrulesA-NoGPOLLMNR" data-parent="#rulesNetworkSniffing">
      <div class="card-body">
        <h3>Check if LLMNR can be used to steal credentials</h3>
<strong>Rule ID:</strong><p class="text-justify">A-NoGPOLLMNR</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that local name resolution protocol (LLMNR) cannot be used to collect credentials by performing a network attack</p>
<strong>Technical Explanation:</strong><p class="text-justify">LLMNR is a protocol which translates names such as foo.bar.com into an ip address. LLMNR has been designed to translate name locally in case the default protocol DNS is not available.<br>
    Regarding Active Directory, DNS is mandatory which makes LLMNR useless.<br>
  LLMNR exploits typo mistakes or faster response time to redirect users to a specially designed share, server or website.<br>
  Being trusted, this service will trigger the single sign on procedure which can be abused to retrieve the user credentials.<br>
<br>
    LLMNR is enabled by default on all OS except starting from Windows 10 v1903 and Windows Server v1903 where it is disabled.<br>
    </p>
<strong>Advised Solution:</strong><p class="text-justify">Enable the GPO <a href="https://docs.microsoft.com/en-us/windows/client-management/mdm/policy-csp-admx-dnsclient#admx-dnsclient-turn-off-multicast">Turn off multicast name resolution</a> and check that no GPO overrides this setting.<br>
    (if it is the case, the policy involved will be displayed below)</p><strong>Introduced in:</strong><p class="text-justify">2.7.0.0</p><strong>Points:</strong><p>Informative rule (0 point)</p>
<strong>Documentation:</strong><p><a href="https://youtu.be/Fg2gvk0qgjM">https://youtu.be/Fg2gvk0qgjM</a><br>
<a href="https://attack.mitre.org/techniques/T1557/001">[MITRE]T1557.001 Man-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-NTFRSOnSysvol"><a name="anchorrulesA-NTFRSOnSysvol"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-NTFRSOnSysvol" aria-expanded="false" aria-controls="rulesA-NTFRSOnSysvol">
          [T]Check if NTFRS is used to replicate SYSVOL (A-NTFRSOnSysvol)
        </button>
      </span>

    </div>

    <div id="rulesA-NTFRSOnSysvol" class="collapse" aria-labelledby="headingrulesA-NTFRSOnSysvol" data-parent="#rulesNetworkSniffing">
      <div class="card-body">
        <h3>Check if NTFRS is used to replicate SYSVOL</h3>
<strong>Rule ID:</strong><p class="text-justify">A-NTFRSOnSysvol</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that the old NTFRS protocol is not used to replicate the SYSVOL share.</p>
<strong>Technical Explanation:</strong><p class="text-justify">NTFRS is an old protocol and is considered insecure.<br>
    The SYSVOL share is mainly hosted on domain controllers to host GPO files and login scripts.<br>
  If the content can be modified, it can be used to grant to a hacker the control of the computers reading these configuration files.<br>
To know if the setting is enabled, PingCastle read the following LDAP entry: CN=Domain System Volume (SYSVOL share),CN=File Replication Service,CN=System<br>
If there is any entry found, the program consider that NTFRS is in use for SYSVOL replication.<br>
<br>
Starting in Windows Server 2019, promoting new domain controllers requires the DFS Replication (DFSR) to replicate the contents in the SYSVOL share.<br>
As a consequence this rule become informative if at least one Windows Server 2019 or more recent is installed as a Domain Controller.<br>
<br>
Please note that at the time of writing, Microsoft supports it until Windows Server 2022 (see the Open Specification link in the documentation section below)<br>
</p>
<strong>Advised Solution:</strong><p class="text-justify">You have to migrate from NTFRS to DFS replication. See the documentation below for more details.<br>
    </p><strong>Introduced in:</strong><p class="text-justify">2.9.0.0</p><strong>Points:</strong><p>5 points if the occurence is greater than or equals than 2<br>
then Informative rule (0 point)</p>
<strong>Documentation:</strong><p><a href="https://docs.microsoft.com/en-us/windows-server/storage/dfs-replication/migrate-sysvol-to-dfsr">https://docs.microsoft.com/en-us/windows-server/storage/dfs-replication/migrate-sysvol-to-dfsr</a><br>
<a href="https://support.microsoft.com/en-us/help/312862/recovering-missing-frs-objects-and-frs-attributes-in-active-directory">https://support.microsoft.com/en-us/help/312862/recovering-missing-frs-objects-and-frs-attributes-in-active-directory</a><br>
<a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-frs1/d18cc589-677e-4133-97e5-113641792c5e">https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-frs1/d18cc589-677e-4133-97e5-113641792c5e</a><br>
<a href="https://docs.microsoft.com/en-us/troubleshoot/windows-server/networking/sysvol-dfsr-migration-fails-after-in-place-upgrade">https://docs.microsoft.com/en-us/troubleshoot/windows-server/networking/sysvol-dfsr-migration-fails-after-in-place-upgrade</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#sysvol_ntfrs">[FR]ANSSI - SYSVOL replication through NTFRS (vuln2_sysvol_ntfrs)</a><span class="badge grade-2">2</span><br>
<a href="https://attack.mitre.org/techniques/T1563">[MITRE]T1563 Remote Service Session Hijacking</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-DCLdapSign"><a name="anchorrulesA-DCLdapSign"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-DCLdapSign" aria-expanded="false" aria-controls="rulesA-DCLdapSign">
          [T]Check if signing is really required for LDAP (A-DCLdapSign)
        </button>
      </span>

    </div>

    <div id="rulesA-DCLdapSign" class="collapse" aria-labelledby="headingrulesA-DCLdapSign" data-parent="#rulesNetworkSniffing">
      <div class="card-body">
        <h3>Check if signing is really required for LDAP</h3>
<strong>Rule ID:</strong><p class="text-justify">A-DCLdapSign</p>
<strong>Description:</strong><p class="text-justify">The purpose is to check if signing is really required for LDAP</p>
<strong>Technical Explanation:</strong><p class="text-justify">If the the request for signing of each LDAP request is not enforced, a man in the middle can be performed on an LDAP connection.<br>
For example to add a user to the admin group.<br>
    <br>
This test is made by ignoring the local computer security policies.<br>
Signature enforcement is done by setting the flag ISC_REQ_INTEGRITY when initializig the Negotiate / NTLM / Kerberos authentication.<br>
The opposite test is made with the flag ISC_REQ_NO_INTEGRITY set.<br>
    <br>
PingCastle is testing if this setting is in place by performing a LDAP authentication with and without signature enforcement.<br>
False positives may exists if the PingCastle program is run on the server tested. That's why, if PingCastle is run on a DC, the DC will not be tested.<br>
</p>
<strong>Advised Solution:</strong><p class="text-justify">You have to make sure that ALL LDAP clients are compatible with LDAP signature.<br>
All versions of Windows since XP support this and also most of the Unix clients.<br>
<br>
You have to follow the Microsoft article quoted in reference to enable LDAP signing.<br>
This includes auditing the clients which are not compatible and instructions on how to enforce this policy.</p><strong>Introduced in:</strong><p class="text-justify">2.11.0.0</p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://docs.microsoft.com/en-US/troubleshoot/windows-server/identity/enable-ldap-signing-in-windows-server">https://docs.microsoft.com/en-US/troubleshoot/windows-server/identity/enable-ldap-signing-in-windows-server</a><br>
<a href="https://techcommunity.microsoft.com/t5/core-infrastructure-and-security/ldap-channel-binding-and-ldap-signing-requirements-march-2020/ba-p/921536/page/4">https://techcommunity.microsoft.com/t5/core-infrastructure-and-security/ldap-channel-binding-and-ldap-signing-requirements-march-2020/ba-p/921536/page/4</a><br>
<a href="https://github.com/zyn3rgy/LdapRelayScan">https://github.com/zyn3rgy/LdapRelayScan</a><br>
<a href="https://attack.mitre.org/techniques/T1557">[MITRE]T1557 Man-in-the-Middle</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-DCLdapsChannelBinding"><a name="anchorrulesA-DCLdapsChannelBinding"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-DCLdapsChannelBinding" aria-expanded="false" aria-controls="rulesA-DCLdapsChannelBinding">
          [T]Check if the Channel Binding is enabled for LDAPS (A-DCLdapsChannelBinding)
        </button>
      </span>

    </div>

    <div id="rulesA-DCLdapsChannelBinding" class="collapse" aria-labelledby="headingrulesA-DCLdapsChannelBinding" data-parent="#rulesNetworkSniffing">
      <div class="card-body">
        <h3>Check if the Channel Binding is enabled for LDAPS</h3>
<strong>Rule ID:</strong><p class="text-justify">A-DCLdapsChannelBinding</p>
<strong>Description:</strong><p class="text-justify">The purpose is to check if the Channel Binding feature of LDAPS is enforced</p>
<strong>Technical Explanation:</strong><p class="text-justify">LDAPS (opposed to LDAP) does not allow message signature because this protection is made by the TLS layer.<br>
As a consequence, forged LDAP packets can be relayed in a TLS tunnel, thus becoming LDAPS and without any protection against relay.<br>
<br>
To avoid this attack, a feature named Channel Binding exists. It consists of passing to the authentication layer a property of the TLS channel (typically a hash of the server certificate) to bind the outer channel (TLS) and the inner channel (LDAP).<br>
This protection is also called "Extended Protection".<br>
<br>
PingCastle is testing if this binding is in place by performing a LDAPS authentication with Channel Binding enabled and disabled.<br>
False positives may exists if the PingCastle program is run on the server tested. That's why, if PingCastle is run on a DC, the DC will not be tested.<br>
</p>
<strong>Advised Solution:</strong><p class="text-justify">You have to make sure that ALL LDAPS clients are compatible with Channel Binding.<br>
All supported Windows have been updated since March 2020 to take this into account and also most of the Unix clients (see the RedHat bulletin link below).<br>
<br>
You can start auditing via registry, on each domain controller<br>
Reg Add HKLM\SYSTEM\CurrentControlSet\Services\NTDS\Diagnostics /v "16 LDAP Interface Events" /t REG_DWORD /d 2<br>
Then monitor the Windows event IDs 3039 and 3040.<br>
<br>
Once it has been verified that all clients are compatible, Channel Binding can be enforced:<br>
create the key LdapEnforceChannelBinding in HKLM\SYSTEM\CurrentControlSet\Services\NTDS\Parameters and set its value to 1 or 2<br>
    </p><strong>Introduced in:</strong><p class="text-justify">2.11.0.0</p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://support.microsoft.com/en-us/topic/use-the-ldapenforcechannelbinding-registry-entry-to-make-ldap-authentication-over-ssl-tls-more-secure-e9ecfa27-5e57-8519-6ba3-d2c06b21812e">https://support.microsoft.com/en-us/topic/use-the-ldapenforcechannelbinding-registry-entry-to-make-ldap-authentication-over-ssl-tls-more-secure-e9ecfa27-5e57-8519-6ba3-d2c06b21812e</a><br>
<a href="https://techcommunity.microsoft.com/t5/core-infrastructure-and-security/ldap-channel-binding-and-ldap-signing-requirements-march-2020/ba-p/921536/page/4">https://techcommunity.microsoft.com/t5/core-infrastructure-and-security/ldap-channel-binding-and-ldap-signing-requirements-march-2020/ba-p/921536/page/4</a><br>
<a href="https://oxfordcomputergroup.com/resources/ldap-channel-binding-signing-requirements/">https://oxfordcomputergroup.com/resources/ldap-channel-binding-signing-requirements/</a><br>
<a href="https://github.com/zyn3rgy/LdapRelayScan">https://github.com/zyn3rgy/LdapRelayScan</a><br>
<a href="https://access.redhat.com/articles/4661861">https://access.redhat.com/articles/4661861</a><br>
<a href="http://gary-nebbett.blogspot.com/2020/01/ldap-channel-binding.html">http://gary-nebbett.blogspot.com/2020/01/ldap-channel-binding.html</a><br>
<a href="https://attack.mitre.org/techniques/T1557">[MITRE]T1557 Man-in-the-Middle</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-SMB2SignatureNotEnabled"><a name="anchorrulesA-SMB2SignatureNotEnabled"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-SMB2SignatureNotEnabled" aria-expanded="false" aria-controls="rulesA-SMB2SignatureNotEnabled">
          [T]Check if the file share protocol can sign its network dialog (A-SMB2SignatureNotEnabled)
        </button>
      </span>

    </div>

    <div id="rulesA-SMB2SignatureNotEnabled" class="collapse" aria-labelledby="headingrulesA-SMB2SignatureNotEnabled" data-parent="#rulesNetworkSniffing">
      <div class="card-body">
        <h3>Check if the file share protocol can sign its network dialog</h3>
<strong>Rule ID:</strong><p class="text-justify">A-SMB2SignatureNotEnabled</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that the SMB version 2 protocol has signing enabled when communicating with domain controllers</p>
<strong>Technical Explanation:</strong><p class="text-justify">Python responder is a tool used to compromise a domain by listening for SMB connections and injecting rogue data into the communications at the network level. SMB v1 does not provide a mechanism to enforce integrity and thus is compromised easily. SMB v2 (and subsequent version SMB v3) provides a way to guarantee the integrity of the network communication via a signature of each packet. By establishing a SMB v2 dialog with domain controllers, PingCastle checks the signature capability by looking at the SMB options provided by the server.</p>
<strong>Advised Solution:</strong><p class="text-justify">Enable the group policy "Digitally sign communications (if client agrees)" or check for any policy, which may alter the server settings. See the <a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/smbv1-microsoft-network-server-digitally-sign-communications-if-client-agrees">official documentation</a> for more information.</p><strong>Introduced in:</strong><p class="text-justify">2.5.0.0</p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://msdn.microsoft.com/en-us/library/cc246675.aspx">https://msdn.microsoft.com/en-us/library/cc246675.aspx</a><br>
<a href="https://www.cert.ssi.gouv.fr/actualite/CERTFR-2015-ACT-021/#SECTION00010000000000000000">[FR]ANSSI CERTFR-2015-ACT-021</a><br>
<a href="https://attack.mitre.org/techniques/T1557">[MITRE]T1557 Man-in-the-Middle</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-SMB2SignatureNotRequired"><a name="anchorrulesA-SMB2SignatureNotRequired"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-SMB2SignatureNotRequired" aria-expanded="false" aria-controls="rulesA-SMB2SignatureNotRequired">
          [T]Check if the file share protocol requires its client to sign its network dialog (A-SMB2SignatureNotRequired)
        </button>
      </span>

    </div>

    <div id="rulesA-SMB2SignatureNotRequired" class="collapse" aria-labelledby="headingrulesA-SMB2SignatureNotRequired" data-parent="#rulesNetworkSniffing">
      <div class="card-body">
        <h3>Check if the file share protocol requires its client to sign its network dialog</h3>
<strong>Rule ID:</strong><p class="text-justify">A-SMB2SignatureNotRequired</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that the SMB version 2 protocol has signing enforced when communicating with domain controllers</p>
<strong>Technical Explanation:</strong><p class="text-justify">Python responder is a tool used to compromise a domain by listening for SMB connections and injecting rogue data into the communications at the network level. SMB v1 does not provide a mechanism to enforce integrity and thus is compromised easily. SMB v2 (and subsequent version SMB v3) provides a way to guarantee the integrity of the network communication via a signature of each packet. By establishing a SMB v2 dialog with domain controllers, PingCastle checks the signature capability by looking at the SMB options provided by the server.</p>
<strong>Advised Solution:</strong><p class="text-justify">Enable the group policy "Digitally sign communications (always)" or check for any policy which may alter the server settings. See the <a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/microsoft-network-server-digitally-sign-communications-always">official documentation</a> for more information.</p><strong>Introduced in:</strong><p class="text-justify">2.5.0.0</p><strong>Points:</strong><p>Informative rule (0 point)</p>
<strong>Documentation:</strong><p><a href="https://msdn.microsoft.com/en-us/library/cc246675.aspx">https://msdn.microsoft.com/en-us/library/cc246675.aspx</a><br>
<a href="https://www.cert.ssi.gouv.fr/actualite/CERTFR-2015-ACT-021/#SECTION00010000000000000000">[FR]ANSSI CERTFR-2015-ACT-021</a><br>
<a href="https://attack.mitre.org/techniques/T1557">[MITRE]T1557 Man-in-the-Middle</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-LDAPSigningDisabled"><a name="anchorrulesA-LDAPSigningDisabled"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-LDAPSigningDisabled" aria-expanded="false" aria-controls="rulesA-LDAPSigningDisabled">
          [T]Ensure LDAP signing requirements is not set to None (A-LDAPSigningDisabled)
        </button>
      </span>

    </div>

    <div id="rulesA-LDAPSigningDisabled" class="collapse" aria-labelledby="headingrulesA-LDAPSigningDisabled" data-parent="#rulesNetworkSniffing">
      <div class="card-body">
        <h3>Ensure LDAP signing requirements is not set to None</h3>
<strong>Rule ID:</strong><p class="text-justify">A-LDAPSigningDisabled</p>
<strong>Description:</strong><p class="text-justify">The purpose is to check that the integrity of the network protocol LDAP as not been endangered by explicitly disabling LDAP signing.</p>
<strong>Technical Explanation:</strong><p class="text-justify">The LDAP signature feature enables the integrity of the network communication between the computer and the domain controller.<br>
Hackers aim at intercepting the communication at the network layer and modify the network dialog to grant themselves admin privileges.<br>
The goal of this feature is to defeat these attacks.<br>
Unfortunately, not all devices support LDAP signature. That's why the best practice is to Require Signature if possible or to, at least, try to negotiate it.<br>
In this case, the LDAP signature feature is configured to None (no negotiation), which can enable hackers to perform their attacks.</p>
<strong>Advised Solution:</strong><p class="text-justify">Locate the GPO specified in Details and change the setting in "Network security: LDAP client signing requirements".<br>
    Disable this setting, or set it to "Negotiate signing" or "Require Signature".<br>
The setting is located in :<br>
    Computer configuration -&gt; Policies -&gt; Windows Settings -&gt;Security Settings -&gt; Local Policies -&gt; Security Options.<br>
As an alternative, the file GptTmpl.inf can be manually edited.</p><strong>Introduced in:</strong><p class="text-justify">2.7.0.0</p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/network-security-ldap-client-signing-requirements">https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/network-security-ldap-client-signing-requirements</a><br>
<a href="https://attack.mitre.org/techniques/T1557">[MITRE]T1557 Man-in-the-Middle</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-HardenedPaths"><a name="anchorrulesA-HardenedPaths"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-HardenedPaths" aria-expanded="false" aria-controls="rulesA-HardenedPaths">
          [T]Hardened Paths weakness (A-HardenedPaths)
        </button>
      </span>

    </div>

    <div id="rulesA-HardenedPaths" class="collapse" aria-labelledby="headingrulesA-HardenedPaths" data-parent="#rulesNetworkSniffing">
      <div class="card-body">
        <h3>Hardened Paths weakness</h3>
<strong>Rule ID:</strong><p class="text-justify">A-HardenedPaths</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that there is no weakness related to hardened paths</p>
<strong>Technical Explanation:</strong><p class="text-justify">Two vulnerabilities have been reported in 2015 (MS15-011 and MS15-014) which allows a domain takeover via GPO modifications done with a man-in-the-middle attack.<br>
    To mitigate these vulnerabilites, Microsoft has designed a workaround named "Hardened Paths". It forces connection settings to enforce Integrity, Mutual Authentication or Privacy.<br>
    By default if this policy is empty, if will enforce Integrity and Mutual Authentication on the SYSVOL or NETLOGON shares.<br>
    This rule checks if there have been any overwrite to disable this protection.<br>
    </p>
<strong>Advised Solution:</strong><p class="text-justify">You have to edit the Hardened Path section in the GPO.<br>
    This section is located in Computer Configuration/Policies/Administrative Templates/Network/Network Provider.<br>
  Check each value reported here and make sure that entries containing SYSVOL or NETLOGON have RequireIntegrity and RequireMutualAuthentication set to 1.<br>
  In addition to that, check entries having the pattern \\DCName\* and apply the same solution.</p><strong>Introduced in:</strong><p class="text-justify">2.10.1.0</p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://www.pingcastle.com/PingCastleFiles/ad_hc_rules_list.html"></a><br>
<a href="https://labs.f-secure.com/archive/how-to-own-any-windows-network-with-group-policy-hijacking-attacks/">https://labs.f-secure.com/archive/how-to-own-any-windows-network-with-group-policy-hijacking-attacks/</a><br>
<a href="https://talubu.wordpress.com/2018/02/28/configuring-unc-hardened-access-through-group-policy/">https://talubu.wordpress.com/2018/02/28/configuring-unc-hardened-access-through-group-policy/</a><br>
<a href="https://adsecurity.org/?p=1405">https://adsecurity.org/?p=1405</a><br>
<a href="https://support.microsoft.com/en-us/topic/ms15-011-vulnerability-in-group-policy-could-allow-remote-code-execution-february-10-2015-91b4bda2-945d-455b-ebbb-01d1ec191328">https://support.microsoft.com/en-us/topic/ms15-011-vulnerability-in-group-policy-could-allow-remote-code-execution-february-10-2015-91b4bda2-945d-455b-ebbb-01d1ec191328</a><br>
<a href="https://www.stigviewer.com/stig/windows_10/2018-04-06/finding/V-63577">[US]STIG V-63577 - Hardened UNC Paths must be defined to require mutual authentication and integrity for at least the \\*\SYSVOL and \\*\NETLOGON shares.</a><br>
<a href="https://attack.mitre.org/techniques/T1557/001">[MITRE]T1557.001 Man-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay</a></p>
    </div>
  </div></div></div>
			<!-- Accordion rulesNetworkSniffing end -->

		<div class="row"><div class="col-lg-12 mt-3">
		<h3>Pass-the-credential
		</h3>

		<div class="row"><div class="col-lg-12">
		<p>If the password is a secret, which protects its derivatives, such as the fingerprint named hash, it can be used as if it was the password itself.
		</p>

		<!-- Accordion rulesPassTheCredential -->
<div id="rulesPassTheCredential">
<div class="card">
    
    <div class="card-header" id="headingrulesA-SmartCardRequired"><a name="anchorrulesA-SmartCardRequired"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-SmartCardRequired" aria-expanded="false" aria-controls="rulesA-SmartCardRequired">
          [T]Check for accounts using smart card with unchanged password for a long time (A-SmartCardRequired)
        </button>
      </span>

    </div>

    <div id="rulesA-SmartCardRequired" class="collapse" aria-labelledby="headingrulesA-SmartCardRequired" data-parent="#rulesPassTheCredential">
      <div class="card-body">
        <h3>Check for accounts using smart card with unchanged password for a long time</h3>
<strong>Rule ID:</strong><p class="text-justify">A-SmartCardRequired</p>
<strong>Description:</strong><p class="text-justify">The purpose is to make sure the requirement of Smart Cards doesn't degrade password rotation</p>
<strong>Technical Explanation:</strong><p class="text-justify">Using smart cards to protected sensitive accounts is a good thing. Nevertheless, when the "Smart Card required" flag is set, the password of the account is not changed anymore by default. The rule is triggered 90 days after the last change of the attribute unicodePwd. This value is collected using the replication metadata of the attribute 589914</p>
<strong>Advised Solution:</strong><p class="text-justify">There are a few solutions to fix this issue, the most obvious being to change the user password on a regular basis. <br>
    The fastest way is to check if the domain has the attribute <i>msDS-ExpirePasswordsOnSmartCardOnlyAccounts</i>, which is available for Windows Server 2016 and later versions and handles periodically hash change. <br>
    Be sure also that functional level is at least Windows Server 2016 the GPO "Enable rolling of expiring NTLM secrets during sign on, for users who are required to use Microsoft Passport or smart card for interactive sign on"  is not disabled.<br>
    Another possibility, instead of changing the password, is to disable the flag "this account requires a smart card" then re-enable it, which will trigger an internal password hash change.<br>
    You can also used the script provided by the DoD named Invoke-SmartcardHashRefresh (see link below)</p><strong>Points:</strong><p>30 points if present</p>
<strong>Documentation:</strong><p><a href="https://blogs.technet.microsoft.com/positivesecurity/2017/05/17/smartcard-and-pass-the-hash/">https://blogs.technet.microsoft.com/positivesecurity/2017/05/17/smartcard-and-pass-the-hash/</a><br>
<a href="https://github.com/nsacyber/Pass-the-Hash-Guidance">https://github.com/nsacyber/Pass-the-Hash-Guidance</a><br>
<a href="https://www.stigviewer.com/stig/active_directory_domain/2017-12-15/finding/V-72821">[US]STIG V-72821 - All accounts, privileged and unprivileged, that require smart cards must have the underlying NT hash rotated at least every 60 days.</a><br>
<a href="https://www.ssi.gouv.fr/uploads/IMG/pdf/NP_ActiveDirectory_NoteTech.pdf#paragraph.3.6.2.2">[FR]ANSSI - Recommandations de sécurité relatives à Active Directory - R38 [paragraph.3.6.2.2]</a><br>
<a href="https://attack.mitre.org/techniques/T1110/002">[MITRE]T1110.002 Brute Force: Password Cracking</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-ProtectedUsers"><a name="anchorrulesA-ProtectedUsers"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-ProtectedUsers" aria-expanded="false" aria-controls="rulesA-ProtectedUsers">
          [M]Check for presence of the Protected Users group (A-ProtectedUsers)
        </button>
      </span>

    </div>

    <div id="rulesA-ProtectedUsers" class="collapse" aria-labelledby="headingrulesA-ProtectedUsers" data-parent="#rulesPassTheCredential">
      <div class="card-body">
        <h3>Check for presence of the Protected Users group</h3>
<strong>Rule ID:</strong><p class="text-justify">A-ProtectedUsers</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that the schema has been updated for the creation of the Protected Users group.</p>
<strong>Technical Explanation:</strong><p class="text-justify">The Protected Users group is a special group, which is a very effective mitigation solution to counter attacks using credential theft starting with Windows 8.1. Older Operating System must be updated to use this protection, such as the <b>Windows 7 KB2871997</b> patch.</p>
<strong>Advised Solution:</strong><p class="text-justify">The Protected Users group is automatically created when the PDC (primary DC) emulator role is transferred to Windows Server 2012 R2 or newer domain controller. The group is then automatically replicated to all other domain controllers.<br>
<b> Warning: Do not add service accounts into this group as this will result in "authentication failure" messages. Use "protected accounts" instead</b></p><strong>Points:</strong><p>Informative rule (0 point)</p>
<strong>Documentation:</strong><p><a href="https://docs.microsoft.com/en-us/windows-server/security/credentials-protection-and-management/protected-users-security-group">https://docs.microsoft.com/en-us/windows-server/security/credentials-protection-and-management/protected-users-security-group</a><br>
<a href="https://www.stigviewer.com/stig/active_directory_domain/2017-12-15/finding/V-78131">[US]STIG V-78131 - Accounts with domain level administrative privileges must be members of the Protected Users group in domains with a domain functional level of Windows 2012 R2 or higher.</a><br>
<a href="https://www.cert.ssi.gouv.fr/alerte/CERTFR-2017-ALE-012">[FR]ANSSI CERTFR-2017-ALE-012</a><br>
<a href="https://attack.mitre.org/mitigations/M1026">[MITRE]Mitre Att&amp;ck - Mitigation - Privileged Account Management</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-LAPS-Joined-Computers"><a name="anchorrulesA-LAPS-Joined-Computers"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-LAPS-Joined-Computers" aria-expanded="false" aria-controls="rulesA-LAPS-Joined-Computers">
          [T]Check if LAPS passwords can be retrieved from computers that have been added manually by users. (A-LAPS-Joined-Computers)
        </button>
      </span>

    </div>

    <div id="rulesA-LAPS-Joined-Computers" class="collapse" aria-labelledby="headingrulesA-LAPS-Joined-Computers" data-parent="#rulesPassTheCredential">
      <div class="card-body">
        <h3>Check if LAPS passwords can be retrieved from computers that have been added manually by users.</h3>
<strong>Rule ID:</strong><p class="text-justify">A-LAPS-Joined-Computers</p>
<strong>Description:</strong><p class="text-justify">The purpose of this rule is to ensure that there is no LAPS permission problems with computers that have been added manually to the domain by a user</p>
<strong>Technical Explanation:</strong><p class="text-justify">By default, every domain user can add up to 10 computers to the domain (see the rule S-ADRegistration for more information).<br>
    When a computer is added to the domain, the owner of the computer object is the user who joined the computer.<br>
    To trace this insertion, a special attribute mS-DS-CreatorSID is added, whose value is the SID of its creator.<br>
    When LAPS is installed, the local admin account has its password stored in a special attribute named, by default, ms-mcs-AdmPwd. Its access is retricted.<br>
    Because the user who created it is the owner of the underlying object, it can retrieve the LAPS attribute and get the local admin password.<br>
    <br>
    In addition to check if the owner of the computer object is the user which added it, this program checks also if this user have an explicit permission on this object to write the owner, write the security descriptor, or "all extended rights".<br>
    Indeed, the right "all extended rights" allows to read the LAPS password and write access to these attributes can cancel the security hardening of changing the owner.<br>
    </p>
<strong>Advised Solution:</strong><p class="text-justify">Review the security of the computer objects listed in the LAPS section below to change their ownership (you can give it to the domain admins group).<br>
    Check if the creator has also write permissions to change the owner or the security descriptor and if he has the right "all extended rights" on this object.<br>
    If it is the case, remove the permissions granted to this user.<br>
    </p><strong>Introduced in:</strong><p class="text-justify">2.9.3.0</p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://azurecloudai.blog/2019/10/01/laps-security-concern-computers-joiners-are-able-to-see-laps-password/">https://azurecloudai.blog/2019/10/01/laps-security-concern-computers-joiners-are-able-to-see-laps-password/</a><br>
<a href="https://www.securityinsider-wavestone.com/2020/01/taking-over-windows-workstations-pxe-laps.html">https://www.securityinsider-wavestone.com/2020/01/taking-over-windows-workstations-pxe-laps.html</a><br>
<a href="https://attack.mitre.org/techniques/T1555/005">[MITRE]T1555.005 Credentials from Password Stores: Password Managers</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-LAPS-Not-Installed"><a name="anchorrulesA-LAPS-Not-Installed"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-LAPS-Not-Installed" aria-expanded="false" aria-controls="rulesA-LAPS-Not-Installed">
          [M][T]Check if the LAPS tool to handle the native local administrator passwords is installed (A-LAPS-Not-Installed)
        </button>
      </span>

    </div>

    <div id="rulesA-LAPS-Not-Installed" class="collapse" aria-labelledby="headingrulesA-LAPS-Not-Installed" data-parent="#rulesPassTheCredential">
      <div class="card-body">
        <h3>Check if the LAPS tool to handle the native local administrator passwords is installed</h3>
<strong>Rule ID:</strong><p class="text-justify">A-LAPS-Not-Installed</p>
<strong>Description:</strong><p class="text-justify">The purpose is to make sure that there is a proper password policy in place for the native local administrator account.</p>
<strong>Technical Explanation:</strong><p class="text-justify">LAPS (Local Administrator Password Solution) is the advised solution to handle passwords for the native local administrator account on all workstations, as it is a simple way to handle most of the subject.</p>
<strong>Advised Solution:</strong><p class="text-justify">If you don't have any provisioning process or password solution to manage local administrators, you should install the LAPS solution. If you mitigate the risk differently, you should add this rule as an exception, as the risk is covered.</p><strong>Points:</strong><p>15 points if present</p>
<strong>Documentation:</strong><p><a href="https://www.microsoft.com/en-us/download/details.aspx?id=46899">https://www.microsoft.com/en-us/download/details.aspx?id=46899</a><br>
<a href="https://www.stigviewer.com/stig/active_directory_domain/2017-12-15/finding/V-36438">[US]STIG V-36438 - Local administrator accounts on domain systems must not share the same password.</a><br>
<a href="https://www.cert.ssi.gouv.fr/actualite/CERTFR-2015-ACT-046/#SECTION00020000000000000000">[FR]ANSSI CERTFR-2015-ACT-046</a><br>
<a href="https://attack.mitre.org/techniques/T1078/003">[MITRE]T1078.003 Valid Accounts: Local Accounts</a><br>
<a href="https://attack.mitre.org/mitigations/M1026">[MITRE]Mitre Att&amp;ck - Mitigation - Privileged Account Management</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-DCRefuseComputerPwdChange"><a name="anchorrulesA-DCRefuseComputerPwdChange"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-DCRefuseComputerPwdChange" aria-expanded="false" aria-controls="rulesA-DCRefuseComputerPwdChange">
          [M]Ensure that Domain Controllers don't deny the change of computer account passwords. (A-DCRefuseComputerPwdChange)
        </button>
      </span>

    </div>

    <div id="rulesA-DCRefuseComputerPwdChange" class="collapse" aria-labelledby="headingrulesA-DCRefuseComputerPwdChange" data-parent="#rulesPassTheCredential">
      <div class="card-body">
        <h3>Ensure that Domain Controllers don't deny the change of computer account passwords.</h3>
<strong>Rule ID:</strong><p class="text-justify">A-DCRefuseComputerPwdChange</p>
<strong>Description:</strong><p class="text-justify">The purpose is to check that the computer account password can be changed as usual.</p>
<strong>Technical Explanation:</strong><p class="text-justify">For each computer, there is a hidden user account. This account is used to maintain the computer inside the Active Directory domain.<br>
    The password of this account is changed every 30 days automatically except if the Domain Controller prohibits this.<br>
  This is the case when this GPO setting is enabled.</p>
<strong>Advised Solution:</strong><p class="text-justify">Locate the GPO specified in Details and change the setting in "Domain controller: Refuse machine account password changes".<br>
    Disable this setting, or set it to "Disabled".<br>
The setting is located in :<br>
    Computer configuration -&gt; Policies -&gt; Windows Settings -&gt;Security Settings -&gt; Local Policies -&gt; Security Options.<br>
As an alternative, the file GptTmpl.inf can be manually edited.</p><strong>Introduced in:</strong><p class="text-justify">2.7.0.0</p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/domain-controller-refuse-machine-account-password-changes">https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/domain-controller-refuse-machine-account-password-changes</a><br>
<a href="https://www.stigviewer.com/stig/active_directory_service_2008/2011-05-23/finding/V-4408">[US]STIG V-4408 - The domain controller must be configured to allow reset of machine account passwords.</a><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-DC-Spooler"><a name="anchorrulesA-DC-Spooler"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-DC-Spooler" aria-expanded="false" aria-controls="rulesA-DC-Spooler">
          [T]Ensure that the Print Spooler service cannot be abused to get the DC credentials (A-DC-Spooler)
        </button>
      </span>

    </div>

    <div id="rulesA-DC-Spooler" class="collapse" aria-labelledby="headingrulesA-DC-Spooler" data-parent="#rulesPassTheCredential">
      <div class="card-body">
        <h3>Ensure that the Print Spooler service cannot be abused to get the DC credentials</h3>
<strong>Rule ID:</strong><p class="text-justify">A-DC-Spooler</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that credentials cannot be extracted from the DC via its Print Spooler service</p>
<strong>Technical Explanation:</strong><p class="text-justify">When there's an account with unconstrained delegation configured (which is fairly common) and the Print Spooler service running on a computer, you can get that computers credentials sent to the system with unconstrained delegation as a user. With a domain controller, the TGT of the DC can be extracted allowing an attacker to reuse it with a DCSync attack and obtain all user hashes and impersonate them.</p>
<strong>Advised Solution:</strong><p class="text-justify">The Print Spooler service should be deactivated on domain controllers. Please note as a consequence that the Printer Pruning functionality (rarely used) will be unavailable.</p><strong>Introduced in:</strong><p class="text-justify">2.6.0.0</p><strong>Points:</strong><p>10 points if present</p>
<strong>Documentation:</strong><p><a href="https://adsecurity.org/?p=4056">https://adsecurity.org/?p=4056</a><br>
<a href="https://www.slideshare.net/harmj0y/derbycon-the-unintended-risks-of-trusting-active-directory">https://www.slideshare.net/harmj0y/derbycon-the-unintended-risks-of-trusting-active-directory</a><br>
<a href="https://attack.mitre.org/techniques/T1187">[MITRE]T1187 Forced Authentication</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-DC-WebClient"><a name="anchorrulesA-DC-WebClient"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-DC-WebClient" aria-expanded="false" aria-controls="rulesA-DC-WebClient">
          [T]Ensure that the WebClient client cannot be abused to force a DC connection to a HTTP server (A-DC-WebClient)
        </button>
      </span>

    </div>

    <div id="rulesA-DC-WebClient" class="collapse" aria-labelledby="headingrulesA-DC-WebClient" data-parent="#rulesPassTheCredential">
      <div class="card-body">
        <h3>Ensure that the WebClient client cannot be abused to force a DC connection to a HTTP server</h3>
<strong>Rule ID:</strong><p class="text-justify">A-DC-WebClient</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that DC cannot connect with normal command line to a HTTP server</p>
<strong>Technical Explanation:</strong><p class="text-justify">By default, Windows computers supports only UNC paths (aka \\server\path).<br>
    The WebDAV protocol, implemented with HTTP, enables files on webserver to be managed as on a classic file share.<br>
    The role of the WebClient service is to provide as a native API call a service to manage files located on a WebDAV server (HTTP URLs).<br>
    If the WebClient service is active, command line tools and services can access files on a webserver without any specifc action.<br>
 <br>
    When forced authentication attacks are being used (Print Spooler, PetitPotam, ...) and if this service is in use, the DC can connect to webservers.<br>
    An attacker can abuse this service to bypass classic detection rules but this does not represent a vulnerability in itself.<br>
<br>
    It is not expected that Domain Controllers access WebDAV services but please note that some backup software is known to use cloud connection and thus, requires it.<br>
    This is why this rule is classify as informative.<br>
    <br>
    Also please note that WebClient can be remotely started using a 'Search Connector' file. See the details in the link below.<br>
    </p>
<strong>Advised Solution:</strong><p class="text-justify">If the WebClient service is in official use (typically from backup applications), disable the service.</p><strong>Introduced in:</strong><p class="text-justify">2.11.0.0</p><strong>Points:</strong><p>Informative rule (0 point)</p>
<strong>Documentation:</strong><p><a href="https://gist.github.com/gladiatx0r/1ffe59031d42c08603a3bde0ff678feb#rpc-to-rce-steps">https://gist.github.com/gladiatx0r/1ffe59031d42c08603a3bde0ff678feb#rpc-to-rce-steps</a><br>
<a href="https://attack.mitre.org/techniques/T1187">[MITRE]T1187 Forced Authentication</a></p>
    </div>
  </div></div></div>
			<!-- Accordion rulesPassTheCredential end -->

		<div class="row"><div class="col-lg-12 mt-3">
		<h3>Password retrieval
		</h3>

		<div class="row"><div class="col-lg-12">
		<p>Passwords stored in clear text or obfuscated can be retrieved. By reusing the user's identity, an attacker's login appears like from any legitimate user. There's no need to perform a potentially detectable exploit for intrusion or lateral movement.
		</p>

		<!-- Accordion rulesPasswordRetrieval -->
<div id="rulesPasswordRetrieval">
<div class="card">
    
    <div class="card-header" id="headingrulesA-ReversiblePwd"><a name="anchorrulesA-ReversiblePwd"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-ReversiblePwd" aria-expanded="false" aria-controls="rulesA-ReversiblePwd">
          [T]Check for GPO which enables reversible passwords (A-ReversiblePwd)
        </button>
      </span>

    </div>

    <div id="rulesA-ReversiblePwd" class="collapse" aria-labelledby="headingrulesA-ReversiblePwd" data-parent="#rulesPasswordRetrieval">
      <div class="card-body">
        <h3>Check for GPO which enables reversible passwords</h3>
<strong>Rule ID:</strong><p class="text-justify">A-ReversiblePwd</p>
<strong>Description:</strong><p class="text-justify">The purpose is to verify if a GPO alters the password policy of the domain to enable reversible passwords</p>
<strong>Technical Explanation:</strong><p class="text-justify">The policy "Store passwords using reversible encryption" is enabled. In this case, it means that the password is actually stored in clear text in the <i>supplementalCredential</i> attribute of the account and that it can be retrieved using a DCSync attack.</p>
<strong>Advised Solution:</strong><p class="text-justify">In order to remove the reversible passwords, we advise to identify the GPO indicated by the program and change the setting "Store passwords using reversible encryption"</p><strong>Points:</strong><p>10 points if present</p>
<strong>Documentation:</strong><p><a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/store-passwords-using-reversible-encryption">https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/store-passwords-using-reversible-encryption</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#reversible_password">[FR]ANSSI - Accounts with passwords stored using reversible encryption (vuln3_reversible_password)</a><span class="badge grade-3">3</span><br>
<a href="https://attack.mitre.org/techniques/T1110/002">[MITRE]T1110.002 Brute Force: Password Cracking</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-UnixPwd"><a name="anchorrulesA-UnixPwd"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-UnixPwd" aria-expanded="false" aria-controls="rulesA-UnixPwd">
          [T]Check if attributes unixUserPassword and userPassword are set (A-UnixPwd)
        </button>
      </span>

    </div>

    <div id="rulesA-UnixPwd" class="collapse" aria-labelledby="headingrulesA-UnixPwd" data-parent="#rulesPasswordRetrieval">
      <div class="card-body">
        <h3>Check if attributes unixUserPassword and userPassword are set</h3>
<strong>Rule ID:</strong><p class="text-justify">A-UnixPwd</p>
<strong>Description:</strong><p class="text-justify">The purpose is to check if password information may be stored in AD attributes</p>
<strong>Technical Explanation:</strong><p class="text-justify">To perform Single Sign On (SSO) systems need to share secrets with Active Directory.<br>
    This is not the case for all systems such as Unix and Mainframe and designers have found a workaround by storing this secret into a user account attribute.<br>
  However not all systems did implement a proper and cryptographically safe protocol and they are checking the password submitted in their system with an AD attribute.<br>
At that time, it was not known that these attributes can be queried by everyone and as consequence, they did not enforce a robust protection.<br>
Looking at the attribute unixUserPassword, the password can be retrieved either in clear text (encoded as ASCII) or with a weak algorithm such as ROT 13.<br>
<br>
In addition to that, the way to change a password in LDAP system is to modify the value of the special attribute userPassword.<br>
This attribute is not supposed to be visible. However Active Directory is using another attribute named unicodePwd (unless the heuristic fUserPwdSupport is set).<br>
That means that the attribute userPassword is not special anymore and that a change of its value is displayed in clear text, considered as a normal attribute.<br>
A misconfigured application can change the user password using this old mechanism, and as a consequence, set the user password in clear text.<br>
</p>
<strong>Advised Solution:</strong><p class="text-justify">The attributes unixUserPassword and userPassword from the mentioned user accounts should be cleared, unless the remote system is known to have a strong cryptographic protocol.</p><strong>Points:</strong><p>Informative rule (0 point)</p>
<strong>Documentation:</strong><p><a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/f3adda9f-89e1-4340-a3f2-1f0a6249f1f8">https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/f3adda9f-89e1-4340-a3f2-1f0a6249f1f8</a><br>
<a href="https://www.blackhillsinfosec.com/domain-goodness-learned-love-ad-explorer/">https://www.blackhillsinfosec.com/domain-goodness-learned-love-ad-explorer/</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#reversible_password">[FR]ANSSI - Accounts with passwords stored using reversible encryption (vuln3_reversible_password)</a><span class="badge grade-3">3</span><br>
<a href="https://attack.mitre.org/techniques/T1552">[MITRE]T1552 Unsecured Credentials</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-PwdGPO"><a name="anchorrulesA-PwdGPO"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-PwdGPO" aria-expanded="false" aria-controls="rulesA-PwdGPO">
          [T]Find Password GPO (A-PwdGPO)
        </button>
      </span>

    </div>

    <div id="rulesA-PwdGPO" class="collapse" aria-labelledby="headingrulesA-PwdGPO" data-parent="#rulesPasswordRetrieval">
      <div class="card-body">
        <h3>Find Password GPO</h3>
<strong>Rule ID:</strong><p class="text-justify">A-PwdGPO</p>
<strong>Description:</strong><p class="text-justify">The purpose is to alert when a password is present in a GPO. If a password is in a GPO, the password should be considered compromised and reset.</p>
<strong>Technical Explanation:</strong><p class="text-justify">PingCastle attempts to identify passwords stored in GPOs. If PingCastle was able to retrieve a password, attackers can also obtain it and so the account should be considered compromised. Note that Microsoft published the AES key used to encrypt passwords in GPOs, which is why even an encrypted password is insecure.</p>
<strong>Advised Solution:</strong><p class="text-justify">To solve this issue, you should manually change the password to a new one. If this password is shared on many systems, each system should have a different password. If the GPO was used to define the native local administrator account, it is recommended to install a password solution manager such as LAPS.</p><strong>Points:</strong><p>20 points per discovery</p>
<strong>Documentation:</strong><p><a href="https://msdn.microsoft.com/en-us/library/cc422924.aspx">https://msdn.microsoft.com/en-us/library/cc422924.aspx</a><br>
<a href="https://www.cert.ssi.gouv.fr/actualite/CERTFR-2015-ACT-046/#SECTION00020000000000000000">[FR]ANSSI CERTFR-2015-ACT-046</a><br>
<a href="https://attack.mitre.org/techniques/T1552/006">[MITRE]T1552.006 Unsecured Credentials: Group Policy Preferences</a></p>
    </div>
  </div></div></div>
			<!-- Accordion rulesPasswordRetrieval end -->

		<div class="row"><div class="col-lg-12 mt-3">
		<h3>Reconnaissance
		</h3>

		<div class="row"><div class="col-lg-12">
		<p>At the beginning of an attack, a hacker tries to collect as much data as possible. Leaking information just reduces the time an attacker needs to gain control of the domain.
		</p>

		<!-- Accordion rulesReconnaissance -->
<div id="rulesReconnaissance">
<div class="card">
    
    <div class="card-header" id="headingrulesA-DsHeuristicsAllowAnonNSPI"><a name="anchorrulesA-DsHeuristicsAllowAnonNSPI"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-DsHeuristicsAllowAnonNSPI" aria-expanded="false" aria-controls="rulesA-DsHeuristicsAllowAnonNSPI">
          [T]Check for access without any account to the Name Service Provider Interface (NSPI) protocol (A-DsHeuristicsAllowAnonNSPI)
        </button>
      </span>

    </div>

    <div id="rulesA-DsHeuristicsAllowAnonNSPI" class="collapse" aria-labelledby="headingrulesA-DsHeuristicsAllowAnonNSPI" data-parent="#rulesReconnaissance">
      <div class="card-body">
        <h3>Check for access without any account to the Name Service Provider Interface (NSPI) protocol</h3>
<strong>Rule ID:</strong><p class="text-justify">A-DsHeuristicsAllowAnonNSPI</p>
<strong>Description:</strong><p class="text-justify">The purpose is to identify domains having the NSPI protocol exposed without any required account</p>
<strong>Technical Explanation:</strong><p class="text-justify">The way an Active Directory behaves can be controlled via the attribute <i>DsHeuristics</i> of <i>CN=Directory Service,CN=Windows NT,CN=Services,CN=Configuration</i>. A parameter stored in its attribute and whose value is <i>fAllowAnonNSPI</i> can be set to allow access to the NSPI protocol without any account.<br>
The NSPI protocol is used internally by Exchange to resolve addresses, and thus can be used to dump all the users of the forest. It can be exposed to the internet via RPC over HTTP.</p>
<strong>Advised Solution:</strong><p class="text-justify">The easiest and fastest way to correct this issue is to <b>replace the eighth (8th) character of the DsHeuristics attribute</b>. If it is not a 0, replace by 0 to fix the issue.</p><strong>Introduced in:</strong><p class="text-justify">2.9.0.0</p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/e5899be4-862e-496f-9a38-33950617d2c5">https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/e5899be4-862e-496f-9a38-33950617d2c5</a><br>
<a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-nspi/6dd0a3ea-b4d4-4a73-a857-add03a89a543">https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-nspi/6dd0a3ea-b4d4-4a73-a857-add03a89a543</a><br>
<a href="https://www.stigviewer.com/stig/active_directory_forest/2016-12-19/finding/V-8555">[US]STIG V-8555 - Anonymous Access to AD forest data above the rootDSE level must be disabled. </a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#dsheuristics_bad">[FR]ANSSI - Dangerous dsHeuristics settings (vuln1_dsheuristics_bad)</a><span class="badge grade-1">1</span><br>
<a href="https://attack.mitre.org/techniques/T1110/003">[MITRE]T1110.003 Brute Force: Password Spraying</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-DsHeuristicsAnonymous"><a name="anchorrulesA-DsHeuristicsAnonymous"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-DsHeuristicsAnonymous" aria-expanded="false" aria-controls="rulesA-DsHeuristicsAnonymous">
          [T]Check for access without any account via a forest wide setting (A-DsHeuristicsAnonymous)
        </button>
      </span>

    </div>

    <div id="rulesA-DsHeuristicsAnonymous" class="collapse" aria-labelledby="headingrulesA-DsHeuristicsAnonymous" data-parent="#rulesReconnaissance">
      <div class="card-body">
        <h3>Check for access without any account via a forest wide setting</h3>
<strong>Rule ID:</strong><p class="text-justify">A-DsHeuristicsAnonymous</p>
<strong>Description:</strong><p class="text-justify">The purpose is to identify domains having a forest setting which allows access to the domain without any account </p>
<strong>Technical Explanation:</strong><p class="text-justify">The way an Active Directory behaves can be controlled via the attribute <i>DsHeuristics</i> of <i>CN=Directory Service,CN=Windows NT,CN=Services,CN=Configuration</i>. A parameter stored in its attribute and whose value is <i>fLDAPBlockAnonOps</i> can be set to allow access without any account on the <b>whole forest level</b>.<br>
It is possible to verify the results provided by the PingCastle solution by using a Kali Linux distribution. You should run <i>rpcclient -U " target_ip_address</i> and press enter at the password prompt to finally type <i>enumdomusers</i>.</p>
<strong>Advised Solution:</strong><p class="text-justify">The easiest and fastest way to correct this issue is to <b>replace the seventh (7th) character of the DsHeuristics attribute</b>. If it is a 2, replace by 0 to fix the issue.</p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://msdn.microsoft.com/en-us/library/cc223560.aspx">https://msdn.microsoft.com/en-us/library/cc223560.aspx</a><br>
<a href="https://support.microsoft.com/en-us/help/326690/anonymous-ldap-operations-to-active-directory-are-disabled-on-windows">https://support.microsoft.com/en-us/help/326690/anonymous-ldap-operations-to-active-directory-are-disabled-on-windows</a><br>
<a href="https://www.stigviewer.com/stig/active_directory_forest/2016-12-19/finding/V-8555">[US]STIG V-8555 - Anonymous Access to AD forest data above the rootDSE level must be disabled. </a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#dsheuristics_bad">[FR]ANSSI - Dangerous dsHeuristics settings (vuln2_dsheuristics_bad)</a><span class="badge grade-2">2</span><br>
<a href="https://attack.mitre.org/techniques/T1110/003">[MITRE]T1110.003 Brute Force: Password Spraying</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-AnonymousAuthorizedGPO"><a name="anchorrulesA-AnonymousAuthorizedGPO"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-AnonymousAuthorizedGPO" aria-expanded="false" aria-controls="rulesA-AnonymousAuthorizedGPO">
          [T]Check for GPO granting access to the domain without any account (A-AnonymousAuthorizedGPO)
        </button>
      </span>

    </div>

    <div id="rulesA-AnonymousAuthorizedGPO" class="collapse" aria-labelledby="headingrulesA-AnonymousAuthorizedGPO" data-parent="#rulesReconnaissance">
      <div class="card-body">
        <h3>Check for GPO granting access to the domain without any account</h3>
<strong>Rule ID:</strong><p class="text-justify">A-AnonymousAuthorizedGPO</p>
<strong>Description:</strong><p class="text-justify">The purpose is to identify domains having a GPO which allows access to the domain without any account </p>
<strong>Technical Explanation:</strong><p class="text-justify">It is possible that domains are set to authorize connection without any account, which represents a security breach. It allows potential attackers to enumerate all the users and computers belonging to a domain, in order to identify very efficiently future weak targets.<br>
It is possible to verify the results provided by the PingCastle solution by using a Kali Linux distribution. You should run [rpcclient -U " target_ip_address] and press enter at the password prompt to finally type [enumdomusers].</p>
<strong>Advised Solution:</strong><p class="text-justify">In order to remove the anonymous access, we advise to identify the GPO indicated by the program and change the setting restrictanonymous and restrictanonymoussam</p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://technet.microsoft.com/en-us/library/cc963223.aspx">https://technet.microsoft.com/en-us/library/cc963223.aspx</a><br>
<a href="https://technet.microsoft.com/en-us/library/jj852184.aspx">https://technet.microsoft.com/en-us/library/jj852184.aspx</a><br>
<a href="https://www.stigviewer.com/stig/active_directory_service_2003/2011-05-20/finding/V-14798">[US]STIG V-14798 - Directory data (outside the root DSE) of a non-public directory must be configured to prevent anonymous access.</a><br>
<a href="https://attack.mitre.org/techniques/T1110/003">[MITRE]T1110.003 Brute Force: Password Spraying</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-PreWin2000Anonymous"><a name="anchorrulesA-PreWin2000Anonymous"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-PreWin2000Anonymous" aria-expanded="false" aria-controls="rulesA-PreWin2000Anonymous">
          [T]Check for Windows 2000 compatibility which allows access to the domain without any account (A-PreWin2000Anonymous)
        </button>
      </span>

    </div>

    <div id="rulesA-PreWin2000Anonymous" class="collapse" aria-labelledby="headingrulesA-PreWin2000Anonymous" data-parent="#rulesReconnaissance">
      <div class="card-body">
        <h3>Check for Windows 2000 compatibility which allows access to the domain without any account</h3>
<strong>Rule ID:</strong><p class="text-justify">A-PreWin2000Anonymous</p>
<strong>Description:</strong><p class="text-justify">The purpose is to identify domains which allow access without any account because of a Pre-Windows 2000 compatibility</p>
<strong>Technical Explanation:</strong><p class="text-justify">When a Windows Server 2003 DC is promoted, a pre-Windows 2000 compatibility setting can be enabled through the wizard. If it is enabled, the wizard will add "Everyone" and "Anonymous" to the pre-Windows 2000 compatible access group, and by doing so, it will authorize the domain to be queried without an account (null session)<br>
It is possible to verify the results provided by the PingCastle solution by using a Kali distribution. You should run [rpcclient -U " target_ip_address] and press enter at the password prompt to finally type [enumdomusers].</p>
<strong>Advised Solution:</strong><p class="text-justify">Remove the "Everyone" and "Anonymous" from the PreWin2000 group while making sure that the group "Authenticated Users" is present, then reboot each DC.<br>
    Note: removing the group "Authenticated Users" (and not keep it like advised here) is an advanced recommendation quoted in the rule A-PreWin2000AuthenticatedUsers</p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://msdn.microsoft.com/en-us/library/cc223672.aspx">https://msdn.microsoft.com/en-us/library/cc223672.aspx</a><br>
<a href="https://www.stigviewer.com/stig/active_directory_domain/2017-12-15/finding/V-8547">[US]STIG V-8547 - The Anonymous Logon and Everyone groups must not be members of the Pre-Windows 2000 Compatible Access group.</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#compatible_2000_anonymous">[FR]ANSSI - The "Pre - Windows 2000 Compatible Access" group includes "Anonymous" (vuln2_compatible_2000_anonymous)</a><span class="badge grade-2">2</span><br>
<a href="https://attack.mitre.org/techniques/T1110/003">[MITRE]T1110.003 Brute Force: Password Spraying</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-DnsZoneTransfert"><a name="anchorrulesA-DnsZoneTransfert"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-DnsZoneTransfert" aria-expanded="false" aria-controls="rulesA-DnsZoneTransfert">
          [T]Check if DNS Zones are configured with Zone Transfers. (A-DnsZoneTransfert)
        </button>
      </span>

    </div>

    <div id="rulesA-DnsZoneTransfert" class="collapse" aria-labelledby="headingrulesA-DnsZoneTransfert" data-parent="#rulesReconnaissance">
      <div class="card-body">
        <h3>Check if DNS Zones are configured with Zone Transfers.</h3>
<strong>Rule ID:</strong><p class="text-justify">A-DnsZoneTransfert</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that no DNS Zones are configured with Zone Transfers.</p>
<strong>Technical Explanation:</strong><p class="text-justify">When the Zone Transfers mechanism is enabled, an attacker can retrieve all DNS records anonymously.<br>
    He can then use this feature to generate network noise to trigger a man in the middle attack and capture credentials.<br>
<br>
    This setting is domain wide, meaning that all servers share the same setting.<br>
    Please note that PingCastle does this check to only one DNS Server of the zone.<br>
<br>
    To test if the Zone Transfers is enabled, issue the following command:<br>
    on Linux: </p><pre>host -t axfr domain.name dns-server</pre> or <pre>dig axfr @dns-server domain.name</pre><br>
    on Windows: <pre>nslookup</pre> then <pre>server dns-server</pre> then <pre>set type=any</pre> then <pre>ls -d domain.name</pre><br>
    <p></p>
<strong>Advised Solution:</strong><p class="text-justify">You have to disable Zone Transfers.<br>
    Identify the faulty zone in the details below.<br>
    Go to the DNS console and select a zone in the "Forward Lookup Zones".<br>
    Right click on it and switch to the "Zone Transfers" tab.<br>
    Then ensure "Allow zone transfers" is not enabled "To any server".<br>
    You can also run: dnscmd /zoneresetsecondaries zone /noxfr<br>
    </p><strong>Introduced in:</strong><p class="text-justify">2.9.3.0</p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-dnsp/f97756c9-3783-428b-9451-b376f877319a">https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-dnsp/f97756c9-3783-428b-9451-b376f877319a</a><br>
<a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/dnscmd">    https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/dnscmd</a><br>
<a href="https://attack.mitre.org/techniques/T1018">[MITRE]T1018 Remote System Discovery</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-NoNetSessionHardening"><a name="anchorrulesA-NoNetSessionHardening"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-NoNetSessionHardening" aria-expanded="false" aria-controls="rulesA-NoNetSessionHardening">
          [T]Check if NetCease has been put in place to mitigate Bloodhound (A-NoNetSessionHardening)
        </button>
      </span>

    </div>

    <div id="rulesA-NoNetSessionHardening" class="collapse" aria-labelledby="headingrulesA-NoNetSessionHardening" data-parent="#rulesReconnaissance">
      <div class="card-body">
        <h3>Check if NetCease has been put in place to mitigate Bloodhound</h3>
<strong>Rule ID:</strong><p class="text-justify">A-NoNetSessionHardening</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that mitigations are in place against the Bloodhound tool</p>
<strong>Technical Explanation:</strong><p class="text-justify">By default, Windows computers allow any authenticated user to enumerate network sessions to it.<br>
This means an attacker could enumerate network sessions to a file share hosting home directories or a Domain Controller to see who's connected to SYSVOL (to apply Group Policy) and determine which workstations each user and admin account is logged into.<br>
Bloodhound uses this capability extensively to map out credentials in the network.<br>
<br>
Disabling Net Session Enumeration removes the capability for any user to enumerate net session info (Recon).</p>
<strong>Advised Solution:</strong><p class="text-justify">If this mitigation is not part of the computer image, apply the following recommendations:<br>
Run the NetCease PowerShell script (referenced below) on a reference workstation.<br>
Open the Group Policy Management Console. Right-click the Group Policy object (GPO) that should contain the new preference item, and then click Edit .<br>
In the console tree under Computer Configuration, expand the Preferences folder, and then expand the Windows Settings folder.<br>
Right-click the Registry node, point to New, and select Registry Wizard.<br>
Select the reference workstation on which the desired registry settings exist, then click Next .<br>
Browse to HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanServer\DefaultSecurity\<br>
and select the check box for “SrvsvcSessionInfo” from which you want to create a Registry preference item. Select the check box for a key only if you want to create a Registry item for the key rather than for a value within the key.<br>
Click Finish.<br>
The settings that you selected appear as preference items in the Registry Wizard Values collection</p><strong>Introduced in:</strong><p class="text-justify">2.9.0.0</p><strong>Points:</strong><p>Informative rule (0 point)</p>
<strong>Documentation:</strong><p><a href="https://github.com/p0w3rsh3ll/NetCease">https://github.com/p0w3rsh3ll/NetCease</a><br>
<a href="https://adsecurity.org/?p=3299">https://adsecurity.org/?p=3299</a><br>
<a href="https://attack.mitre.org/techniques/T1087/001">[MITRE]T1087.001 Account Discovery: Local Account</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-DsHeuristicsLDAPSecurity"><a name="anchorrulesA-DsHeuristicsLDAPSecurity"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-DsHeuristicsLDAPSecurity" aria-expanded="false" aria-controls="rulesA-DsHeuristicsLDAPSecurity">
          [T]Check if the mitigation for CVE-2021-42291 has been enabled (A-DsHeuristicsLDAPSecurity)
        </button>
      </span>

    </div>

    <div id="rulesA-DsHeuristicsLDAPSecurity" class="collapse" aria-labelledby="headingrulesA-DsHeuristicsLDAPSecurity" data-parent="#rulesReconnaissance">
      <div class="card-body">
        <h3>Check if the mitigation for CVE-2021-42291 has been enabled</h3>
<strong>Rule ID:</strong><p class="text-justify">A-DsHeuristicsLDAPSecurity</p>
<strong>Description:</strong><p class="text-justify">The purpose is to identify domains having mitigation for CVE-2021-42291 not set to enabled</p>
<strong>Technical Explanation:</strong><p class="text-justify">The way an Active Directory behaves can be controlled via the attribute <i>DsHeuristics</i> of <i>CN=Directory Service,CN=Windows NT,CN=Services,CN=Configuration</i>.<br>
    A parameter stored in its attribute and whose value is <i>LDAPAddAutZVerifications</i> and <i>LDAPOwnerModify</i> can be set to modify the mitigatation of CVE-2021-42291.<br>
The KB5008383 has introduced changes to default security descriptor of Computer containers to add audit and limit computer creation without being admin.<br>
Indeed, it is recommended to not let anyone create computer accounts as they can be used to abuse Kerberos or to perform relay attacks.<br>
<br>
Mitigations in CVE-2021-42291 consist of 3 choices to be set on 2 settings.<br>
They are named LDAPAddAutZVerifications and LDAPOwnerModify and are respectively the 28th and 29th character of this string.<br>
For the expected values:<br>
- With the value 0 (the default), it enables an additional audit mechanism<br>
- With the value 1 (recommended), it enforces new security permissions, especially to require an action of the domain admin when unusual actions are performed<br>
- With the value 2 (not recommended), it disables the audit mechanism that has been added by default and do not enable the new security permissions<br>
</p>
<strong>Advised Solution:</strong><p class="text-justify">The easiest and fastest way to correct this issue is to <b>replace the 28th and 29th character of the DsHeuristics attribute</b>.<br>
    The value of LDAPAddAutZVerifications and LDAPOwnerModify should be set to 1.<br>
    <br>
    Open the procedure embedded into the KB5008383 to apply this mitigation and change the DsHeuristics value.<br>
    <br>
    Note: You have to pay attention that there are control characters at the 10th and 20th position to avoid undesired changes of the DsHeuristics attribute.<br>
    Typically if the DsHeuristics is empty, the expected new value is 00000000010000000002000000011<br>
    </p><strong>Introduced in:</strong><p class="text-justify">2.10.1.0</p><strong>Points:</strong><p>Informative rule (0 point)</p>
<strong>Documentation:</strong><p><a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/e5899be4-862e-496f-9a38-33950617d2c5">https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/e5899be4-862e-496f-9a38-33950617d2c5</a><br>
<a href="https://support.microsoft.com/en-au/topic/kb5008383-active-directory-permissions-updates-cve-2021-42291-536d5555-ffba-4248-a60e-d6cbc849cde1">https://support.microsoft.com/en-au/topic/kb5008383-active-directory-permissions-updates-cve-2021-42291-536d5555-ffba-4248-a60e-d6cbc849cde1</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#dsheuristics_bad">[FR]ANSSI - Dangerous dsHeuristics settings (vuln3_dsheuristics_bad)</a><span class="badge grade-3">3</span><br>
<a href="https://attack.mitre.org/techniques/T1187">[MITRE]T1187 Forced Authentication</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-DsHeuristicsDoNotVerifyUniqueness"><a name="anchorrulesA-DsHeuristicsDoNotVerifyUniqueness"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-DsHeuristicsDoNotVerifyUniqueness" aria-expanded="false" aria-controls="rulesA-DsHeuristicsDoNotVerifyUniqueness">
          [T]Check if the UPN and SPN uniqueness check has been disabled (A-DsHeuristicsDoNotVerifyUniqueness)
        </button>
      </span>

    </div>

    <div id="rulesA-DsHeuristicsDoNotVerifyUniqueness" class="collapse" aria-labelledby="headingrulesA-DsHeuristicsDoNotVerifyUniqueness" data-parent="#rulesReconnaissance">
      <div class="card-body">
        <h3>Check if the UPN and SPN uniqueness check has been disabled</h3>
<strong>Rule ID:</strong><p class="text-justify">A-DsHeuristicsDoNotVerifyUniqueness</p>
<strong>Description:</strong><p class="text-justify">The purpose is to identify domains having the SPN and UPN uniqueness check disabled</p>
<strong>Technical Explanation:</strong><p class="text-justify">The way an Active Directory behaves can be controlled via the attribute <i>DsHeuristics</i> of <i>CN=Directory Service,CN=Windows NT,CN=Services,CN=Configuration</i>. A parameter stored in its attribute and whose value is <i>DoNotVerifyUPNAndOrSPNUniqueness</i> can be set to disable the UPN or SPN check.<br>
This setting has been introduced to overwrite the mitigation of the vulnerability CVE-2021-42282 fixed by the KB5008382.</p>
<strong>Advised Solution:</strong><p class="text-justify">The easiest and fastest way to correct this issue is to <b>replace the 21th character of the DsHeuristics attribute</b>. If it is not a 0, replace by 0 to fix the issue.</p><strong>Introduced in:</strong><p class="text-justify">2.10.1.0</p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/e5899be4-862e-496f-9a38-33950617d2c5">https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/e5899be4-862e-496f-9a38-33950617d2c5</a><br>
<a href="https://support.microsoft.com/en-us/topic/kb5008382-verification-of-uniqueness-for-user-principal-name-service-principal-name-and-the-service-principal-name-alias-cve-2021-42282-4651b175-290c-4e59-8fcb-e4e5cd0cdb29">https://support.microsoft.com/en-us/topic/kb5008382-verification-of-uniqueness-for-user-principal-name-service-principal-name-and-the-service-principal-name-alias-cve-2021-42282-4651b175-290c-4e59-8fcb-e4e5cd0cdb29</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#dsheuristics_bad">[FR]ANSSI - Dangerous dsHeuristics settings (vuln2_dsheuristics_bad)</a><span class="badge grade-2">2</span><br>
<a href="https://attack.mitre.org/techniques/T1187">[MITRE]T1187 Forced Authentication</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-PreWin2000AuthenticatedUsers"><a name="anchorrulesA-PreWin2000AuthenticatedUsers"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-PreWin2000AuthenticatedUsers" aria-expanded="false" aria-controls="rulesA-PreWin2000AuthenticatedUsers">
          [T]Check that the "Pre-Windows 2000 Compatible Access" group does not contain "Authenticated Users" (A-PreWin2000AuthenticatedUsers)
        </button>
      </span>

    </div>

    <div id="rulesA-PreWin2000AuthenticatedUsers" class="collapse" aria-labelledby="headingrulesA-PreWin2000AuthenticatedUsers" data-parent="#rulesReconnaissance">
      <div class="card-body">
        <h3>Check that the "Pre-Windows 2000 Compatible Access" group does not contain "Authenticated Users"</h3>
<strong>Rule ID:</strong><p class="text-justify">A-PreWin2000AuthenticatedUsers</p>
<strong>Description:</strong><p class="text-justify">The purpose is checking if the "Pre-Windows 2000 Compatible Access" group contains "Authenticated Users"</p>
<strong>Technical Explanation:</strong><p class="text-justify">The pre-Windows 2000 compatible access group grants access to some RPC calls.<br>
    Its default and secure value is the "Authenticated Users" group which allows users to perform group look-up using legacy protocols.<br>
    <br>
  If this group contains "Authenticated Users", it increases the impact of the exploitation of vulnerabilities in legacy protocols such as the Print Spooler service.<br>
    Indeed, in the #PrintNightmare attack, it enables a patch bypass on domain controllers because the property Elevated Token is on when establishing a session to the DC.<br>
    Removing the group can have side impacts and as a consequence, this is reported here as a special hardening measure.<br>
  </p>
<strong>Advised Solution:</strong><p class="text-justify">Remove "Authenticated Users" from the PreWin2000 group.</p><strong>Introduced in:</strong><p class="text-justify">2.9.3.0</p><strong>Points:</strong><p>Informative rule (0 point)</p>
<strong>Documentation:</strong><p><a href="https://msdn.microsoft.com/en-us/library/cc223672.aspx">https://msdn.microsoft.com/en-us/library/cc223672.aspx</a><br>
<a href="https://www.gradenegger.eu/?p=1132">https://www.gradenegger.eu/?p=1132</a><br>
<a href="https://attack.mitre.org/techniques/T1210">[MITRE]T1210 Exploitation of Remote Services</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-PreWin2000Other"><a name="anchorrulesA-PreWin2000Other"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-PreWin2000Other" aria-expanded="false" aria-controls="rulesA-PreWin2000Other">
          [T]Check that the "Pre-Windows 2000 Compatible Access" group has not been modified from its default (A-PreWin2000Other)
        </button>
      </span>

    </div>

    <div id="rulesA-PreWin2000Other" class="collapse" aria-labelledby="headingrulesA-PreWin2000Other" data-parent="#rulesReconnaissance">
      <div class="card-body">
        <h3>Check that the "Pre-Windows 2000 Compatible Access" group has not been modified from its default</h3>
<strong>Rule ID:</strong><p class="text-justify">A-PreWin2000Other</p>
<strong>Description:</strong><p class="text-justify">The purpose is checking that no additional account has been added to the "Pre-Windows 2000 Compatible Access" group</p>
<strong>Technical Explanation:</strong><p class="text-justify">The pre-Windows 2000 compatible access group grants access to some RPC calls which should not be available to users or computers.</p>
<strong>Advised Solution:</strong><p class="text-justify">Remove the members from the PreWin2000 group while making sure that the group "Authenticated Users" is present. Then reboot each DC.</p><strong>Introduced in:</strong><p class="text-justify">2.9.0.0</p><strong>Points:</strong><p>2 points if present</p>
<strong>Documentation:</strong><p><a href="https://msdn.microsoft.com/en-us/library/cc223672.aspx">https://msdn.microsoft.com/en-us/library/cc223672.aspx</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#compatible_2000_not_default">[FR]ANSSI - Use of the "Pre-Windows 2000 Compatible Access" group (vuln3_compatible_2000_not_default)</a><span class="badge grade-3">3</span><br>
<a href="https://attack.mitre.org/techniques/T1110/003">[MITRE]T1110.003 Brute Force: Password Spraying</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-NullSession"><a name="anchorrulesA-NullSession"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-NullSession" aria-expanded="false" aria-controls="rulesA-NullSession">
          [T]Retrieve data from the domain without any account (A-NullSession)
        </button>
      </span>

    </div>

    <div id="rulesA-NullSession" class="collapse" aria-labelledby="headingrulesA-NullSession" data-parent="#rulesReconnaissance">
      <div class="card-body">
        <h3>Retrieve data from the domain without any account</h3>
<strong>Rule ID:</strong><p class="text-justify">A-NullSession</p>
<strong>Description:</strong><p class="text-justify">The purpose is to check if access without any account, aka NULL Sessions, is possible within the Active Directory. A NULL Session is a session opened anonymously to access the AD, often used by attackers to perform a recon operation on the AD, to identify weaknesses</p>
<strong>Technical Explanation:</strong><p class="text-justify">Unlike other rules, which check for known cause of anonymous access, this rule tries to enumerate accounts from the domain without any account. The program uses two methods: MS-SAMR with a NULL connection and MS-LSAT, which forces SID resolution with a well known SID.<br>
NULL sessions are deactivated by default since Windows Server 2003 and Windows XP. For compatibility reasons a setting enabling them may be still active years after.<br>
It is possible to verify the results provided by the PingCastle solution by using a Kali distribution. You should run [rpcclient -U " target_ip_address] and press enter at the password prompt to finally type [enumdomusers].</p>
<strong>Advised Solution:</strong><p class="text-justify">Locate other PingCastle rules such as A-PreWin2000Anonymous or A-DsHeuristicsAnonymous which triggered and apply the solutions. You can use the PingCastle scanner mode to do a manual check and prove the extraction of the data.</p><strong>Points:</strong><p>10 points if present</p>
<strong>Documentation:</strong><p><a href="https://www.sans.org/reading-room/whitepapers/windows/null-sessions-nt-2000-286">https://www.sans.org/reading-room/whitepapers/windows/null-sessions-nt-2000-286</a><br>
<a href="https://www.stigviewer.com/stig/active_directory_service_2003/2011-05-20/finding/V-14798">[US]STIG V-14798 - Directory data (outside the root DSE) of a non-public directory must be configured to prevent anonymous access.</a><br>
<a href="https://attack.mitre.org/techniques/T1110/003">[MITRE]T1110.003 Brute Force: Password Spraying</a></p>
    </div>
  </div></div></div>
			<!-- Accordion rulesReconnaissance end -->

		<div class="row"><div class="col-lg-12 mt-3">
		<h3>Temporary admins
		</h3>

		<div class="row"><div class="col-lg-12">
		<p>Administrators grant sometimes privileged rights to colleagues without any approval from a security officer.
		</p>

		<!-- Accordion rulesTemporaryAdmins -->
<div id="rulesTemporaryAdmins">
<div class="card">
    
    <div class="card-header" id="headingrulesA-AdminSDHolder"><a name="anchorrulesA-AdminSDHolder"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-AdminSDHolder" aria-expanded="false" aria-controls="rulesA-AdminSDHolder">
          [M]Check for suspicious account(s) used in administrator activities (A-AdminSDHolder)
        </button>
      </span>

    </div>

    <div id="rulesA-AdminSDHolder" class="collapse" aria-labelledby="headingrulesA-AdminSDHolder" data-parent="#rulesTemporaryAdmins">
      <div class="card-body">
        <h3>Check for suspicious account(s) used in administrator activities</h3>
<strong>Rule ID:</strong><p class="text-justify">A-AdminSDHolder</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that there are no rogue admin accounts in the Active Directory</p>
<strong>Technical Explanation:</strong><p class="text-justify">A check is performed on non-admin accounts in order to identify if they have an attribute <i>admincount</i> set. If they have this attribute, it means that this account, which is not supposed to be admin, has been granted administrator rights in the past. This typically happens when an administrator gives temporary rights to a normal account, off process.</p>
<strong>Advised Solution:</strong><p class="text-justify">These accounts should be reviewed, especially in regards with their past activities and have the admincount attribute removed. In order to identify which accounts are detected by this rule, we advise to run a PowerShell command that will show you all users having this flag set: <i>get-adobject -ldapfilter "(admincount=1)"</i><br>
    Do not forget to look at the section AdminSDHolder below.</p><strong>Points:</strong><p>50 points if the occurence is greater than or equals than 50<br>
then 45 points if the occurence is greater than or equals than 45<br>
then 40 points if the occurence is greater than or equals than 40<br>
then 35 points if the occurence is greater than or equals than 35<br>
then 30 points if the occurence is greater than or equals than 30<br>
then 25 points if the occurence is greater than or equals than 25<br>
then 20 points if the occurence is greater than or equals than 20<br>
then 15 points if present</p>
<strong>Documentation:</strong><p><a href="https://msdn.microsoft.com/en-us/library/ms675212(v=vs.85).aspx">https://msdn.microsoft.com/en-us/library/ms675212(v=vs.85).aspx</a><br>
<a href="https://www.ssi.gouv.fr/uploads/IMG/pdf/NP_ActiveDirectory_NoteTech.pdf#paragraph.3.6.3.1">[FR]ANSSI - Recommandations de sécurité relatives à Active Directory - R40 [paragraph.3.6.3.1]</a><br>
<a href="https://attack.mitre.org/mitigations/M1026">[MITRE]Mitre Att&amp;ck - Mitigation - Privileged Account Management</a></p>
    </div>
  </div></div></div>
			<!-- Accordion rulesTemporaryAdmins end -->

		<div class="row"><div class="col-lg-12 mt-3">
		<h3>Weak password
		</h3>

		<div class="row"><div class="col-lg-12">
		<p>Misprotected credentials can be abused to be retrieved in plain text and then, impersonate the user.
		</p>

		<!-- Accordion rulesWeakPassword -->
<div id="rulesWeakPassword">
<div class="card">
    
    <div class="card-header" id="headingrulesA-LimitBlankPasswordUse"><a name="anchorrulesA-LimitBlankPasswordUse"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-LimitBlankPasswordUse" aria-expanded="false" aria-controls="rulesA-LimitBlankPasswordUse">
          [T]Check for GPO allowing accounts without password to be accessed from the network (A-LimitBlankPasswordUse)
        </button>
      </span>

    </div>

    <div id="rulesA-LimitBlankPasswordUse" class="collapse" aria-labelledby="headingrulesA-LimitBlankPasswordUse" data-parent="#rulesWeakPassword">
      <div class="card-body">
        <h3>Check for GPO allowing accounts without password to be accessed from the network</h3>
<strong>Rule ID:</strong><p class="text-justify">A-LimitBlankPasswordUse</p>
<strong>Description:</strong><p class="text-justify">The purpose is to identify if accounts without password are allowed to be accessed from the network. This represents a high risk, as an account without a password is essentially an account that cannot be assigned to anyone. </p>
<strong>Technical Explanation:</strong><p class="text-justify">This rule verifies if there is a GPO with the setting "Limit local account use of blank passwords to console logon only" disabled.</p>
<strong>Advised Solution:</strong><p class="text-justify">Locate the policy having the setting "Limit local account use of blank passwords to console logon only" disabled and enabled the setting.</p><strong>Points:</strong><p>5 points if present</p>
<strong>Documentation:</strong><p><a href="https://technet.microsoft.com/en-us/library/jj852174.aspx">https://technet.microsoft.com/en-us/library/jj852174.aspx</a><br>
<a href="https://attack.mitre.org/techniques/T1110/003">[MITRE]T1110.003 Brute Force: Password Spraying</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-MinPwdLen"><a name="anchorrulesA-MinPwdLen"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-MinPwdLen" aria-expanded="false" aria-controls="rulesA-MinPwdLen">
          [T]Check for short password length in password policy (A-MinPwdLen)
        </button>
      </span>

    </div>

    <div id="rulesA-MinPwdLen" class="collapse" aria-labelledby="headingrulesA-MinPwdLen" data-parent="#rulesWeakPassword">
      <div class="card-body">
        <h3>Check for short password length in password policy</h3>
<strong>Rule ID:</strong><p class="text-justify">A-MinPwdLen</p>
<strong>Description:</strong><p class="text-justify">The purpose is to verify if the password policy of the domain enforces users to have at least 8 characters in their password</p>
<strong>Technical Explanation:</strong><p class="text-justify">A check is performed to identify if the GPO regarding password policy allows less than 8 characters password. Short passwords represent a high risk because they can fairly easily be brute-forced or password sprayed. Most CERT and agencies advise for at least 8 characters (and often this number goes up to 12)</p>
<strong>Advised Solution:</strong><p class="text-justify">To solve the issue, the best way is to either remove the GPO enabling short password, or to modify it in order to increase the password length to at least 8 characters</p><strong>Points:</strong><p>10 points if present</p>
<strong>Documentation:</strong><p><a href="https://www.microsoft.com/en-us/research/publication/password-guidance/">https://www.microsoft.com/en-us/research/publication/password-guidance/</a><br>
<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#privileged_members_password">[FR]ANSSI - Privileged group members with weak password policy (vuln2_privileged_members_password)</a><span class="badge grade-2">2</span><br>
<a href="https://attack.mitre.org/techniques/T1201">[MITRE]T1201 Password Policy Discovery</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-Guest"><a name="anchorrulesA-Guest"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-Guest" aria-expanded="false" aria-controls="rulesA-Guest">
          [M][T]Check if the guest account is enabled (A-Guest)
        </button>
      </span>

    </div>

    <div id="rulesA-Guest" class="collapse" aria-labelledby="headingrulesA-Guest" data-parent="#rulesWeakPassword">
      <div class="card-body">
        <h3>Check if the guest account is enabled</h3>
<strong>Rule ID:</strong><p class="text-justify">A-Guest</p>
<strong>Description:</strong><p class="text-justify">The purpose is to ensure that the Guest account of the domain is not enabled</p>
<strong>Technical Explanation:</strong><p class="text-justify">The Guest account is a special account whose SID is S-1-5-domain-501. It is used as a non-nominative account to allow anyone to connect to the Active Directory.<br>
Unless there is a justification about its activation, this represents a security issue because anybody can use this account to connect to any computer without any trace.</p>
<strong>Advised Solution:</strong><p class="text-justify">You have to find the Guest account and disable it.</p><strong>Introduced in:</strong><p class="text-justify">2.10.1.0</p><strong>Points:</strong><p>15 points if present</p>
<strong>Documentation:</strong><p><a href="https://attack.mitre.org/techniques/T1078/003">[MITRE]T1078.003 Valid Accounts: Local Accounts</a><br>
<a href="https://attack.mitre.org/mitigations/M1015">[MITRE]Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a></p>
    </div>
  </div>
    <div class="card-header" id="headingrulesA-NoServicePolicy"><a name="anchorrulesA-NoServicePolicy"></a>
      <span class="card-title mb-0">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#rulesA-NoServicePolicy" aria-expanded="false" aria-controls="rulesA-NoServicePolicy">
          [T]Check the Password Policy for Service Accounts (Information) (A-NoServicePolicy)
        </button>
      </span>

    </div>

    <div id="rulesA-NoServicePolicy" class="collapse" aria-labelledby="headingrulesA-NoServicePolicy" data-parent="#rulesWeakPassword">
      <div class="card-body">
        <h3>Check the Password Policy for Service Accounts (Information)</h3>
<strong>Rule ID:</strong><p class="text-justify">A-NoServicePolicy</p>
<strong>Description:</strong><p class="text-justify">The purpose is to give information regarding a best practice for the Service Account password policy. Indeed, having a 20+ characters password for this account greatly helps reducing the risk of Kerberoasting attacks (offline cracking of the TGS tickets)<br>
Note: PSO (Password Settings Objects) will be visible only if the user, which collected the information, has the permission to view it.</p>
<strong>Technical Explanation:</strong><p class="text-justify">The rule is purely informative, as it gives insights regarding a best practice. It verifies if there is a GPO or PSO enforcing a 20+ characters password for the Service Accounts. </p>
<strong>Advised Solution:</strong><p class="text-justify"> The recommended way to handle service accounts is to use "Managed service accounts" introduced since Windows Server 2008 R2 (search for "msDS-ManagedServiceAccount").<br>
To solve the anomaly, you should implement a PSO or GPO password guarantying a 20+ length password.</p><strong>Points:</strong><p>Informative rule (0 point)</p>
<strong>Documentation:</strong><p><a href="https://www.microsoft.com/en-us/research/publication/password-guidance/">https://www.microsoft.com/en-us/research/publication/password-guidance/</a><br>
<a href="https://attack.mitre.org/techniques/T1201">[MITRE]T1201 Password Policy Discovery</a></p>
    </div>
  </div></div></div>
			<!-- Accordion rulesWeakPassword end -->

		<!-- SubSection Mitre Att&amp;ck mapping -->
		<div class="row"><div class="col-lg-12 mt-2">
			<h2>Mitre Att&amp;ck mapping</h2>
		</div></div>
        <!-- SubSection Mitre Att&amp;ck mapping end --><div class="row"><div class="col-lg-12"><p>This is the mapping of the Mitre Att&amp;ck framework with PingCastle rules.</p></div></div><div class="row"><div class="col-lg-12"><p>Number of rules covered: 174</p></div></div><div class="row"><div class="col-lg-12"><p>Number of rules not covered: 0</p></div></div><div class="row"><div class="col-lg-12"><p></p><h3>Techniques</h3><p></p></div></div><p>Number of Mitre rules matched: 26</p><p>Number of PingCastle rules not covered: 80</p><div class="row"><div class="col-lg-12"><div class="row"><div class="col-lg-12"><p><strong>Initial Access</strong></p></div></div><p><a href="https://attack.mitre.org/techniques/T1078/003">T1078.003 Valid Accounts: Local Accounts</a> [2]</p> <span class="text-monospace">A-Guest</span> <span class="text-monospace">A-LAPS-Not-Installed</span><div class="row"><div class="col-lg-12"><p><strong>Execution</strong></p></div></div><p><a href="https://attack.mitre.org/techniques/T1569">T1569 System Services</a> [1]</p> <span class="text-monospace">P-DisplaySpecifier</span><div class="row"><div class="col-lg-12"><p><strong>Privilege Escalation</strong></p></div></div><p><a href="https://attack.mitre.org/techniques/T1134/005">T1134.005 Access Token Manipulation: SID-History Injection</a> [5]</p> <span class="text-monospace">S-SIDHistory</span> <span class="text-monospace">T-SIDFiltering</span> <span class="text-monospace">T-SIDHistoryDangerous</span> <span class="text-monospace">T-SIDHistorySameDomain</span> <span class="text-monospace">T-SIDHistoryUnknownDomain</span><div class="row"><div class="col-lg-12"><p><strong>Defense Evasion</strong></p></div></div><p><a href="https://attack.mitre.org/techniques/T1207">T1207 Rogue Domain Controller</a> [2]</p> <span class="text-monospace">P-RODCSYSVOLWrite</span> <span class="text-monospace">S-DCRegistration</span><p><a href="https://attack.mitre.org/techniques/T1600/001">T1600.001 Weaken Encryption: Reduce Key Space</a> [18]</p> <span class="text-monospace">A-CertROCA</span> <span class="text-monospace">A-CertWeakDSA</span> <span class="text-monospace">A-CertWeakRsaComponent</span> <span class="text-monospace">A-DCLdapsProtocol</span> <span class="text-monospace">A-DCLdapsProtocolAdvanced</span> <span class="text-monospace">A-MD2IntermediateCert</span> <span class="text-monospace">A-MD2RootCert</span> <span class="text-monospace">A-MD4IntermediateCert</span> <span class="text-monospace">A-MD4RootCert</span> <span class="text-monospace">A-MD5IntermediateCert</span> <span class="text-monospace">A-MD5RootCert</span> <span class="text-monospace">A-SHA0IntermediateCert</span> <span class="text-monospace">A-SHA0RootCert</span> <span class="text-monospace">A-SHA1IntermediateCert</span> <span class="text-monospace">A-SHA1RootCert</span> <span class="text-monospace">A-WSUS-SslProtocol</span> <span class="text-monospace">A-WeakRSARootCert</span> <span class="text-monospace">A-WeakRSARootCert2</span><div class="row"><div class="col-lg-12"><p><strong>Credential Access</strong></p></div></div><p><a href="https://attack.mitre.org/techniques/T1003">T1003 OS Credential Dumping</a> [1]</p> <span class="text-monospace">T-AzureADSSO</span><p><a href="https://attack.mitre.org/techniques/T1003/004">T1003.004 OS Credential Dumping: LSA Secrets</a> [1]</p> <span class="text-monospace">P-ServiceDomainAdmin</span><p><a href="https://attack.mitre.org/techniques/T111">T111 Two-Factor Authentication Interception</a> [1]</p> <span class="text-monospace">P-DelegationKeyAdmin</span><p><a href="https://attack.mitre.org/techniques/T1110/002">T1110.002 Brute Force: Password Cracking</a> [5]</p> <span class="text-monospace">A-LMHashAuthorized</span> <span class="text-monospace">A-ReversiblePwd</span> <span class="text-monospace">A-SmartCardRequired</span> <span class="text-monospace">S-C-Reversible</span> <span class="text-monospace">S-Reversible</span><p><a href="https://attack.mitre.org/techniques/T1110/003">T1110.003 Brute Force: Password Spraying</a> [7]</p> <span class="text-monospace">A-AnonymousAuthorizedGPO</span> <span class="text-monospace">A-DsHeuristicsAllowAnonNSPI</span> <span class="text-monospace">A-DsHeuristicsAnonymous</span> <span class="text-monospace">A-LimitBlankPasswordUse</span> <span class="text-monospace">A-NullSession</span> <span class="text-monospace">A-PreWin2000Anonymous</span> <span class="text-monospace">A-PreWin2000Other</span><p><a href="https://attack.mitre.org/techniques/T1187">T1187 Forced Authentication</a> [11]</p> <span class="text-monospace">A-DC-Spooler</span> <span class="text-monospace">A-DC-WebClient</span> <span class="text-monospace">A-DsHeuristicsDoNotVerifyUniqueness</span> <span class="text-monospace">A-DsHeuristicsLDAPSecurity</span> <span class="text-monospace">P-DelegationDCa2d2</span> <span class="text-monospace">P-DelegationDCsourcedeleg</span> <span class="text-monospace">P-DelegationDCt2a4d</span> <span class="text-monospace">P-DelegationEveryone</span> <span class="text-monospace">P-UnconstrainedDelegation</span> <span class="text-monospace">P-UnkownDelegation</span> <span class="text-monospace">T-TGTDelegation</span><p><a href="https://attack.mitre.org/techniques/T1552">T1552 Unsecured Credentials</a> [1]</p> <span class="text-monospace">A-UnixPwd</span><p><a href="https://attack.mitre.org/techniques/T1552/006">T1552.006 Unsecured Credentials: Group Policy Preferences</a> [1]</p> <span class="text-monospace">A-PwdGPO</span><p><a href="https://attack.mitre.org/techniques/T1555/005">T1555.005 Credentials from Password Stores: Password Managers</a> [1]</p> <span class="text-monospace">A-LAPS-Joined-Computers</span><p><a href="https://attack.mitre.org/techniques/T1557">T1557 Man-in-the-Middle</a> [11]</p> <span class="text-monospace">A-CertEnrollChannelBinding</span> <span class="text-monospace">A-CertEnrollHttp</span> <span class="text-monospace">A-DCLdapSign</span> <span class="text-monospace">A-DCLdapsChannelBinding</span> <span class="text-monospace">A-DnsZoneAUCreateChild</span> <span class="text-monospace">A-DnsZoneUpdate1</span> <span class="text-monospace">A-DnsZoneUpdate2</span> <span class="text-monospace">A-LDAPSigningDisabled</span> <span class="text-monospace">A-SMB2SignatureNotEnabled</span> <span class="text-monospace">A-SMB2SignatureNotRequired</span> <span class="text-monospace">T-Inactive</span><p><a href="https://attack.mitre.org/techniques/T1557/001">T1557.001 Man-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay</a> [4]</p> <span class="text-monospace">A-HardenedPaths</span> <span class="text-monospace">A-NoGPOLLMNR</span> <span class="text-monospace">S-OldNtlm</span> <span class="text-monospace">S-SMB-v1</span><p><a href="https://attack.mitre.org/techniques/T1558">T1558 Steal or Forge Kerberos Tickets</a> [7]</p> <span class="text-monospace">A-CertTempAgent</span> <span class="text-monospace">A-CertTempAnyPurpose</span> <span class="text-monospace">A-CertTempAnyone</span> <span class="text-monospace">A-CertTempCustomSubject</span> <span class="text-monospace">A-CertTempNoSecurity</span> <span class="text-monospace">S-KerberosArmoring</span> <span class="text-monospace">S-KerberosArmoringDC</span><p><a href="https://attack.mitre.org/techniques/T1558/001">T1558.001 Steal or Forge Kerberos Tickets: Golden Ticket</a> [1]</p> <span class="text-monospace">A-Krbtgt</span><p><a href="https://attack.mitre.org/techniques/T1558/003">T1558.003 Steal or Forge Kerberos Tickets: Kerberoasting</a> [1]</p> <span class="text-monospace">P-Kerberoasting</span><p><a href="https://attack.mitre.org/techniques/T1558/004">T1558.004 Steal or Forge Kerberos Tickets: AS-REP Roasting</a> [3]</p> <span class="text-monospace">S-DesEnabled</span> <span class="text-monospace">S-NoPreAuth</span> <span class="text-monospace">S-NoPreAuthAdmin</span><div class="row"><div class="col-lg-12"><p><strong>Discovery</strong></p></div></div><p><a href="https://attack.mitre.org/techniques/T1018">T1018 Remote System Discovery</a> [1]</p> <span class="text-monospace">A-DnsZoneTransfert</span><p><a href="https://attack.mitre.org/techniques/T1069/002">T1069.002 Permission Groups Discovery: Domain Groups</a> [2]</p> <span class="text-monospace">P-ControlPathIndirectEveryone</span> <span class="text-monospace">P-ControlPathIndirectMany</span><p><a href="https://attack.mitre.org/techniques/T1087/001">T1087.001 Account Discovery: Local Account</a> [1]</p> <span class="text-monospace">A-NoNetSessionHardening</span><p><a href="https://attack.mitre.org/techniques/T1201">T1201 Password Policy Discovery</a> [2]</p> <span class="text-monospace">A-MinPwdLen</span> <span class="text-monospace">A-NoServicePolicy</span><div class="row"><div class="col-lg-12"><p><strong>Lateral Movement</strong></p></div></div><p><a href="https://attack.mitre.org/techniques/T1210">T1210 Exploitation of Remote Services</a> [3]</p> <span class="text-monospace">A-PreWin2000AuthenticatedUsers</span> <span class="text-monospace">T-FileDeployedOutOfDomain</span> <span class="text-monospace">T-ScriptOutOfDomain</span><p><a href="https://attack.mitre.org/techniques/T1563">T1563 Remote Service Session Hijacking</a> [1]</p> <span class="text-monospace">A-NTFRSOnSysvol</span></div></div><div class="row"><div class="col-lg-12"><p></p><h3>Mitigations</h3><p></p></div></div><p>Number of Mitre rules matched: 7</p><p>Number of PingCastle rules not covered: 77</p><div class="row"><div class="col-lg-12"><p><a href="https://attack.mitre.org/mitigations/M1015">Mitre Att&amp;ck - Mitigation - Active Directory Configuration</a> [43]</p> <span class="text-monospace">A-DCRefuseComputerPwdChange</span> <span class="text-monospace">A-Guest</span> <span class="text-monospace">A-MembershipEveryone</span> <span class="text-monospace">P-DangerousExtendedRight</span> <span class="text-monospace">P-Delegated</span> <span class="text-monospace">P-DelegationDCa2d2</span> <span class="text-monospace">P-DelegationDCsourcedeleg</span> <span class="text-monospace">P-DelegationDCt2a4d</span> <span class="text-monospace">P-DelegationEveryone</span> <span class="text-monospace">P-DelegationFileDeployed</span> <span class="text-monospace">P-DelegationGPOData</span> <span class="text-monospace">P-DelegationKeyAdmin</span> <span class="text-monospace">P-DelegationLoginScript</span> <span class="text-monospace">P-DsHeuristicsDoListObject</span> <span class="text-monospace">P-ExchangeAdminSDHolder</span> <span class="text-monospace">P-ExchangePrivEsc</span> <span class="text-monospace">P-PrivilegeEveryone</span> <span class="text-monospace">P-RODCAdminRevealed</span> <span class="text-monospace">P-RODCAllowedGroup</span> <span class="text-monospace">P-RODCDeniedGroup</span> <span class="text-monospace">P-RODCNeverReveal</span> <span class="text-monospace">P-RODCRevealOnDemand</span> <span class="text-monospace">P-RODCSYSVOLWrite</span> <span class="text-monospace">P-UnconstrainedDelegation</span> <span class="text-monospace">P-UnkownDelegation</span> <span class="text-monospace">P-UnprotectedOU</span> <span class="text-monospace">S-C-PrimaryGroup</span> <span class="text-monospace">S-DC-SubnetMissing</span> <span class="text-monospace">S-Duplicate</span> <span class="text-monospace">S-JavaSchema</span> <span class="text-monospace">S-PrimaryGroup</span> <span class="text-monospace">S-PwdLastSet-45</span> <span class="text-monospace">S-PwdLastSet-90</span> <span class="text-monospace">S-PwdLastSet-DC</span> <span class="text-monospace">S-PwdNeverExpires</span> <span class="text-monospace">S-PwdNotRequired</span> <span class="text-monospace">S-SIDHistory</span> <span class="text-monospace">T-AlgsAES</span> <span class="text-monospace">T-SIDFiltering</span> <span class="text-monospace">T-SIDHistoryDangerous</span> <span class="text-monospace">T-SIDHistorySameDomain</span> <span class="text-monospace">T-SIDHistoryUnknownDomain</span> <span class="text-monospace">T-TGTDelegation</span><p><a href="https://attack.mitre.org/mitigations/M1047">Mitre Att&amp;ck - Mitigation - Audit</a> [3]</p> <span class="text-monospace">A-AuditDC</span> <span class="text-monospace">A-AuditPowershell</span> <span class="text-monospace">P-RecycleBin</span><p><a href="https://attack.mitre.org/mitigations/M1053">Mitre Att&amp;ck - Mitigation - Data Backup</a> [2]</p> <span class="text-monospace">A-BackupMetadata</span> <span class="text-monospace">A-NotEnoughDC</span><p><a href="https://attack.mitre.org/mitigations/M1026">Mitre Att&amp;ck - Mitigation - Privileged Account Management</a> [21]</p> <span class="text-monospace">A-AdminSDHolder</span> <span class="text-monospace">A-LAPS-Not-Installed</span> <span class="text-monospace">A-ProtectedUsers</span> <span class="text-monospace">P-AdminEmailOn</span> <span class="text-monospace">P-AdminLogin</span> <span class="text-monospace">P-AdminNum</span> <span class="text-monospace">P-AdminPwdTooOld</span> <span class="text-monospace">P-DCOwner</span> <span class="text-monospace">P-DNSAdmin</span> <span class="text-monospace">P-DNSDelegation</span> <span class="text-monospace">P-DsHeuristicsAdminSDExMask</span> <span class="text-monospace">P-Inactive</span> <span class="text-monospace">P-LoginDCEveryone</span> <span class="text-monospace">P-LogonDenied</span> <span class="text-monospace">P-OperatorsEmpty</span> <span class="text-monospace">P-RecoveryModeUnprotected</span> <span class="text-monospace">P-SchemaAdmin</span> <span class="text-monospace">P-ServiceDomainAdmin</span> <span class="text-monospace">P-TrustedCredManAccessPrivilege</span> <span class="text-monospace">S-Domain$$$</span> <span class="text-monospace">T-Downlevel</span><p><a href="https://attack.mitre.org/mitigations/M1025">Mitre Att&amp;ck - Mitigation - Privileged Process Integrity</a> [1]</p> <span class="text-monospace">P-ProtectedUsers</span><p><a href="https://attack.mitre.org/mitigations/M1051">Mitre Att&amp;ck - Mitigation - Update Software</a> [21]</p> <span class="text-monospace">S-DC-2000</span> <span class="text-monospace">S-DC-2003</span> <span class="text-monospace">S-DC-2008</span> <span class="text-monospace">S-DC-NotUpdated</span> <span class="text-monospace">S-FunctionalLevel1</span> <span class="text-monospace">S-FunctionalLevel3</span> <span class="text-monospace">S-FunctionalLevel4</span> <span class="text-monospace">S-OS-2000</span> <span class="text-monospace">S-OS-2003</span> <span class="text-monospace">S-OS-2008</span> <span class="text-monospace">S-OS-NT</span> <span class="text-monospace">S-OS-Vista</span> <span class="text-monospace">S-OS-W10</span> <span class="text-monospace">S-OS-Win7</span> <span class="text-monospace">S-OS-Win8</span> <span class="text-monospace">S-OS-XP</span> <span class="text-monospace">S-Vuln-MS14-068</span> <span class="text-monospace">S-Vuln-MS17_010</span> <span class="text-monospace">S-WSUS-HTTP</span> <span class="text-monospace">S-WSUS-NoPinning</span> <span class="text-monospace">S-WSUS-UserProxy</span><p><a href="https://attack.mitre.org/mitigations/M1018">Mitre Att&amp;ck - Mitigation - User Account Management</a> [6]</p> <span class="text-monospace">S-ADRegistration</span> <span class="text-monospace">S-ADRegistrationSchema</span> <span class="text-monospace">S-C-Inactive</span> <span class="text-monospace">S-DC-Inactive</span> <span class="text-monospace">S-DefaultOUChanged</span> <span class="text-monospace">S-Inactive</span></div></div>
		<!-- SubSection ANSSI Rules mapping -->
		<div class="row"><div class="col-lg-12 mt-2">
			<h2>ANSSI Rules mapping</h2>
		</div></div>
        <!-- SubSection ANSSI Rules mapping end --><div class="row"><div class="col-lg-12"><p>This is the mapping of the ANSSI rules with PingCastle rules.</p></div></div><p>Number of ANSSI rules matched: 48</p><div class="row"><div class="col-lg-12"><p><span class="badge grade-1">1</span>: 20</p><p><span class="badge grade-2">2</span>: 14</p><p><span class="badge grade-3">3</span>: 13</p><p><span class="badge grade-4">4</span>: 1</p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-1">1</span>Constrained authentication delegation to a domain controller service (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#delegation_a2d2">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln1_delegation_a2d2</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">P-DelegationDCa2d2</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-1">1</span>Constrained delegation with protocol transition to a domain controller service (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#delegation_t2a4d">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln1_delegation_t2a4d</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">P-DelegationDCt2a4d</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-1">1</span>Dangerous Display Specifiers (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#vuln_display_specifier">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln1_vuln_display_specifier</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">P-DisplaySpecifier</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-1">1</span><span class="badge grade-2">2</span><span class="badge grade-3">3</span>Dangerous dsHeuristics settings (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#dsheuristics_bad">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln1_dsheuristics_bad</span> <span class="text-monospace">vuln2_dsheuristics_bad</span> <span class="text-monospace">vuln3_dsheuristics_bad</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">A-DsHeuristicsAllowAnonNSPI</span> <span class="text-monospace">A-DsHeuristicsAnonymous</span> <span class="text-monospace">A-DsHeuristicsDoNotVerifyUniqueness</span> <span class="text-monospace">A-DsHeuristicsLDAPSecurity</span> <span class="text-monospace">P-DsHeuristicsAdminSDExMask</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-1">1</span>Dangerous enrollment permission on authentication certificate templates (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#vuln_adcs_template_auth_enroll_with_name">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln1_vuln_adcs_template_auth_enroll_with_name</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">A-CertTempAgent</span> <span class="text-monospace">A-CertTempAnyPurpose</span> <span class="text-monospace">A-CertTempAnyone</span> <span class="text-monospace">A-CertTempCustomSubject</span> <span class="text-monospace">A-CertTempNoSecurity</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-1">1</span>Domain controllers in inconsistent state (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#dc_inconsistent_uac">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln1_dc_inconsistent_uac</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">S-DCRegistration</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-1">1</span>Domain controllers with passwords unchanged for more than 45 days (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#password_change_dc_no_change">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln1_password_change_dc_no_change</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">S-PwdLastSet-DC</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-1">1</span>Dormant accounts (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#user_accounts_dormant">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln1_user_accounts_dormant</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">S-Inactive</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-1">1</span>Inactive domain controllers (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#password_change_inactive_dc">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln1_password_change_inactive_dc</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">S-DC-Inactive</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-1">1</span><span class="badge grade-3">3</span>Insufficient forest and domains functional levels (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#vuln_functional_level">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln1_vuln_functional_level</span> <span class="text-monospace">vuln3_vuln_functional_level</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">S-FunctionalLevel1</span> <span class="text-monospace">S-FunctionalLevel3</span> <span class="text-monospace">S-FunctionalLevel4</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-1">1</span>Kerberos pre-authentication disabled for privileged accounts (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#kerberos_properties_preauth_priv">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln1_kerberos_properties_preauth_priv</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">S-NoPreAuthAdmin</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-1">1</span>Large privileged group member count (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#privileged_members">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln1_privileged_members</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">P-AdminNum</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-1">1</span><span class="badge grade-3">3</span>Misconfigured DNS zones (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#dnszone_bad_prop">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln1_dnszone_bad_prop</span> <span class="text-monospace">vuln3_dnszone_bad_prop</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">A-DnsZoneUpdate1</span> <span class="text-monospace">A-DnsZoneUpdate2</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-1">1</span>Outbound forest trust relationships with sID History enabled (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#trusts_forest_sidhistory">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln1_trusts_forest_sidhistory</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">T-SIDFiltering</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-1">1</span>Privileged account passwords age too old (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#password_change_priv">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln1_password_change_priv</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">P-AdminPwdTooOld</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-1">1</span>Privileged accounts with SPN (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#spn_priv">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln1_spn_priv</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">P-Kerberoasting</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-1">1</span>Privileged accounts with never-expiring passwords (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#dont_expire_priv">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln1_dont_expire_priv</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">P-ServiceDomainAdmin</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-1">1</span>Resource-based constrained delegation on domain controlers (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#delegation_sourcedeleg">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln1_delegation_sourcedeleg</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">P-DelegationDCsourcedeleg</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-1">1</span>Unfiltered outbound domain trust relationship (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#trusts_domain_notfiltered">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln1_trusts_domain_notfiltered</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">T-SIDFiltering</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-1">1</span><span class="badge grade-3">3</span>Weak or vulnerable certificates (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#certificates_vuln">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln1_certificates_vuln</span> <span class="text-monospace">vuln3_certificates_vuln</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">A-CertROCA</span> <span class="text-monospace">A-CertWeakDSA</span> <span class="text-monospace">A-CertWeakRsaComponent</span> <span class="text-monospace">A-MD2IntermediateCert</span> <span class="text-monospace">A-MD2RootCert</span> <span class="text-monospace">A-MD4IntermediateCert</span> <span class="text-monospace">A-MD4RootCert</span> <span class="text-monospace">A-MD5IntermediateCert</span> <span class="text-monospace">A-MD5RootCert</span> <span class="text-monospace">A-SHA0IntermediateCert</span> <span class="text-monospace">A-SHA0RootCert</span> <span class="text-monospace">A-SHA1IntermediateCert</span> <span class="text-monospace">A-SHA1RootCert</span> <span class="text-monospace">A-WeakRSARootCert</span> <span class="text-monospace">A-WeakRSARootCert2</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-2">2</span>Accounts or groups with unexpected SID history (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#sidhistory_dangerous">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln2_sidhistory_dangerous</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">T-SIDHistoryDangerous</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-2">2</span>Accounts with never-expiring passwords (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#dont_expire">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln2_dont_expire</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">S-PwdNeverExpires</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-2">2</span>Bad Active Directory versions (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#adupdate_bad">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln2_adupdate_bad</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">P-DelegationKeyAdmin</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-2">2</span>Kerberos pre-authentication disabled (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#kerberos_properties_preauth">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln2_kerberos_properties_preauth</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">S-NoPreAuth</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-2">2</span>Krbtgt account password unchanged for more than a year (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#krbtgt">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln2_krbtgt</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">A-Krbtgt</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-2">2</span>Privileged group members with weak password policy (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#privileged_members_password">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln2_privileged_members_password</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">A-MinPwdLen</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-2">2</span>Privileged users revealed on RODC (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#rodc_priv_revealed">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln2_rodc_priv_revealed</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">P-RODCAdminRevealed</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-2">2</span>SYSVOL replication through NTFRS (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#sysvol_ntfrs">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln2_sysvol_ntfrs</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">A-NTFRSOnSysvol</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-2">2</span>Schema class allowing dangerous object creation (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#warning_schema_posssuperiors">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln2_warning_schema_posssuperiors</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">S-ADRegistrationSchema</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-2">2</span>Servers with passwords unchanged for more than 90 days (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#password_change_server_no_change_90">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln2_password_change_server_no_change_90</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">S-PwdLastSet-90</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-2">2</span>The "Pre - Windows 2000 Compatible Access" group includes "Anonymous" (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#compatible_2000_anonymous">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln2_compatible_2000_anonymous</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">A-PreWin2000Anonymous</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-2">2</span>Trust account passwords unchanged for more than a year (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#trusts_accounts">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln2_trusts_accounts</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">T-AzureADSSO</span> <span class="text-monospace">T-Inactive</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-2">2</span>Unconstrained authentication delegation (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#delegation_t4d">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln2_delegation_t4d</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">P-UnconstrainedDelegation</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-2">2</span>Use of Kerberos with weak encryption (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#kerberos_properties_deskey">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln2_kerberos_properties_deskey</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">S-DesEnabled</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-3">3</span>Accounts or groups with SID history set (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#sidhistory_present">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln3_sidhistory_present</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">T-SIDHistorySameDomain</span> <span class="text-monospace">T-SIDHistoryUnknownDomain</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-3">3</span>Accounts with modified PrimaryGroupID (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#primary_group_id_nochange">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln3_primary_group_id_nochange</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">S-C-PrimaryGroup</span> <span class="text-monospace">S-PrimaryGroup</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-3">3</span>Accounts with passwords stored using reversible encryption (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#reversible_password">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln3_reversible_password</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">A-ReversiblePwd</span> <span class="text-monospace">A-UnixPwd</span> <span class="text-monospace">S-C-Reversible</span> <span class="text-monospace">S-Reversible</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-3">3</span>Dangerous configuration of read-only domain controllers (RODC) (neverReveal) (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#rodc_never_reveal">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln3_rodc_never_reveal</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">P-RODCNeverReveal</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-3">3</span>Dangerous configuration of read-only domain controllers (RODC) (reveal) (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#rodc_reveal">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln3_rodc_reveal</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">P-RODCRevealOnDemand</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-3">3</span>Dangerous configuration of replication groups for read-only domain controllers (RODCs) (allow) (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#rodc_allowed_group">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln3_rodc_allowed_group</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">P-RODCAllowedGroup</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-3">3</span>Dangerous configuration of replication groups for read-only domain controllers (RODCs) (denied) (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#rodc_denied_group">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln3_rodc_denied_group</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">P-RODCDeniedGroup</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-3">3</span>Inactive servers (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#password_change_inactive_servers">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln3_password_change_inactive_servers</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">S-C-Inactive</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-3">3</span>Inbound trust relationships with delegation (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#trusts_tgt_deleg">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln3_trusts_tgt_deleg</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">T-TGTDelegation</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-3">3</span>Incorrect object owners (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#owner">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln3_owner</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">P-DCOwner</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-3">3</span>Privileged accounts outside of the Protected Users group (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#protected_users">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln3_protected_users</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">P-ProtectedUsers</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-3">3</span>Servers with passwords unchanged for more than 45 days (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#password_change_server_no_change_45">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln3_password_change_server_no_change_45</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">S-PwdLastSet-45</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-3">3</span>Use of the "Pre-Windows 2000 Compatible Access" group (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#compatible_2000_not_default">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln3_compatible_2000_not_default</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">A-PreWin2000Other</span></p></div></div><div class="row"><div class="col-lg-12"><p><span class="badge grade-4">4</span>DnsAdmins group members (<a href="https://www.cert.ssi.gouv.fr/uploads/guide-ad.html#dnsadmins">link</a>)</p></div></div><div class="row"><div class="col-lg-12"><p>ANSSI ID&nbsp;: <span class="text-monospace">vuln4_dnsadmins</span></p></div></div><div class="row"><div class="col-lg-12"><p>PingCastle ID&nbsp;: <span class="text-monospace">P-DNSAdmin</span></p></div></div>
</div>


<script type="text/javascript">
/*! jQuery v3.3.1 | (c) JS Foundation and other contributors | jquery.org/license */
!function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){"use strict";var n=[],r=e.document,i=Object.getPrototypeOf,o=n.slice,a=n.concat,s=n.push,u=n.indexOf,l={},c=l.toString,f=l.hasOwnProperty,p=f.toString,d=p.call(Object),h={},g=function e(t){return"function"==typeof t&&"number"!=typeof t.nodeType},y=function e(t){return null!=t&&t===t.window},v={type:!0,src:!0,noModule:!0};function m(e,t,n){var i,o=(t=t||r).createElement("script");if(o.text=e,n)for(i in v)n[i]&&(o[i]=n[i]);t.head.appendChild(o).parentNode.removeChild(o)}function x(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?l[c.call(e)]||"object":typeof e}var b="3.3.1",w=function(e,t){return new w.fn.init(e,t)},T=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;w.fn=w.prototype={jquery:"3.3.1",constructor:w,length:0,toArray:function(){return o.call(this)},get:function(e){return null==e?o.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=w.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return w.each(this,e)},map:function(e){return this.pushStack(w.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(o.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:s,sort:n.sort,splice:n.splice},w.extend=w.fn.extend=function(){var e,t,n,r,i,o,a=arguments[0]||{},s=1,u=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[s]||{},s++),"object"==typeof a||g(a)||(a={}),s===u&&(a=this,s--);s<u;s++)if(null!=(e=arguments[s]))for(t in e)n=a[t],a!==(r=e[t])&&(l&&r&&(w.isPlainObject(r)||(i=Array.isArray(r)))?(i?(i=!1,o=n&&Array.isArray(n)?n:[]):o=n&&w.isPlainObject(n)?n:{},a[t]=w.extend(l,o,r)):void 0!==r&&(a[t]=r));return a},w.extend({expando:"jQuery"+("3.3.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==c.call(e))&&(!(t=i(e))||"function"==typeof(n=f.call(t,"constructor")&&t.constructor)&&p.call(n)===d)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e){m(e)},each:function(e,t){var n,r=0;if(C(e)){for(n=e.length;r<n;r++)if(!1===t.call(e[r],r,e[r]))break}else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},trim:function(e){return null==e?"":(e+"").replace(T,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(C(Object(e))?w.merge(n,"string"==typeof e?[e]:e):s.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:u.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r,i=[],o=0,a=e.length,s=!n;o<a;o++)(r=!t(e[o],o))!==s&&i.push(e[o]);return i},map:function(e,t,n){var r,i,o=0,s=[];if(C(e))for(r=e.length;o<r;o++)null!=(i=t(e[o],o,n))&&s.push(i);else for(o in e)null!=(i=t(e[o],o,n))&&s.push(i);return a.apply([],s)},guid:1,support:h}),"function"==typeof Symbol&&(w.fn[Symbol.iterator]=n[Symbol.iterator]),w.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){l["[object "+t+"]"]=t.toLowerCase()});function C(e){var t=!!e&&"length"in e&&e.length,n=x(e);return!g(e)&&!y(e)&&("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e)}var E=function(e){var t,n,r,i,o,a,s,u,l,c,f,p,d,h,g,y,v,m,x,b="sizzle"+1*new Date,w=e.document,T=0,C=0,E=ae(),k=ae(),S=ae(),D=function(e,t){return e===t&&(f=!0),0},N={}.hasOwnProperty,A=[],j=A.pop,q=A.push,L=A.push,H=A.slice,O=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},P="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",M="[\\x20\\t\\r\\n\\f]",R="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",I="\\["+M+"*("+R+")(?:"+M+"*([*^$|!~]?=)"+M+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+R+"))|)"+M+"*\\]",W=":("+R+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+I+")*)|.*)\\)|)",$=new RegExp(M+"+","g"),B=new RegExp("^"+M+"+|((?:^|[^\\\\])(?:\\\\.)*)"+M+"+$","g"),F=new RegExp("^"+M+"*,"+M+"*"),_=new RegExp("^"+M+"*([>+~]|"+M+")"+M+"*"),z=new RegExp("="+M+"*([^\\]'\"]*?)"+M+"*\\]","g"),X=new RegExp(W),U=new RegExp("^"+R+"$"),V={ID:new RegExp("^#("+R+")"),CLASS:new RegExp("^\\.("+R+")"),TAG:new RegExp("^("+R+"|[*])"),ATTR:new RegExp("^"+I),PSEUDO:new RegExp("^"+W),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+M+"*(even|odd|(([+-]|)(\\d*)n|)"+M+"*(?:([+-]|)"+M+"*(\\d+)|))"+M+"*\\)|)","i"),bool:new RegExp("^(?:"+P+")$","i"),needsContext:new RegExp("^"+M+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+M+"*((?:-\\d)?\\d*)"+M+"*\\)|)(?=[^-]|$)","i")},G=/^(?:input|select|textarea|button)$/i,Y=/^h\d$/i,Q=/^[^{]+\{\s*\[native \w/,J=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,K=/[+~]/,Z=new RegExp("\\\\([\\da-f]{1,6}"+M+"?|("+M+")|.)","ig"),ee=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)},te=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ne=function(e,t){return t?"\0"===e?"\ufffd":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},re=function(){p()},ie=me(function(e){return!0===e.disabled&&("form"in e||"label"in e)},{dir:"parentNode",next:"legend"});try{L.apply(A=H.call(w.childNodes),w.childNodes),A[w.childNodes.length].nodeType}catch(e){L={apply:A.length?function(e,t){q.apply(e,H.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}function oe(e,t,r,i){var o,s,l,c,f,h,v,m=t&&t.ownerDocument,T=t?t.nodeType:9;if(r=r||[],"string"!=typeof e||!e||1!==T&&9!==T&&11!==T)return r;if(!i&&((t?t.ownerDocument||t:w)!==d&&p(t),t=t||d,g)){if(11!==T&&(f=J.exec(e)))if(o=f[1]){if(9===T){if(!(l=t.getElementById(o)))return r;if(l.id===o)return r.push(l),r}else if(m&&(l=m.getElementById(o))&&x(t,l)&&l.id===o)return r.push(l),r}else{if(f[2])return L.apply(r,t.getElementsByTagName(e)),r;if((o=f[3])&&n.getElementsByClassName&&t.getElementsByClassName)return L.apply(r,t.getElementsByClassName(o)),r}if(n.qsa&&!S[e+" "]&&(!y||!y.test(e))){if(1!==T)m=t,v=e;else if("object"!==t.nodeName.toLowerCase()){(c=t.getAttribute("id"))?c=c.replace(te,ne):t.setAttribute("id",c=b),s=(h=a(e)).length;while(s--)h[s]="#"+c+" "+ve(h[s]);v=h.join(","),m=K.test(e)&&ge(t.parentNode)||t}if(v)try{return L.apply(r,m.querySelectorAll(v)),r}catch(e){}finally{c===b&&t.removeAttribute("id")}}}return u(e.replace(B,"$1"),t,r,i)}function ae(){var e=[];function t(n,i){return e.push(n+" ")>r.cacheLength&&delete t[e.shift()],t[n+" "]=i}return t}function se(e){return e[b]=!0,e}function ue(e){var t=d.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function le(e,t){var n=e.split("|"),i=n.length;while(i--)r.attrHandle[n[i]]=t}function ce(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function fe(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function pe(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function de(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&ie(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function he(e){return se(function(t){return t=+t,se(function(n,r){var i,o=e([],n.length,t),a=o.length;while(a--)n[i=o[a]]&&(n[i]=!(r[i]=n[i]))})})}function ge(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}n=oe.support={},o=oe.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},p=oe.setDocument=function(e){var t,i,a=e?e.ownerDocument||e:w;return a!==d&&9===a.nodeType&&a.documentElement?(d=a,h=d.documentElement,g=!o(d),w!==d&&(i=d.defaultView)&&i.top!==i&&(i.addEventListener?i.addEventListener("unload",re,!1):i.attachEvent&&i.attachEvent("onunload",re)),n.attributes=ue(function(e){return e.className="i",!e.getAttribute("className")}),n.getElementsByTagName=ue(function(e){return e.appendChild(d.createComment("")),!e.getElementsByTagName("*").length}),n.getElementsByClassName=Q.test(d.getElementsByClassName),n.getById=ue(function(e){return h.appendChild(e).id=b,!d.getElementsByName||!d.getElementsByName(b).length}),n.getById?(r.filter.ID=function(e){var t=e.replace(Z,ee);return function(e){return e.getAttribute("id")===t}},r.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&g){var n=t.getElementById(e);return n?[n]:[]}}):(r.filter.ID=function(e){var t=e.replace(Z,ee);return function(e){var n="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}},r.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&g){var n,r,i,o=t.getElementById(e);if(o){if((n=o.getAttributeNode("id"))&&n.value===e)return[o];i=t.getElementsByName(e),r=0;while(o=i[r++])if((n=o.getAttributeNode("id"))&&n.value===e)return[o]}return[]}}),r.find.TAG=n.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):n.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){while(n=o[i++])1===n.nodeType&&r.push(n);return r}return o},r.find.CLASS=n.getElementsByClassName&&function(e,t){if("undefined"!=typeof t.getElementsByClassName&&g)return t.getElementsByClassName(e)},v=[],y=[],(n.qsa=Q.test(d.querySelectorAll))&&(ue(function(e){h.appendChild(e).innerHTML="<a id='"+b+"'></a><select id='"+b+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&y.push("[*^$]="+M+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||y.push("\\["+M+"*(?:value|"+P+")"),e.querySelectorAll("[id~="+b+"-]").length||y.push("~="),e.querySelectorAll(":checked").length||y.push(":checked"),e.querySelectorAll("a#"+b+"+*").length||y.push(".#.+[+~]")}),ue(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=d.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&y.push("name"+M+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&y.push(":enabled",":disabled"),h.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&y.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),y.push(",.*:")})),(n.matchesSelector=Q.test(m=h.matches||h.webkitMatchesSelector||h.mozMatchesSelector||h.oMatchesSelector||h.msMatchesSelector))&&ue(function(e){n.disconnectedMatch=m.call(e,"*"),m.call(e,"[s!='']:x"),v.push("!=",W)}),y=y.length&&new RegExp(y.join("|")),v=v.length&&new RegExp(v.join("|")),t=Q.test(h.compareDocumentPosition),x=t||Q.test(h.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},D=t?function(e,t){if(e===t)return f=!0,0;var r=!e.compareDocumentPosition-!t.compareDocumentPosition;return r||(1&(r=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!n.sortDetached&&t.compareDocumentPosition(e)===r?e===d||e.ownerDocument===w&&x(w,e)?-1:t===d||t.ownerDocument===w&&x(w,t)?1:c?O(c,e)-O(c,t):0:4&r?-1:1)}:function(e,t){if(e===t)return f=!0,0;var n,r=0,i=e.parentNode,o=t.parentNode,a=[e],s=[t];if(!i||!o)return e===d?-1:t===d?1:i?-1:o?1:c?O(c,e)-O(c,t):0;if(i===o)return ce(e,t);n=e;while(n=n.parentNode)a.unshift(n);n=t;while(n=n.parentNode)s.unshift(n);while(a[r]===s[r])r++;return r?ce(a[r],s[r]):a[r]===w?-1:s[r]===w?1:0},d):d},oe.matches=function(e,t){return oe(e,null,null,t)},oe.matchesSelector=function(e,t){if((e.ownerDocument||e)!==d&&p(e),t=t.replace(z,"='$1']"),n.matchesSelector&&g&&!S[t+" "]&&(!v||!v.test(t))&&(!y||!y.test(t)))try{var r=m.call(e,t);if(r||n.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(e){}return oe(t,d,null,[e]).length>0},oe.contains=function(e,t){return(e.ownerDocument||e)!==d&&p(e),x(e,t)},oe.attr=function(e,t){(e.ownerDocument||e)!==d&&p(e);var i=r.attrHandle[t.toLowerCase()],o=i&&N.call(r.attrHandle,t.toLowerCase())?i(e,t,!g):void 0;return void 0!==o?o:n.attributes||!g?e.getAttribute(t):(o=e.getAttributeNode(t))&&o.specified?o.value:null},oe.escape=function(e){return(e+"").replace(te,ne)},oe.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},oe.uniqueSort=function(e){var t,r=[],i=0,o=0;if(f=!n.detectDuplicates,c=!n.sortStable&&e.slice(0),e.sort(D),f){while(t=e[o++])t===e[o]&&(i=r.push(o));while(i--)e.splice(r[i],1)}return c=null,e},i=oe.getText=function(e){var t,n="",r=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=i(e)}else if(3===o||4===o)return e.nodeValue}else while(t=e[r++])n+=i(t);return n},(r=oe.selectors={cacheLength:50,createPseudo:se,match:V,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(Z,ee),e[3]=(e[3]||e[4]||e[5]||"").replace(Z,ee),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||oe.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&oe.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return V.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&X.test(n)&&(t=a(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(Z,ee).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=E[e+" "];return t||(t=new RegExp("(^|"+M+")"+e+"("+M+"|$)"))&&E(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=oe.attr(r,e);return null==i?"!="===t:!t||(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i.replace($," ")+" ").indexOf(n)>-1:"|="===t&&(i===n||i.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,r,i){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,u){var l,c,f,p,d,h,g=o!==a?"nextSibling":"previousSibling",y=t.parentNode,v=s&&t.nodeName.toLowerCase(),m=!u&&!s,x=!1;if(y){if(o){while(g){p=t;while(p=p[g])if(s?p.nodeName.toLowerCase()===v:1===p.nodeType)return!1;h=g="only"===e&&!h&&"nextSibling"}return!0}if(h=[a?y.firstChild:y.lastChild],a&&m){x=(d=(l=(c=(f=(p=y)[b]||(p[b]={}))[p.uniqueID]||(f[p.uniqueID]={}))[e]||[])[0]===T&&l[1])&&l[2],p=d&&y.childNodes[d];while(p=++d&&p&&p[g]||(x=d=0)||h.pop())if(1===p.nodeType&&++x&&p===t){c[e]=[T,d,x];break}}else if(m&&(x=d=(l=(c=(f=(p=t)[b]||(p[b]={}))[p.uniqueID]||(f[p.uniqueID]={}))[e]||[])[0]===T&&l[1]),!1===x)while(p=++d&&p&&p[g]||(x=d=0)||h.pop())if((s?p.nodeName.toLowerCase()===v:1===p.nodeType)&&++x&&(m&&((c=(f=p[b]||(p[b]={}))[p.uniqueID]||(f[p.uniqueID]={}))[e]=[T,x]),p===t))break;return(x-=i)===r||x%r==0&&x/r>=0}}},PSEUDO:function(e,t){var n,i=r.pseudos[e]||r.setFilters[e.toLowerCase()]||oe.error("unsupported pseudo: "+e);return i[b]?i(t):i.length>1?(n=[e,e,"",t],r.setFilters.hasOwnProperty(e.toLowerCase())?se(function(e,n){var r,o=i(e,t),a=o.length;while(a--)e[r=O(e,o[a])]=!(n[r]=o[a])}):function(e){return i(e,0,n)}):i}},pseudos:{not:se(function(e){var t=[],n=[],r=s(e.replace(B,"$1"));return r[b]?se(function(e,t,n,i){var o,a=r(e,null,i,[]),s=e.length;while(s--)(o=a[s])&&(e[s]=!(t[s]=o))}):function(e,i,o){return t[0]=e,r(t,null,o,n),t[0]=null,!n.pop()}}),has:se(function(e){return function(t){return oe(e,t).length>0}}),contains:se(function(e){return e=e.replace(Z,ee),function(t){return(t.textContent||t.innerText||i(t)).indexOf(e)>-1}}),lang:se(function(e){return U.test(e||"")||oe.error("unsupported lang: "+e),e=e.replace(Z,ee).toLowerCase(),function(t){var n;do{if(n=g?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===h},focus:function(e){return e===d.activeElement&&(!d.hasFocus||d.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:de(!1),disabled:de(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!r.pseudos.empty(e)},header:function(e){return Y.test(e.nodeName)},input:function(e){return G.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:he(function(){return[0]}),last:he(function(e,t){return[t-1]}),eq:he(function(e,t,n){return[n<0?n+t:n]}),even:he(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:he(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:he(function(e,t,n){for(var r=n<0?n+t:n;--r>=0;)e.push(r);return e}),gt:he(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=r.pseudos.eq;for(t in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})r.pseudos[t]=fe(t);for(t in{submit:!0,reset:!0})r.pseudos[t]=pe(t);function ye(){}ye.prototype=r.filters=r.pseudos,r.setFilters=new ye,a=oe.tokenize=function(e,t){var n,i,o,a,s,u,l,c=k[e+" "];if(c)return t?0:c.slice(0);s=e,u=[],l=r.preFilter;while(s){n&&!(i=F.exec(s))||(i&&(s=s.slice(i[0].length)||s),u.push(o=[])),n=!1,(i=_.exec(s))&&(n=i.shift(),o.push({value:n,type:i[0].replace(B," ")}),s=s.slice(n.length));for(a in r.filter)!(i=V[a].exec(s))||l[a]&&!(i=l[a](i))||(n=i.shift(),o.push({value:n,type:a,matches:i}),s=s.slice(n.length));if(!n)break}return t?s.length:s?oe.error(e):k(e,u).slice(0)};function ve(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function me(e,t,n){var r=t.dir,i=t.next,o=i||r,a=n&&"parentNode"===o,s=C++;return t.first?function(t,n,i){while(t=t[r])if(1===t.nodeType||a)return e(t,n,i);return!1}:function(t,n,u){var l,c,f,p=[T,s];if(u){while(t=t[r])if((1===t.nodeType||a)&&e(t,n,u))return!0}else while(t=t[r])if(1===t.nodeType||a)if(f=t[b]||(t[b]={}),c=f[t.uniqueID]||(f[t.uniqueID]={}),i&&i===t.nodeName.toLowerCase())t=t[r]||t;else{if((l=c[o])&&l[0]===T&&l[1]===s)return p[2]=l[2];if(c[o]=p,p[2]=e(t,n,u))return!0}return!1}}function xe(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function be(e,t,n){for(var r=0,i=t.length;r<i;r++)oe(e,t[r],n);return n}function we(e,t,n,r,i){for(var o,a=[],s=0,u=e.length,l=null!=t;s<u;s++)(o=e[s])&&(n&&!n(o,r,i)||(a.push(o),l&&t.push(s)));return a}function Te(e,t,n,r,i,o){return r&&!r[b]&&(r=Te(r)),i&&!i[b]&&(i=Te(i,o)),se(function(o,a,s,u){var l,c,f,p=[],d=[],h=a.length,g=o||be(t||"*",s.nodeType?[s]:s,[]),y=!e||!o&&t?g:we(g,p,e,s,u),v=n?i||(o?e:h||r)?[]:a:y;if(n&&n(y,v,s,u),r){l=we(v,d),r(l,[],s,u),c=l.length;while(c--)(f=l[c])&&(v[d[c]]=!(y[d[c]]=f))}if(o){if(i||e){if(i){l=[],c=v.length;while(c--)(f=v[c])&&l.push(y[c]=f);i(null,v=[],l,u)}c=v.length;while(c--)(f=v[c])&&(l=i?O(o,f):p[c])>-1&&(o[l]=!(a[l]=f))}}else v=we(v===a?v.splice(h,v.length):v),i?i(null,a,v,u):L.apply(a,v)})}function Ce(e){for(var t,n,i,o=e.length,a=r.relative[e[0].type],s=a||r.relative[" "],u=a?1:0,c=me(function(e){return e===t},s,!0),f=me(function(e){return O(t,e)>-1},s,!0),p=[function(e,n,r){var i=!a&&(r||n!==l)||((t=n).nodeType?c(e,n,r):f(e,n,r));return t=null,i}];u<o;u++)if(n=r.relative[e[u].type])p=[me(xe(p),n)];else{if((n=r.filter[e[u].type].apply(null,e[u].matches))[b]){for(i=++u;i<o;i++)if(r.relative[e[i].type])break;return Te(u>1&&xe(p),u>1&&ve(e.slice(0,u-1).concat({value:" "===e[u-2].type?"*":""})).replace(B,"$1"),n,u<i&&Ce(e.slice(u,i)),i<o&&Ce(e=e.slice(i)),i<o&&ve(e))}p.push(n)}return xe(p)}function Ee(e,t){var n=t.length>0,i=e.length>0,o=function(o,a,s,u,c){var f,h,y,v=0,m="0",x=o&&[],b=[],w=l,C=o||i&&r.find.TAG("*",c),E=T+=null==w?1:Math.random()||.1,k=C.length;for(c&&(l=a===d||a||c);m!==k&&null!=(f=C[m]);m++){if(i&&f){h=0,a||f.ownerDocument===d||(p(f),s=!g);while(y=e[h++])if(y(f,a||d,s)){u.push(f);break}c&&(T=E)}n&&((f=!y&&f)&&v--,o&&x.push(f))}if(v+=m,n&&m!==v){h=0;while(y=t[h++])y(x,b,a,s);if(o){if(v>0)while(m--)x[m]||b[m]||(b[m]=j.call(u));b=we(b)}L.apply(u,b),c&&!o&&b.length>0&&v+t.length>1&&oe.uniqueSort(u)}return c&&(T=E,l=w),x};return n?se(o):o}return s=oe.compile=function(e,t){var n,r=[],i=[],o=S[e+" "];if(!o){t||(t=a(e)),n=t.length;while(n--)(o=Ce(t[n]))[b]?r.push(o):i.push(o);(o=S(e,Ee(i,r))).selector=e}return o},u=oe.select=function(e,t,n,i){var o,u,l,c,f,p="function"==typeof e&&e,d=!i&&a(e=p.selector||e);if(n=n||[],1===d.length){if((u=d[0]=d[0].slice(0)).length>2&&"ID"===(l=u[0]).type&&9===t.nodeType&&g&&r.relative[u[1].type]){if(!(t=(r.find.ID(l.matches[0].replace(Z,ee),t)||[])[0]))return n;p&&(t=t.parentNode),e=e.slice(u.shift().value.length)}o=V.needsContext.test(e)?0:u.length;while(o--){if(l=u[o],r.relative[c=l.type])break;if((f=r.find[c])&&(i=f(l.matches[0].replace(Z,ee),K.test(u[0].type)&&ge(t.parentNode)||t))){if(u.splice(o,1),!(e=i.length&&ve(u)))return L.apply(n,i),n;break}}}return(p||s(e,d))(i,t,!g,n,!t||K.test(e)&&ge(t.parentNode)||t),n},n.sortStable=b.split("").sort(D).join("")===b,n.detectDuplicates=!!f,p(),n.sortDetached=ue(function(e){return 1&e.compareDocumentPosition(d.createElement("fieldset"))}),ue(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||le("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),n.attributes&&ue(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||le("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),ue(function(e){return null==e.getAttribute("disabled")})||le(P,function(e,t,n){var r;if(!n)return!0===e[t]?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),oe}(e);w.find=E,w.expr=E.selectors,w.expr[":"]=w.expr.pseudos,w.uniqueSort=w.unique=E.uniqueSort,w.text=E.getText,w.isXMLDoc=E.isXML,w.contains=E.contains,w.escapeSelector=E.escape;var k=function(e,t,n){var r=[],i=void 0!==n;while((e=e[t])&&9!==e.nodeType)if(1===e.nodeType){if(i&&w(e).is(n))break;r.push(e)}return r},S=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},D=w.expr.match.needsContext;function N(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var A=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function j(e,t,n){return g(t)?w.grep(e,function(e,r){return!!t.call(e,r,e)!==n}):t.nodeType?w.grep(e,function(e){return e===t!==n}):"string"!=typeof t?w.grep(e,function(e){return u.call(t,e)>-1!==n}):w.filter(t,e,n)}w.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?w.find.matchesSelector(r,e)?[r]:[]:w.find.matches(e,w.grep(t,function(e){return 1===e.nodeType}))},w.fn.extend({find:function(e){var t,n,r=this.length,i=this;if("string"!=typeof e)return this.pushStack(w(e).filter(function(){for(t=0;t<r;t++)if(w.contains(i[t],this))return!0}));for(n=this.pushStack([]),t=0;t<r;t++)w.find(e,i[t],n);return r>1?w.uniqueSort(n):n},filter:function(e){return this.pushStack(j(this,e||[],!1))},not:function(e){return this.pushStack(j(this,e||[],!0))},is:function(e){return!!j(this,"string"==typeof e&&D.test(e)?w(e):e||[],!1).length}});var q,L=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(w.fn.init=function(e,t,n){var i,o;if(!e)return this;if(n=n||q,"string"==typeof e){if(!(i="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:L.exec(e))||!i[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(i[1]){if(t=t instanceof w?t[0]:t,w.merge(this,w.parseHTML(i[1],t&&t.nodeType?t.ownerDocument||t:r,!0)),A.test(i[1])&&w.isPlainObject(t))for(i in t)g(this[i])?this[i](t[i]):this.attr(i,t[i]);return this}return(o=r.getElementById(i[2]))&&(this[0]=o,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):g(e)?void 0!==n.ready?n.ready(e):e(w):w.makeArray(e,this)}).prototype=w.fn,q=w(r);var H=/^(?:parents|prev(?:Until|All))/,O={children:!0,contents:!0,next:!0,prev:!0};w.fn.extend({has:function(e){var t=w(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(w.contains(this,t[e]))return!0})},closest:function(e,t){var n,r=0,i=this.length,o=[],a="string"!=typeof e&&w(e);if(!D.test(e))for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&w.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(o.length>1?w.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?u.call(w(e),this[0]):u.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(w.uniqueSort(w.merge(this.get(),w(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}});function P(e,t){while((e=e[t])&&1!==e.nodeType);return e}w.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return k(e,"parentNode")},parentsUntil:function(e,t,n){return k(e,"parentNode",n)},next:function(e){return P(e,"nextSibling")},prev:function(e){return P(e,"previousSibling")},nextAll:function(e){return k(e,"nextSibling")},prevAll:function(e){return k(e,"previousSibling")},nextUntil:function(e,t,n){return k(e,"nextSibling",n)},prevUntil:function(e,t,n){return k(e,"previousSibling",n)},siblings:function(e){return S((e.parentNode||{}).firstChild,e)},children:function(e){return S(e.firstChild)},contents:function(e){return N(e,"iframe")?e.contentDocument:(N(e,"template")&&(e=e.content||e),w.merge([],e.childNodes))}},function(e,t){w.fn[e]=function(n,r){var i=w.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=w.filter(r,i)),this.length>1&&(O[e]||w.uniqueSort(i),H.test(e)&&i.reverse()),this.pushStack(i)}});var M=/[^\x20\t\r\n\f]+/g;function R(e){var t={};return w.each(e.match(M)||[],function(e,n){t[n]=!0}),t}w.Callbacks=function(e){e="string"==typeof e?R(e):w.extend({},e);var t,n,r,i,o=[],a=[],s=-1,u=function(){for(i=i||e.once,r=t=!0;a.length;s=-1){n=a.shift();while(++s<o.length)!1===o[s].apply(n[0],n[1])&&e.stopOnFalse&&(s=o.length,n=!1)}e.memory||(n=!1),t=!1,i&&(o=n?[]:"")},l={add:function(){return o&&(n&&!t&&(s=o.length-1,a.push(n)),function t(n){w.each(n,function(n,r){g(r)?e.unique&&l.has(r)||o.push(r):r&&r.length&&"string"!==x(r)&&t(r)})}(arguments),n&&!t&&u()),this},remove:function(){return w.each(arguments,function(e,t){var n;while((n=w.inArray(t,o,n))>-1)o.splice(n,1),n<=s&&s--}),this},has:function(e){return e?w.inArray(e,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return i=a=[],o=n="",this},disabled:function(){return!o},lock:function(){return i=a=[],n||t||(o=n=""),this},locked:function(){return!!i},fireWith:function(e,n){return i||(n=[e,(n=n||[]).slice?n.slice():n],a.push(n),t||u()),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!r}};return l};function I(e){return e}function W(e){throw e}function $(e,t,n,r){var i;try{e&&g(i=e.promise)?i.call(e).done(t).fail(n):e&&g(i=e.then)?i.call(e,t,n):t.apply(void 0,[e].slice(r))}catch(e){n.apply(void 0,[e])}}w.extend({Deferred:function(t){var n=[["notify","progress",w.Callbacks("memory"),w.Callbacks("memory"),2],["resolve","done",w.Callbacks("once memory"),w.Callbacks("once memory"),0,"resolved"],["reject","fail",w.Callbacks("once memory"),w.Callbacks("once memory"),1,"rejected"]],r="pending",i={state:function(){return r},always:function(){return o.done(arguments).fail(arguments),this},"catch":function(e){return i.then(null,e)},pipe:function(){var e=arguments;return w.Deferred(function(t){w.each(n,function(n,r){var i=g(e[r[4]])&&e[r[4]];o[r[1]](function(){var e=i&&i.apply(this,arguments);e&&g(e.promise)?e.promise().progress(t.notify).done(t.resolve).fail(t.reject):t[r[0]+"With"](this,i?[e]:arguments)})}),e=null}).promise()},then:function(t,r,i){var o=0;function a(t,n,r,i){return function(){var s=this,u=arguments,l=function(){var e,l;if(!(t<o)){if((e=r.apply(s,u))===n.promise())throw new TypeError("Thenable self-resolution");l=e&&("object"==typeof e||"function"==typeof e)&&e.then,g(l)?i?l.call(e,a(o,n,I,i),a(o,n,W,i)):(o++,l.call(e,a(o,n,I,i),a(o,n,W,i),a(o,n,I,n.notifyWith))):(r!==I&&(s=void 0,u=[e]),(i||n.resolveWith)(s,u))}},c=i?l:function(){try{l()}catch(e){w.Deferred.exceptionHook&&w.Deferred.exceptionHook(e,c.stackTrace),t+1>=o&&(r!==W&&(s=void 0,u=[e]),n.rejectWith(s,u))}};t?c():(w.Deferred.getStackHook&&(c.stackTrace=w.Deferred.getStackHook()),e.setTimeout(c))}}return w.Deferred(function(e){n[0][3].add(a(0,e,g(i)?i:I,e.notifyWith)),n[1][3].add(a(0,e,g(t)?t:I)),n[2][3].add(a(0,e,g(r)?r:W))}).promise()},promise:function(e){return null!=e?w.extend(e,i):i}},o={};return w.each(n,function(e,t){var a=t[2],s=t[5];i[t[1]]=a.add,s&&a.add(function(){r=s},n[3-e][2].disable,n[3-e][3].disable,n[0][2].lock,n[0][3].lock),a.add(t[3].fire),o[t[0]]=function(){return o[t[0]+"With"](this===o?void 0:this,arguments),this},o[t[0]+"With"]=a.fireWith}),i.promise(o),t&&t.call(o,o),o},when:function(e){var t=arguments.length,n=t,r=Array(n),i=o.call(arguments),a=w.Deferred(),s=function(e){return function(n){r[e]=this,i[e]=arguments.length>1?o.call(arguments):n,--t||a.resolveWith(r,i)}};if(t<=1&&($(e,a.done(s(n)).resolve,a.reject,!t),"pending"===a.state()||g(i[n]&&i[n].then)))return a.then();while(n--)$(i[n],s(n),a.reject);return a.promise()}});var B=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;w.Deferred.exceptionHook=function(t,n){e.console&&e.console.warn&&t&&B.test(t.name)&&e.console.warn("jQuery.Deferred exception: "+t.message,t.stack,n)},w.readyException=function(t){e.setTimeout(function(){throw t})};var F=w.Deferred();w.fn.ready=function(e){return F.then(e)["catch"](function(e){w.readyException(e)}),this},w.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--w.readyWait:w.isReady)||(w.isReady=!0,!0!==e&&--w.readyWait>0||F.resolveWith(r,[w]))}}),w.ready.then=F.then;function _(){r.removeEventListener("DOMContentLoaded",_),e.removeEventListener("load",_),w.ready()}"complete"===r.readyState||"loading"!==r.readyState&&!r.documentElement.doScroll?e.setTimeout(w.ready):(r.addEventListener("DOMContentLoaded",_),e.addEventListener("load",_));var z=function(e,t,n,r,i,o,a){var s=0,u=e.length,l=null==n;if("object"===x(n)){i=!0;for(s in n)z(e,t,s,n[s],!0,o,a)}else if(void 0!==r&&(i=!0,g(r)||(a=!0),l&&(a?(t.call(e,r),t=null):(l=t,t=function(e,t,n){return l.call(w(e),n)})),t))for(;s<u;s++)t(e[s],n,a?r:r.call(e[s],s,t(e[s],n)));return i?e:l?t.call(e):u?t(e[0],n):o},X=/^-ms-/,U=/-([a-z])/g;function V(e,t){return t.toUpperCase()}function G(e){return e.replace(X,"ms-").replace(U,V)}var Y=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function Q(){this.expando=w.expando+Q.uid++}Q.uid=1,Q.prototype={cache:function(e){var t=e[this.expando];return t||(t={},Y(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,i=this.cache(e);if("string"==typeof t)i[G(t)]=n;else for(r in t)i[G(r)]=t[r];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][G(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){n=(t=Array.isArray(t)?t.map(G):(t=G(t))in r?[t]:t.match(M)||[]).length;while(n--)delete r[t[n]]}(void 0===t||w.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!w.isEmptyObject(t)}};var J=new Q,K=new Q,Z=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,ee=/[A-Z]/g;function te(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:Z.test(e)?JSON.parse(e):e)}function ne(e,t,n){var r;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(ee,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n=te(n)}catch(e){}K.set(e,t,n)}else n=void 0;return n}w.extend({hasData:function(e){return K.hasData(e)||J.hasData(e)},data:function(e,t,n){return K.access(e,t,n)},removeData:function(e,t){K.remove(e,t)},_data:function(e,t,n){return J.access(e,t,n)},_removeData:function(e,t){J.remove(e,t)}}),w.fn.extend({data:function(e,t){var n,r,i,o=this[0],a=o&&o.attributes;if(void 0===e){if(this.length&&(i=K.get(o),1===o.nodeType&&!J.get(o,"hasDataAttrs"))){n=a.length;while(n--)a[n]&&0===(r=a[n].name).indexOf("data-")&&(r=G(r.slice(5)),ne(o,r,i[r]));J.set(o,"hasDataAttrs",!0)}return i}return"object"==typeof e?this.each(function(){K.set(this,e)}):z(this,function(t){var n;if(o&&void 0===t){if(void 0!==(n=K.get(o,e)))return n;if(void 0!==(n=ne(o,e)))return n}else this.each(function(){K.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){K.remove(this,e)})}}),w.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=J.get(e,t),n&&(!r||Array.isArray(n)?r=J.access(e,t,w.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=w.queue(e,t),r=n.length,i=n.shift(),o=w._queueHooks(e,t),a=function(){w.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,a,o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return J.get(e,n)||J.access(e,n,{empty:w.Callbacks("once memory").add(function(){J.remove(e,[t+"queue",n])})})}}),w.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?w.queue(this[0],e):void 0===t?this:this.each(function(){var n=w.queue(this,e,t);w._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&w.dequeue(this,e)})},dequeue:function(e){return this.each(function(){w.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=w.Deferred(),o=this,a=this.length,s=function(){--r||i.resolveWith(o,[o])};"string"!=typeof e&&(t=e,e=void 0),e=e||"fx";while(a--)(n=J.get(o[a],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(s));return s(),i.promise(t)}});var re=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ie=new RegExp("^(?:([+-])=|)("+re+")([a-z%]*)$","i"),oe=["Top","Right","Bottom","Left"],ae=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&w.contains(e.ownerDocument,e)&&"none"===w.css(e,"display")},se=function(e,t,n,r){var i,o,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];i=n.apply(e,r||[]);for(o in t)e.style[o]=a[o];return i};function ue(e,t,n,r){var i,o,a=20,s=r?function(){return r.cur()}:function(){return w.css(e,t,"")},u=s(),l=n&&n[3]||(w.cssNumber[t]?"":"px"),c=(w.cssNumber[t]||"px"!==l&&+u)&&ie.exec(w.css(e,t));if(c&&c[3]!==l){u/=2,l=l||c[3],c=+u||1;while(a--)w.style(e,t,c+l),(1-o)*(1-(o=s()/u||.5))<=0&&(a=0),c/=o;c*=2,w.style(e,t,c+l),n=n||[]}return n&&(c=+c||+u||0,i=n[1]?c+(n[1]+1)*n[2]:+n[2],r&&(r.unit=l,r.start=c,r.end=i)),i}var le={};function ce(e){var t,n=e.ownerDocument,r=e.nodeName,i=le[r];return i||(t=n.body.appendChild(n.createElement(r)),i=w.css(t,"display"),t.parentNode.removeChild(t),"none"===i&&(i="block"),le[r]=i,i)}function fe(e,t){for(var n,r,i=[],o=0,a=e.length;o<a;o++)(r=e[o]).style&&(n=r.style.display,t?("none"===n&&(i[o]=J.get(r,"display")||null,i[o]||(r.style.display="")),""===r.style.display&&ae(r)&&(i[o]=ce(r))):"none"!==n&&(i[o]="none",J.set(r,"display",n)));for(o=0;o<a;o++)null!=i[o]&&(e[o].style.display=i[o]);return e}w.fn.extend({show:function(){return fe(this,!0)},hide:function(){return fe(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){ae(this)?w(this).show():w(this).hide()})}});var pe=/^(?:checkbox|radio)$/i,de=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,he=/^$|^module$|\/(?:java|ecma)script/i,ge={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ge.optgroup=ge.option,ge.tbody=ge.tfoot=ge.colgroup=ge.caption=ge.thead,ge.th=ge.td;function ye(e,t){var n;return n="undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t||"*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&N(e,t)?w.merge([e],n):n}function ve(e,t){for(var n=0,r=e.length;n<r;n++)J.set(e[n],"globalEval",!t||J.get(t[n],"globalEval"))}var me=/<|&#?\w+;/;function xe(e,t,n,r,i){for(var o,a,s,u,l,c,f=t.createDocumentFragment(),p=[],d=0,h=e.length;d<h;d++)if((o=e[d])||0===o)if("object"===x(o))w.merge(p,o.nodeType?[o]:o);else if(me.test(o)){a=a||f.appendChild(t.createElement("div")),s=(de.exec(o)||["",""])[1].toLowerCase(),u=ge[s]||ge._default,a.innerHTML=u[1]+w.htmlPrefilter(o)+u[2],c=u[0];while(c--)a=a.lastChild;w.merge(p,a.childNodes),(a=f.firstChild).textContent=""}else p.push(t.createTextNode(o));f.textContent="",d=0;while(o=p[d++])if(r&&w.inArray(o,r)>-1)i&&i.push(o);else if(l=w.contains(o.ownerDocument,o),a=ye(f.appendChild(o),"script"),l&&ve(a),n){c=0;while(o=a[c++])he.test(o.type||"")&&n.push(o)}return f}!function(){var e=r.createDocumentFragment().appendChild(r.createElement("div")),t=r.createElement("input");t.setAttribute("type","radio"),t.setAttribute("checked","checked"),t.setAttribute("name","t"),e.appendChild(t),h.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",h.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue}();var be=r.documentElement,we=/^key/,Te=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Ce=/^([^.]*)(?:\.(.+)|)/;function Ee(){return!0}function ke(){return!1}function Se(){try{return r.activeElement}catch(e){}}function De(e,t,n,r,i,o){var a,s;if("object"==typeof t){"string"!=typeof n&&(r=r||n,n=void 0);for(s in t)De(e,s,n,r,t[s],o);return e}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=ke;else if(!i)return e;return 1===o&&(a=i,(i=function(e){return w().off(e),a.apply(this,arguments)}).guid=a.guid||(a.guid=w.guid++)),e.each(function(){w.event.add(this,t,i,r,n)})}w.event={global:{},add:function(e,t,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,y=J.get(e);if(y){n.handler&&(n=(o=n).handler,i=o.selector),i&&w.find.matchesSelector(be,i),n.guid||(n.guid=w.guid++),(u=y.events)||(u=y.events={}),(a=y.handle)||(a=y.handle=function(t){return"undefined"!=typeof w&&w.event.triggered!==t.type?w.event.dispatch.apply(e,arguments):void 0}),l=(t=(t||"").match(M)||[""]).length;while(l--)d=g=(s=Ce.exec(t[l])||[])[1],h=(s[2]||"").split(".").sort(),d&&(f=w.event.special[d]||{},d=(i?f.delegateType:f.bindType)||d,f=w.event.special[d]||{},c=w.extend({type:d,origType:g,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&w.expr.match.needsContext.test(i),namespace:h.join(".")},o),(p=u[d])||((p=u[d]=[]).delegateCount=0,f.setup&&!1!==f.setup.call(e,r,h,a)||e.addEventListener&&e.addEventListener(d,a)),f.add&&(f.add.call(e,c),c.handler.guid||(c.handler.guid=n.guid)),i?p.splice(p.delegateCount++,0,c):p.push(c),w.event.global[d]=!0)}},remove:function(e,t,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,y=J.hasData(e)&&J.get(e);if(y&&(u=y.events)){l=(t=(t||"").match(M)||[""]).length;while(l--)if(s=Ce.exec(t[l])||[],d=g=s[1],h=(s[2]||"").split(".").sort(),d){f=w.event.special[d]||{},p=u[d=(r?f.delegateType:f.bindType)||d]||[],s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=p.length;while(o--)c=p[o],!i&&g!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(p.splice(o,1),c.selector&&p.delegateCount--,f.remove&&f.remove.call(e,c));a&&!p.length&&(f.teardown&&!1!==f.teardown.call(e,h,y.handle)||w.removeEvent(e,d,y.handle),delete u[d])}else for(d in u)w.event.remove(e,d+t[l],n,r,!0);w.isEmptyObject(u)&&J.remove(e,"handle events")}},dispatch:function(e){var t=w.event.fix(e),n,r,i,o,a,s,u=new Array(arguments.length),l=(J.get(this,"events")||{})[t.type]||[],c=w.event.special[t.type]||{};for(u[0]=t,n=1;n<arguments.length;n++)u[n]=arguments[n];if(t.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,t)){s=w.event.handlers.call(this,t,l),n=0;while((o=s[n++])&&!t.isPropagationStopped()){t.currentTarget=o.elem,r=0;while((a=o.handlers[r++])&&!t.isImmediatePropagationStopped())t.rnamespace&&!t.rnamespace.test(a.namespace)||(t.handleObj=a,t.data=a.data,void 0!==(i=((w.event.special[a.origType]||{}).handle||a.handler).apply(o.elem,u))&&!1===(t.result=i)&&(t.preventDefault(),t.stopPropagation()))}return c.postDispatch&&c.postDispatch.call(this,t),t.result}},handlers:function(e,t){var n,r,i,o,a,s=[],u=t.delegateCount,l=e.target;if(u&&l.nodeType&&!("click"===e.type&&e.button>=1))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==e.type||!0!==l.disabled)){for(o=[],a={},n=0;n<u;n++)void 0===a[i=(r=t[n]).selector+" "]&&(a[i]=r.needsContext?w(i,this).index(l)>-1:w.find(i,this,null,[l]).length),a[i]&&o.push(r);o.length&&s.push({elem:l,handlers:o})}return l=this,u<t.length&&s.push({elem:l,handlers:t.slice(u)}),s},addProp:function(e,t){Object.defineProperty(w.Event.prototype,e,{enumerable:!0,configurable:!0,get:g(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[w.expando]?e:new w.Event(e)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==Se()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===Se()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&N(this,"input"))return this.click(),!1},_default:function(e){return N(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},w.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},w.Event=function(e,t){if(!(this instanceof w.Event))return new w.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?Ee:ke,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&w.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[w.expando]=!0},w.Event.prototype={constructor:w.Event,isDefaultPrevented:ke,isPropagationStopped:ke,isImmediatePropagationStopped:ke,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=Ee,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=Ee,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=Ee,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},w.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,"char":!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(e){var t=e.button;return null==e.which&&we.test(e.type)?null!=e.charCode?e.charCode:e.keyCode:!e.which&&void 0!==t&&Te.test(e.type)?1&t?1:2&t?3:4&t?2:0:e.which}},w.event.addProp),w.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){w.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,o=e.handleObj;return i&&(i===r||w.contains(r,i))||(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),w.fn.extend({on:function(e,t,n,r){return De(this,e,t,n,r)},one:function(e,t,n,r){return De(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,w(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=ke),this.each(function(){w.event.remove(this,e,n,t)})}});var Ne=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,Ae=/<script|<style|<link/i,je=/checked\s*(?:[^=]|=\s*.checked.)/i,qe=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Le(e,t){return N(e,"table")&&N(11!==t.nodeType?t:t.firstChild,"tr")?w(e).children("tbody")[0]||e:e}function He(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function Oe(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Pe(e,t){var n,r,i,o,a,s,u,l;if(1===t.nodeType){if(J.hasData(e)&&(o=J.access(e),a=J.set(t,o),l=o.events)){delete a.handle,a.events={};for(i in l)for(n=0,r=l[i].length;n<r;n++)w.event.add(t,i,l[i][n])}K.hasData(e)&&(s=K.access(e),u=w.extend({},s),K.set(t,u))}}function Me(e,t){var n=t.nodeName.toLowerCase();"input"===n&&pe.test(e.type)?t.checked=e.checked:"input"!==n&&"textarea"!==n||(t.defaultValue=e.defaultValue)}function Re(e,t,n,r){t=a.apply([],t);var i,o,s,u,l,c,f=0,p=e.length,d=p-1,y=t[0],v=g(y);if(v||p>1&&"string"==typeof y&&!h.checkClone&&je.test(y))return e.each(function(i){var o=e.eq(i);v&&(t[0]=y.call(this,i,o.html())),Re(o,t,n,r)});if(p&&(i=xe(t,e[0].ownerDocument,!1,e,r),o=i.firstChild,1===i.childNodes.length&&(i=o),o||r)){for(u=(s=w.map(ye(i,"script"),He)).length;f<p;f++)l=i,f!==d&&(l=w.clone(l,!0,!0),u&&w.merge(s,ye(l,"script"))),n.call(e[f],l,f);if(u)for(c=s[s.length-1].ownerDocument,w.map(s,Oe),f=0;f<u;f++)l=s[f],he.test(l.type||"")&&!J.access(l,"globalEval")&&w.contains(c,l)&&(l.src&&"module"!==(l.type||"").toLowerCase()?w._evalUrl&&w._evalUrl(l.src):m(l.textContent.replace(qe,""),c,l))}return e}function Ie(e,t,n){for(var r,i=t?w.filter(t,e):e,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||w.cleanData(ye(r)),r.parentNode&&(n&&w.contains(r.ownerDocument,r)&&ve(ye(r,"script")),r.parentNode.removeChild(r));return e}w.extend({htmlPrefilter:function(e){return e.replace(Ne,"<$1></$2>")},clone:function(e,t,n){var r,i,o,a,s=e.cloneNode(!0),u=w.contains(e.ownerDocument,e);if(!(h.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||w.isXMLDoc(e)))for(a=ye(s),r=0,i=(o=ye(e)).length;r<i;r++)Me(o[r],a[r]);if(t)if(n)for(o=o||ye(e),a=a||ye(s),r=0,i=o.length;r<i;r++)Pe(o[r],a[r]);else Pe(e,s);return(a=ye(s,"script")).length>0&&ve(a,!u&&ye(e,"script")),s},cleanData:function(e){for(var t,n,r,i=w.event.special,o=0;void 0!==(n=e[o]);o++)if(Y(n)){if(t=n[J.expando]){if(t.events)for(r in t.events)i[r]?w.event.remove(n,r):w.removeEvent(n,r,t.handle);n[J.expando]=void 0}n[K.expando]&&(n[K.expando]=void 0)}}}),w.fn.extend({detach:function(e){return Ie(this,e,!0)},remove:function(e){return Ie(this,e)},text:function(e){return z(this,function(e){return void 0===e?w.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return Re(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Le(this,e).appendChild(e)})},prepend:function(){return Re(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Le(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return Re(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return Re(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(w.cleanData(ye(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return w.clone(this,e,t)})},html:function(e){return z(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Ae.test(e)&&!ge[(de.exec(e)||["",""])[1].toLowerCase()]){e=w.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(w.cleanData(ye(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=[];return Re(this,arguments,function(t){var n=this.parentNode;w.inArray(this,e)<0&&(w.cleanData(ye(this)),n&&n.replaceChild(t,this))},e)}}),w.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){w.fn[e]=function(e){for(var n,r=[],i=w(e),o=i.length-1,a=0;a<=o;a++)n=a===o?this:this.clone(!0),w(i[a])[t](n),s.apply(r,n.get());return this.pushStack(r)}});var We=new RegExp("^("+re+")(?!px)[a-z%]+$","i"),$e=function(t){var n=t.ownerDocument.defaultView;return n&&n.opener||(n=e),n.getComputedStyle(t)},Be=new RegExp(oe.join("|"),"i");!function(){function t(){if(c){l.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",c.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",be.appendChild(l).appendChild(c);var t=e.getComputedStyle(c);i="1%"!==t.top,u=12===n(t.marginLeft),c.style.right="60%",s=36===n(t.right),o=36===n(t.width),c.style.position="absolute",a=36===c.offsetWidth||"absolute",be.removeChild(l),c=null}}function n(e){return Math.round(parseFloat(e))}var i,o,a,s,u,l=r.createElement("div"),c=r.createElement("div");c.style&&(c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",h.clearCloneStyle="content-box"===c.style.backgroundClip,w.extend(h,{boxSizingReliable:function(){return t(),o},pixelBoxStyles:function(){return t(),s},pixelPosition:function(){return t(),i},reliableMarginLeft:function(){return t(),u},scrollboxSize:function(){return t(),a}}))}();function Fe(e,t,n){var r,i,o,a,s=e.style;return(n=n||$e(e))&&(""!==(a=n.getPropertyValue(t)||n[t])||w.contains(e.ownerDocument,e)||(a=w.style(e,t)),!h.pixelBoxStyles()&&We.test(a)&&Be.test(t)&&(r=s.width,i=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=r,s.minWidth=i,s.maxWidth=o)),void 0!==a?a+"":a}function _e(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}var ze=/^(none|table(?!-c[ea]).+)/,Xe=/^--/,Ue={position:"absolute",visibility:"hidden",display:"block"},Ve={letterSpacing:"0",fontWeight:"400"},Ge=["Webkit","Moz","ms"],Ye=r.createElement("div").style;function Qe(e){if(e in Ye)return e;var t=e[0].toUpperCase()+e.slice(1),n=Ge.length;while(n--)if((e=Ge[n]+t)in Ye)return e}function Je(e){var t=w.cssProps[e];return t||(t=w.cssProps[e]=Qe(e)||e),t}function Ke(e,t,n){var r=ie.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function Ze(e,t,n,r,i,o){var a="width"===t?1:0,s=0,u=0;if(n===(r?"border":"content"))return 0;for(;a<4;a+=2)"margin"===n&&(u+=w.css(e,n+oe[a],!0,i)),r?("content"===n&&(u-=w.css(e,"padding"+oe[a],!0,i)),"margin"!==n&&(u-=w.css(e,"border"+oe[a]+"Width",!0,i))):(u+=w.css(e,"padding"+oe[a],!0,i),"padding"!==n?u+=w.css(e,"border"+oe[a]+"Width",!0,i):s+=w.css(e,"border"+oe[a]+"Width",!0,i));return!r&&o>=0&&(u+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-u-s-.5))),u}function et(e,t,n){var r=$e(e),i=Fe(e,t,r),o="border-box"===w.css(e,"boxSizing",!1,r),a=o;if(We.test(i)){if(!n)return i;i="auto"}return a=a&&(h.boxSizingReliable()||i===e.style[t]),("auto"===i||!parseFloat(i)&&"inline"===w.css(e,"display",!1,r))&&(i=e["offset"+t[0].toUpperCase()+t.slice(1)],a=!0),(i=parseFloat(i)||0)+Ze(e,t,n||(o?"border":"content"),a,r,i)+"px"}w.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Fe(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,a,s=G(t),u=Xe.test(t),l=e.style;if(u||(t=Je(s)),a=w.cssHooks[t]||w.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(i=a.get(e,!1,r))?i:l[t];"string"==(o=typeof n)&&(i=ie.exec(n))&&i[1]&&(n=ue(e,t,i),o="number"),null!=n&&n===n&&("number"===o&&(n+=i&&i[3]||(w.cssNumber[s]?"":"px")),h.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),a&&"set"in a&&void 0===(n=a.set(e,n,r))||(u?l.setProperty(t,n):l[t]=n))}},css:function(e,t,n,r){var i,o,a,s=G(t);return Xe.test(t)||(t=Je(s)),(a=w.cssHooks[t]||w.cssHooks[s])&&"get"in a&&(i=a.get(e,!0,n)),void 0===i&&(i=Fe(e,t,r)),"normal"===i&&t in Ve&&(i=Ve[t]),""===n||n?(o=parseFloat(i),!0===n||isFinite(o)?o||0:i):i}}),w.each(["height","width"],function(e,t){w.cssHooks[t]={get:function(e,n,r){if(n)return!ze.test(w.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?et(e,t,r):se(e,Ue,function(){return et(e,t,r)})},set:function(e,n,r){var i,o=$e(e),a="border-box"===w.css(e,"boxSizing",!1,o),s=r&&Ze(e,t,r,a,o);return a&&h.scrollboxSize()===o.position&&(s-=Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(o[t])-Ze(e,t,"border",!1,o)-.5)),s&&(i=ie.exec(n))&&"px"!==(i[3]||"px")&&(e.style[t]=n,n=w.css(e,t)),Ke(e,n,s)}}}),w.cssHooks.marginLeft=_e(h.reliableMarginLeft,function(e,t){if(t)return(parseFloat(Fe(e,"marginLeft"))||e.getBoundingClientRect().left-se(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),w.each({margin:"",padding:"",border:"Width"},function(e,t){w.cssHooks[e+t]={expand:function(n){for(var r=0,i={},o="string"==typeof n?n.split(" "):[n];r<4;r++)i[e+oe[r]+t]=o[r]||o[r-2]||o[0];return i}},"margin"!==e&&(w.cssHooks[e+t].set=Ke)}),w.fn.extend({css:function(e,t){return z(this,function(e,t,n){var r,i,o={},a=0;if(Array.isArray(t)){for(r=$e(e),i=t.length;a<i;a++)o[t[a]]=w.css(e,t[a],!1,r);return o}return void 0!==n?w.style(e,t,n):w.css(e,t)},e,t,arguments.length>1)}});function tt(e,t,n,r,i){return new tt.prototype.init(e,t,n,r,i)}w.Tween=tt,tt.prototype={constructor:tt,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||w.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(w.cssNumber[n]?"":"px")},cur:function(){var e=tt.propHooks[this.prop];return e&&e.get?e.get(this):tt.propHooks._default.get(this)},run:function(e){var t,n=tt.propHooks[this.prop];return this.options.duration?this.pos=t=w.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):tt.propHooks._default.set(this),this}},tt.prototype.init.prototype=tt.prototype,tt.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=w.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){w.fx.step[e.prop]?w.fx.step[e.prop](e):1!==e.elem.nodeType||null==e.elem.style[w.cssProps[e.prop]]&&!w.cssHooks[e.prop]?e.elem[e.prop]=e.now:w.style(e.elem,e.prop,e.now+e.unit)}}},tt.propHooks.scrollTop=tt.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},w.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},w.fx=tt.prototype.init,w.fx.step={};var nt,rt,it=/^(?:toggle|show|hide)$/,ot=/queueHooks$/;function at(){rt&&(!1===r.hidden&&e.requestAnimationFrame?e.requestAnimationFrame(at):e.setTimeout(at,w.fx.interval),w.fx.tick())}function st(){return e.setTimeout(function(){nt=void 0}),nt=Date.now()}function ut(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=oe[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function lt(e,t,n){for(var r,i=(pt.tweeners[t]||[]).concat(pt.tweeners["*"]),o=0,a=i.length;o<a;o++)if(r=i[o].call(n,t,e))return r}function ct(e,t,n){var r,i,o,a,s,u,l,c,f="width"in t||"height"in t,p=this,d={},h=e.style,g=e.nodeType&&ae(e),y=J.get(e,"fxshow");n.queue||(null==(a=w._queueHooks(e,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,p.always(function(){p.always(function(){a.unqueued--,w.queue(e,"fx").length||a.empty.fire()})}));for(r in t)if(i=t[r],it.test(i)){if(delete t[r],o=o||"toggle"===i,i===(g?"hide":"show")){if("show"!==i||!y||void 0===y[r])continue;g=!0}d[r]=y&&y[r]||w.style(e,r)}if((u=!w.isEmptyObject(t))||!w.isEmptyObject(d)){f&&1===e.nodeType&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],null==(l=y&&y.display)&&(l=J.get(e,"display")),"none"===(c=w.css(e,"display"))&&(l?c=l:(fe([e],!0),l=e.style.display||l,c=w.css(e,"display"),fe([e]))),("inline"===c||"inline-block"===c&&null!=l)&&"none"===w.css(e,"float")&&(u||(p.done(function(){h.display=l}),null==l&&(c=h.display,l="none"===c?"":c)),h.display="inline-block")),n.overflow&&(h.overflow="hidden",p.always(function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]})),u=!1;for(r in d)u||(y?"hidden"in y&&(g=y.hidden):y=J.access(e,"fxshow",{display:l}),o&&(y.hidden=!g),g&&fe([e],!0),p.done(function(){g||fe([e]),J.remove(e,"fxshow");for(r in d)w.style(e,r,d[r])})),u=lt(g?y[r]:0,r,p),r in y||(y[r]=u.start,g&&(u.end=u.start,u.start=0))}}function ft(e,t){var n,r,i,o,a;for(n in e)if(r=G(n),i=t[r],o=e[n],Array.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),(a=w.cssHooks[r])&&"expand"in a){o=a.expand(o),delete e[r];for(n in o)n in e||(e[n]=o[n],t[n]=i)}else t[r]=i}function pt(e,t,n){var r,i,o=0,a=pt.prefilters.length,s=w.Deferred().always(function(){delete u.elem}),u=function(){if(i)return!1;for(var t=nt||st(),n=Math.max(0,l.startTime+l.duration-t),r=1-(n/l.duration||0),o=0,a=l.tweens.length;o<a;o++)l.tweens[o].run(r);return s.notifyWith(e,[l,r,n]),r<1&&a?n:(a||s.notifyWith(e,[l,1,0]),s.resolveWith(e,[l]),!1)},l=s.promise({elem:e,props:w.extend({},t),opts:w.extend(!0,{specialEasing:{},easing:w.easing._default},n),originalProperties:t,originalOptions:n,startTime:nt||st(),duration:n.duration,tweens:[],createTween:function(t,n){var r=w.Tween(e,l.opts,t,n,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(r),r},stop:function(t){var n=0,r=t?l.tweens.length:0;if(i)return this;for(i=!0;n<r;n++)l.tweens[n].run(1);return t?(s.notifyWith(e,[l,1,0]),s.resolveWith(e,[l,t])):s.rejectWith(e,[l,t]),this}}),c=l.props;for(ft(c,l.opts.specialEasing);o<a;o++)if(r=pt.prefilters[o].call(l,e,c,l.opts))return g(r.stop)&&(w._queueHooks(l.elem,l.opts.queue).stop=r.stop.bind(r)),r;return w.map(c,lt,l),g(l.opts.start)&&l.opts.start.call(e,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),w.fx.timer(w.extend(u,{elem:e,anim:l,queue:l.opts.queue})),l}w.Animation=w.extend(pt,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return ue(n.elem,e,ie.exec(t),n),n}]},tweener:function(e,t){g(e)?(t=e,e=["*"]):e=e.match(M);for(var n,r=0,i=e.length;r<i;r++)n=e[r],pt.tweeners[n]=pt.tweeners[n]||[],pt.tweeners[n].unshift(t)},prefilters:[ct],prefilter:function(e,t){t?pt.prefilters.unshift(e):pt.prefilters.push(e)}}),w.speed=function(e,t,n){var r=e&&"object"==typeof e?w.extend({},e):{complete:n||!n&&t||g(e)&&e,duration:e,easing:n&&t||t&&!g(t)&&t};return w.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in w.fx.speeds?r.duration=w.fx.speeds[r.duration]:r.duration=w.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){g(r.old)&&r.old.call(this),r.queue&&w.dequeue(this,r.queue)},r},w.fn.extend({fadeTo:function(e,t,n,r){return this.filter(ae).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=w.isEmptyObject(e),o=w.speed(t,n,r),a=function(){var t=pt(this,w.extend({},e),o);(i||J.get(this,"finish"))&&t.stop(!0)};return a.finish=a,i||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&!1!==e&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",o=w.timers,a=J.get(this);if(i)a[i]&&a[i].stop&&r(a[i]);else for(i in a)a[i]&&a[i].stop&&ot.test(i)&&r(a[i]);for(i=o.length;i--;)o[i].elem!==this||null!=e&&o[i].queue!==e||(o[i].anim.stop(n),t=!1,o.splice(i,1));!t&&n||w.dequeue(this,e)})},finish:function(e){return!1!==e&&(e=e||"fx"),this.each(function(){var t,n=J.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],o=w.timers,a=r?r.length:0;for(n.finish=!0,w.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;t<a;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),w.each(["toggle","show","hide"],function(e,t){var n=w.fn[t];w.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(ut(t,!0),e,r,i)}}),w.each({slideDown:ut("show"),slideUp:ut("hide"),slideToggle:ut("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){w.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),w.timers=[],w.fx.tick=function(){var e,t=0,n=w.timers;for(nt=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||w.fx.stop(),nt=void 0},w.fx.timer=function(e){w.timers.push(e),w.fx.start()},w.fx.interval=13,w.fx.start=function(){rt||(rt=!0,at())},w.fx.stop=function(){rt=null},w.fx.speeds={slow:600,fast:200,_default:400},w.fn.delay=function(t,n){return t=w.fx?w.fx.speeds[t]||t:t,n=n||"fx",this.queue(n,function(n,r){var i=e.setTimeout(n,t);r.stop=function(){e.clearTimeout(i)}})},function(){var e=r.createElement("input"),t=r.createElement("select").appendChild(r.createElement("option"));e.type="checkbox",h.checkOn=""!==e.value,h.optSelected=t.selected,(e=r.createElement("input")).value="t",e.type="radio",h.radioValue="t"===e.value}();var dt,ht=w.expr.attrHandle;w.fn.extend({attr:function(e,t){return z(this,w.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){w.removeAttr(this,e)})}}),w.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return"undefined"==typeof e.getAttribute?w.prop(e,t,n):(1===o&&w.isXMLDoc(e)||(i=w.attrHooks[t.toLowerCase()]||(w.expr.match.bool.test(t)?dt:void 0)),void 0!==n?null===n?void w.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):i&&"get"in i&&null!==(r=i.get(e,t))?r:null==(r=w.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!h.radioValue&&"radio"===t&&N(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r=0,i=t&&t.match(M);if(i&&1===e.nodeType)while(n=i[r++])e.removeAttribute(n)}}),dt={set:function(e,t,n){return!1===t?w.removeAttr(e,n):e.setAttribute(n,n),n}},w.each(w.expr.match.bool.source.match(/\w+/g),function(e,t){var n=ht[t]||w.find.attr;ht[t]=function(e,t,r){var i,o,a=t.toLowerCase();return r||(o=ht[a],ht[a]=i,i=null!=n(e,t,r)?a:null,ht[a]=o),i}});var gt=/^(?:input|select|textarea|button)$/i,yt=/^(?:a|area)$/i;w.fn.extend({prop:function(e,t){return z(this,w.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[w.propFix[e]||e]})}}),w.extend({prop:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&w.isXMLDoc(e)||(t=w.propFix[t]||t,i=w.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=w.find.attr(e,"tabindex");return t?parseInt(t,10):gt.test(e.nodeName)||yt.test(e.nodeName)&&e.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),h.optSelected||(w.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),w.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){w.propFix[this.toLowerCase()]=this});function vt(e){return(e.match(M)||[]).join(" ")}function mt(e){return e.getAttribute&&e.getAttribute("class")||""}function xt(e){return Array.isArray(e)?e:"string"==typeof e?e.match(M)||[]:[]}w.fn.extend({addClass:function(e){var t,n,r,i,o,a,s,u=0;if(g(e))return this.each(function(t){w(this).addClass(e.call(this,t,mt(this)))});if((t=xt(e)).length)while(n=this[u++])if(i=mt(n),r=1===n.nodeType&&" "+vt(i)+" "){a=0;while(o=t[a++])r.indexOf(" "+o+" ")<0&&(r+=o+" ");i!==(s=vt(r))&&n.setAttribute("class",s)}return this},removeClass:function(e){var t,n,r,i,o,a,s,u=0;if(g(e))return this.each(function(t){w(this).removeClass(e.call(this,t,mt(this)))});if(!arguments.length)return this.attr("class","");if((t=xt(e)).length)while(n=this[u++])if(i=mt(n),r=1===n.nodeType&&" "+vt(i)+" "){a=0;while(o=t[a++])while(r.indexOf(" "+o+" ")>-1)r=r.replace(" "+o+" "," ");i!==(s=vt(r))&&n.setAttribute("class",s)}return this},toggleClass:function(e,t){var n=typeof e,r="string"===n||Array.isArray(e);return"boolean"==typeof t&&r?t?this.addClass(e):this.removeClass(e):g(e)?this.each(function(n){w(this).toggleClass(e.call(this,n,mt(this),t),t)}):this.each(function(){var t,i,o,a;if(r){i=0,o=w(this),a=xt(e);while(t=a[i++])o.hasClass(t)?o.removeClass(t):o.addClass(t)}else void 0!==e&&"boolean"!==n||((t=mt(this))&&J.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||!1===e?"":J.get(this,"__className__")||""))})},hasClass:function(e){var t,n,r=0;t=" "+e+" ";while(n=this[r++])if(1===n.nodeType&&(" "+vt(mt(n))+" ").indexOf(t)>-1)return!0;return!1}});var bt=/\r/g;w.fn.extend({val:function(e){var t,n,r,i=this[0];{if(arguments.length)return r=g(e),this.each(function(n){var i;1===this.nodeType&&(null==(i=r?e.call(this,n,w(this).val()):e)?i="":"number"==typeof i?i+="":Array.isArray(i)&&(i=w.map(i,function(e){return null==e?"":e+""})),(t=w.valHooks[this.type]||w.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,i,"value")||(this.value=i))});if(i)return(t=w.valHooks[i.type]||w.valHooks[i.nodeName.toLowerCase()])&&"get"in t&&void 0!==(n=t.get(i,"value"))?n:"string"==typeof(n=i.value)?n.replace(bt,""):null==n?"":n}}}),w.extend({valHooks:{option:{get:function(e){var t=w.find.attr(e,"value");return null!=t?t:vt(w.text(e))}},select:{get:function(e){var t,n,r,i=e.options,o=e.selectedIndex,a="select-one"===e.type,s=a?null:[],u=a?o+1:i.length;for(r=o<0?u:a?o:0;r<u;r++)if(((n=i[r]).selected||r===o)&&!n.disabled&&(!n.parentNode.disabled||!N(n.parentNode,"optgroup"))){if(t=w(n).val(),a)return t;s.push(t)}return s},set:function(e,t){var n,r,i=e.options,o=w.makeArray(t),a=i.length;while(a--)((r=i[a]).selected=w.inArray(w.valHooks.option.get(r),o)>-1)&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),w.each(["radio","checkbox"],function(){w.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=w.inArray(w(e).val(),t)>-1}},h.checkOn||(w.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),h.focusin="onfocusin"in e;var wt=/^(?:focusinfocus|focusoutblur)$/,Tt=function(e){e.stopPropagation()};w.extend(w.event,{trigger:function(t,n,i,o){var a,s,u,l,c,p,d,h,v=[i||r],m=f.call(t,"type")?t.type:t,x=f.call(t,"namespace")?t.namespace.split("."):[];if(s=h=u=i=i||r,3!==i.nodeType&&8!==i.nodeType&&!wt.test(m+w.event.triggered)&&(m.indexOf(".")>-1&&(m=(x=m.split(".")).shift(),x.sort()),c=m.indexOf(":")<0&&"on"+m,t=t[w.expando]?t:new w.Event(m,"object"==typeof t&&t),t.isTrigger=o?2:3,t.namespace=x.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+x.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),n=null==n?[t]:w.makeArray(n,[t]),d=w.event.special[m]||{},o||!d.trigger||!1!==d.trigger.apply(i,n))){if(!o&&!d.noBubble&&!y(i)){for(l=d.delegateType||m,wt.test(l+m)||(s=s.parentNode);s;s=s.parentNode)v.push(s),u=s;u===(i.ownerDocument||r)&&v.push(u.defaultView||u.parentWindow||e)}a=0;while((s=v[a++])&&!t.isPropagationStopped())h=s,t.type=a>1?l:d.bindType||m,(p=(J.get(s,"events")||{})[t.type]&&J.get(s,"handle"))&&p.apply(s,n),(p=c&&s[c])&&p.apply&&Y(s)&&(t.result=p.apply(s,n),!1===t.result&&t.preventDefault());return t.type=m,o||t.isDefaultPrevented()||d._default&&!1!==d._default.apply(v.pop(),n)||!Y(i)||c&&g(i[m])&&!y(i)&&((u=i[c])&&(i[c]=null),w.event.triggered=m,t.isPropagationStopped()&&h.addEventListener(m,Tt),i[m](),t.isPropagationStopped()&&h.removeEventListener(m,Tt),w.event.triggered=void 0,u&&(i[c]=u)),t.result}},simulate:function(e,t,n){var r=w.extend(new w.Event,n,{type:e,isSimulated:!0});w.event.trigger(r,null,t)}}),w.fn.extend({trigger:function(e,t){return this.each(function(){w.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return w.event.trigger(e,t,n,!0)}}),h.focusin||w.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){w.event.simulate(t,e.target,w.event.fix(e))};w.event.special[t]={setup:function(){var r=this.ownerDocument||this,i=J.access(r,t);i||r.addEventListener(e,n,!0),J.access(r,t,(i||0)+1)},teardown:function(){var r=this.ownerDocument||this,i=J.access(r,t)-1;i?J.access(r,t,i):(r.removeEventListener(e,n,!0),J.remove(r,t))}}});var Ct=e.location,Et=Date.now(),kt=/\?/;w.parseXML=function(t){var n;if(!t||"string"!=typeof t)return null;try{n=(new e.DOMParser).parseFromString(t,"text/xml")}catch(e){n=void 0}return n&&!n.getElementsByTagName("parsererror").length||w.error("Invalid XML: "+t),n};var St=/\[\]$/,Dt=/\r?\n/g,Nt=/^(?:submit|button|image|reset|file)$/i,At=/^(?:input|select|textarea|keygen)/i;function jt(e,t,n,r){var i;if(Array.isArray(t))w.each(t,function(t,i){n||St.test(e)?r(e,i):jt(e+"["+("object"==typeof i&&null!=i?t:"")+"]",i,n,r)});else if(n||"object"!==x(t))r(e,t);else for(i in t)jt(e+"["+i+"]",t[i],n,r)}w.param=function(e,t){var n,r=[],i=function(e,t){var n=g(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(Array.isArray(e)||e.jquery&&!w.isPlainObject(e))w.each(e,function(){i(this.name,this.value)});else for(n in e)jt(n,e[n],t,i);return r.join("&")},w.fn.extend({serialize:function(){return w.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=w.prop(this,"elements");return e?w.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!w(this).is(":disabled")&&At.test(this.nodeName)&&!Nt.test(e)&&(this.checked||!pe.test(e))}).map(function(e,t){var n=w(this).val();return null==n?null:Array.isArray(n)?w.map(n,function(e){return{name:t.name,value:e.replace(Dt,"\r\n")}}):{name:t.name,value:n.replace(Dt,"\r\n")}}).get()}});var qt=/%20/g,Lt=/#.*$/,Ht=/([?&])_=[^&]*/,Ot=/^(.*?):[ \t]*([^\r\n]*)$/gm,Pt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Mt=/^(?:GET|HEAD)$/,Rt=/^\/\//,It={},Wt={},$t="*/".concat("*"),Bt=r.createElement("a");Bt.href=Ct.href;function Ft(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,o=t.toLowerCase().match(M)||[];if(g(n))while(r=o[i++])"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function _t(e,t,n,r){var i={},o=e===Wt;function a(s){var u;return i[s]=!0,w.each(e[s]||[],function(e,s){var l=s(t,n,r);return"string"!=typeof l||o||i[l]?o?!(u=l):void 0:(t.dataTypes.unshift(l),a(l),!1)}),u}return a(t.dataTypes[0])||!i["*"]&&a("*")}function zt(e,t){var n,r,i=w.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&w.extend(!0,e,r),e}function Xt(e,t,n){var r,i,o,a,s=e.contents,u=e.dataTypes;while("*"===u[0])u.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in s)if(s[i]&&s[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||e.converters[i+" "+u[0]]){o=i;break}a||(a=i)}o=o||a}if(o)return o!==u[0]&&u.unshift(o),n[o]}function Ut(e,t,n,r){var i,o,a,s,u,l={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)l[a.toLowerCase()]=e.converters[a];o=c.shift();while(o)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(a=l[u+" "+o]||l["* "+o]))for(i in l)if((s=i.split(" "))[1]===o&&(a=l[u+" "+s[0]]||l["* "+s[0]])){!0===a?a=l[i]:!0!==l[i]&&(o=s[0],c.unshift(s[1]));break}if(!0!==a)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}w.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ct.href,type:"GET",isLocal:Pt.test(Ct.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":$t,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":w.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?zt(zt(e,w.ajaxSettings),t):zt(w.ajaxSettings,e)},ajaxPrefilter:Ft(It),ajaxTransport:Ft(Wt),ajax:function(t,n){"object"==typeof t&&(n=t,t=void 0),n=n||{};var i,o,a,s,u,l,c,f,p,d,h=w.ajaxSetup({},n),g=h.context||h,y=h.context&&(g.nodeType||g.jquery)?w(g):w.event,v=w.Deferred(),m=w.Callbacks("once memory"),x=h.statusCode||{},b={},T={},C="canceled",E={readyState:0,getResponseHeader:function(e){var t;if(c){if(!s){s={};while(t=Ot.exec(a))s[t[1].toLowerCase()]=t[2]}t=s[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return c?a:null},setRequestHeader:function(e,t){return null==c&&(e=T[e.toLowerCase()]=T[e.toLowerCase()]||e,b[e]=t),this},overrideMimeType:function(e){return null==c&&(h.mimeType=e),this},statusCode:function(e){var t;if(e)if(c)E.always(e[E.status]);else for(t in e)x[t]=[x[t],e[t]];return this},abort:function(e){var t=e||C;return i&&i.abort(t),k(0,t),this}};if(v.promise(E),h.url=((t||h.url||Ct.href)+"").replace(Rt,Ct.protocol+"//"),h.type=n.method||n.type||h.method||h.type,h.dataTypes=(h.dataType||"*").toLowerCase().match(M)||[""],null==h.crossDomain){l=r.createElement("a");try{l.href=h.url,l.href=l.href,h.crossDomain=Bt.protocol+"//"+Bt.host!=l.protocol+"//"+l.host}catch(e){h.crossDomain=!0}}if(h.data&&h.processData&&"string"!=typeof h.data&&(h.data=w.param(h.data,h.traditional)),_t(It,h,n,E),c)return E;(f=w.event&&h.global)&&0==w.active++&&w.event.trigger("ajaxStart"),h.type=h.type.toUpperCase(),h.hasContent=!Mt.test(h.type),o=h.url.replace(Lt,""),h.hasContent?h.data&&h.processData&&0===(h.contentType||"").indexOf("application/x-www-form-urlencoded")&&(h.data=h.data.replace(qt,"+")):(d=h.url.slice(o.length),h.data&&(h.processData||"string"==typeof h.data)&&(o+=(kt.test(o)?"&":"?")+h.data,delete h.data),!1===h.cache&&(o=o.replace(Ht,"$1"),d=(kt.test(o)?"&":"?")+"_="+Et+++d),h.url=o+d),h.ifModified&&(w.lastModified[o]&&E.setRequestHeader("If-Modified-Since",w.lastModified[o]),w.etag[o]&&E.setRequestHeader("If-None-Match",w.etag[o])),(h.data&&h.hasContent&&!1!==h.contentType||n.contentType)&&E.setRequestHeader("Content-Type",h.contentType),E.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+$t+"; q=0.01":""):h.accepts["*"]);for(p in h.headers)E.setRequestHeader(p,h.headers[p]);if(h.beforeSend&&(!1===h.beforeSend.call(g,E,h)||c))return E.abort();if(C="abort",m.add(h.complete),E.done(h.success),E.fail(h.error),i=_t(Wt,h,n,E)){if(E.readyState=1,f&&y.trigger("ajaxSend",[E,h]),c)return E;h.async&&h.timeout>0&&(u=e.setTimeout(function(){E.abort("timeout")},h.timeout));try{c=!1,i.send(b,k)}catch(e){if(c)throw e;k(-1,e)}}else k(-1,"No Transport");function k(t,n,r,s){var l,p,d,b,T,C=n;c||(c=!0,u&&e.clearTimeout(u),i=void 0,a=s||"",E.readyState=t>0?4:0,l=t>=200&&t<300||304===t,r&&(b=Xt(h,E,r)),b=Ut(h,b,E,l),l?(h.ifModified&&((T=E.getResponseHeader("Last-Modified"))&&(w.lastModified[o]=T),(T=E.getResponseHeader("etag"))&&(w.etag[o]=T)),204===t||"HEAD"===h.type?C="nocontent":304===t?C="notmodified":(C=b.state,p=b.data,l=!(d=b.error))):(d=C,!t&&C||(C="error",t<0&&(t=0))),E.status=t,E.statusText=(n||C)+"",l?v.resolveWith(g,[p,C,E]):v.rejectWith(g,[E,C,d]),E.statusCode(x),x=void 0,f&&y.trigger(l?"ajaxSuccess":"ajaxError",[E,h,l?p:d]),m.fireWith(g,[E,C]),f&&(y.trigger("ajaxComplete",[E,h]),--w.active||w.event.trigger("ajaxStop")))}return E},getJSON:function(e,t,n){return w.get(e,t,n,"json")},getScript:function(e,t){return w.get(e,void 0,t,"script")}}),w.each(["get","post"],function(e,t){w[t]=function(e,n,r,i){return g(n)&&(i=i||r,r=n,n=void 0),w.ajax(w.extend({url:e,type:t,dataType:i,data:n,success:r},w.isPlainObject(e)&&e))}}),w._evalUrl=function(e){return w.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,"throws":!0})},w.fn.extend({wrapAll:function(e){var t;return this[0]&&(g(e)&&(e=e.call(this[0])),t=w(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(e){return g(e)?this.each(function(t){w(this).wrapInner(e.call(this,t))}):this.each(function(){var t=w(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=g(e);return this.each(function(n){w(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(e){return this.parent(e).not("body").each(function(){w(this).replaceWith(this.childNodes)}),this}}),w.expr.pseudos.hidden=function(e){return!w.expr.pseudos.visible(e)},w.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},w.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch(e){}};var Vt={0:200,1223:204},Gt=w.ajaxSettings.xhr();h.cors=!!Gt&&"withCredentials"in Gt,h.ajax=Gt=!!Gt,w.ajaxTransport(function(t){var n,r;if(h.cors||Gt&&!t.crossDomain)return{send:function(i,o){var a,s=t.xhr();if(s.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(a in t.xhrFields)s[a]=t.xhrFields[a];t.mimeType&&s.overrideMimeType&&s.overrideMimeType(t.mimeType),t.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(a in i)s.setRequestHeader(a,i[a]);n=function(e){return function(){n&&(n=r=s.onload=s.onerror=s.onabort=s.ontimeout=s.onreadystatechange=null,"abort"===e?s.abort():"error"===e?"number"!=typeof s.status?o(0,"error"):o(s.status,s.statusText):o(Vt[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=n(),r=s.onerror=s.ontimeout=n("error"),void 0!==s.onabort?s.onabort=r:s.onreadystatechange=function(){4===s.readyState&&e.setTimeout(function(){n&&r()})},n=n("abort");try{s.send(t.hasContent&&t.data||null)}catch(e){if(n)throw e}},abort:function(){n&&n()}}}),w.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),w.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return w.globalEval(e),e}}}),w.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),w.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(i,o){t=w("<script>").prop({charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&o("error"===e.type?404:200,e.type)}),r.head.appendChild(t[0])},abort:function(){n&&n()}}}});var Yt=[],Qt=/(=)\?(?=&|$)|\?\?/;w.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Yt.pop()||w.expando+"_"+Et++;return this[e]=!0,e}}),w.ajaxPrefilter("json jsonp",function(t,n,r){var i,o,a,s=!1!==t.jsonp&&(Qt.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Qt.test(t.data)&&"data");if(s||"jsonp"===t.dataTypes[0])return i=t.jsonpCallback=g(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,s?t[s]=t[s].replace(Qt,"$1"+i):!1!==t.jsonp&&(t.url+=(kt.test(t.url)?"&":"?")+t.jsonp+"="+i),t.converters["script json"]=function(){return a||w.error(i+" was not called"),a[0]},t.dataTypes[0]="json",o=e[i],e[i]=function(){a=arguments},r.always(function(){void 0===o?w(e).removeProp(i):e[i]=o,t[i]&&(t.jsonpCallback=n.jsonpCallback,Yt.push(i)),a&&g(o)&&o(a[0]),a=o=void 0}),"script"}),h.createHTMLDocument=function(){var e=r.implementation.createHTMLDocument("").body;return e.innerHTML="<form></form><form></form>",2===e.childNodes.length}(),w.parseHTML=function(e,t,n){if("string"!=typeof e)return[];"boolean"==typeof t&&(n=t,t=!1);var i,o,a;return t||(h.createHTMLDocument?((i=(t=r.implementation.createHTMLDocument("")).createElement("base")).href=r.location.href,t.head.appendChild(i)):t=r),o=A.exec(e),a=!n&&[],o?[t.createElement(o[1])]:(o=xe([e],t,a),a&&a.length&&w(a).remove(),w.merge([],o.childNodes))},w.fn.load=function(e,t,n){var r,i,o,a=this,s=e.indexOf(" ");return s>-1&&(r=vt(e.slice(s)),e=e.slice(0,s)),g(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),a.length>0&&w.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done(function(e){o=arguments,a.html(r?w("<div>").append(w.parseHTML(e)).find(r):e)}).always(n&&function(e,t){a.each(function(){n.apply(this,o||[e.responseText,t,e])})}),this},w.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){w.fn[t]=function(e){return this.on(t,e)}}),w.expr.pseudos.animated=function(e){return w.grep(w.timers,function(t){return e===t.elem}).length},w.offset={setOffset:function(e,t,n){var r,i,o,a,s,u,l,c=w.css(e,"position"),f=w(e),p={};"static"===c&&(e.style.position="relative"),s=f.offset(),o=w.css(e,"top"),u=w.css(e,"left"),(l=("absolute"===c||"fixed"===c)&&(o+u).indexOf("auto")>-1)?(a=(r=f.position()).top,i=r.left):(a=parseFloat(o)||0,i=parseFloat(u)||0),g(t)&&(t=t.call(e,n,w.extend({},s))),null!=t.top&&(p.top=t.top-s.top+a),null!=t.left&&(p.left=t.left-s.left+i),"using"in t?t.using.call(e,p):f.css(p)}},w.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){w.offset.setOffset(this,e,t)});var t,n,r=this[0];if(r)return r.getClientRects().length?(t=r.getBoundingClientRect(),n=r.ownerDocument.defaultView,{top:t.top+n.pageYOffset,left:t.left+n.pageXOffset}):{top:0,left:0}},position:function(){if(this[0]){var e,t,n,r=this[0],i={top:0,left:0};if("fixed"===w.css(r,"position"))t=r.getBoundingClientRect();else{t=this.offset(),n=r.ownerDocument,e=r.offsetParent||n.documentElement;while(e&&(e===n.body||e===n.documentElement)&&"static"===w.css(e,"position"))e=e.parentNode;e&&e!==r&&1===e.nodeType&&((i=w(e).offset()).top+=w.css(e,"borderTopWidth",!0),i.left+=w.css(e,"borderLeftWidth",!0))}return{top:t.top-i.top-w.css(r,"marginTop",!0),left:t.left-i.left-w.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent;while(e&&"static"===w.css(e,"position"))e=e.offsetParent;return e||be})}}),w.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n="pageYOffset"===t;w.fn[e]=function(r){return z(this,function(e,r,i){var o;if(y(e)?o=e:9===e.nodeType&&(o=e.defaultView),void 0===i)return o?o[t]:e[r];o?o.scrollTo(n?o.pageXOffset:i,n?i:o.pageYOffset):e[r]=i},e,r,arguments.length)}}),w.each(["top","left"],function(e,t){w.cssHooks[t]=_e(h.pixelPosition,function(e,n){if(n)return n=Fe(e,t),We.test(n)?w(e).position()[t]+"px":n})}),w.each({Height:"height",Width:"width"},function(e,t){w.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){w.fn[r]=function(i,o){var a=arguments.length&&(n||"boolean"!=typeof i),s=n||(!0===i||!0===o?"margin":"border");return z(this,function(t,n,i){var o;return y(t)?0===r.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(o=t.documentElement,Math.max(t.body["scroll"+e],o["scroll"+e],t.body["offset"+e],o["offset"+e],o["client"+e])):void 0===i?w.css(t,n,s):w.style(t,n,i,s)},t,a?i:void 0,a)}})}),w.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,t){w.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),w.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),w.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}}),w.proxy=function(e,t){var n,r,i;if("string"==typeof t&&(n=e[t],t=e,e=n),g(e))return r=o.call(arguments,2),i=function(){return e.apply(t||this,r.concat(o.call(arguments)))},i.guid=e.guid=e.guid||w.guid++,i},w.holdReady=function(e){e?w.readyWait++:w.ready(!0)},w.isArray=Array.isArray,w.parseJSON=JSON.parse,w.nodeName=N,w.isFunction=g,w.isWindow=y,w.camelCase=G,w.type=x,w.now=Date.now,w.isNumeric=function(e){var t=w.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},"function"==typeof define&&define.amd&&define("jquery",[],function(){return w});var Jt=e.jQuery,Kt=e.$;return w.noConflict=function(t){return e.$===w&&(e.$=Kt),t&&e.jQuery===w&&(e.jQuery=Jt),w},t||(e.jQuery=e.$=w),w});

</script>
<script type="text/javascript">
/**
 * @popperjs/core v2.11.5 - MIT License
 */

!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Popper={})}(this,(function(e){"use strict";function t(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function n(e){return e instanceof t(e).Element||e instanceof Element}function r(e){return e instanceof t(e).HTMLElement||e instanceof HTMLElement}function o(e){return"undefined"!=typeof ShadowRoot&&(e instanceof t(e).ShadowRoot||e instanceof ShadowRoot)}var i=Math.max,a=Math.min,s=Math.round;function f(e,t){void 0===t&&(t=!1);var n=e.getBoundingClientRect(),o=1,i=1;if(r(e)&&t){var a=e.offsetHeight,f=e.offsetWidth;f>0&&(o=s(n.width)/f||1),a>0&&(i=s(n.height)/a||1)}return{width:n.width/o,height:n.height/i,top:n.top/i,right:n.right/o,bottom:n.bottom/i,left:n.left/o,x:n.left/o,y:n.top/i}}function c(e){var n=t(e);return{scrollLeft:n.pageXOffset,scrollTop:n.pageYOffset}}function p(e){return e?(e.nodeName||"").toLowerCase():null}function u(e){return((n(e)?e.ownerDocument:e.document)||window.document).documentElement}function l(e){return f(u(e)).left+c(e).scrollLeft}function d(e){return t(e).getComputedStyle(e)}function h(e){var t=d(e),n=t.overflow,r=t.overflowX,o=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+o+r)}function m(e,n,o){void 0===o&&(o=!1);var i,a,d=r(n),m=r(n)&&function(e){var t=e.getBoundingClientRect(),n=s(t.width)/e.offsetWidth||1,r=s(t.height)/e.offsetHeight||1;return 1!==n||1!==r}(n),v=u(n),g=f(e,m),y={scrollLeft:0,scrollTop:0},b={x:0,y:0};return(d||!d&&!o)&&(("body"!==p(n)||h(v))&&(y=(i=n)!==t(i)&&r(i)?{scrollLeft:(a=i).scrollLeft,scrollTop:a.scrollTop}:c(i)),r(n)?((b=f(n,!0)).x+=n.clientLeft,b.y+=n.clientTop):v&&(b.x=l(v))),{x:g.left+y.scrollLeft-b.x,y:g.top+y.scrollTop-b.y,width:g.width,height:g.height}}function v(e){var t=f(e),n=e.offsetWidth,r=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-r)<=1&&(r=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:r}}function g(e){return"html"===p(e)?e:e.assignedSlot||e.parentNode||(o(e)?e.host:null)||u(e)}function y(e){return["html","body","#document"].indexOf(p(e))>=0?e.ownerDocument.body:r(e)&&h(e)?e:y(g(e))}function b(e,n){var r;void 0===n&&(n=[]);var o=y(e),i=o===(null==(r=e.ownerDocument)?void 0:r.body),a=t(o),s=i?[a].concat(a.visualViewport||[],h(o)?o:[]):o,f=n.concat(s);return i?f:f.concat(b(g(s)))}function x(e){return["table","td","th"].indexOf(p(e))>=0}function w(e){return r(e)&&"fixed"!==d(e).position?e.offsetParent:null}function O(e){for(var n=t(e),i=w(e);i&&x(i)&&"static"===d(i).position;)i=w(i);return i&&("html"===p(i)||"body"===p(i)&&"static"===d(i).position)?n:i||function(e){var t=-1!==navigator.userAgent.toLowerCase().indexOf("firefox");if(-1!==navigator.userAgent.indexOf("Trident")&&r(e)&&"fixed"===d(e).position)return null;var n=g(e);for(o(n)&&(n=n.host);r(n)&&["html","body"].indexOf(p(n))<0;){var i=d(n);if("none"!==i.transform||"none"!==i.perspective||"paint"===i.contain||-1!==["transform","perspective"].indexOf(i.willChange)||t&&"filter"===i.willChange||t&&i.filter&&"none"!==i.filter)return n;n=n.parentNode}return null}(e)||n}var j="top",E="bottom",D="right",A="left",L="auto",P=[j,E,D,A],M="start",k="end",W="viewport",B="popper",H=P.reduce((function(e,t){return e.concat([t+"-"+M,t+"-"+k])}),[]),T=[].concat(P,[L]).reduce((function(e,t){return e.concat([t,t+"-"+M,t+"-"+k])}),[]),R=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function S(e){var t=new Map,n=new Set,r=[];function o(e){n.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach((function(e){if(!n.has(e)){var r=t.get(e);r&&o(r)}})),r.push(e)}return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){n.has(e.name)||o(e)})),r}function C(e){return e.split("-")[0]}function q(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&o(n)){var r=t;do{if(r&&e.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function V(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function N(e,r){return r===W?V(function(e){var n=t(e),r=u(e),o=n.visualViewport,i=r.clientWidth,a=r.clientHeight,s=0,f=0;return o&&(i=o.width,a=o.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(s=o.offsetLeft,f=o.offsetTop)),{width:i,height:a,x:s+l(e),y:f}}(e)):n(r)?function(e){var t=f(e);return t.top=t.top+e.clientTop,t.left=t.left+e.clientLeft,t.bottom=t.top+e.clientHeight,t.right=t.left+e.clientWidth,t.width=e.clientWidth,t.height=e.clientHeight,t.x=t.left,t.y=t.top,t}(r):V(function(e){var t,n=u(e),r=c(e),o=null==(t=e.ownerDocument)?void 0:t.body,a=i(n.scrollWidth,n.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),s=i(n.scrollHeight,n.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0),f=-r.scrollLeft+l(e),p=-r.scrollTop;return"rtl"===d(o||n).direction&&(f+=i(n.clientWidth,o?o.clientWidth:0)-a),{width:a,height:s,x:f,y:p}}(u(e)))}function I(e,t,o){var s="clippingParents"===t?function(e){var t=b(g(e)),o=["absolute","fixed"].indexOf(d(e).position)>=0&&r(e)?O(e):e;return n(o)?t.filter((function(e){return n(e)&&q(e,o)&&"body"!==p(e)})):[]}(e):[].concat(t),f=[].concat(s,[o]),c=f[0],u=f.reduce((function(t,n){var r=N(e,n);return t.top=i(r.top,t.top),t.right=a(r.right,t.right),t.bottom=a(r.bottom,t.bottom),t.left=i(r.left,t.left),t}),N(e,c));return u.width=u.right-u.left,u.height=u.bottom-u.top,u.x=u.left,u.y=u.top,u}function _(e){return e.split("-")[1]}function F(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function U(e){var t,n=e.reference,r=e.element,o=e.placement,i=o?C(o):null,a=o?_(o):null,s=n.x+n.width/2-r.width/2,f=n.y+n.height/2-r.height/2;switch(i){case j:t={x:s,y:n.y-r.height};break;case E:t={x:s,y:n.y+n.height};break;case D:t={x:n.x+n.width,y:f};break;case A:t={x:n.x-r.width,y:f};break;default:t={x:n.x,y:n.y}}var c=i?F(i):null;if(null!=c){var p="y"===c?"height":"width";switch(a){case M:t[c]=t[c]-(n[p]/2-r[p]/2);break;case k:t[c]=t[c]+(n[p]/2-r[p]/2)}}return t}function z(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function X(e,t){return t.reduce((function(t,n){return t[n]=e,t}),{})}function Y(e,t){void 0===t&&(t={});var r=t,o=r.placement,i=void 0===o?e.placement:o,a=r.boundary,s=void 0===a?"clippingParents":a,c=r.rootBoundary,p=void 0===c?W:c,l=r.elementContext,d=void 0===l?B:l,h=r.altBoundary,m=void 0!==h&&h,v=r.padding,g=void 0===v?0:v,y=z("number"!=typeof g?g:X(g,P)),b=d===B?"reference":B,x=e.rects.popper,w=e.elements[m?b:d],O=I(n(w)?w:w.contextElement||u(e.elements.popper),s,p),A=f(e.elements.reference),L=U({reference:A,element:x,strategy:"absolute",placement:i}),M=V(Object.assign({},x,L)),k=d===B?M:A,H={top:O.top-k.top+y.top,bottom:k.bottom-O.bottom+y.bottom,left:O.left-k.left+y.left,right:k.right-O.right+y.right},T=e.modifiersData.offset;if(d===B&&T){var R=T[i];Object.keys(H).forEach((function(e){var t=[D,E].indexOf(e)>=0?1:-1,n=[j,E].indexOf(e)>=0?"y":"x";H[e]+=R[n]*t}))}return H}var G={placement:"bottom",modifiers:[],strategy:"absolute"};function J(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some((function(e){return!(e&&"function"==typeof e.getBoundingClientRect)}))}function K(e){void 0===e&&(e={});var t=e,r=t.defaultModifiers,o=void 0===r?[]:r,i=t.defaultOptions,a=void 0===i?G:i;return function(e,t,r){void 0===r&&(r=a);var i,s,f={placement:"bottom",orderedModifiers:[],options:Object.assign({},G,a),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},c=[],p=!1,u={state:f,setOptions:function(r){var i="function"==typeof r?r(f.options):r;l(),f.options=Object.assign({},a,f.options,i),f.scrollParents={reference:n(e)?b(e):e.contextElement?b(e.contextElement):[],popper:b(t)};var s,p,d=function(e){var t=S(e);return R.reduce((function(e,n){return e.concat(t.filter((function(e){return e.phase===n})))}),[])}((s=[].concat(o,f.options.modifiers),p=s.reduce((function(e,t){var n=e[t.name];return e[t.name]=n?Object.assign({},n,t,{options:Object.assign({},n.options,t.options),data:Object.assign({},n.data,t.data)}):t,e}),{}),Object.keys(p).map((function(e){return p[e]}))));return f.orderedModifiers=d.filter((function(e){return e.enabled})),f.orderedModifiers.forEach((function(e){var t=e.name,n=e.options,r=void 0===n?{}:n,o=e.effect;if("function"==typeof o){var i=o({state:f,name:t,instance:u,options:r}),a=function(){};c.push(i||a)}})),u.update()},forceUpdate:function(){if(!p){var e=f.elements,t=e.reference,n=e.popper;if(J(t,n)){f.rects={reference:m(t,O(n),"fixed"===f.options.strategy),popper:v(n)},f.reset=!1,f.placement=f.options.placement,f.orderedModifiers.forEach((function(e){return f.modifiersData[e.name]=Object.assign({},e.data)}));for(var r=0;r<f.orderedModifiers.length;r++)if(!0!==f.reset){var o=f.orderedModifiers[r],i=o.fn,a=o.options,s=void 0===a?{}:a,c=o.name;"function"==typeof i&&(f=i({state:f,options:s,name:c,instance:u})||f)}else f.reset=!1,r=-1}}},update:(i=function(){return new Promise((function(e){u.forceUpdate(),e(f)}))},function(){return s||(s=new Promise((function(e){Promise.resolve().then((function(){s=void 0,e(i())}))}))),s}),destroy:function(){l(),p=!0}};if(!J(e,t))return u;function l(){c.forEach((function(e){return e()})),c=[]}return u.setOptions(r).then((function(e){!p&&r.onFirstUpdate&&r.onFirstUpdate(e)})),u}}var Q={passive:!0};var Z={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var n=e.state,r=e.instance,o=e.options,i=o.scroll,a=void 0===i||i,s=o.resize,f=void 0===s||s,c=t(n.elements.popper),p=[].concat(n.scrollParents.reference,n.scrollParents.popper);return a&&p.forEach((function(e){e.addEventListener("scroll",r.update,Q)})),f&&c.addEventListener("resize",r.update,Q),function(){a&&p.forEach((function(e){e.removeEventListener("scroll",r.update,Q)})),f&&c.removeEventListener("resize",r.update,Q)}},data:{}};var $={name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,n=e.name;t.modifiersData[n]=U({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},ee={top:"auto",right:"auto",bottom:"auto",left:"auto"};function te(e){var n,r=e.popper,o=e.popperRect,i=e.placement,a=e.variation,f=e.offsets,c=e.position,p=e.gpuAcceleration,l=e.adaptive,h=e.roundOffsets,m=e.isFixed,v=f.x,g=void 0===v?0:v,y=f.y,b=void 0===y?0:y,x="function"==typeof h?h({x:g,y:b}):{x:g,y:b};g=x.x,b=x.y;var w=f.hasOwnProperty("x"),L=f.hasOwnProperty("y"),P=A,M=j,W=window;if(l){var B=O(r),H="clientHeight",T="clientWidth";if(B===t(r)&&"static"!==d(B=u(r)).position&&"absolute"===c&&(H="scrollHeight",T="scrollWidth"),B=B,i===j||(i===A||i===D)&&a===k)M=E,b-=(m&&B===W&&W.visualViewport?W.visualViewport.height:B[H])-o.height,b*=p?1:-1;if(i===A||(i===j||i===E)&&a===k)P=D,g-=(m&&B===W&&W.visualViewport?W.visualViewport.width:B[T])-o.width,g*=p?1:-1}var R,S=Object.assign({position:c},l&&ee),C=!0===h?function(e){var t=e.x,n=e.y,r=window.devicePixelRatio||1;return{x:s(t*r)/r||0,y:s(n*r)/r||0}}({x:g,y:b}):{x:g,y:b};return g=C.x,b=C.y,p?Object.assign({},S,((R={})[M]=L?"0":"",R[P]=w?"0":"",R.transform=(W.devicePixelRatio||1)<=1?"translate("+g+"px, "+b+"px)":"translate3d("+g+"px, "+b+"px, 0)",R)):Object.assign({},S,((n={})[M]=L?b+"px":"",n[P]=w?g+"px":"",n.transform="",n))}var ne={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,n=e.options,r=n.gpuAcceleration,o=void 0===r||r,i=n.adaptive,a=void 0===i||i,s=n.roundOffsets,f=void 0===s||s,c={placement:C(t.placement),variation:_(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:o,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,te(Object.assign({},c,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:a,roundOffsets:f})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,te(Object.assign({},c,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:f})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}};var re={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var n=t.styles[e]||{},o=t.attributes[e]||{},i=t.elements[e];r(i)&&p(i)&&(Object.assign(i.style,n),Object.keys(o).forEach((function(e){var t=o[e];!1===t?i.removeAttribute(e):i.setAttribute(e,!0===t?"":t)})))}))},effect:function(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach((function(e){var o=t.elements[e],i=t.attributes[e]||{},a=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:n[e]).reduce((function(e,t){return e[t]="",e}),{});r(o)&&p(o)&&(Object.assign(o.style,a),Object.keys(i).forEach((function(e){o.removeAttribute(e)})))}))}},requires:["computeStyles"]};var oe={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,n=e.options,r=e.name,o=n.offset,i=void 0===o?[0,0]:o,a=T.reduce((function(e,n){return e[n]=function(e,t,n){var r=C(e),o=[A,j].indexOf(r)>=0?-1:1,i="function"==typeof n?n(Object.assign({},t,{placement:e})):n,a=i[0],s=i[1];return a=a||0,s=(s||0)*o,[A,D].indexOf(r)>=0?{x:s,y:a}:{x:a,y:s}}(n,t.rects,i),e}),{}),s=a[t.placement],f=s.x,c=s.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=f,t.modifiersData.popperOffsets.y+=c),t.modifiersData[r]=a}},ie={left:"right",right:"left",bottom:"top",top:"bottom"};function ae(e){return e.replace(/left|right|bottom|top/g,(function(e){return ie[e]}))}var se={start:"end",end:"start"};function fe(e){return e.replace(/start|end/g,(function(e){return se[e]}))}function ce(e,t){void 0===t&&(t={});var n=t,r=n.placement,o=n.boundary,i=n.rootBoundary,a=n.padding,s=n.flipVariations,f=n.allowedAutoPlacements,c=void 0===f?T:f,p=_(r),u=p?s?H:H.filter((function(e){return _(e)===p})):P,l=u.filter((function(e){return c.indexOf(e)>=0}));0===l.length&&(l=u);var d=l.reduce((function(t,n){return t[n]=Y(e,{placement:n,boundary:o,rootBoundary:i,padding:a})[C(n)],t}),{});return Object.keys(d).sort((function(e,t){return d[e]-d[t]}))}var pe={name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name;if(!t.modifiersData[r]._skip){for(var o=n.mainAxis,i=void 0===o||o,a=n.altAxis,s=void 0===a||a,f=n.fallbackPlacements,c=n.padding,p=n.boundary,u=n.rootBoundary,l=n.altBoundary,d=n.flipVariations,h=void 0===d||d,m=n.allowedAutoPlacements,v=t.options.placement,g=C(v),y=f||(g===v||!h?[ae(v)]:function(e){if(C(e)===L)return[];var t=ae(e);return[fe(e),t,fe(t)]}(v)),b=[v].concat(y).reduce((function(e,n){return e.concat(C(n)===L?ce(t,{placement:n,boundary:p,rootBoundary:u,padding:c,flipVariations:h,allowedAutoPlacements:m}):n)}),[]),x=t.rects.reference,w=t.rects.popper,O=new Map,P=!0,k=b[0],W=0;W<b.length;W++){var B=b[W],H=C(B),T=_(B)===M,R=[j,E].indexOf(H)>=0,S=R?"width":"height",q=Y(t,{placement:B,boundary:p,rootBoundary:u,altBoundary:l,padding:c}),V=R?T?D:A:T?E:j;x[S]>w[S]&&(V=ae(V));var N=ae(V),I=[];if(i&&I.push(q[H]<=0),s&&I.push(q[V]<=0,q[N]<=0),I.every((function(e){return e}))){k=B,P=!1;break}O.set(B,I)}if(P)for(var F=function(e){var t=b.find((function(t){var n=O.get(t);if(n)return n.slice(0,e).every((function(e){return e}))}));if(t)return k=t,"break"},U=h?3:1;U>0;U--){if("break"===F(U))break}t.placement!==k&&(t.modifiersData[r]._skip=!0,t.placement=k,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function ue(e,t,n){return i(e,a(t,n))}var le={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name,o=n.mainAxis,s=void 0===o||o,f=n.altAxis,c=void 0!==f&&f,p=n.boundary,u=n.rootBoundary,l=n.altBoundary,d=n.padding,h=n.tether,m=void 0===h||h,g=n.tetherOffset,y=void 0===g?0:g,b=Y(t,{boundary:p,rootBoundary:u,padding:d,altBoundary:l}),x=C(t.placement),w=_(t.placement),L=!w,P=F(x),k="x"===P?"y":"x",W=t.modifiersData.popperOffsets,B=t.rects.reference,H=t.rects.popper,T="function"==typeof y?y(Object.assign({},t.rects,{placement:t.placement})):y,R="number"==typeof T?{mainAxis:T,altAxis:T}:Object.assign({mainAxis:0,altAxis:0},T),S=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,q={x:0,y:0};if(W){if(s){var V,N="y"===P?j:A,I="y"===P?E:D,U="y"===P?"height":"width",z=W[P],X=z+b[N],G=z-b[I],J=m?-H[U]/2:0,K=w===M?B[U]:H[U],Q=w===M?-H[U]:-B[U],Z=t.elements.arrow,$=m&&Z?v(Z):{width:0,height:0},ee=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},te=ee[N],ne=ee[I],re=ue(0,B[U],$[U]),oe=L?B[U]/2-J-re-te-R.mainAxis:K-re-te-R.mainAxis,ie=L?-B[U]/2+J+re+ne+R.mainAxis:Q+re+ne+R.mainAxis,ae=t.elements.arrow&&O(t.elements.arrow),se=ae?"y"===P?ae.clientTop||0:ae.clientLeft||0:0,fe=null!=(V=null==S?void 0:S[P])?V:0,ce=z+ie-fe,pe=ue(m?a(X,z+oe-fe-se):X,z,m?i(G,ce):G);W[P]=pe,q[P]=pe-z}if(c){var le,de="x"===P?j:A,he="x"===P?E:D,me=W[k],ve="y"===k?"height":"width",ge=me+b[de],ye=me-b[he],be=-1!==[j,A].indexOf(x),xe=null!=(le=null==S?void 0:S[k])?le:0,we=be?ge:me-B[ve]-H[ve]-xe+R.altAxis,Oe=be?me+B[ve]+H[ve]-xe-R.altAxis:ye,je=m&&be?function(e,t,n){var r=ue(e,t,n);return r>n?n:r}(we,me,Oe):ue(m?we:ge,me,m?Oe:ye);W[k]=je,q[k]=je-me}t.modifiersData[r]=q}},requiresIfExists:["offset"]};var de={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,n=e.state,r=e.name,o=e.options,i=n.elements.arrow,a=n.modifiersData.popperOffsets,s=C(n.placement),f=F(s),c=[A,D].indexOf(s)>=0?"height":"width";if(i&&a){var p=function(e,t){return z("number"!=typeof(e="function"==typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:X(e,P))}(o.padding,n),u=v(i),l="y"===f?j:A,d="y"===f?E:D,h=n.rects.reference[c]+n.rects.reference[f]-a[f]-n.rects.popper[c],m=a[f]-n.rects.reference[f],g=O(i),y=g?"y"===f?g.clientHeight||0:g.clientWidth||0:0,b=h/2-m/2,x=p[l],w=y-u[c]-p[d],L=y/2-u[c]/2+b,M=ue(x,L,w),k=f;n.modifiersData[r]=((t={})[k]=M,t.centerOffset=M-L,t)}},effect:function(e){var t=e.state,n=e.options.element,r=void 0===n?"[data-popper-arrow]":n;null!=r&&("string"!=typeof r||(r=t.elements.popper.querySelector(r)))&&q(t.elements.popper,r)&&(t.elements.arrow=r)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function he(e,t,n){return void 0===n&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function me(e){return[j,D,E,A].some((function(t){return e[t]>=0}))}var ve={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,n=e.name,r=t.rects.reference,o=t.rects.popper,i=t.modifiersData.preventOverflow,a=Y(t,{elementContext:"reference"}),s=Y(t,{altBoundary:!0}),f=he(a,r),c=he(s,o,i),p=me(f),u=me(c);t.modifiersData[n]={referenceClippingOffsets:f,popperEscapeOffsets:c,isReferenceHidden:p,hasPopperEscaped:u},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":p,"data-popper-escaped":u})}},ge=K({defaultModifiers:[Z,$,ne,re]}),ye=[Z,$,ne,re,oe,pe,le,de,ve],be=K({defaultModifiers:ye});e.applyStyles=re,e.arrow=de,e.computeStyles=ne,e.createPopper=be,e.createPopperLite=ge,e.defaultModifiers=ye,e.detectOverflow=Y,e.eventListeners=Z,e.flip=pe,e.hide=ve,e.offset=oe,e.popperGenerator=K,e.popperOffsets=$,e.preventOverflow=le,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=popper.min.js.map

</script>
<script type="text/javascript">
/*!
  * Bootstrap v5.1.3 (https://getbootstrap.com/)
  * Copyright 2011-2021 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("@popperjs/core")):"function"==typeof define&&define.amd?define(["@popperjs/core"],e):(t="undefined"!=typeof globalThis?globalThis:t||self).bootstrap=e(t.Popper)}(this,(function(t){"use strict";function e(t){if(t&&t.__esModule)return t;const e=Object.create(null);if(t)for(const i in t)if("default"!==i){const s=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:()=>t[i]})}return e.default=t,Object.freeze(e)}const i=e(t),s="transitionend",n=t=>{let e=t.getAttribute("data-bs-target");if(!e||"#"===e){let i=t.getAttribute("href");if(!i||!i.includes("#")&&!i.startsWith("."))return null;i.includes("#")&&!i.startsWith("#")&&(i=`#${i.split("#")[1]}`),e=i&&"#"!==i?i.trim():null}return e},o=t=>{const e=n(t);return e&&document.querySelector(e)?e:null},r=t=>{const e=n(t);return e?document.querySelector(e):null},a=t=>{t.dispatchEvent(new Event(s))},l=t=>!(!t||"object"!=typeof t)&&(void 0!==t.jquery&&(t=t[0]),void 0!==t.nodeType),c=t=>l(t)?t.jquery?t[0]:t:"string"==typeof t&&t.length>0?document.querySelector(t):null,h=(t,e,i)=>{Object.keys(i).forEach((s=>{const n=i[s],o=e[s],r=o&&l(o)?"element":null==(a=o)?`${a}`:{}.toString.call(a).match(/\s([a-z]+)/i)[1].toLowerCase();var a;if(!new RegExp(n).test(r))throw new TypeError(`${t.toUpperCase()}: Option "${s}" provided type "${r}" but expected type "${n}".`)}))},d=t=>!(!l(t)||0===t.getClientRects().length)&&"visible"===getComputedStyle(t).getPropertyValue("visibility"),u=t=>!t||t.nodeType!==Node.ELEMENT_NODE||!!t.classList.contains("disabled")||(void 0!==t.disabled?t.disabled:t.hasAttribute("disabled")&&"false"!==t.getAttribute("disabled")),g=t=>{if(!document.documentElement.attachShadow)return null;if("function"==typeof t.getRootNode){const e=t.getRootNode();return e instanceof ShadowRoot?e:null}return t instanceof ShadowRoot?t:t.parentNode?g(t.parentNode):null},_=()=>{},f=t=>{t.offsetHeight},p=()=>{const{jQuery:t}=window;return t&&!document.body.hasAttribute("data-bs-no-jquery")?t:null},m=[],b=()=>"rtl"===document.documentElement.dir,v=t=>{var e;e=()=>{const e=p();if(e){const i=t.NAME,s=e.fn[i];e.fn[i]=t.jQueryInterface,e.fn[i].Constructor=t,e.fn[i].noConflict=()=>(e.fn[i]=s,t.jQueryInterface)}},"loading"===document.readyState?(m.length||document.addEventListener("DOMContentLoaded",(()=>{m.forEach((t=>t()))})),m.push(e)):e()},y=t=>{"function"==typeof t&&t()},E=(t,e,i=!0)=>{if(!i)return void y(t);const n=(t=>{if(!t)return 0;let{transitionDuration:e,transitionDelay:i}=window.getComputedStyle(t);const s=Number.parseFloat(e),n=Number.parseFloat(i);return s||n?(e=e.split(",")[0],i=i.split(",")[0],1e3*(Number.parseFloat(e)+Number.parseFloat(i))):0})(e)+5;let o=!1;const r=({target:i})=>{i===e&&(o=!0,e.removeEventListener(s,r),y(t))};e.addEventListener(s,r),setTimeout((()=>{o||a(e)}),n)},w=(t,e,i,s)=>{let n=t.indexOf(e);if(-1===n)return t[!i&&s?t.length-1:0];const o=t.length;return n+=i?1:-1,s&&(n=(n+o)%o),t[Math.max(0,Math.min(n,o-1))]},A=/[^.]*(?=\..*)\.|.*/,T=/\..*/,C=/::\d+$/,k={};let L=1;const S={mouseenter:"mouseover",mouseleave:"mouseout"},O=/^(mouseenter|mouseleave)/i,N=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function D(t,e){return e&&`${e}::${L++}`||t.uidEvent||L++}function I(t){const e=D(t);return t.uidEvent=e,k[e]=k[e]||{},k[e]}function P(t,e,i=null){const s=Object.keys(t);for(let n=0,o=s.length;n<o;n++){const o=t[s[n]];if(o.originalHandler===e&&o.delegationSelector===i)return o}return null}function x(t,e,i){const s="string"==typeof e,n=s?i:e;let o=H(t);return N.has(o)||(o=t),[s,n,o]}function M(t,e,i,s,n){if("string"!=typeof e||!t)return;if(i||(i=s,s=null),O.test(e)){const t=t=>function(e){if(!e.relatedTarget||e.relatedTarget!==e.delegateTarget&&!e.delegateTarget.contains(e.relatedTarget))return t.call(this,e)};s?s=t(s):i=t(i)}const[o,r,a]=x(e,i,s),l=I(t),c=l[a]||(l[a]={}),h=P(c,r,o?i:null);if(h)return void(h.oneOff=h.oneOff&&n);const d=D(r,e.replace(A,"")),u=o?function(t,e,i){return function s(n){const o=t.querySelectorAll(e);for(let{target:r}=n;r&&r!==this;r=r.parentNode)for(let a=o.length;a--;)if(o[a]===r)return n.delegateTarget=r,s.oneOff&&$.off(t,n.type,e,i),i.apply(r,[n]);return null}}(t,i,s):function(t,e){return function i(s){return s.delegateTarget=t,i.oneOff&&$.off(t,s.type,e),e.apply(t,[s])}}(t,i);u.delegationSelector=o?i:null,u.originalHandler=r,u.oneOff=n,u.uidEvent=d,c[d]=u,t.addEventListener(a,u,o)}function j(t,e,i,s,n){const o=P(e[i],s,n);o&&(t.removeEventListener(i,o,Boolean(n)),delete e[i][o.uidEvent])}function H(t){return t=t.replace(T,""),S[t]||t}const $={on(t,e,i,s){M(t,e,i,s,!1)},one(t,e,i,s){M(t,e,i,s,!0)},off(t,e,i,s){if("string"!=typeof e||!t)return;const[n,o,r]=x(e,i,s),a=r!==e,l=I(t),c=e.startsWith(".");if(void 0!==o){if(!l||!l[r])return;return void j(t,l,r,o,n?i:null)}c&&Object.keys(l).forEach((i=>{!function(t,e,i,s){const n=e[i]||{};Object.keys(n).forEach((o=>{if(o.includes(s)){const s=n[o];j(t,e,i,s.originalHandler,s.delegationSelector)}}))}(t,l,i,e.slice(1))}));const h=l[r]||{};Object.keys(h).forEach((i=>{const s=i.replace(C,"");if(!a||e.includes(s)){const e=h[i];j(t,l,r,e.originalHandler,e.delegationSelector)}}))},trigger(t,e,i){if("string"!=typeof e||!t)return null;const s=p(),n=H(e),o=e!==n,r=N.has(n);let a,l=!0,c=!0,h=!1,d=null;return o&&s&&(a=s.Event(e,i),s(t).trigger(a),l=!a.isPropagationStopped(),c=!a.isImmediatePropagationStopped(),h=a.isDefaultPrevented()),r?(d=document.createEvent("HTMLEvents"),d.initEvent(n,l,!0)):d=new CustomEvent(e,{bubbles:l,cancelable:!0}),void 0!==i&&Object.keys(i).forEach((t=>{Object.defineProperty(d,t,{get:()=>i[t]})})),h&&d.preventDefault(),c&&t.dispatchEvent(d),d.defaultPrevented&&void 0!==a&&a.preventDefault(),d}},B=new Map,z={set(t,e,i){B.has(t)||B.set(t,new Map);const s=B.get(t);s.has(e)||0===s.size?s.set(e,i):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(s.keys())[0]}.`)},get:(t,e)=>B.has(t)&&B.get(t).get(e)||null,remove(t,e){if(!B.has(t))return;const i=B.get(t);i.delete(e),0===i.size&&B.delete(t)}};class R{constructor(t){(t=c(t))&&(this._element=t,z.set(this._element,this.constructor.DATA_KEY,this))}dispose(){z.remove(this._element,this.constructor.DATA_KEY),$.off(this._element,this.constructor.EVENT_KEY),Object.getOwnPropertyNames(this).forEach((t=>{this[t]=null}))}_queueCallback(t,e,i=!0){E(t,e,i)}static getInstance(t){return z.get(c(t),this.DATA_KEY)}static getOrCreateInstance(t,e={}){return this.getInstance(t)||new this(t,"object"==typeof e?e:null)}static get VERSION(){return"5.1.3"}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}}const F=(t,e="hide")=>{const i=`click.dismiss${t.EVENT_KEY}`,s=t.NAME;$.on(document,i,`[data-bs-dismiss="${s}"]`,(function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),u(this))return;const n=r(this)||this.closest(`.${s}`);t.getOrCreateInstance(n)[e]()}))};class q extends R{static get NAME(){return"alert"}close(){if($.trigger(this._element,"close.bs.alert").defaultPrevented)return;this._element.classList.remove("show");const t=this._element.classList.contains("fade");this._queueCallback((()=>this._destroyElement()),this._element,t)}_destroyElement(){this._element.remove(),$.trigger(this._element,"closed.bs.alert"),this.dispose()}static jQueryInterface(t){return this.each((function(){const e=q.getOrCreateInstance(this);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t](this)}}))}}F(q,"close"),v(q);const W='[data-bs-toggle="button"]';class U extends R{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(t){return this.each((function(){const e=U.getOrCreateInstance(this);"toggle"===t&&e[t]()}))}}function K(t){return"true"===t||"false"!==t&&(t===Number(t).toString()?Number(t):""===t||"null"===t?null:t)}function V(t){return t.replace(/[A-Z]/g,(t=>`-${t.toLowerCase()}`))}$.on(document,"click.bs.button.data-api",W,(t=>{t.preventDefault();const e=t.target.closest(W);U.getOrCreateInstance(e).toggle()})),v(U);const X={setDataAttribute(t,e,i){t.setAttribute(`data-bs-${V(e)}`,i)},removeDataAttribute(t,e){t.removeAttribute(`data-bs-${V(e)}`)},getDataAttributes(t){if(!t)return{};const e={};return Object.keys(t.dataset).filter((t=>t.startsWith("bs"))).forEach((i=>{let s=i.replace(/^bs/,"");s=s.charAt(0).toLowerCase()+s.slice(1,s.length),e[s]=K(t.dataset[i])})),e},getDataAttribute:(t,e)=>K(t.getAttribute(`data-bs-${V(e)}`)),offset(t){const e=t.getBoundingClientRect();return{top:e.top+window.pageYOffset,left:e.left+window.pageXOffset}},position:t=>({top:t.offsetTop,left:t.offsetLeft})},Y={find:(t,e=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(e,t)),findOne:(t,e=document.documentElement)=>Element.prototype.querySelector.call(e,t),children:(t,e)=>[].concat(...t.children).filter((t=>t.matches(e))),parents(t,e){const i=[];let s=t.parentNode;for(;s&&s.nodeType===Node.ELEMENT_NODE&&3!==s.nodeType;)s.matches(e)&&i.push(s),s=s.parentNode;return i},prev(t,e){let i=t.previousElementSibling;for(;i;){if(i.matches(e))return[i];i=i.previousElementSibling}return[]},next(t,e){let i=t.nextElementSibling;for(;i;){if(i.matches(e))return[i];i=i.nextElementSibling}return[]},focusableChildren(t){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map((t=>`${t}:not([tabindex^="-"])`)).join(", ");return this.find(e,t).filter((t=>!u(t)&&d(t)))}},Q="carousel",G={interval:5e3,keyboard:!0,slide:!1,pause:"hover",wrap:!0,touch:!0},Z={interval:"(number|boolean)",keyboard:"boolean",slide:"(boolean|string)",pause:"(string|boolean)",wrap:"boolean",touch:"boolean"},J="next",tt="prev",et="left",it="right",st={ArrowLeft:it,ArrowRight:et},nt="slid.bs.carousel",ot="active",rt=".active.carousel-item";class at extends R{constructor(t,e){super(t),this._items=null,this._interval=null,this._activeElement=null,this._isPaused=!1,this._isSliding=!1,this.touchTimeout=null,this.touchStartX=0,this.touchDeltaX=0,this._config=this._getConfig(e),this._indicatorsElement=Y.findOne(".carousel-indicators",this._element),this._touchSupported="ontouchstart"in document.documentElement||navigator.maxTouchPoints>0,this._pointerEvent=Boolean(window.PointerEvent),this._addEventListeners()}static get Default(){return G}static get NAME(){return Q}next(){this._slide(J)}nextWhenVisible(){!document.hidden&&d(this._element)&&this.next()}prev(){this._slide(tt)}pause(t){t||(this._isPaused=!0),Y.findOne(".carousel-item-next, .carousel-item-prev",this._element)&&(a(this._element),this.cycle(!0)),clearInterval(this._interval),this._interval=null}cycle(t){t||(this._isPaused=!1),this._interval&&(clearInterval(this._interval),this._interval=null),this._config&&this._config.interval&&!this._isPaused&&(this._updateInterval(),this._interval=setInterval((document.visibilityState?this.nextWhenVisible:this.next).bind(this),this._config.interval))}to(t){this._activeElement=Y.findOne(rt,this._element);const e=this._getItemIndex(this._activeElement);if(t>this._items.length-1||t<0)return;if(this._isSliding)return void $.one(this._element,nt,(()=>this.to(t)));if(e===t)return this.pause(),void this.cycle();const i=t>e?J:tt;this._slide(i,this._items[t])}_getConfig(t){return t={...G,...X.getDataAttributes(this._element),..."object"==typeof t?t:{}},h(Q,t,Z),t}_handleSwipe(){const t=Math.abs(this.touchDeltaX);if(t<=40)return;const e=t/this.touchDeltaX;this.touchDeltaX=0,e&&this._slide(e>0?it:et)}_addEventListeners(){this._config.keyboard&&$.on(this._element,"keydown.bs.carousel",(t=>this._keydown(t))),"hover"===this._config.pause&&($.on(this._element,"mouseenter.bs.carousel",(t=>this.pause(t))),$.on(this._element,"mouseleave.bs.carousel",(t=>this.cycle(t)))),this._config.touch&&this._touchSupported&&this._addTouchEventListeners()}_addTouchEventListeners(){const t=t=>this._pointerEvent&&("pen"===t.pointerType||"touch"===t.pointerType),e=e=>{t(e)?this.touchStartX=e.clientX:this._pointerEvent||(this.touchStartX=e.touches[0].clientX)},i=t=>{this.touchDeltaX=t.touches&&t.touches.length>1?0:t.touches[0].clientX-this.touchStartX},s=e=>{t(e)&&(this.touchDeltaX=e.clientX-this.touchStartX),this._handleSwipe(),"hover"===this._config.pause&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout((t=>this.cycle(t)),500+this._config.interval))};Y.find(".carousel-item img",this._element).forEach((t=>{$.on(t,"dragstart.bs.carousel",(t=>t.preventDefault()))})),this._pointerEvent?($.on(this._element,"pointerdown.bs.carousel",(t=>e(t))),$.on(this._element,"pointerup.bs.carousel",(t=>s(t))),this._element.classList.add("pointer-event")):($.on(this._element,"touchstart.bs.carousel",(t=>e(t))),$.on(this._element,"touchmove.bs.carousel",(t=>i(t))),$.on(this._element,"touchend.bs.carousel",(t=>s(t))))}_keydown(t){if(/input|textarea/i.test(t.target.tagName))return;const e=st[t.key];e&&(t.preventDefault(),this._slide(e))}_getItemIndex(t){return this._items=t&&t.parentNode?Y.find(".carousel-item",t.parentNode):[],this._items.indexOf(t)}_getItemByOrder(t,e){const i=t===J;return w(this._items,e,i,this._config.wrap)}_triggerSlideEvent(t,e){const i=this._getItemIndex(t),s=this._getItemIndex(Y.findOne(rt,this._element));return $.trigger(this._element,"slide.bs.carousel",{relatedTarget:t,direction:e,from:s,to:i})}_setActiveIndicatorElement(t){if(this._indicatorsElement){const e=Y.findOne(".active",this._indicatorsElement);e.classList.remove(ot),e.removeAttribute("aria-current");const i=Y.find("[data-bs-target]",this._indicatorsElement);for(let e=0;e<i.length;e++)if(Number.parseInt(i[e].getAttribute("data-bs-slide-to"),10)===this._getItemIndex(t)){i[e].classList.add(ot),i[e].setAttribute("aria-current","true");break}}}_updateInterval(){const t=this._activeElement||Y.findOne(rt,this._element);if(!t)return;const e=Number.parseInt(t.getAttribute("data-bs-interval"),10);e?(this._config.defaultInterval=this._config.defaultInterval||this._config.interval,this._config.interval=e):this._config.interval=this._config.defaultInterval||this._config.interval}_slide(t,e){const i=this._directionToOrder(t),s=Y.findOne(rt,this._element),n=this._getItemIndex(s),o=e||this._getItemByOrder(i,s),r=this._getItemIndex(o),a=Boolean(this._interval),l=i===J,c=l?"carousel-item-start":"carousel-item-end",h=l?"carousel-item-next":"carousel-item-prev",d=this._orderToDirection(i);if(o&&o.classList.contains(ot))return void(this._isSliding=!1);if(this._isSliding)return;if(this._triggerSlideEvent(o,d).defaultPrevented)return;if(!s||!o)return;this._isSliding=!0,a&&this.pause(),this._setActiveIndicatorElement(o),this._activeElement=o;const u=()=>{$.trigger(this._element,nt,{relatedTarget:o,direction:d,from:n,to:r})};if(this._element.classList.contains("slide")){o.classList.add(h),f(o),s.classList.add(c),o.classList.add(c);const t=()=>{o.classList.remove(c,h),o.classList.add(ot),s.classList.remove(ot,h,c),this._isSliding=!1,setTimeout(u,0)};this._queueCallback(t,s,!0)}else s.classList.remove(ot),o.classList.add(ot),this._isSliding=!1,u();a&&this.cycle()}_directionToOrder(t){return[it,et].includes(t)?b()?t===et?tt:J:t===et?J:tt:t}_orderToDirection(t){return[J,tt].includes(t)?b()?t===tt?et:it:t===tt?it:et:t}static carouselInterface(t,e){const i=at.getOrCreateInstance(t,e);let{_config:s}=i;"object"==typeof e&&(s={...s,...e});const n="string"==typeof e?e:s.slide;if("number"==typeof e)i.to(e);else if("string"==typeof n){if(void 0===i[n])throw new TypeError(`No method named "${n}"`);i[n]()}else s.interval&&s.ride&&(i.pause(),i.cycle())}static jQueryInterface(t){return this.each((function(){at.carouselInterface(this,t)}))}static dataApiClickHandler(t){const e=r(this);if(!e||!e.classList.contains("carousel"))return;const i={...X.getDataAttributes(e),...X.getDataAttributes(this)},s=this.getAttribute("data-bs-slide-to");s&&(i.interval=!1),at.carouselInterface(e,i),s&&at.getInstance(e).to(s),t.preventDefault()}}$.on(document,"click.bs.carousel.data-api","[data-bs-slide], [data-bs-slide-to]",at.dataApiClickHandler),$.on(window,"load.bs.carousel.data-api",(()=>{const t=Y.find('[data-bs-ride="carousel"]');for(let e=0,i=t.length;e<i;e++)at.carouselInterface(t[e],at.getInstance(t[e]))})),v(at);const lt="collapse",ct={toggle:!0,parent:null},ht={toggle:"boolean",parent:"(null|element)"},dt="show",ut="collapse",gt="collapsing",_t="collapsed",ft=":scope .collapse .collapse",pt='[data-bs-toggle="collapse"]';class mt extends R{constructor(t,e){super(t),this._isTransitioning=!1,this._config=this._getConfig(e),this._triggerArray=[];const i=Y.find(pt);for(let t=0,e=i.length;t<e;t++){const e=i[t],s=o(e),n=Y.find(s).filter((t=>t===this._element));null!==s&&n.length&&(this._selector=s,this._triggerArray.push(e))}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return ct}static get NAME(){return lt}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let t,e=[];if(this._config.parent){const t=Y.find(ft,this._config.parent);e=Y.find(".collapse.show, .collapse.collapsing",this._config.parent).filter((e=>!t.includes(e)))}const i=Y.findOne(this._selector);if(e.length){const s=e.find((t=>i!==t));if(t=s?mt.getInstance(s):null,t&&t._isTransitioning)return}if($.trigger(this._element,"show.bs.collapse").defaultPrevented)return;e.forEach((e=>{i!==e&&mt.getOrCreateInstance(e,{toggle:!1}).hide(),t||z.set(e,"bs.collapse",null)}));const s=this._getDimension();this._element.classList.remove(ut),this._element.classList.add(gt),this._element.style[s]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const n=`scroll${s[0].toUpperCase()+s.slice(1)}`;this._queueCallback((()=>{this._isTransitioning=!1,this._element.classList.remove(gt),this._element.classList.add(ut,dt),this._element.style[s]="",$.trigger(this._element,"shown.bs.collapse")}),this._element,!0),this._element.style[s]=`${this._element[n]}px`}hide(){if(this._isTransitioning||!this._isShown())return;if($.trigger(this._element,"hide.bs.collapse").defaultPrevented)return;const t=this._getDimension();this._element.style[t]=`${this._element.getBoundingClientRect()[t]}px`,f(this._element),this._element.classList.add(gt),this._element.classList.remove(ut,dt);const e=this._triggerArray.length;for(let t=0;t<e;t++){const e=this._triggerArray[t],i=r(e);i&&!this._isShown(i)&&this._addAriaAndCollapsedClass([e],!1)}this._isTransitioning=!0,this._element.style[t]="",this._queueCallback((()=>{this._isTransitioning=!1,this._element.classList.remove(gt),this._element.classList.add(ut),$.trigger(this._element,"hidden.bs.collapse")}),this._element,!0)}_isShown(t=this._element){return t.classList.contains(dt)}_getConfig(t){return(t={...ct,...X.getDataAttributes(this._element),...t}).toggle=Boolean(t.toggle),t.parent=c(t.parent),h(lt,t,ht),t}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(!this._config.parent)return;const t=Y.find(ft,this._config.parent);Y.find(pt,this._config.parent).filter((e=>!t.includes(e))).forEach((t=>{const e=r(t);e&&this._addAriaAndCollapsedClass([t],this._isShown(e))}))}_addAriaAndCollapsedClass(t,e){t.length&&t.forEach((t=>{e?t.classList.remove(_t):t.classList.add(_t),t.setAttribute("aria-expanded",e)}))}static jQueryInterface(t){return this.each((function(){const e={};"string"==typeof t&&/show|hide/.test(t)&&(e.toggle=!1);const i=mt.getOrCreateInstance(this,e);if("string"==typeof t){if(void 0===i[t])throw new TypeError(`No method named "${t}"`);i[t]()}}))}}$.on(document,"click.bs.collapse.data-api",pt,(function(t){("A"===t.target.tagName||t.delegateTarget&&"A"===t.delegateTarget.tagName)&&t.preventDefault();const e=o(this);Y.find(e).forEach((t=>{mt.getOrCreateInstance(t,{toggle:!1}).toggle()}))})),v(mt);const bt="dropdown",vt="Escape",yt="Space",Et="ArrowUp",wt="ArrowDown",At=new RegExp("ArrowUp|ArrowDown|Escape"),Tt="click.bs.dropdown.data-api",Ct="keydown.bs.dropdown.data-api",kt="show",Lt='[data-bs-toggle="dropdown"]',St=".dropdown-menu",Ot=b()?"top-end":"top-start",Nt=b()?"top-start":"top-end",Dt=b()?"bottom-end":"bottom-start",It=b()?"bottom-start":"bottom-end",Pt=b()?"left-start":"right-start",xt=b()?"right-start":"left-start",Mt={offset:[0,2],boundary:"clippingParents",reference:"toggle",display:"dynamic",popperConfig:null,autoClose:!0},jt={offset:"(array|string|function)",boundary:"(string|element)",reference:"(string|element|object)",display:"string",popperConfig:"(null|object|function)",autoClose:"(boolean|string)"};class Ht extends R{constructor(t,e){super(t),this._popper=null,this._config=this._getConfig(e),this._menu=this._getMenuElement(),this._inNavbar=this._detectNavbar()}static get Default(){return Mt}static get DefaultType(){return jt}static get NAME(){return bt}toggle(){return this._isShown()?this.hide():this.show()}show(){if(u(this._element)||this._isShown(this._menu))return;const t={relatedTarget:this._element};if($.trigger(this._element,"show.bs.dropdown",t).defaultPrevented)return;const e=Ht.getParentFromElement(this._element);this._inNavbar?X.setDataAttribute(this._menu,"popper","none"):this._createPopper(e),"ontouchstart"in document.documentElement&&!e.closest(".navbar-nav")&&[].concat(...document.body.children).forEach((t=>$.on(t,"mouseover",_))),this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(kt),this._element.classList.add(kt),$.trigger(this._element,"shown.bs.dropdown",t)}hide(){if(u(this._element)||!this._isShown(this._menu))return;const t={relatedTarget:this._element};this._completeHide(t)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(t){$.trigger(this._element,"hide.bs.dropdown",t).defaultPrevented||("ontouchstart"in document.documentElement&&[].concat(...document.body.children).forEach((t=>$.off(t,"mouseover",_))),this._popper&&this._popper.destroy(),this._menu.classList.remove(kt),this._element.classList.remove(kt),this._element.setAttribute("aria-expanded","false"),X.removeDataAttribute(this._menu,"popper"),$.trigger(this._element,"hidden.bs.dropdown",t))}_getConfig(t){if(t={...this.constructor.Default,...X.getDataAttributes(this._element),...t},h(bt,t,this.constructor.DefaultType),"object"==typeof t.reference&&!l(t.reference)&&"function"!=typeof t.reference.getBoundingClientRect)throw new TypeError(`${bt.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return t}_createPopper(t){if(void 0===i)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");let e=this._element;"parent"===this._config.reference?e=t:l(this._config.reference)?e=c(this._config.reference):"object"==typeof this._config.reference&&(e=this._config.reference);const s=this._getPopperConfig(),n=s.modifiers.find((t=>"applyStyles"===t.name&&!1===t.enabled));this._popper=i.createPopper(e,this._menu,s),n&&X.setDataAttribute(this._menu,"popper","static")}_isShown(t=this._element){return t.classList.contains(kt)}_getMenuElement(){return Y.next(this._element,St)[0]}_getPlacement(){const t=this._element.parentNode;if(t.classList.contains("dropend"))return Pt;if(t.classList.contains("dropstart"))return xt;const e="end"===getComputedStyle(this._menu).getPropertyValue("--bs-position").trim();return t.classList.contains("dropup")?e?Nt:Ot:e?It:Dt}_detectNavbar(){return null!==this._element.closest(".navbar")}_getOffset(){const{offset:t}=this._config;return"string"==typeof t?t.split(",").map((t=>Number.parseInt(t,10))):"function"==typeof t?e=>t(e,this._element):t}_getPopperConfig(){const t={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return"static"===this._config.display&&(t.modifiers=[{name:"applyStyles",enabled:!1}]),{...t,..."function"==typeof this._config.popperConfig?this._config.popperConfig(t):this._config.popperConfig}}_selectMenuItem({key:t,target:e}){const i=Y.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter(d);i.length&&w(i,e,t===wt,!i.includes(e)).focus()}static jQueryInterface(t){return this.each((function(){const e=Ht.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}}))}static clearMenus(t){if(t&&(2===t.button||"keyup"===t.type&&"Tab"!==t.key))return;const e=Y.find(Lt);for(let i=0,s=e.length;i<s;i++){const s=Ht.getInstance(e[i]);if(!s||!1===s._config.autoClose)continue;if(!s._isShown())continue;const n={relatedTarget:s._element};if(t){const e=t.composedPath(),i=e.includes(s._menu);if(e.includes(s._element)||"inside"===s._config.autoClose&&!i||"outside"===s._config.autoClose&&i)continue;if(s._menu.contains(t.target)&&("keyup"===t.type&&"Tab"===t.key||/input|select|option|textarea|form/i.test(t.target.tagName)))continue;"click"===t.type&&(n.clickEvent=t)}s._completeHide(n)}}static getParentFromElement(t){return r(t)||t.parentNode}static dataApiKeydownHandler(t){if(/input|textarea/i.test(t.target.tagName)?t.key===yt||t.key!==vt&&(t.key!==wt&&t.key!==Et||t.target.closest(St)):!At.test(t.key))return;const e=this.classList.contains(kt);if(!e&&t.key===vt)return;if(t.preventDefault(),t.stopPropagation(),u(this))return;const i=this.matches(Lt)?this:Y.prev(this,Lt)[0],s=Ht.getOrCreateInstance(i);if(t.key!==vt)return t.key===Et||t.key===wt?(e||s.show(),void s._selectMenuItem(t)):void(e&&t.key!==yt||Ht.clearMenus());s.hide()}}$.on(document,Ct,Lt,Ht.dataApiKeydownHandler),$.on(document,Ct,St,Ht.dataApiKeydownHandler),$.on(document,Tt,Ht.clearMenus),$.on(document,"keyup.bs.dropdown.data-api",Ht.clearMenus),$.on(document,Tt,Lt,(function(t){t.preventDefault(),Ht.getOrCreateInstance(this).toggle()})),v(Ht);const $t=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Bt=".sticky-top";class zt{constructor(){this._element=document.body}getWidth(){const t=document.documentElement.clientWidth;return Math.abs(window.innerWidth-t)}hide(){const t=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,"paddingRight",(e=>e+t)),this._setElementAttributes($t,"paddingRight",(e=>e+t)),this._setElementAttributes(Bt,"marginRight",(e=>e-t))}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(t,e,i){const s=this.getWidth();this._applyManipulationCallback(t,(t=>{if(t!==this._element&&window.innerWidth>t.clientWidth+s)return;this._saveInitialAttribute(t,e);const n=window.getComputedStyle(t)[e];t.style[e]=`${i(Number.parseFloat(n))}px`}))}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,"paddingRight"),this._resetElementAttributes($t,"paddingRight"),this._resetElementAttributes(Bt,"marginRight")}_saveInitialAttribute(t,e){const i=t.style[e];i&&X.setDataAttribute(t,e,i)}_resetElementAttributes(t,e){this._applyManipulationCallback(t,(t=>{const i=X.getDataAttribute(t,e);void 0===i?t.style.removeProperty(e):(X.removeDataAttribute(t,e),t.style[e]=i)}))}_applyManipulationCallback(t,e){l(t)?e(t):Y.find(t,this._element).forEach(e)}isOverflowing(){return this.getWidth()>0}}const Rt={className:"modal-backdrop",isVisible:!0,isAnimated:!1,rootElement:"body",clickCallback:null},Ft={className:"string",isVisible:"boolean",isAnimated:"boolean",rootElement:"(element|string)",clickCallback:"(function|null)"},qt="show",Wt="mousedown.bs.backdrop";class Ut{constructor(t){this._config=this._getConfig(t),this._isAppended=!1,this._element=null}show(t){this._config.isVisible?(this._append(),this._config.isAnimated&&f(this._getElement()),this._getElement().classList.add(qt),this._emulateAnimation((()=>{y(t)}))):y(t)}hide(t){this._config.isVisible?(this._getElement().classList.remove(qt),this._emulateAnimation((()=>{this.dispose(),y(t)}))):y(t)}_getElement(){if(!this._element){const t=document.createElement("div");t.className=this._config.className,this._config.isAnimated&&t.classList.add("fade"),this._element=t}return this._element}_getConfig(t){return(t={...Rt,..."object"==typeof t?t:{}}).rootElement=c(t.rootElement),h("backdrop",t,Ft),t}_append(){this._isAppended||(this._config.rootElement.append(this._getElement()),$.on(this._getElement(),Wt,(()=>{y(this._config.clickCallback)})),this._isAppended=!0)}dispose(){this._isAppended&&($.off(this._element,Wt),this._element.remove(),this._isAppended=!1)}_emulateAnimation(t){E(t,this._getElement(),this._config.isAnimated)}}const Kt={trapElement:null,autofocus:!0},Vt={trapElement:"element",autofocus:"boolean"},Xt=".bs.focustrap",Yt="backward";class Qt{constructor(t){this._config=this._getConfig(t),this._isActive=!1,this._lastTabNavDirection=null}activate(){const{trapElement:t,autofocus:e}=this._config;this._isActive||(e&&t.focus(),$.off(document,Xt),$.on(document,"focusin.bs.focustrap",(t=>this._handleFocusin(t))),$.on(document,"keydown.tab.bs.focustrap",(t=>this._handleKeydown(t))),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,$.off(document,Xt))}_handleFocusin(t){const{target:e}=t,{trapElement:i}=this._config;if(e===document||e===i||i.contains(e))return;const s=Y.focusableChildren(i);0===s.length?i.focus():this._lastTabNavDirection===Yt?s[s.length-1].focus():s[0].focus()}_handleKeydown(t){"Tab"===t.key&&(this._lastTabNavDirection=t.shiftKey?Yt:"forward")}_getConfig(t){return t={...Kt,..."object"==typeof t?t:{}},h("focustrap",t,Vt),t}}const Gt="modal",Zt="Escape",Jt={backdrop:!0,keyboard:!0,focus:!0},te={backdrop:"(boolean|string)",keyboard:"boolean",focus:"boolean"},ee="hidden.bs.modal",ie="show.bs.modal",se="resize.bs.modal",ne="click.dismiss.bs.modal",oe="keydown.dismiss.bs.modal",re="mousedown.dismiss.bs.modal",ae="modal-open",le="show",ce="modal-static";class he extends R{constructor(t,e){super(t),this._config=this._getConfig(e),this._dialog=Y.findOne(".modal-dialog",this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._ignoreBackdropClick=!1,this._isTransitioning=!1,this._scrollBar=new zt}static get Default(){return Jt}static get NAME(){return Gt}toggle(t){return this._isShown?this.hide():this.show(t)}show(t){this._isShown||this._isTransitioning||$.trigger(this._element,ie,{relatedTarget:t}).defaultPrevented||(this._isShown=!0,this._isAnimated()&&(this._isTransitioning=!0),this._scrollBar.hide(),document.body.classList.add(ae),this._adjustDialog(),this._setEscapeEvent(),this._setResizeEvent(),$.on(this._dialog,re,(()=>{$.one(this._element,"mouseup.dismiss.bs.modal",(t=>{t.target===this._element&&(this._ignoreBackdropClick=!0)}))})),this._showBackdrop((()=>this._showElement(t))))}hide(){if(!this._isShown||this._isTransitioning)return;if($.trigger(this._element,"hide.bs.modal").defaultPrevented)return;this._isShown=!1;const t=this._isAnimated();t&&(this._isTransitioning=!0),this._setEscapeEvent(),this._setResizeEvent(),this._focustrap.deactivate(),this._element.classList.remove(le),$.off(this._element,ne),$.off(this._dialog,re),this._queueCallback((()=>this._hideModal()),this._element,t)}dispose(){[window,this._dialog].forEach((t=>$.off(t,".bs.modal"))),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Ut({isVisible:Boolean(this._config.backdrop),isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new Qt({trapElement:this._element})}_getConfig(t){return t={...Jt,...X.getDataAttributes(this._element),..."object"==typeof t?t:{}},h(Gt,t,te),t}_showElement(t){const e=this._isAnimated(),i=Y.findOne(".modal-body",this._dialog);this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0,i&&(i.scrollTop=0),e&&f(this._element),this._element.classList.add(le),this._queueCallback((()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,$.trigger(this._element,"shown.bs.modal",{relatedTarget:t})}),this._dialog,e)}_setEscapeEvent(){this._isShown?$.on(this._element,oe,(t=>{this._config.keyboard&&t.key===Zt?(t.preventDefault(),this.hide()):this._config.keyboard||t.key!==Zt||this._triggerBackdropTransition()})):$.off(this._element,oe)}_setResizeEvent(){this._isShown?$.on(window,se,(()=>this._adjustDialog())):$.off(window,se)}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide((()=>{document.body.classList.remove(ae),this._resetAdjustments(),this._scrollBar.reset(),$.trigger(this._element,ee)}))}_showBackdrop(t){$.on(this._element,ne,(t=>{this._ignoreBackdropClick?this._ignoreBackdropClick=!1:t.target===t.currentTarget&&(!0===this._config.backdrop?this.hide():"static"===this._config.backdrop&&this._triggerBackdropTransition())})),this._backdrop.show(t)}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if($.trigger(this._element,"hidePrevented.bs.modal").defaultPrevented)return;const{classList:t,scrollHeight:e,style:i}=this._element,s=e>document.documentElement.clientHeight;!s&&"hidden"===i.overflowY||t.contains(ce)||(s||(i.overflowY="hidden"),t.add(ce),this._queueCallback((()=>{t.remove(ce),s||this._queueCallback((()=>{i.overflowY=""}),this._dialog)}),this._dialog),this._element.focus())}_adjustDialog(){const t=this._element.scrollHeight>document.documentElement.clientHeight,e=this._scrollBar.getWidth(),i=e>0;(!i&&t&&!b()||i&&!t&&b())&&(this._element.style.paddingLeft=`${e}px`),(i&&!t&&!b()||!i&&t&&b())&&(this._element.style.paddingRight=`${e}px`)}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(t,e){return this.each((function(){const i=he.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===i[t])throw new TypeError(`No method named "${t}"`);i[t](e)}}))}}$.on(document,"click.bs.modal.data-api",'[data-bs-toggle="modal"]',(function(t){const e=r(this);["A","AREA"].includes(this.tagName)&&t.preventDefault(),$.one(e,ie,(t=>{t.defaultPrevented||$.one(e,ee,(()=>{d(this)&&this.focus()}))}));const i=Y.findOne(".modal.show");i&&he.getInstance(i).hide(),he.getOrCreateInstance(e).toggle(this)})),F(he),v(he);const de="offcanvas",ue={backdrop:!0,keyboard:!0,scroll:!1},ge={backdrop:"boolean",keyboard:"boolean",scroll:"boolean"},_e="show",fe=".offcanvas.show",pe="hidden.bs.offcanvas";class me extends R{constructor(t,e){super(t),this._config=this._getConfig(e),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get NAME(){return de}static get Default(){return ue}toggle(t){return this._isShown?this.hide():this.show(t)}show(t){this._isShown||$.trigger(this._element,"show.bs.offcanvas",{relatedTarget:t}).defaultPrevented||(this._isShown=!0,this._element.style.visibility="visible",this._backdrop.show(),this._config.scroll||(new zt).hide(),this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(_e),this._queueCallback((()=>{this._config.scroll||this._focustrap.activate(),$.trigger(this._element,"shown.bs.offcanvas",{relatedTarget:t})}),this._element,!0))}hide(){this._isShown&&($.trigger(this._element,"hide.bs.offcanvas").defaultPrevented||(this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.remove(_e),this._backdrop.hide(),this._queueCallback((()=>{this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._element.style.visibility="hidden",this._config.scroll||(new zt).reset(),$.trigger(this._element,pe)}),this._element,!0)))}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_getConfig(t){return t={...ue,...X.getDataAttributes(this._element),..."object"==typeof t?t:{}},h(de,t,ge),t}_initializeBackDrop(){return new Ut({className:"offcanvas-backdrop",isVisible:this._config.backdrop,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:()=>this.hide()})}_initializeFocusTrap(){return new Qt({trapElement:this._element})}_addEventListeners(){$.on(this._element,"keydown.dismiss.bs.offcanvas",(t=>{this._config.keyboard&&"Escape"===t.key&&this.hide()}))}static jQueryInterface(t){return this.each((function(){const e=me.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t](this)}}))}}$.on(document,"click.bs.offcanvas.data-api",'[data-bs-toggle="offcanvas"]',(function(t){const e=r(this);if(["A","AREA"].includes(this.tagName)&&t.preventDefault(),u(this))return;$.one(e,pe,(()=>{d(this)&&this.focus()}));const i=Y.findOne(fe);i&&i!==e&&me.getInstance(i).hide(),me.getOrCreateInstance(e).toggle(this)})),$.on(window,"load.bs.offcanvas.data-api",(()=>Y.find(fe).forEach((t=>me.getOrCreateInstance(t).show())))),F(me),v(me);const be=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),ve=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^#&/:?]*(?:[#/?]|$))/i,ye=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[\d+/a-z]+=*$/i,Ee=(t,e)=>{const i=t.nodeName.toLowerCase();if(e.includes(i))return!be.has(i)||Boolean(ve.test(t.nodeValue)||ye.test(t.nodeValue));const s=e.filter((t=>t instanceof RegExp));for(let t=0,e=s.length;t<e;t++)if(s[t].test(i))return!0;return!1};function we(t,e,i){if(!t.length)return t;if(i&&"function"==typeof i)return i(t);const s=(new window.DOMParser).parseFromString(t,"text/html"),n=[].concat(...s.body.querySelectorAll("*"));for(let t=0,i=n.length;t<i;t++){const i=n[t],s=i.nodeName.toLowerCase();if(!Object.keys(e).includes(s)){i.remove();continue}const o=[].concat(...i.attributes),r=[].concat(e["*"]||[],e[s]||[]);o.forEach((t=>{Ee(t,r)||i.removeAttribute(t.nodeName)}))}return s.body.innerHTML}const Ae="tooltip",Te=new Set(["sanitize","allowList","sanitizeFn"]),Ce={animation:"boolean",template:"string",title:"(string|element|function)",trigger:"string",delay:"(number|object)",html:"boolean",selector:"(string|boolean)",placement:"(string|function)",offset:"(array|string|function)",container:"(string|element|boolean)",fallbackPlacements:"array",boundary:"(string|element)",customClass:"(string|function)",sanitize:"boolean",sanitizeFn:"(null|function)",allowList:"object",popperConfig:"(null|object|function)"},ke={AUTO:"auto",TOP:"top",RIGHT:b()?"left":"right",BOTTOM:"bottom",LEFT:b()?"right":"left"},Le={animation:!0,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,selector:!1,placement:"top",offset:[0,0],container:!1,fallbackPlacements:["top","right","bottom","left"],boundary:"clippingParents",customClass:"",sanitize:!0,sanitizeFn:null,allowList:{"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},popperConfig:null},Se={HIDE:"hide.bs.tooltip",HIDDEN:"hidden.bs.tooltip",SHOW:"show.bs.tooltip",SHOWN:"shown.bs.tooltip",INSERTED:"inserted.bs.tooltip",CLICK:"click.bs.tooltip",FOCUSIN:"focusin.bs.tooltip",FOCUSOUT:"focusout.bs.tooltip",MOUSEENTER:"mouseenter.bs.tooltip",MOUSELEAVE:"mouseleave.bs.tooltip"},Oe="fade",Ne="show",De="show",Ie="out",Pe=".tooltip-inner",xe=".modal",Me="hide.bs.modal",je="hover",He="focus";class $e extends R{constructor(t,e){if(void 0===i)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(t),this._isEnabled=!0,this._timeout=0,this._hoverState="",this._activeTrigger={},this._popper=null,this._config=this._getConfig(e),this.tip=null,this._setListeners()}static get Default(){return Le}static get NAME(){return Ae}static get Event(){return Se}static get DefaultType(){return Ce}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(t){if(this._isEnabled)if(t){const e=this._initializeOnDelegatedTarget(t);e._activeTrigger.click=!e._activeTrigger.click,e._isWithActiveTrigger()?e._enter(null,e):e._leave(null,e)}else{if(this.getTipElement().classList.contains(Ne))return void this._leave(null,this);this._enter(null,this)}}dispose(){clearTimeout(this._timeout),$.off(this._element.closest(xe),Me,this._hideModalHandler),this.tip&&this.tip.remove(),this._disposePopper(),super.dispose()}show(){if("none"===this._element.style.display)throw new Error("Please use show on visible elements");if(!this.isWithContent()||!this._isEnabled)return;const t=$.trigger(this._element,this.constructor.Event.SHOW),e=g(this._element),s=null===e?this._element.ownerDocument.documentElement.contains(this._element):e.contains(this._element);if(t.defaultPrevented||!s)return;"tooltip"===this.constructor.NAME&&this.tip&&this.getTitle()!==this.tip.querySelector(Pe).innerHTML&&(this._disposePopper(),this.tip.remove(),this.tip=null);const n=this.getTipElement(),o=(t=>{do{t+=Math.floor(1e6*Math.random())}while(document.getElementById(t));return t})(this.constructor.NAME);n.setAttribute("id",o),this._element.setAttribute("aria-describedby",o),this._config.animation&&n.classList.add(Oe);const r="function"==typeof this._config.placement?this._config.placement.call(this,n,this._element):this._config.placement,a=this._getAttachment(r);this._addAttachmentClass(a);const{container:l}=this._config;z.set(n,this.constructor.DATA_KEY,this),this._element.ownerDocument.documentElement.contains(this.tip)||(l.append(n),$.trigger(this._element,this.constructor.Event.INSERTED)),this._popper?this._popper.update():this._popper=i.createPopper(this._element,n,this._getPopperConfig(a)),n.classList.add(Ne);const c=this._resolvePossibleFunction(this._config.customClass);c&&n.classList.add(...c.split(" ")),"ontouchstart"in document.documentElement&&[].concat(...document.body.children).forEach((t=>{$.on(t,"mouseover",_)}));const h=this.tip.classList.contains(Oe);this._queueCallback((()=>{const t=this._hoverState;this._hoverState=null,$.trigger(this._element,this.constructor.Event.SHOWN),t===Ie&&this._leave(null,this)}),this.tip,h)}hide(){if(!this._popper)return;const t=this.getTipElement();if($.trigger(this._element,this.constructor.Event.HIDE).defaultPrevented)return;t.classList.remove(Ne),"ontouchstart"in document.documentElement&&[].concat(...document.body.children).forEach((t=>$.off(t,"mouseover",_))),this._activeTrigger.click=!1,this._activeTrigger.focus=!1,this._activeTrigger.hover=!1;const e=this.tip.classList.contains(Oe);this._queueCallback((()=>{this._isWithActiveTrigger()||(this._hoverState!==De&&t.remove(),this._cleanTipClass(),this._element.removeAttribute("aria-describedby"),$.trigger(this._element,this.constructor.Event.HIDDEN),this._disposePopper())}),this.tip,e),this._hoverState=""}update(){null!==this._popper&&this._popper.update()}isWithContent(){return Boolean(this.getTitle())}getTipElement(){if(this.tip)return this.tip;const t=document.createElement("div");t.innerHTML=this._config.template;const e=t.children[0];return this.setContent(e),e.classList.remove(Oe,Ne),this.tip=e,this.tip}setContent(t){this._sanitizeAndSetContent(t,this.getTitle(),Pe)}_sanitizeAndSetContent(t,e,i){const s=Y.findOne(i,t);e||!s?this.setElementContent(s,e):s.remove()}setElementContent(t,e){if(null!==t)return l(e)?(e=c(e),void(this._config.html?e.parentNode!==t&&(t.innerHTML="",t.append(e)):t.textContent=e.textContent)):void(this._config.html?(this._config.sanitize&&(e=we(e,this._config.allowList,this._config.sanitizeFn)),t.innerHTML=e):t.textContent=e)}getTitle(){const t=this._element.getAttribute("data-bs-original-title")||this._config.title;return this._resolvePossibleFunction(t)}updateAttachment(t){return"right"===t?"end":"left"===t?"start":t}_initializeOnDelegatedTarget(t,e){return e||this.constructor.getOrCreateInstance(t.delegateTarget,this._getDelegateConfig())}_getOffset(){const{offset:t}=this._config;return"string"==typeof t?t.split(",").map((t=>Number.parseInt(t,10))):"function"==typeof t?e=>t(e,this._element):t}_resolvePossibleFunction(t){return"function"==typeof t?t.call(this._element):t}_getPopperConfig(t){const e={placement:t,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"onChange",enabled:!0,phase:"afterWrite",fn:t=>this._handlePopperPlacementChange(t)}],onFirstUpdate:t=>{t.options.placement!==t.placement&&this._handlePopperPlacementChange(t)}};return{...e,..."function"==typeof this._config.popperConfig?this._config.popperConfig(e):this._config.popperConfig}}_addAttachmentClass(t){this.getTipElement().classList.add(`${this._getBasicClassPrefix()}-${this.updateAttachment(t)}`)}_getAttachment(t){return ke[t.toUpperCase()]}_setListeners(){this._config.trigger.split(" ").forEach((t=>{if("click"===t)$.on(this._element,this.constructor.Event.CLICK,this._config.selector,(t=>this.toggle(t)));else if("manual"!==t){const e=t===je?this.constructor.Event.MOUSEENTER:this.constructor.Event.FOCUSIN,i=t===je?this.constructor.Event.MOUSELEAVE:this.constructor.Event.FOCUSOUT;$.on(this._element,e,this._config.selector,(t=>this._enter(t))),$.on(this._element,i,this._config.selector,(t=>this._leave(t)))}})),this._hideModalHandler=()=>{this._element&&this.hide()},$.on(this._element.closest(xe),Me,this._hideModalHandler),this._config.selector?this._config={...this._config,trigger:"manual",selector:""}:this._fixTitle()}_fixTitle(){const t=this._element.getAttribute("title"),e=typeof this._element.getAttribute("data-bs-original-title");(t||"string"!==e)&&(this._element.setAttribute("data-bs-original-title",t||""),!t||this._element.getAttribute("aria-label")||this._element.textContent||this._element.setAttribute("aria-label",t),this._element.setAttribute("title",""))}_enter(t,e){e=this._initializeOnDelegatedTarget(t,e),t&&(e._activeTrigger["focusin"===t.type?He:je]=!0),e.getTipElement().classList.contains(Ne)||e._hoverState===De?e._hoverState=De:(clearTimeout(e._timeout),e._hoverState=De,e._config.delay&&e._config.delay.show?e._timeout=setTimeout((()=>{e._hoverState===De&&e.show()}),e._config.delay.show):e.show())}_leave(t,e){e=this._initializeOnDelegatedTarget(t,e),t&&(e._activeTrigger["focusout"===t.type?He:je]=e._element.contains(t.relatedTarget)),e._isWithActiveTrigger()||(clearTimeout(e._timeout),e._hoverState=Ie,e._config.delay&&e._config.delay.hide?e._timeout=setTimeout((()=>{e._hoverState===Ie&&e.hide()}),e._config.delay.hide):e.hide())}_isWithActiveTrigger(){for(const t in this._activeTrigger)if(this._activeTrigger[t])return!0;return!1}_getConfig(t){const e=X.getDataAttributes(this._element);return Object.keys(e).forEach((t=>{Te.has(t)&&delete e[t]})),(t={...this.constructor.Default,...e,..."object"==typeof t&&t?t:{}}).container=!1===t.container?document.body:c(t.container),"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),"number"==typeof t.title&&(t.title=t.title.toString()),"number"==typeof t.content&&(t.content=t.content.toString()),h(Ae,t,this.constructor.DefaultType),t.sanitize&&(t.template=we(t.template,t.allowList,t.sanitizeFn)),t}_getDelegateConfig(){const t={};for(const e in this._config)this.constructor.Default[e]!==this._config[e]&&(t[e]=this._config[e]);return t}_cleanTipClass(){const t=this.getTipElement(),e=new RegExp(`(^|\\s)${this._getBasicClassPrefix()}\\S+`,"g"),i=t.getAttribute("class").match(e);null!==i&&i.length>0&&i.map((t=>t.trim())).forEach((e=>t.classList.remove(e)))}_getBasicClassPrefix(){return"bs-tooltip"}_handlePopperPlacementChange(t){const{state:e}=t;e&&(this.tip=e.elements.popper,this._cleanTipClass(),this._addAttachmentClass(this._getAttachment(e.placement)))}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null)}static jQueryInterface(t){return this.each((function(){const e=$e.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}}))}}v($e);const Be={...$e.Default,placement:"right",offset:[0,8],trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>'},ze={...$e.DefaultType,content:"(string|element|function)"},Re={HIDE:"hide.bs.popover",HIDDEN:"hidden.bs.popover",SHOW:"show.bs.popover",SHOWN:"shown.bs.popover",INSERTED:"inserted.bs.popover",CLICK:"click.bs.popover",FOCUSIN:"focusin.bs.popover",FOCUSOUT:"focusout.bs.popover",MOUSEENTER:"mouseenter.bs.popover",MOUSELEAVE:"mouseleave.bs.popover"};class Fe extends $e{static get Default(){return Be}static get NAME(){return"popover"}static get Event(){return Re}static get DefaultType(){return ze}isWithContent(){return this.getTitle()||this._getContent()}setContent(t){this._sanitizeAndSetContent(t,this.getTitle(),".popover-header"),this._sanitizeAndSetContent(t,this._getContent(),".popover-body")}_getContent(){return this._resolvePossibleFunction(this._config.content)}_getBasicClassPrefix(){return"bs-popover"}static jQueryInterface(t){return this.each((function(){const e=Fe.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}}))}}v(Fe);const qe="scrollspy",We={offset:10,method:"auto",target:""},Ue={offset:"number",method:"string",target:"(string|element)"},Ke="active",Ve=".nav-link, .list-group-item, .dropdown-item",Xe="position";class Ye extends R{constructor(t,e){super(t),this._scrollElement="BODY"===this._element.tagName?window:this._element,this._config=this._getConfig(e),this._offsets=[],this._targets=[],this._activeTarget=null,this._scrollHeight=0,$.on(this._scrollElement,"scroll.bs.scrollspy",(()=>this._process())),this.refresh(),this._process()}static get Default(){return We}static get NAME(){return qe}refresh(){const t=this._scrollElement===this._scrollElement.window?"offset":Xe,e="auto"===this._config.method?t:this._config.method,i=e===Xe?this._getScrollTop():0;this._offsets=[],this._targets=[],this._scrollHeight=this._getScrollHeight(),Y.find(Ve,this._config.target).map((t=>{const s=o(t),n=s?Y.findOne(s):null;if(n){const t=n.getBoundingClientRect();if(t.width||t.height)return[X[e](n).top+i,s]}return null})).filter((t=>t)).sort(((t,e)=>t[0]-e[0])).forEach((t=>{this._offsets.push(t[0]),this._targets.push(t[1])}))}dispose(){$.off(this._scrollElement,".bs.scrollspy"),super.dispose()}_getConfig(t){return(t={...We,...X.getDataAttributes(this._element),..."object"==typeof t&&t?t:{}}).target=c(t.target)||document.documentElement,h(qe,t,Ue),t}_getScrollTop(){return this._scrollElement===window?this._scrollElement.pageYOffset:this._scrollElement.scrollTop}_getScrollHeight(){return this._scrollElement.scrollHeight||Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)}_getOffsetHeight(){return this._scrollElement===window?window.innerHeight:this._scrollElement.getBoundingClientRect().height}_process(){const t=this._getScrollTop()+this._config.offset,e=this._getScrollHeight(),i=this._config.offset+e-this._getOffsetHeight();if(this._scrollHeight!==e&&this.refresh(),t>=i){const t=this._targets[this._targets.length-1];this._activeTarget!==t&&this._activate(t)}else{if(this._activeTarget&&t<this._offsets[0]&&this._offsets[0]>0)return this._activeTarget=null,void this._clear();for(let e=this._offsets.length;e--;)this._activeTarget!==this._targets[e]&&t>=this._offsets[e]&&(void 0===this._offsets[e+1]||t<this._offsets[e+1])&&this._activate(this._targets[e])}}_activate(t){this._activeTarget=t,this._clear();const e=Ve.split(",").map((e=>`${e}[data-bs-target="${t}"],${e}[href="${t}"]`)),i=Y.findOne(e.join(","),this._config.target);i.classList.add(Ke),i.classList.contains("dropdown-item")?Y.findOne(".dropdown-toggle",i.closest(".dropdown")).classList.add(Ke):Y.parents(i,".nav, .list-group").forEach((t=>{Y.prev(t,".nav-link, .list-group-item").forEach((t=>t.classList.add(Ke))),Y.prev(t,".nav-item").forEach((t=>{Y.children(t,".nav-link").forEach((t=>t.classList.add(Ke)))}))})),$.trigger(this._scrollElement,"activate.bs.scrollspy",{relatedTarget:t})}_clear(){Y.find(Ve,this._config.target).filter((t=>t.classList.contains(Ke))).forEach((t=>t.classList.remove(Ke)))}static jQueryInterface(t){return this.each((function(){const e=Ye.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}}))}}$.on(window,"load.bs.scrollspy.data-api",(()=>{Y.find('[data-bs-spy="scroll"]').forEach((t=>new Ye(t)))})),v(Ye);const Qe="active",Ge="fade",Ze="show",Je=".active",ti=":scope > li > .active";class ei extends R{static get NAME(){return"tab"}show(){if(this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE&&this._element.classList.contains(Qe))return;let t;const e=r(this._element),i=this._element.closest(".nav, .list-group");if(i){const e="UL"===i.nodeName||"OL"===i.nodeName?ti:Je;t=Y.find(e,i),t=t[t.length-1]}const s=t?$.trigger(t,"hide.bs.tab",{relatedTarget:this._element}):null;if($.trigger(this._element,"show.bs.tab",{relatedTarget:t}).defaultPrevented||null!==s&&s.defaultPrevented)return;this._activate(this._element,i);const n=()=>{$.trigger(t,"hidden.bs.tab",{relatedTarget:this._element}),$.trigger(this._element,"shown.bs.tab",{relatedTarget:t})};e?this._activate(e,e.parentNode,n):n()}_activate(t,e,i){const s=(!e||"UL"!==e.nodeName&&"OL"!==e.nodeName?Y.children(e,Je):Y.find(ti,e))[0],n=i&&s&&s.classList.contains(Ge),o=()=>this._transitionComplete(t,s,i);s&&n?(s.classList.remove(Ze),this._queueCallback(o,t,!0)):o()}_transitionComplete(t,e,i){if(e){e.classList.remove(Qe);const t=Y.findOne(":scope > .dropdown-menu .active",e.parentNode);t&&t.classList.remove(Qe),"tab"===e.getAttribute("role")&&e.setAttribute("aria-selected",!1)}t.classList.add(Qe),"tab"===t.getAttribute("role")&&t.setAttribute("aria-selected",!0),f(t),t.classList.contains(Ge)&&t.classList.add(Ze);let s=t.parentNode;if(s&&"LI"===s.nodeName&&(s=s.parentNode),s&&s.classList.contains("dropdown-menu")){const e=t.closest(".dropdown");e&&Y.find(".dropdown-toggle",e).forEach((t=>t.classList.add(Qe))),t.setAttribute("aria-expanded",!0)}i&&i()}static jQueryInterface(t){return this.each((function(){const e=ei.getOrCreateInstance(this);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}}))}}$.on(document,"click.bs.tab.data-api",'[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',(function(t){["A","AREA"].includes(this.tagName)&&t.preventDefault(),u(this)||ei.getOrCreateInstance(this).show()})),v(ei);const ii="toast",si="hide",ni="show",oi="showing",ri={animation:"boolean",autohide:"boolean",delay:"number"},ai={animation:!0,autohide:!0,delay:5e3};class li extends R{constructor(t,e){super(t),this._config=this._getConfig(e),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get DefaultType(){return ri}static get Default(){return ai}static get NAME(){return ii}show(){$.trigger(this._element,"show.bs.toast").defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),this._element.classList.remove(si),f(this._element),this._element.classList.add(ni),this._element.classList.add(oi),this._queueCallback((()=>{this._element.classList.remove(oi),$.trigger(this._element,"shown.bs.toast"),this._maybeScheduleHide()}),this._element,this._config.animation))}hide(){this._element.classList.contains(ni)&&($.trigger(this._element,"hide.bs.toast").defaultPrevented||(this._element.classList.add(oi),this._queueCallback((()=>{this._element.classList.add(si),this._element.classList.remove(oi),this._element.classList.remove(ni),$.trigger(this._element,"hidden.bs.toast")}),this._element,this._config.animation)))}dispose(){this._clearTimeout(),this._element.classList.contains(ni)&&this._element.classList.remove(ni),super.dispose()}_getConfig(t){return t={...ai,...X.getDataAttributes(this._element),..."object"==typeof t&&t?t:{}},h(ii,t,this.constructor.DefaultType),t}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout((()=>{this.hide()}),this._config.delay)))}_onInteraction(t,e){switch(t.type){case"mouseover":case"mouseout":this._hasMouseInteraction=e;break;case"focusin":case"focusout":this._hasKeyboardInteraction=e}if(e)return void this._clearTimeout();const i=t.relatedTarget;this._element===i||this._element.contains(i)||this._maybeScheduleHide()}_setListeners(){$.on(this._element,"mouseover.bs.toast",(t=>this._onInteraction(t,!0))),$.on(this._element,"mouseout.bs.toast",(t=>this._onInteraction(t,!1))),$.on(this._element,"focusin.bs.toast",(t=>this._onInteraction(t,!0))),$.on(this._element,"focusout.bs.toast",(t=>this._onInteraction(t,!1)))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(t){return this.each((function(){const e=li.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t](this)}}))}}return F(li),v(li),{Alert:q,Button:U,Carousel:at,Collapse:mt,Dropdown:Ht,Modal:he,Offcanvas:me,Popover:Fe,ScrollSpy:Ye,Tab:ei,Toast:li,Tooltip:$e}}));
//# sourceMappingURL=bootstrap.min.js.map
</script>
<script type="text/javascript">
/**
  * bootstrap-table - An extended table to integration with some of the most widely used CSS frameworks. (Supports Bootstrap, Semantic UI, Bulma, Material Design, Foundation)
  *
  * @version v1.19.1
  * @homepage https://bootstrap-table.com
  * @author wenzhixin <wenzhixin2010@gmail.com> (http://wenzhixin.net.cn/)
  * @license MIT
  */

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],e):(t="undefined"!=typeof globalThis?globalThis:t||self).BootstrapTable=e(t.jQuery)}(this,(function(t){"use strict";function e(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var i=e(t);function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,i){return e&&a(t.prototype,e),i&&a(t,i),t}function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var s,r=t[Symbol.iterator]();!(n=(s=r.next()).done)&&(i.push(s.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==r.return||r.return()}finally{if(o)throw a}}return i}(t,e)||c(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t){return function(t){if(Array.isArray(t))return h(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||c(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){if(t){if("string"==typeof t)return h(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?h(t,e):void 0}}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function u(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=c(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,r=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return s=t.done,t},e:function(t){r=!0,a=t},f:function(){try{s||null==i.return||i.return()}finally{if(r)throw a}}}}var d="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function f(t,e){return t(e={exports:{}},e.exports),e.exports}var p=function(t){return t&&t.Math==Math&&t},g=p("object"==typeof globalThis&&globalThis)||p("object"==typeof window&&window)||p("object"==typeof self&&self)||p("object"==typeof d&&d)||function(){return this}()||Function("return this")(),v=function(t){try{return!!t()}catch(t){return!0}},b=!v((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),m={}.propertyIsEnumerable,y=Object.getOwnPropertyDescriptor,w={f:y&&!m.call({1:2},1)?function(t){var e=y(this,t);return!!e&&e.enumerable}:m},S=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},x={}.toString,k=function(t){return x.call(t).slice(8,-1)},O="".split,C=v((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==k(t)?O.call(t,""):Object(t)}:Object,T=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t},P=function(t){return C(T(t))},I=function(t){return"object"==typeof t?null!==t:"function"==typeof t},A=function(t,e){if(!I(t))return t;var i,n;if(e&&"function"==typeof(i=t.toString)&&!I(n=i.call(t)))return n;if("function"==typeof(i=t.valueOf)&&!I(n=i.call(t)))return n;if(!e&&"function"==typeof(i=t.toString)&&!I(n=i.call(t)))return n;throw TypeError("Can't convert object to primitive value")},$={}.hasOwnProperty,E=function(t,e){return $.call(t,e)},R=g.document,j=I(R)&&I(R.createElement),_=function(t){return j?R.createElement(t):{}},N=!b&&!v((function(){return 7!=Object.defineProperty(_("div"),"a",{get:function(){return 7}}).a})),F=Object.getOwnPropertyDescriptor,D={f:b?F:function(t,e){if(t=P(t),e=A(e,!0),N)try{return F(t,e)}catch(t){}if(E(t,e))return S(!w.f.call(t,e),t[e])}},V=function(t){if(!I(t))throw TypeError(String(t)+" is not an object");return t},B=Object.defineProperty,L={f:b?B:function(t,e,i){if(V(t),e=A(e,!0),V(i),N)try{return B(t,e,i)}catch(t){}if("get"in i||"set"in i)throw TypeError("Accessors not supported");return"value"in i&&(t[e]=i.value),t}},H=b?function(t,e,i){return L.f(t,e,S(1,i))}:function(t,e,i){return t[e]=i,t},M=function(t,e){try{H(g,t,e)}catch(i){g[t]=e}return e},U="__core-js_shared__",z=g[U]||M(U,{}),q=Function.toString;"function"!=typeof z.inspectSource&&(z.inspectSource=function(t){return q.call(t)});var W,G,K,Y=z.inspectSource,X=g.WeakMap,J="function"==typeof X&&/native code/.test(Y(X)),Q=f((function(t){(t.exports=function(t,e){return z[t]||(z[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.10.1",mode:"global",copyright:"© 2021 Denis Pushkarev (zloirock.ru)"})})),Z=0,tt=Math.random(),et=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++Z+tt).toString(36)},it=Q("keys"),nt=function(t){return it[t]||(it[t]=et(t))},ot={},at=g.WeakMap;if(J){var st=z.state||(z.state=new at),rt=st.get,lt=st.has,ct=st.set;W=function(t,e){return e.facade=t,ct.call(st,t,e),e},G=function(t){return rt.call(st,t)||{}},K=function(t){return lt.call(st,t)}}else{var ht=nt("state");ot[ht]=!0,W=function(t,e){return e.facade=t,H(t,ht,e),e},G=function(t){return E(t,ht)?t[ht]:{}},K=function(t){return E(t,ht)}}var ut={set:W,get:G,has:K,enforce:function(t){return K(t)?G(t):W(t,{})},getterFor:function(t){return function(e){var i;if(!I(e)||(i=G(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return i}}},dt=f((function(t){var e=ut.get,i=ut.enforce,n=String(String).split("String");(t.exports=function(t,e,o,a){var s,r=!!a&&!!a.unsafe,l=!!a&&!!a.enumerable,c=!!a&&!!a.noTargetGet;"function"==typeof o&&("string"!=typeof e||E(o,"name")||H(o,"name",e),(s=i(o)).source||(s.source=n.join("string"==typeof e?e:""))),t!==g?(r?!c&&t[e]&&(l=!0):delete t[e],l?t[e]=o:H(t,e,o)):l?t[e]=o:M(e,o)})(Function.prototype,"toString",(function(){return"function"==typeof this&&e(this).source||Y(this)}))})),ft=g,pt=function(t){return"function"==typeof t?t:void 0},gt=function(t,e){return arguments.length<2?pt(ft[t])||pt(g[t]):ft[t]&&ft[t][e]||g[t]&&g[t][e]},vt=Math.ceil,bt=Math.floor,mt=function(t){return isNaN(t=+t)?0:(t>0?bt:vt)(t)},yt=Math.min,wt=function(t){return t>0?yt(mt(t),9007199254740991):0},St=Math.max,xt=Math.min,kt=function(t,e){var i=mt(t);return i<0?St(i+e,0):xt(i,e)},Ot=function(t){return function(e,i,n){var o,a=P(e),s=wt(a.length),r=kt(n,s);if(t&&i!=i){for(;s>r;)if((o=a[r++])!=o)return!0}else for(;s>r;r++)if((t||r in a)&&a[r]===i)return t||r||0;return!t&&-1}},Ct={includes:Ot(!0),indexOf:Ot(!1)},Tt=Ct.indexOf,Pt=function(t,e){var i,n=P(t),o=0,a=[];for(i in n)!E(ot,i)&&E(n,i)&&a.push(i);for(;e.length>o;)E(n,i=e[o++])&&(~Tt(a,i)||a.push(i));return a},It=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],At=It.concat("length","prototype"),$t={f:Object.getOwnPropertyNames||function(t){return Pt(t,At)}},Et={f:Object.getOwnPropertySymbols},Rt=gt("Reflect","ownKeys")||function(t){var e=$t.f(V(t)),i=Et.f;return i?e.concat(i(t)):e},jt=function(t,e){for(var i=Rt(e),n=L.f,o=D.f,a=0;a<i.length;a++){var s=i[a];E(t,s)||n(t,s,o(e,s))}},_t=/#|\.prototype\./,Nt=function(t,e){var i=Dt[Ft(t)];return i==Bt||i!=Vt&&("function"==typeof e?v(e):!!e)},Ft=Nt.normalize=function(t){return String(t).replace(_t,".").toLowerCase()},Dt=Nt.data={},Vt=Nt.NATIVE="N",Bt=Nt.POLYFILL="P",Lt=Nt,Ht=D.f,Mt=function(t,e){var i,n,o,a,s,r=t.target,l=t.global,c=t.stat;if(i=l?g:c?g[r]||M(r,{}):(g[r]||{}).prototype)for(n in e){if(a=e[n],o=t.noTargetGet?(s=Ht(i,n))&&s.value:i[n],!Lt(l?n:r+(c?".":"#")+n,t.forced)&&void 0!==o){if(typeof a==typeof o)continue;jt(a,o)}(t.sham||o&&o.sham)&&H(a,"sham",!0),dt(i,n,a,t)}},Ut="\t\n\v\f\r                　\u2028\u2029\ufeff",zt="["+Ut+"]",qt=RegExp("^"+zt+zt+"*"),Wt=RegExp(zt+zt+"*$"),Gt=function(t){return function(e){var i=String(T(e));return 1&t&&(i=i.replace(qt,"")),2&t&&(i=i.replace(Wt,"")),i}},Kt={start:Gt(1),end:Gt(2),trim:Gt(3)},Yt=Kt.trim;Mt({target:"String",proto:!0,forced:function(t){return v((function(){return!!Ut[t]()||"​᠎"!="​᠎"[t]()||Ut[t].name!==t}))}("trim")},{trim:function(){return Yt(this)}});var Xt=function(t,e){var i=[][t];return!!i&&v((function(){i.call(null,e||function(){throw 1},1)}))},Jt=[].join,Qt=C!=Object,Zt=Xt("join",",");Mt({target:"Array",proto:!0,forced:Qt||!Zt},{join:function(t){return Jt.call(P(this),void 0===t?",":t)}});var te=function(){var t=V(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e};function ee(t,e){return RegExp(t,e)}var ie={UNSUPPORTED_Y:v((function(){var t=ee("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),BROKEN_CARET:v((function(){var t=ee("^r","gy");return t.lastIndex=2,null!=t.exec("str")}))},ne=RegExp.prototype.exec,oe=Q("native-string-replace",String.prototype.replace),ae=ne,se=function(){var t=/a/,e=/b*/g;return ne.call(t,"a"),ne.call(e,"a"),0!==t.lastIndex||0!==e.lastIndex}(),re=ie.UNSUPPORTED_Y||ie.BROKEN_CARET,le=void 0!==/()??/.exec("")[1];(se||le||re)&&(ae=function(t){var e,i,n,o,a=this,s=re&&a.sticky,r=te.call(a),l=a.source,c=0,h=t;return s&&(-1===(r=r.replace("y","")).indexOf("g")&&(r+="g"),h=String(t).slice(a.lastIndex),a.lastIndex>0&&(!a.multiline||a.multiline&&"\n"!==t[a.lastIndex-1])&&(l="(?: "+l+")",h=" "+h,c++),i=new RegExp("^(?:"+l+")",r)),le&&(i=new RegExp("^"+l+"$(?!\\s)",r)),se&&(e=a.lastIndex),n=ne.call(s?i:a,h),s?n?(n.input=n.input.slice(c),n[0]=n[0].slice(c),n.index=a.lastIndex,a.lastIndex+=n[0].length):a.lastIndex=0:se&&n&&(a.lastIndex=a.global?n.index+n[0].length:e),le&&n&&n.length>1&&oe.call(n[0],i,(function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(n[o]=void 0)})),n});var ce=ae;Mt({target:"RegExp",proto:!0,forced:/./.exec!==ce},{exec:ce});var he,ue,de="process"==k(g.process),fe=gt("navigator","userAgent")||"",pe=g.process,ge=pe&&pe.versions,ve=ge&&ge.v8;ve?ue=(he=ve.split("."))[0]+he[1]:fe&&(!(he=fe.match(/Edge\/(\d+)/))||he[1]>=74)&&(he=fe.match(/Chrome\/(\d+)/))&&(ue=he[1]);var be=ue&&+ue,me=!!Object.getOwnPropertySymbols&&!v((function(){return!Symbol.sham&&(de?38===be:be>37&&be<41)})),ye=me&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,we=Q("wks"),Se=g.Symbol,xe=ye?Se:Se&&Se.withoutSetter||et,ke=function(t){return E(we,t)&&(me||"string"==typeof we[t])||(me&&E(Se,t)?we[t]=Se[t]:we[t]=xe("Symbol."+t)),we[t]},Oe=ke("species"),Ce=!v((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})),Te="$0"==="a".replace(/./,"$0"),Pe=ke("replace"),Ie=!!/./[Pe]&&""===/./[Pe]("a","$0"),Ae=!v((function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var i="ab".split(t);return 2!==i.length||"a"!==i[0]||"b"!==i[1]})),$e=function(t,e,i,n){var o=ke(t),a=!v((function(){var e={};return e[o]=function(){return 7},7!=""[t](e)})),s=a&&!v((function(){var e=!1,i=/a/;return"split"===t&&((i={}).constructor={},i.constructor[Oe]=function(){return i},i.flags="",i[o]=/./[o]),i.exec=function(){return e=!0,null},i[o](""),!e}));if(!a||!s||"replace"===t&&(!Ce||!Te||Ie)||"split"===t&&!Ae){var r=/./[o],l=i(o,""[t],(function(t,e,i,n,o){return e.exec===RegExp.prototype.exec?a&&!o?{done:!0,value:r.call(e,i,n)}:{done:!0,value:t.call(i,e,n)}:{done:!1}}),{REPLACE_KEEPS_$0:Te,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:Ie}),c=l[0],h=l[1];dt(String.prototype,t,c),dt(RegExp.prototype,o,2==e?function(t,e){return h.call(t,this,e)}:function(t){return h.call(t,this)})}n&&H(RegExp.prototype[o],"sham",!0)},Ee=ke("match"),Re=function(t){var e;return I(t)&&(void 0!==(e=t[Ee])?!!e:"RegExp"==k(t))},je=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t},_e=ke("species"),Ne=function(t){return function(e,i){var n,o,a=String(T(e)),s=mt(i),r=a.length;return s<0||s>=r?t?"":void 0:(n=a.charCodeAt(s))<55296||n>56319||s+1===r||(o=a.charCodeAt(s+1))<56320||o>57343?t?a.charAt(s):n:t?a.slice(s,s+2):o-56320+(n-55296<<10)+65536}},Fe={codeAt:Ne(!1),charAt:Ne(!0)}.charAt,De=function(t,e,i){return e+(i?Fe(t,e).length:1)},Ve=function(t,e){var i=t.exec;if("function"==typeof i){var n=i.call(t,e);if("object"!=typeof n)throw TypeError("RegExp exec method returned something other than an Object or null");return n}if("RegExp"!==k(t))throw TypeError("RegExp#exec called on incompatible receiver");return ce.call(t,e)},Be=ie.UNSUPPORTED_Y,Le=[].push,He=Math.min,Me=4294967295;$e("split",2,(function(t,e,i){var n;return n="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,i){var n=String(T(this)),o=void 0===i?Me:i>>>0;if(0===o)return[];if(void 0===t)return[n];if(!Re(t))return e.call(n,t,o);for(var a,s,r,l=[],c=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),h=0,u=new RegExp(t.source,c+"g");(a=ce.call(u,n))&&!((s=u.lastIndex)>h&&(l.push(n.slice(h,a.index)),a.length>1&&a.index<n.length&&Le.apply(l,a.slice(1)),r=a[0].length,h=s,l.length>=o));)u.lastIndex===a.index&&u.lastIndex++;return h===n.length?!r&&u.test("")||l.push(""):l.push(n.slice(h)),l.length>o?l.slice(0,o):l}:"0".split(void 0,0).length?function(t,i){return void 0===t&&0===i?[]:e.call(this,t,i)}:e,[function(e,i){var o=T(this),a=null==e?void 0:e[t];return void 0!==a?a.call(e,o,i):n.call(String(o),e,i)},function(t,o){var a=i(n,t,this,o,n!==e);if(a.done)return a.value;var s=V(t),r=String(this),l=function(t,e){var i,n=V(t).constructor;return void 0===n||null==(i=V(n)[_e])?e:je(i)}(s,RegExp),c=s.unicode,h=(s.ignoreCase?"i":"")+(s.multiline?"m":"")+(s.unicode?"u":"")+(Be?"g":"y"),u=new l(Be?"^(?:"+s.source+")":s,h),d=void 0===o?Me:o>>>0;if(0===d)return[];if(0===r.length)return null===Ve(u,r)?[r]:[];for(var f=0,p=0,g=[];p<r.length;){u.lastIndex=Be?0:p;var v,b=Ve(u,Be?r.slice(p):r);if(null===b||(v=He(wt(u.lastIndex+(Be?p:0)),r.length))===f)p=De(r,p,c);else{if(g.push(r.slice(f,p)),g.length===d)return g;for(var m=1;m<=b.length-1;m++)if(g.push(b[m]),g.length===d)return g;p=f=v}}return g.push(r.slice(f)),g}]}),Be);var Ue=Object.keys||function(t){return Pt(t,It)},ze=w.f,qe=function(t){return function(e){for(var i,n=P(e),o=Ue(n),a=o.length,s=0,r=[];a>s;)i=o[s++],b&&!ze.call(n,i)||r.push(t?[i,n[i]]:n[i]);return r}},We={entries:qe(!0),values:qe(!1)}.entries;Mt({target:"Object",stat:!0},{entries:function(t){return We(t)}});var Ge,Ke=b?Object.defineProperties:function(t,e){V(t);for(var i,n=Ue(e),o=n.length,a=0;o>a;)L.f(t,i=n[a++],e[i]);return t},Ye=gt("document","documentElement"),Xe=nt("IE_PROTO"),Je=function(){},Qe=function(t){return"<script>"+t+"</"+"script>"},Ze=function(){try{Ge=document.domain&&new ActiveXObject("htmlfile")}catch(t){}var t,e;Ze=Ge?function(t){t.write(Qe("")),t.close();var e=t.parentWindow.Object;return t=null,e}(Ge):((e=_("iframe")).style.display="none",Ye.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(Qe("document.F=Object")),t.close(),t.F);for(var i=It.length;i--;)delete Ze.prototype[It[i]];return Ze()};ot[Xe]=!0;var ti=Object.create||function(t,e){var i;return null!==t?(Je.prototype=V(t),i=new Je,Je.prototype=null,i[Xe]=t):i=Ze(),void 0===e?i:Ke(i,e)},ei=ke("unscopables"),ii=Array.prototype;null==ii[ei]&&L.f(ii,ei,{configurable:!0,value:ti(null)});var ni=function(t){ii[ei][t]=!0},oi=Ct.includes;Mt({target:"Array",proto:!0},{includes:function(t){return oi(this,t,arguments.length>1?arguments[1]:void 0)}}),ni("includes");var ai=Array.isArray||function(t){return"Array"==k(t)},si=function(t){return Object(T(t))},ri=function(t,e,i){var n=A(e);n in t?L.f(t,n,S(0,i)):t[n]=i},li=ke("species"),ci=function(t,e){var i;return ai(t)&&("function"!=typeof(i=t.constructor)||i!==Array&&!ai(i.prototype)?I(i)&&null===(i=i[li])&&(i=void 0):i=void 0),new(void 0===i?Array:i)(0===e?0:e)},hi=ke("species"),ui=function(t){return be>=51||!v((function(){var e=[];return(e.constructor={})[hi]=function(){return{foo:1}},1!==e[t](Boolean).foo}))},di=ke("isConcatSpreadable"),fi=9007199254740991,pi="Maximum allowed index exceeded",gi=be>=51||!v((function(){var t=[];return t[di]=!1,t.concat()[0]!==t})),vi=ui("concat"),bi=function(t){if(!I(t))return!1;var e=t[di];return void 0!==e?!!e:ai(t)};Mt({target:"Array",proto:!0,forced:!gi||!vi},{concat:function(t){var e,i,n,o,a,s=si(this),r=ci(s,0),l=0;for(e=-1,n=arguments.length;e<n;e++)if(bi(a=-1===e?s:arguments[e])){if(l+(o=wt(a.length))>fi)throw TypeError(pi);for(i=0;i<o;i++,l++)i in a&&ri(r,l,a[i])}else{if(l>=fi)throw TypeError(pi);ri(r,l++,a)}return r.length=l,r}});var mi=[].push,yi=function(t){var e=1==t,i=2==t,n=3==t,o=4==t,a=6==t,s=7==t,r=5==t||a;return function(l,c,h,u){for(var d,f,p=si(l),g=C(p),v=function(t,e,i){if(je(t),void 0===e)return t;switch(i){case 0:return function(){return t.call(e)};case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,o){return t.call(e,i,n,o)}}return function(){return t.apply(e,arguments)}}(c,h,3),b=wt(g.length),m=0,y=u||ci,w=e?y(l,b):i||s?y(l,0):void 0;b>m;m++)if((r||m in g)&&(f=v(d=g[m],m,p),t))if(e)w[m]=f;else if(f)switch(t){case 3:return!0;case 5:return d;case 6:return m;case 2:mi.call(w,d)}else switch(t){case 4:return!1;case 7:mi.call(w,d)}return a?-1:n||o?o:w}},wi={forEach:yi(0),map:yi(1),filter:yi(2),some:yi(3),every:yi(4),find:yi(5),findIndex:yi(6),filterOut:yi(7)},Si=wi.find,xi="find",ki=!0;xi in[]&&Array(1).find((function(){ki=!1})),Mt({target:"Array",proto:!0,forced:ki},{find:function(t){return Si(this,t,arguments.length>1?arguments[1]:void 0)}}),ni(xi);var Oi=function(t){if(Re(t))throw TypeError("The method doesn't accept regular expressions");return t},Ci=ke("match"),Ti=function(t){var e=/./;try{"/./"[t](e)}catch(i){try{return e[Ci]=!1,"/./"[t](e)}catch(t){}}return!1};Mt({target:"String",proto:!0,forced:!Ti("includes")},{includes:function(t){return!!~String(T(this)).indexOf(Oi(t),arguments.length>1?arguments[1]:void 0)}});var Pi={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Ii=wi.forEach,Ai=Xt("forEach")?[].forEach:function(t){return Ii(this,t,arguments.length>1?arguments[1]:void 0)};for(var $i in Pi){var Ei=g[$i],Ri=Ei&&Ei.prototype;if(Ri&&Ri.forEach!==Ai)try{H(Ri,"forEach",Ai)}catch(t){Ri.forEach=Ai}}var ji=Kt.trim,_i=g.parseFloat,Ni=1/_i(Ut+"-0")!=-1/0?function(t){var e=ji(String(t)),i=_i(e);return 0===i&&"-"==e.charAt(0)?-0:i}:_i;Mt({global:!0,forced:parseFloat!=Ni},{parseFloat:Ni});var Fi=Ct.indexOf,Di=[].indexOf,Vi=!!Di&&1/[1].indexOf(1,-0)<0,Bi=Xt("indexOf");Mt({target:"Array",proto:!0,forced:Vi||!Bi},{indexOf:function(t){return Vi?Di.apply(this,arguments)||0:Fi(this,t,arguments.length>1?arguments[1]:void 0)}});var Li=[],Hi=Li.sort,Mi=v((function(){Li.sort(void 0)})),Ui=v((function(){Li.sort(null)})),zi=Xt("sort");Mt({target:"Array",proto:!0,forced:Mi||!Ui||!zi},{sort:function(t){return void 0===t?Hi.call(si(this)):Hi.call(si(this),je(t))}});var qi=Math.floor,Wi="".replace,Gi=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,Ki=/\$([$&'`]|\d{1,2})/g,Yi=function(t,e,i,n,o,a){var s=i+t.length,r=n.length,l=Ki;return void 0!==o&&(o=si(o),l=Gi),Wi.call(a,l,(function(a,l){var c;switch(l.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,i);case"'":return e.slice(s);case"<":c=o[l.slice(1,-1)];break;default:var h=+l;if(0===h)return a;if(h>r){var u=qi(h/10);return 0===u?a:u<=r?void 0===n[u-1]?l.charAt(1):n[u-1]+l.charAt(1):a}c=n[h-1]}return void 0===c?"":c}))},Xi=Math.max,Ji=Math.min;$e("replace",2,(function(t,e,i,n){var o=n.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,a=n.REPLACE_KEEPS_$0,s=o?"$":"$0";return[function(i,n){var o=T(this),a=null==i?void 0:i[t];return void 0!==a?a.call(i,o,n):e.call(String(o),i,n)},function(t,n){if(!o&&a||"string"==typeof n&&-1===n.indexOf(s)){var r=i(e,t,this,n);if(r.done)return r.value}var l=V(t),c=String(this),h="function"==typeof n;h||(n=String(n));var u=l.global;if(u){var d=l.unicode;l.lastIndex=0}for(var f=[];;){var p=Ve(l,c);if(null===p)break;if(f.push(p),!u)break;""===String(p[0])&&(l.lastIndex=De(c,wt(l.lastIndex),d))}for(var g,v="",b=0,m=0;m<f.length;m++){p=f[m];for(var y=String(p[0]),w=Xi(Ji(mt(p.index),c.length),0),S=[],x=1;x<p.length;x++)S.push(void 0===(g=p[x])?g:String(g));var k=p.groups;if(h){var O=[y].concat(S,w,c);void 0!==k&&O.push(k);var C=String(n.apply(void 0,O))}else C=Yi(y,c,w,S,k,n);w>=b&&(v+=c.slice(b,w)+C,b=w+y.length)}return v+c.slice(b)}]}));var Qi=Object.assign,Zi=Object.defineProperty,tn=!Qi||v((function(){if(b&&1!==Qi({b:1},Qi(Zi({},"a",{enumerable:!0,get:function(){Zi(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},i=Symbol(),n="abcdefghijklmnopqrst";return t[i]=7,n.split("").forEach((function(t){e[t]=t})),7!=Qi({},t)[i]||Ue(Qi({},e)).join("")!=n}))?function(t,e){for(var i=si(t),n=arguments.length,o=1,a=Et.f,s=w.f;n>o;)for(var r,l=C(arguments[o++]),c=a?Ue(l).concat(a(l)):Ue(l),h=c.length,u=0;h>u;)r=c[u++],b&&!s.call(l,r)||(i[r]=l[r]);return i}:Qi;Mt({target:"Object",stat:!0,forced:Object.assign!==tn},{assign:tn});var en=wi.filter,nn=ui("filter");Mt({target:"Array",proto:!0,forced:!nn},{filter:function(t){return en(this,t,arguments.length>1?arguments[1]:void 0)}});var on=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e};$e("search",1,(function(t,e,i){return[function(e){var i=T(this),n=null==e?void 0:e[t];return void 0!==n?n.call(e,i):new RegExp(e)[t](String(i))},function(t){var n=i(e,t,this);if(n.done)return n.value;var o=V(t),a=String(this),s=o.lastIndex;on(s,0)||(o.lastIndex=0);var r=Ve(o,a);return on(o.lastIndex,s)||(o.lastIndex=s),null===r?-1:r.index}]}));var an=Kt.trim,sn=g.parseInt,rn=/^[+-]?0[Xx]/,ln=8!==sn(Ut+"08")||22!==sn(Ut+"0x16")?function(t,e){var i=an(String(t));return sn(i,e>>>0||(rn.test(i)?16:10))}:sn;Mt({global:!0,forced:parseInt!=ln},{parseInt:ln});var cn=wi.map,hn=ui("map");Mt({target:"Array",proto:!0,forced:!hn},{map:function(t){return cn(this,t,arguments.length>1?arguments[1]:void 0)}});var un=wi.findIndex,dn="findIndex",fn=!0;dn in[]&&Array(1).findIndex((function(){fn=!1})),Mt({target:"Array",proto:!0,forced:fn},{findIndex:function(t){return un(this,t,arguments.length>1?arguments[1]:void 0)}}),ni(dn);var pn=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,i={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(i,[]),e=i instanceof Array}catch(t){}return function(i,n){return V(i),function(t){if(!I(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype")}(n),e?t.call(i,n):i.__proto__=n,i}}():void 0),gn=function(t,e,i){var n,o;return pn&&"function"==typeof(n=e.constructor)&&n!==i&&I(o=n.prototype)&&o!==i.prototype&&pn(t,o),t},vn=ke("species"),bn=L.f,mn=$t.f,yn=ut.set,wn=ke("match"),Sn=g.RegExp,xn=Sn.prototype,kn=/a/g,On=/a/g,Cn=new Sn(kn)!==kn,Tn=ie.UNSUPPORTED_Y;if(b&&Lt("RegExp",!Cn||Tn||v((function(){return On[wn]=!1,Sn(kn)!=kn||Sn(On)==On||"/a/i"!=Sn(kn,"i")})))){for(var Pn=function(t,e){var i,n=this instanceof Pn,o=Re(t),a=void 0===e;if(!n&&o&&t.constructor===Pn&&a)return t;Cn?o&&!a&&(t=t.source):t instanceof Pn&&(a&&(e=te.call(t)),t=t.source),Tn&&(i=!!e&&e.indexOf("y")>-1)&&(e=e.replace(/y/g,""));var s=gn(Cn?new Sn(t,e):Sn(t,e),n?this:xn,Pn);return Tn&&i&&yn(s,{sticky:i}),s},In=function(t){t in Pn||bn(Pn,t,{configurable:!0,get:function(){return Sn[t]},set:function(e){Sn[t]=e}})},An=mn(Sn),$n=0;An.length>$n;)In(An[$n++]);xn.constructor=Pn,Pn.prototype=xn,dt(g,"RegExp",Pn)}!function(t){var e=gt(t),i=L.f;b&&e&&!e[vn]&&i(e,vn,{configurable:!0,get:function(){return this}})}("RegExp");var En="toString",Rn=RegExp.prototype,jn=Rn.toString,_n=v((function(){return"/a/b"!=jn.call({source:"a",flags:"b"})})),Nn=jn.name!=En;(_n||Nn)&&dt(RegExp.prototype,En,(function(){var t=V(this),e=String(t.source),i=t.flags;return"/"+e+"/"+String(void 0===i&&t instanceof RegExp&&!("flags"in Rn)?te.call(t):i)}),{unsafe:!0});var Fn={};Fn[ke("toStringTag")]="z";var Dn="[object z]"===String(Fn),Vn=ke("toStringTag"),Bn="Arguments"==k(function(){return arguments}()),Ln=Dn?k:function(t){var e,i,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),Vn))?i:Bn?k(e):"Object"==(n=k(e))&&"function"==typeof e.callee?"Arguments":n},Hn=Dn?{}.toString:function(){return"[object "+Ln(this)+"]"};Dn||dt(Object.prototype,"toString",Hn,{unsafe:!0});var Mn=ui("slice"),Un=ke("species"),zn=[].slice,qn=Math.max;Mt({target:"Array",proto:!0,forced:!Mn},{slice:function(t,e){var i,n,o,a=P(this),s=wt(a.length),r=kt(t,s),l=kt(void 0===e?s:e,s);if(ai(a)&&("function"!=typeof(i=a.constructor)||i!==Array&&!ai(i.prototype)?I(i)&&null===(i=i[Un])&&(i=void 0):i=void 0,i===Array||void 0===i))return zn.call(a,r,l);for(n=new(void 0===i?Array:i)(qn(l-r,0)),o=0;r<l;r++,o++)r in a&&ri(n,o,a[r]);return n.length=o,n}});var Wn,Gn,Kn,Yn=!v((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})),Xn=nt("IE_PROTO"),Jn=Object.prototype,Qn=Yn?Object.getPrototypeOf:function(t){return t=si(t),E(t,Xn)?t[Xn]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?Jn:null},Zn=ke("iterator"),to=!1;[].keys&&("next"in(Kn=[].keys())?(Gn=Qn(Qn(Kn)))!==Object.prototype&&(Wn=Gn):to=!0),(null==Wn||v((function(){var t={};return Wn[Zn].call(t)!==t})))&&(Wn={}),E(Wn,Zn)||H(Wn,Zn,(function(){return this}));var eo={IteratorPrototype:Wn,BUGGY_SAFARI_ITERATORS:to},io=L.f,no=ke("toStringTag"),oo=function(t,e,i){t&&!E(t=i?t:t.prototype,no)&&io(t,no,{configurable:!0,value:e})},ao=eo.IteratorPrototype,so=eo.IteratorPrototype,ro=eo.BUGGY_SAFARI_ITERATORS,lo=ke("iterator"),co="keys",ho="values",uo="entries",fo=function(){return this},po="Array Iterator",go=ut.set,vo=ut.getterFor(po),bo=function(t,e,i,n,o,a,s){!function(t,e,i){var n=e+" Iterator";t.prototype=ti(ao,{next:S(1,i)}),oo(t,n,!1)}(i,e,n);var r,l,c,h=function(t){if(t===o&&g)return g;if(!ro&&t in f)return f[t];switch(t){case co:case ho:case uo:return function(){return new i(this,t)}}return function(){return new i(this)}},u=e+" Iterator",d=!1,f=t.prototype,p=f[lo]||f["@@iterator"]||o&&f[o],g=!ro&&p||h(o),v="Array"==e&&f.entries||p;if(v&&(r=Qn(v.call(new t)),so!==Object.prototype&&r.next&&(Qn(r)!==so&&(pn?pn(r,so):"function"!=typeof r[lo]&&H(r,lo,fo)),oo(r,u,!0))),o==ho&&p&&p.name!==ho&&(d=!0,g=function(){return p.call(this)}),f[lo]!==g&&H(f,lo,g),o)if(l={values:h(ho),keys:a?g:h(co),entries:h(uo)},s)for(c in l)(ro||d||!(c in f))&&dt(f,c,l[c]);else Mt({target:e,proto:!0,forced:ro||d},l);return l}(Array,"Array",(function(t,e){go(this,{type:po,target:P(t),index:0,kind:e})}),(function(){var t=vo(this),e=t.target,i=t.kind,n=t.index++;return!e||n>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==i?{value:n,done:!1}:"values"==i?{value:e[n],done:!1}:{value:[n,e[n]],done:!1}}),"values");ni("keys"),ni("values"),ni("entries");var mo=ke("iterator"),yo=ke("toStringTag"),wo=bo.values;for(var So in Pi){var xo=g[So],ko=xo&&xo.prototype;if(ko){if(ko[mo]!==wo)try{H(ko,mo,wo)}catch(t){ko[mo]=wo}if(ko[yo]||H(ko,yo,So),Pi[So])for(var Oo in bo)if(ko[Oo]!==bo[Oo])try{H(ko,Oo,bo[Oo])}catch(t){ko[Oo]=bo[Oo]}}}var Co=ui("splice"),To=Math.max,Po=Math.min,Io=9007199254740991,Ao="Maximum allowed length exceeded";Mt({target:"Array",proto:!0,forced:!Co},{splice:function(t,e){var i,n,o,a,s,r,l=si(this),c=wt(l.length),h=kt(t,c),u=arguments.length;if(0===u?i=n=0:1===u?(i=0,n=c-h):(i=u-2,n=Po(To(mt(e),0),c-h)),c+i-n>Io)throw TypeError(Ao);for(o=ci(l,n),a=0;a<n;a++)(s=h+a)in l&&ri(o,a,l[s]);if(o.length=n,i<n){for(a=h;a<c-n;a++)r=a+i,(s=a+n)in l?l[r]=l[s]:delete l[r];for(a=c;a>c-n+i;a--)delete l[a-1]}else if(i>n)for(a=c-n;a>h;a--)r=a+i-1,(s=a+n-1)in l?l[r]=l[s]:delete l[r];for(a=0;a<i;a++)l[a+h]=arguments[a+2];return l.length=c-n+i,o}});var $o=$t.f,Eo=D.f,Ro=L.f,jo=Kt.trim,_o="Number",No=g.Number,Fo=No.prototype,Do=k(ti(Fo))==_o,Vo=function(t){var e,i,n,o,a,s,r,l,c=A(t,!1);if("string"==typeof c&&c.length>2)if(43===(e=(c=jo(c)).charCodeAt(0))||45===e){if(88===(i=c.charCodeAt(2))||120===i)return NaN}else if(48===e){switch(c.charCodeAt(1)){case 66:case 98:n=2,o=49;break;case 79:case 111:n=8,o=55;break;default:return+c}for(s=(a=c.slice(2)).length,r=0;r<s;r++)if((l=a.charCodeAt(r))<48||l>o)return NaN;return parseInt(a,n)}return+c};if(Lt(_o,!No(" 0o1")||!No("0b1")||No("+0x1"))){for(var Bo,Lo=function(t){var e=arguments.length<1?0:t,i=this;return i instanceof Lo&&(Do?v((function(){Fo.valueOf.call(i)})):k(i)!=_o)?gn(new No(Vo(e)),i,Lo):Vo(e)},Ho=b?$o(No):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),Mo=0;Ho.length>Mo;Mo++)E(No,Bo=Ho[Mo])&&!E(Lo,Bo)&&Ro(Lo,Bo,Eo(No,Bo));Lo.prototype=Fo,Fo.constructor=Lo,dt(g,_o,Lo)}var Uo=[].reverse,zo=[1,2];Mt({target:"Array",proto:!0,forced:String(zo)===String(zo.reverse())},{reverse:function(){return ai(this)&&(this.length=this.length),Uo.call(this)}});var qo=4;try{var Wo=i.default.fn.dropdown.Constructor.VERSION;void 0!==Wo&&(qo=parseInt(Wo,10))}catch(t){}try{var Go=bootstrap.Tooltip.VERSION;void 0!==Go&&(qo=parseInt(Go,10))}catch(t){}var Ko={3:{iconsPrefix:"glyphicon",icons:{paginationSwitchDown:"glyphicon-collapse-down icon-chevron-down",paginationSwitchUp:"glyphicon-collapse-up icon-chevron-up",refresh:"glyphicon-refresh icon-refresh",toggleOff:"glyphicon-list-alt icon-list-alt",toggleOn:"glyphicon-list-alt icon-list-alt",columns:"glyphicon-th icon-th",detailOpen:"glyphicon-plus icon-plus",detailClose:"glyphicon-minus icon-minus",fullscreen:"glyphicon-fullscreen",search:"glyphicon-search",clearSearch:"glyphicon-trash"},classes:{buttonsPrefix:"btn",buttons:"default",buttonsGroup:"btn-group",buttonsDropdown:"btn-group",pull:"pull",inputGroup:"input-group",inputPrefix:"input-",input:"form-control",paginationDropdown:"btn-group dropdown",dropup:"dropup",dropdownActive:"active",paginationActive:"active",buttonActive:"active"},html:{toolbarDropdown:['<ul class="dropdown-menu" role="menu">',"</ul>"],toolbarDropdownItem:'<li class="dropdown-item-marker" role="menuitem"><label>%s</label></li>',toolbarDropdownSeparator:'<li class="divider"></li>',pageDropdown:['<ul class="dropdown-menu" role="menu">',"</ul>"],pageDropdownItem:'<li role="menuitem" class="%s"><a href="#">%s</a></li>',dropdownCaret:'<span class="caret"></span>',pagination:['<ul class="pagination%s">',"</ul>"],paginationItem:'<li class="page-item%s"><a class="page-link" aria-label="%s" href="javascript:void(0)">%s</a></li>',icon:'<i class="%s %s"></i>',inputGroup:'<div class="input-group">%s<span class="input-group-btn">%s</span></div>',searchInput:'<input class="%s%s" type="text" placeholder="%s">',searchButton:'<button class="%s" type="button" name="search" title="%s">%s %s</button>',searchClearButton:'<button class="%s" type="button" name="clearSearch" title="%s">%s %s</button>'}},4:{iconsPrefix:"fa",icons:{paginationSwitchDown:"fa-caret-square-down",paginationSwitchUp:"fa-caret-square-up",refresh:"fa-sync",toggleOff:"fa-toggle-off",toggleOn:"fa-toggle-on",columns:"fa-th-list",detailOpen:"fa-plus",detailClose:"fa-minus",fullscreen:"fa-arrows-alt",search:"fa-search",clearSearch:"fa-trash"},classes:{buttonsPrefix:"btn",buttons:"secondary",buttonsGroup:"btn-group",buttonsDropdown:"btn-group",pull:"float",inputGroup:"btn-group",inputPrefix:"form-control-",input:"form-control",paginationDropdown:"btn-group dropdown",dropup:"dropup",dropdownActive:"active",paginationActive:"active",buttonActive:"active"},html:{toolbarDropdown:['<div class="dropdown-menu dropdown-menu-right">',"</div>"],toolbarDropdownItem:'<label class="dropdown-item dropdown-item-marker">%s</label>',pageDropdown:['<div class="dropdown-menu">',"</div>"],pageDropdownItem:'<a class="dropdown-item %s" href="#">%s</a>',toolbarDropdownSeparator:'<div class="dropdown-divider"></div>',dropdownCaret:'<span class="caret"></span>',pagination:['<ul class="pagination%s">',"</ul>"],paginationItem:'<li class="page-item%s"><a class="page-link" aria-label="%s" href="javascript:void(0)">%s</a></li>',icon:'<i class="%s %s"></i>',inputGroup:'<div class="input-group">%s<div class="input-group-append">%s</div></div>',searchInput:'<input class="%s%s" type="text" placeholder="%s">',searchButton:'<button class="%s" type="button" name="search" title="%s">%s %s</button>',searchClearButton:'<button class="%s" type="button" name="clearSearch" title="%s">%s %s</button>'}},5:{iconsPrefix:"bi",icons:{paginationSwitchDown:"bi-caret-down-square",paginationSwitchUp:"bi-caret-up-square",refresh:"bi-arrow-clockwise",toggleOff:"bi-toggle-off",toggleOn:"bi-toggle-on",columns:"bi-list-ul",detailOpen:"bi-plus",detailClose:"bi-dash",fullscreen:"bi-arrows-move",search:"bi-search",clearSearch:"bi-trash"},classes:{buttonsPrefix:"btn",buttons:"secondary",buttonsGroup:"btn-group",buttonsDropdown:"btn-group",pull:"float",inputGroup:"btn-group",inputPrefix:"form-control-",input:"form-control",paginationDropdown:"btn-group dropdown",dropup:"dropup",dropdownActive:"active",paginationActive:"active",buttonActive:"active"},html:{dataToggle:"data-bs-toggle",toolbarDropdown:['<div class="dropdown-menu dropdown-menu-right">',"</div>"],toolbarDropdownItem:'<label class="dropdown-item dropdown-item-marker">%s</label>',pageDropdown:['<div class="dropdown-menu">',"</div>"],pageDropdownItem:'<a class="dropdown-item %s" href="#">%s</a>',toolbarDropdownSeparator:'<div class="dropdown-divider"></div>',dropdownCaret:'<span class="caret"></span>',pagination:['<ul class="pagination%s">',"</ul>"],paginationItem:'<li class="page-item%s"><a class="page-link" aria-label="%s" href="javascript:void(0)">%s</a></li>',icon:'<i class="%s %s"></i>',inputGroup:'<div class="input-group">%s%s</div>',searchInput:'<input class="%s%s" type="text" placeholder="%s">',searchButton:'<button class="%s" type="button" name="search" title="%s">%s %s</button>',searchClearButton:'<button class="%s" type="button" name="clearSearch" title="%s">%s %s</button>'}}}[qo],Yo={height:void 0,classes:"table table-bordered table-hover",buttons:{},theadClasses:"",headerStyle:function(t){return{}},rowStyle:function(t,e){return{}},rowAttributes:function(t,e){return{}},undefinedText:"-",locale:void 0,virtualScroll:!1,virtualScrollItemHeight:void 0,sortable:!0,sortClass:void 0,silentSort:!0,sortName:void 0,sortOrder:void 0,sortReset:!1,sortStable:!1,rememberOrder:!1,serverSort:!0,customSort:void 0,columns:[[]],data:[],url:void 0,method:"get",cache:!0,contentType:"application/json",dataType:"json",ajax:void 0,ajaxOptions:{},queryParams:function(t){return t},queryParamsType:"limit",responseHandler:function(t){return t},totalField:"total",totalNotFilteredField:"totalNotFiltered",dataField:"rows",footerField:"footer",pagination:!1,paginationParts:["pageInfo","pageSize","pageList"],showExtendedPagination:!1,paginationLoop:!0,sidePagination:"client",totalRows:0,totalNotFiltered:0,pageNumber:1,pageSize:10,pageList:[10,25,50,100],paginationHAlign:"right",paginationVAlign:"bottom",paginationDetailHAlign:"left",paginationPreText:"&lsaquo;",paginationNextText:"&rsaquo;",paginationSuccessivelySize:5,paginationPagesBySide:1,paginationUseIntermediate:!1,search:!1,searchHighlight:!1,searchOnEnterKey:!1,strictSearch:!1,regexSearch:!1,searchSelector:!1,visibleSearch:!1,showButtonIcons:!0,showButtonText:!1,showSearchButton:!1,showSearchClearButton:!1,trimOnSearch:!0,searchAlign:"right",searchTimeOut:500,searchText:"",customSearch:void 0,showHeader:!0,showFooter:!1,footerStyle:function(t){return{}},searchAccentNeutralise:!1,showColumns:!1,showColumnsToggleAll:!1,showColumnsSearch:!1,minimumCountColumns:1,showPaginationSwitch:!1,showRefresh:!1,showToggle:!1,showFullscreen:!1,smartDisplay:!0,escape:!1,filterOptions:{filterAlgorithm:"and"},idField:void 0,selectItemName:"btSelectItem",clickToSelect:!1,ignoreClickToSelectOn:function(t){var e=t.tagName;return["A","BUTTON"].includes(e)},singleSelect:!1,checkboxHeader:!0,maintainMetaData:!1,multipleSelectRow:!1,uniqueId:void 0,cardView:!1,detailView:!1,detailViewIcon:!0,detailViewByClick:!1,detailViewAlign:"left",detailFormatter:function(t,e){return""},detailFilter:function(t,e){return!0},toolbar:void 0,toolbarAlign:"left",buttonsToolbar:void 0,buttonsAlign:"right",buttonsOrder:["paginationSwitch","refresh","toggle","fullscreen","columns"],buttonsPrefix:Ko.classes.buttonsPrefix,buttonsClass:Ko.classes.buttons,icons:Ko.icons,iconSize:void 0,iconsPrefix:Ko.iconsPrefix,loadingFontSize:"auto",loadingTemplate:function(t){return'<span class="loading-wrap">\n      <span class="loading-text">'.concat(t,'</span>\n      <span class="animation-wrap"><span class="animation-dot"></span></span>\n      </span>\n    ')},onAll:function(t,e){return!1},onClickCell:function(t,e,i,n){return!1},onDblClickCell:function(t,e,i,n){return!1},onClickRow:function(t,e){return!1},onDblClickRow:function(t,e){return!1},onSort:function(t,e){return!1},onCheck:function(t){return!1},onUncheck:function(t){return!1},onCheckAll:function(t){return!1},onUncheckAll:function(t){return!1},onCheckSome:function(t){return!1},onUncheckSome:function(t){return!1},onLoadSuccess:function(t){return!1},onLoadError:function(t){return!1},onColumnSwitch:function(t,e){return!1},onPageChange:function(t,e){return!1},onSearch:function(t){return!1},onToggle:function(t){return!1},onPreBody:function(t){return!1},onPostBody:function(){return!1},onPostHeader:function(){return!1},onPostFooter:function(){return!1},onExpandRow:function(t,e,i){return!1},onCollapseRow:function(t,e){return!1},onRefreshOptions:function(t){return!1},onRefresh:function(t){return!1},onResetView:function(){return!1},onScrollBody:function(){return!1},onTogglePagination:function(t){return!1}},Xo={formatLoadingMessage:function(){return"Loading, please wait"},formatRecordsPerPage:function(t){return"".concat(t," rows per page")},formatShowingRows:function(t,e,i,n){return void 0!==n&&n>0&&n>i?"Showing ".concat(t," to ").concat(e," of ").concat(i," rows (filtered from ").concat(n," total rows)"):"Showing ".concat(t," to ").concat(e," of ").concat(i," rows")},formatSRPaginationPreText:function(){return"previous page"},formatSRPaginationPageText:function(t){return"to page ".concat(t)},formatSRPaginationNextText:function(){return"next page"},formatDetailPagination:function(t){return"Showing ".concat(t," rows")},formatSearch:function(){return"Search"},formatClearSearch:function(){return"Clear Search"},formatNoMatches:function(){return"No matching records found"},formatPaginationSwitch:function(){return"Hide/Show pagination"},formatPaginationSwitchDown:function(){return"Show pagination"},formatPaginationSwitchUp:function(){return"Hide pagination"},formatRefresh:function(){return"Refresh"},formatToggle:function(){return"Toggle"},formatToggleOn:function(){return"Show card view"},formatToggleOff:function(){return"Hide card view"},formatColumns:function(){return"Columns"},formatColumnsToggleAll:function(){return"Toggle all"},formatFullscreen:function(){return"Fullscreen"},formatAllRows:function(){return"All"}},Jo={field:void 0,title:void 0,titleTooltip:void 0,class:void 0,width:void 0,widthUnit:"px",rowspan:void 0,colspan:void 0,align:void 0,halign:void 0,falign:void 0,valign:void 0,cellStyle:void 0,radio:!1,checkbox:!1,checkboxEnabled:!0,clickToSelect:!0,showSelectTitle:!1,sortable:!1,sortName:void 0,order:"asc",sorter:void 0,visible:!0,switchable:!0,cardVisible:!0,searchable:!0,formatter:void 0,footerFormatter:void 0,detailFormatter:void 0,searchFormatter:!0,searchHighlightFormatter:!1,escape:!1,events:void 0};Object.assign(Yo,Xo);var Qo={VERSION:"1.19.1",THEME:"bootstrap".concat(qo),CONSTANTS:Ko,DEFAULTS:Yo,COLUMN_DEFAULTS:Jo,METHODS:["getOptions","refreshOptions","getData","getSelections","load","append","prepend","remove","removeAll","insertRow","updateRow","getRowByUniqueId","updateByUniqueId","removeByUniqueId","updateCell","updateCellByUniqueId","showRow","hideRow","getHiddenRows","showColumn","hideColumn","getVisibleColumns","getHiddenColumns","showAllColumns","hideAllColumns","mergeCells","checkAll","uncheckAll","checkInvert","check","uncheck","checkBy","uncheckBy","refresh","destroy","resetView","showLoading","hideLoading","togglePagination","toggleFullscreen","toggleView","resetSearch","filterBy","scrollTo","getScrollPosition","selectPage","prevPage","nextPage","toggleDetailView","expandRow","collapseRow","expandRowByUniqueId","collapseRowByUniqueId","expandAllRows","collapseAllRows","updateColumnTitle","updateFormatText"],EVENTS:{"all.bs.table":"onAll","click-row.bs.table":"onClickRow","dbl-click-row.bs.table":"onDblClickRow","click-cell.bs.table":"onClickCell","dbl-click-cell.bs.table":"onDblClickCell","sort.bs.table":"onSort","check.bs.table":"onCheck","uncheck.bs.table":"onUncheck","check-all.bs.table":"onCheckAll","uncheck-all.bs.table":"onUncheckAll","check-some.bs.table":"onCheckSome","uncheck-some.bs.table":"onUncheckSome","load-success.bs.table":"onLoadSuccess","load-error.bs.table":"onLoadError","column-switch.bs.table":"onColumnSwitch","page-change.bs.table":"onPageChange","search.bs.table":"onSearch","toggle.bs.table":"onToggle","pre-body.bs.table":"onPreBody","post-body.bs.table":"onPostBody","post-header.bs.table":"onPostHeader","post-footer.bs.table":"onPostFooter","expand-row.bs.table":"onExpandRow","collapse-row.bs.table":"onCollapseRow","refresh-options.bs.table":"onRefreshOptions","reset-view.bs.table":"onResetView","refresh.bs.table":"onRefresh","scroll-body.bs.table":"onScrollBody","toggle-pagination.bs.table":"onTogglePagination","virtual-scroll.bs.table":"onVirtualScroll"},LOCALES:{en:Xo,"en-US":Xo}},Zo=v((function(){Ue(1)}));Mt({target:"Object",stat:!0,forced:Zo},{keys:function(t){return Ue(si(t))}}),$e("match",1,(function(t,e,i){return[function(e){var i=T(this),n=null==e?void 0:e[t];return void 0!==n?n.call(e,i):new RegExp(e)[t](String(i))},function(t){var n=i(e,t,this);if(n.done)return n.value;var o=V(t),a=String(this);if(!o.global)return Ve(o,a);var s=o.unicode;o.lastIndex=0;for(var r,l=[],c=0;null!==(r=Ve(o,a));){var h=String(r[0]);l[c]=h,""===h&&(o.lastIndex=De(a,wt(o.lastIndex),s)),c++}return 0===c?null:l}]}));var ta,ea=D.f,ia="".startsWith,na=Math.min,oa=Ti("startsWith"),aa=!(oa||(ta=ea(String.prototype,"startsWith"),!ta||ta.writable));Mt({target:"String",proto:!0,forced:!aa&&!oa},{startsWith:function(t){var e=String(T(this));Oi(t);var i=wt(na(arguments.length>1?arguments[1]:void 0,e.length)),n=String(t);return ia?ia.call(e,n,i):e.slice(i,i+n.length)===n}});var sa=D.f,ra="".endsWith,la=Math.min,ca=Ti("endsWith"),ha=!ca&&!!function(){var t=sa(String.prototype,"endsWith");return t&&!t.writable}();Mt({target:"String",proto:!0,forced:!ha&&!ca},{endsWith:function(t){var e=String(T(this));Oi(t);var i=arguments.length>1?arguments[1]:void 0,n=wt(e.length),o=void 0===i?n:la(wt(i),n),a=String(t);return ra?ra.call(e,a,o):e.slice(o-a.length,o)===a}});var ua={getSearchInput:function(t){return"string"==typeof t.options.searchSelector?i.default(t.options.searchSelector):t.$toolbar.find(".search input")},sprintf:function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];var o=!0,a=0,s=t.replace(/%s/g,(function(){var t=i[a++];return void 0===t?(o=!1,""):t}));return o?s:""},isObject:function(t){return t instanceof Object&&!Array.isArray(t)},isEmptyObject:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 0===Object.entries(t).length&&t.constructor===Object},isNumeric:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},getFieldTitle:function(t,e){var i,n=u(t);try{for(n.s();!(i=n.n()).done;){var o=i.value;if(o.field===e)return o.title}}catch(t){n.e(t)}finally{n.f()}return""},setFieldIndex:function(t){var e,i=0,n=[],o=u(t[0]);try{for(o.s();!(e=o.n()).done;){i+=e.value.colspan||1}}catch(t){o.e(t)}finally{o.f()}for(var a=0;a<t.length;a++){n[a]=[];for(var s=0;s<i;s++)n[a][s]=!1}for(var r=0;r<t.length;r++){var l,c=u(t[r]);try{for(c.s();!(l=c.n()).done;){var h=l.value,d=h.rowspan||1,f=h.colspan||1,p=n[r].indexOf(!1);h.colspanIndex=p,1===f?(h.fieldIndex=p,void 0===h.field&&(h.field=p)):h.colspanGroup=h.colspan;for(var g=0;g<d;g++)for(var v=0;v<f;v++)n[r+g][p+v]=!0}}catch(t){c.e(t)}finally{c.f()}}},normalizeAccent:function(t){return"string"!=typeof t?t:t.normalize("NFD").replace(/[\u0300-\u036f]/g,"")},updateFieldGroup:function(t){var e,i,n=(e=[]).concat.apply(e,l(t)),o=u(t);try{for(o.s();!(i=o.n()).done;){var a,s=u(i.value);try{for(s.s();!(a=s.n()).done;){var r=a.value;if(r.colspanGroup>1){for(var c=0,h=function(t){n.find((function(e){return e.fieldIndex===t})).visible&&c++},d=r.colspanIndex;d<r.colspanIndex+r.colspanGroup;d++)h(d);r.colspan=c,r.visible=c>0}}}catch(t){s.e(t)}finally{s.f()}}}catch(t){o.e(t)}finally{o.f()}},getScrollBarWidth:function(){if(void 0===this.cachedWidth){var t=i.default("<div/>").addClass("fixed-table-scroll-inner"),e=i.default("<div/>").addClass("fixed-table-scroll-outer");e.append(t),i.default("body").append(e);var n=t[0].offsetWidth;e.css("overflow","scroll");var o=t[0].offsetWidth;n===o&&(o=e[0].clientWidth),e.remove(),this.cachedWidth=n-o}return this.cachedWidth},calculateObjectValue:function(t,e,i,o){var a=e;if("string"==typeof e){var s=e.split(".");if(s.length>1){a=window;var r,c=u(s);try{for(c.s();!(r=c.n()).done;){a=a[r.value]}}catch(t){c.e(t)}finally{c.f()}}else a=window[e]}return null!==a&&"object"===n(a)?a:"function"==typeof a?a.apply(t,i||[]):!a&&"string"==typeof e&&this.sprintf.apply(this,[e].concat(l(i)))?this.sprintf.apply(this,[e].concat(l(i))):o},compareObjects:function(t,e,i){var n=Object.keys(t),o=Object.keys(e);if(i&&n.length!==o.length)return!1;for(var a=0,s=n;a<s.length;a++){var r=s[a];if(o.includes(r)&&t[r]!==e[r])return!1}return!0},regexCompare:function(t,e){try{var i=e.match(/^\/(.*?)\/([gim]*)$/);if(-1!==t.toString().search(i?new RegExp(i[1],i[2]):new RegExp(e,"gim")))return!0}catch(t){return!1}},escapeHTML:function(t){return t?t.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"):t},unescapeHTML:function(t){return t?t.toString().replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'"):t},getRealDataAttr:function(t){for(var e=0,i=Object.entries(t);e<i.length;e++){var n=r(i[e],2),o=n[0],a=n[1],s=o.split(/(?=[A-Z])/).join("-").toLowerCase();s!==o&&(t[s]=a,delete t[o])}return t},getItemField:function(t,e,i){var n=t;if("string"!=typeof e||t.hasOwnProperty(e))return i?this.escapeHTML(t[e]):t[e];var o,a=u(e.split("."));try{for(a.s();!(o=a.n()).done;){var s=o.value;n=n&&n[s]}}catch(t){a.e(t)}finally{a.f()}return i?this.escapeHTML(n):n},isIEBrowser:function(){return navigator.userAgent.includes("MSIE ")||/Trident.*rv:11\./.test(navigator.userAgent)},findIndex:function(t,e){var i,n=u(t);try{for(n.s();!(i=n.n()).done;){var o=i.value;if(JSON.stringify(o)===JSON.stringify(e))return t.indexOf(o)}}catch(t){n.e(t)}finally{n.f()}return-1},trToData:function(t,e){var n=this,o=[],a=[];return e.each((function(e,s){var r=i.default(s),l={};l._id=r.attr("id"),l._class=r.attr("class"),l._data=n.getRealDataAttr(r.data()),l._style=r.attr("style"),r.find(">td,>th").each((function(o,s){for(var r=i.default(s),c=+r.attr("colspan")||1,h=+r.attr("rowspan")||1,u=o;a[e]&&a[e][u];u++);for(var d=u;d<u+c;d++)for(var f=e;f<e+h;f++)a[f]||(a[f]=[]),a[f][d]=!0;var p=t[u].field;l[p]=r.html().trim(),l["_".concat(p,"_id")]=r.attr("id"),l["_".concat(p,"_class")]=r.attr("class"),l["_".concat(p,"_rowspan")]=r.attr("rowspan"),l["_".concat(p,"_colspan")]=r.attr("colspan"),l["_".concat(p,"_title")]=r.attr("title"),l["_".concat(p,"_data")]=n.getRealDataAttr(r.data()),l["_".concat(p,"_style")]=r.attr("style")})),o.push(l)})),o},sort:function(t,e,i,n,o,a){return null==t&&(t=""),null==e&&(e=""),n&&t===e&&(t=o,e=a),this.isNumeric(t)&&this.isNumeric(e)?(t=parseFloat(t))<(e=parseFloat(e))?-1*i:t>e?i:0:t===e?0:("string"!=typeof t&&(t=t.toString()),-1===t.localeCompare(e)?-1*i:i)},getEventName:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e=e||"".concat(+new Date).concat(~~(1e6*Math.random())),"".concat(t,"-").concat(e)},hasDetailViewIcon:function(t){return t.detailView&&t.detailViewIcon&&!t.cardView},getDetailViewIndexOffset:function(t){return this.hasDetailViewIcon(t)&&"right"!==t.detailViewAlign?1:0},checkAutoMergeCells:function(t){var e,i=u(t);try{for(i.s();!(e=i.n()).done;)for(var n=e.value,o=0,a=Object.keys(n);o<a.length;o++){var s=a[o];if(s.startsWith("_")&&(s.endsWith("_rowspan")||s.endsWith("_colspan")))return!0}}catch(t){i.e(t)}finally{i.f()}return!1},deepCopy:function(t){return void 0===t?t:i.default.extend(!0,Array.isArray(t)?[]:{},t)}},da=function(){function t(e){var i=this;o(this,t),this.rows=e.rows,this.scrollEl=e.scrollEl,this.contentEl=e.contentEl,this.callback=e.callback,this.itemHeight=e.itemHeight,this.cache={},this.scrollTop=this.scrollEl.scrollTop,this.initDOM(this.rows,e.fixedScroll),this.scrollEl.scrollTop=this.scrollTop,this.lastCluster=0;var n=function(){i.lastCluster!==(i.lastCluster=i.getNum())&&(i.initDOM(i.rows),i.callback(i.startIndex,i.endIndex))};this.scrollEl.addEventListener("scroll",n,!1),this.destroy=function(){i.contentEl.innerHtml="",i.scrollEl.removeEventListener("scroll",n,!1)}}return s(t,[{key:"initDOM",value:function(t,e){void 0===this.clusterHeight&&(this.cache.scrollTop=this.scrollEl.scrollTop,this.cache.data=this.contentEl.innerHTML=t[0]+t[0]+t[0],this.getRowsHeight(t));var i=this.initData(t,this.getNum(e)),n=i.rows.join(""),o=this.checkChanges("data",n),a=this.checkChanges("top",i.topOffset),s=this.checkChanges("bottom",i.bottomOffset),r=[];o&&a?(i.topOffset&&r.push(this.getExtra("top",i.topOffset)),r.push(n),i.bottomOffset&&r.push(this.getExtra("bottom",i.bottomOffset)),this.startIndex=i.start,this.endIndex=i.end,this.contentEl.innerHTML=r.join(""),e&&(this.contentEl.scrollTop=this.cache.scrollTop)):s&&(this.contentEl.lastChild.style.height="".concat(i.bottomOffset,"px"))}},{key:"getRowsHeight",value:function(){if(void 0===this.itemHeight){var t=this.contentEl.children,e=t[Math.floor(t.length/2)];this.itemHeight=e.offsetHeight}this.blockHeight=50*this.itemHeight,this.clusterRows=200,this.clusterHeight=4*this.blockHeight}},{key:"getNum",value:function(t){return this.scrollTop=t?this.cache.scrollTop:this.scrollEl.scrollTop,Math.floor(this.scrollTop/(this.clusterHeight-this.blockHeight))||0}},{key:"initData",value:function(t,e){if(t.length<50)return{topOffset:0,bottomOffset:0,rowsAbove:0,rows:t};var i=Math.max((this.clusterRows-50)*e,0),n=i+this.clusterRows,o=Math.max(i*this.itemHeight,0),a=Math.max((t.length-n)*this.itemHeight,0),s=[],r=i;o<1&&r++;for(var l=i;l<n;l++)t[l]&&s.push(t[l]);return{start:i,end:n,topOffset:o,bottomOffset:a,rowsAbove:r,rows:s}}},{key:"checkChanges",value:function(t,e){var i=e!==this.cache[t];return this.cache[t]=e,i}},{key:"getExtra",value:function(t,e){var i=document.createElement("tr");return i.className="virtual-scroll-".concat(t),e&&(i.style.height="".concat(e,"px")),i.outerHTML}}]),t}(),fa=function(){function t(e,n){o(this,t),this.options=n,this.$el=i.default(e),this.$el_=this.$el.clone(),this.timeoutId_=0,this.timeoutFooter_=0}return s(t,[{key:"init",value:function(){this.initConstants(),this.initLocale(),this.initContainer(),this.initTable(),this.initHeader(),this.initData(),this.initHiddenRows(),this.initToolbar(),this.initPagination(),this.initBody(),this.initSearchText(),this.initServer()}},{key:"initConstants",value:function(){var t=this.options;this.constants=Qo.CONSTANTS,this.constants.theme=i.default.fn.bootstrapTable.theme,this.constants.dataToggle=this.constants.html.dataToggle||"data-toggle";var e=t.buttonsPrefix?"".concat(t.buttonsPrefix,"-"):"";this.constants.buttonsClass=[t.buttonsPrefix,e+t.buttonsClass,ua.sprintf("".concat(e,"%s"),t.iconSize)].join(" ").trim(),this.buttons=ua.calculateObjectValue(this,t.buttons,[],{}),"object"!==n(this.buttons)&&(this.buttons={}),"string"==typeof t.icons&&(t.icons=ua.calculateObjectValue(null,t.icons))}},{key:"initLocale",value:function(){if(this.options.locale){var e=i.default.fn.bootstrapTable.locales,n=this.options.locale.split(/-|_/);n[0]=n[0].toLowerCase(),n[1]&&(n[1]=n[1].toUpperCase());var o={};e[this.options.locale]?o=e[this.options.locale]:e[n.join("-")]?o=e[n.join("-")]:e[n[0]]&&(o=e[n[0]]);for(var a=0,s=Object.entries(o);a<s.length;a++){var l=r(s[a],2),c=l[0],h=l[1];this.options[c]===t.DEFAULTS[c]&&(this.options[c]=h)}}}},{key:"initContainer",value:function(){var t=["top","both"].includes(this.options.paginationVAlign)?'<div class="fixed-table-pagination clearfix"></div>':"",e=["bottom","both"].includes(this.options.paginationVAlign)?'<div class="fixed-table-pagination"></div>':"",n=ua.calculateObjectValue(this.options,this.options.loadingTemplate,[this.options.formatLoadingMessage()]);this.$container=i.default('\n      <div class="bootstrap-table '.concat(this.constants.theme,'">\n      <div class="fixed-table-toolbar"></div>\n      ').concat(t,'\n      <div class="fixed-table-container">\n      <div class="fixed-table-header"><table></table></div>\n      <div class="fixed-table-body">\n      <div class="fixed-table-loading">\n      ').concat(n,'\n      </div>\n      </div>\n      <div class="fixed-table-footer"></div>\n      </div>\n      ').concat(e,"\n      </div>\n    ")),this.$container.insertAfter(this.$el),this.$tableContainer=this.$container.find(".fixed-table-container"),this.$tableHeader=this.$container.find(".fixed-table-header"),this.$tableBody=this.$container.find(".fixed-table-body"),this.$tableLoading=this.$container.find(".fixed-table-loading"),this.$tableFooter=this.$el.find("tfoot"),this.options.buttonsToolbar?this.$toolbar=i.default("body").find(this.options.buttonsToolbar):this.$toolbar=this.$container.find(".fixed-table-toolbar"),this.$pagination=this.$container.find(".fixed-table-pagination"),this.$tableBody.append(this.$el),this.$container.after('<div class="clearfix"></div>'),this.$el.addClass(this.options.classes),this.$tableLoading.addClass(this.options.classes),this.options.height&&(this.$tableContainer.addClass("fixed-height"),this.options.showFooter&&this.$tableContainer.addClass("has-footer"),this.options.classes.split(" ").includes("table-bordered")&&(this.$tableBody.append('<div class="fixed-table-border"></div>'),this.$tableBorder=this.$tableBody.find(".fixed-table-border"),this.$tableLoading.addClass("fixed-table-border")),this.$tableFooter=this.$container.find(".fixed-table-footer"))}},{key:"initTable",value:function(){var e=this,n=[];if(this.$header=this.$el.find(">thead"),this.$header.length?this.options.theadClasses&&this.$header.addClass(this.options.theadClasses):this.$header=i.default('<thead class="'.concat(this.options.theadClasses,'"></thead>')).appendTo(this.$el),this._headerTrClasses=[],this._headerTrStyles=[],this.$header.find("tr").each((function(t,o){var a=i.default(o),s=[];a.find("th").each((function(t,e){var n=i.default(e);void 0!==n.data("field")&&n.data("field","".concat(n.data("field"))),s.push(i.default.extend({},{title:n.html(),class:n.attr("class"),titleTooltip:n.attr("title"),rowspan:n.attr("rowspan")?+n.attr("rowspan"):void 0,colspan:n.attr("colspan")?+n.attr("colspan"):void 0},n.data()))})),n.push(s),a.attr("class")&&e._headerTrClasses.push(a.attr("class")),a.attr("style")&&e._headerTrStyles.push(a.attr("style"))})),Array.isArray(this.options.columns[0])||(this.options.columns=[this.options.columns]),this.options.columns=i.default.extend(!0,[],n,this.options.columns),this.columns=[],this.fieldsColumnsIndex=[],ua.setFieldIndex(this.options.columns),this.options.columns.forEach((function(n,o){n.forEach((function(n,a){var s=i.default.extend({},t.COLUMN_DEFAULTS,n);void 0!==s.fieldIndex&&(e.columns[s.fieldIndex]=s,e.fieldsColumnsIndex[s.field]=s.fieldIndex),e.options.columns[o][a]=s}))})),!this.options.data.length){var o=ua.trToData(this.columns,this.$el.find(">tbody>tr"));o.length&&(this.options.data=o,this.fromHtml=!0)}this.options.pagination&&"server"!==this.options.sidePagination||(this.footerData=ua.trToData(this.columns,this.$el.find(">tfoot>tr"))),this.footerData&&this.$el.find("tfoot").html("<tr></tr>"),!this.options.showFooter||this.options.cardView?this.$tableFooter.hide():this.$tableFooter.show()}},{key:"initHeader",value:function(){var t=this,e={},n=[];this.header={fields:[],styles:[],classes:[],formatters:[],detailFormatters:[],events:[],sorters:[],sortNames:[],cellStyles:[],searchables:[]},ua.updateFieldGroup(this.options.columns),this.options.columns.forEach((function(i,o){var a=[];a.push("<tr".concat(ua.sprintf(' class="%s"',t._headerTrClasses[o])," ").concat(ua.sprintf(' style="%s"',t._headerTrStyles[o]),">"));var s="";if(0===o&&ua.hasDetailViewIcon(t.options)){var l=t.options.columns.length>1?' rowspan="'.concat(t.options.columns.length,'"'):"";s='<th class="detail"'.concat(l,'>\n          <div class="fht-cell"></div>\n          </th>')}s&&"right"!==t.options.detailViewAlign&&a.push(s),i.forEach((function(i,n){var s=ua.sprintf(' class="%s"',i.class),l=i.widthUnit,c=parseFloat(i.width),h=ua.sprintf("text-align: %s; ",i.halign?i.halign:i.align),u=ua.sprintf("text-align: %s; ",i.align),d=ua.sprintf("vertical-align: %s; ",i.valign);if(d+=ua.sprintf("width: %s; ",!i.checkbox&&!i.radio||c?c?c+l:void 0:i.showSelectTitle?void 0:"36px"),void 0!==i.fieldIndex||i.visible){var f=ua.calculateObjectValue(null,t.options.headerStyle,[i]),p=[],g="";if(f&&f.css)for(var v=0,b=Object.entries(f.css);v<b.length;v++){var m=r(b[v],2),y=m[0],w=m[1];p.push("".concat(y,": ").concat(w))}if(f&&f.classes&&(g=ua.sprintf(' class="%s"',i.class?[i.class,f.classes].join(" "):f.classes)),void 0!==i.fieldIndex){if(t.header.fields[i.fieldIndex]=i.field,t.header.styles[i.fieldIndex]=u+d,t.header.classes[i.fieldIndex]=s,t.header.formatters[i.fieldIndex]=i.formatter,t.header.detailFormatters[i.fieldIndex]=i.detailFormatter,t.header.events[i.fieldIndex]=i.events,t.header.sorters[i.fieldIndex]=i.sorter,t.header.sortNames[i.fieldIndex]=i.sortName,t.header.cellStyles[i.fieldIndex]=i.cellStyle,t.header.searchables[i.fieldIndex]=i.searchable,!i.visible)return;if(t.options.cardView&&!i.cardVisible)return;e[i.field]=i}a.push("<th".concat(ua.sprintf(' title="%s"',i.titleTooltip)),i.checkbox||i.radio?ua.sprintf(' class="bs-checkbox %s"',i.class||""):g||s,ua.sprintf(' style="%s"',h+d+p.join("; ")),ua.sprintf(' rowspan="%s"',i.rowspan),ua.sprintf(' colspan="%s"',i.colspan),ua.sprintf(' data-field="%s"',i.field),0===n&&o>0?" data-not-first-th":"",">"),a.push(ua.sprintf('<div class="th-inner %s">',t.options.sortable&&i.sortable?"sortable both":""));var S=t.options.escape?ua.escapeHTML(i.title):i.title,x=S;i.checkbox&&(S="",!t.options.singleSelect&&t.options.checkboxHeader&&(S='<label><input name="btSelectAll" type="checkbox" /><span></span></label>'),t.header.stateField=i.field),i.radio&&(S="",t.header.stateField=i.field),!S&&i.showSelectTitle&&(S+=x),a.push(S),a.push("</div>"),a.push('<div class="fht-cell"></div>'),a.push("</div>"),a.push("</th>")}})),s&&"right"===t.options.detailViewAlign&&a.push(s),a.push("</tr>"),a.length>3&&n.push(a.join(""))})),this.$header.html(n.join("")),this.$header.find("th[data-field]").each((function(t,n){i.default(n).data(e[i.default(n).data("field")])})),this.$container.off("click",".th-inner").on("click",".th-inner",(function(e){var n=i.default(e.currentTarget);if(t.options.detailView&&!n.parent().hasClass("bs-checkbox")&&n.closest(".bootstrap-table")[0]!==t.$container[0])return!1;t.options.sortable&&n.parent().data().sortable&&t.onSort(e)}));var o=ua.getEventName("resize.bootstrap-table",this.$el.attr("id"));i.default(window).off(o),!this.options.showHeader||this.options.cardView?(this.$header.hide(),this.$tableHeader.hide(),this.$tableLoading.css("top",0)):(this.$header.show(),this.$tableHeader.show(),this.$tableLoading.css("top",this.$header.outerHeight()+1),this.getCaret(),i.default(window).on(o,(function(){return t.resetView()}))),this.$selectAll=this.$header.find('[name="btSelectAll"]'),this.$selectAll.off("click").on("click",(function(e){e.stopPropagation();var n=i.default(e.currentTarget).prop("checked");t[n?"checkAll":"uncheckAll"](),t.updateSelected()}))}},{key:"initData",value:function(t,e){"append"===e?this.options.data=this.options.data.concat(t):"prepend"===e?this.options.data=[].concat(t).concat(this.options.data):(t=t||ua.deepCopy(this.options.data),this.options.data=Array.isArray(t)?t:t[this.options.dataField]),this.data=l(this.options.data),this.options.sortReset&&(this.unsortedData=l(this.data)),"server"!==this.options.sidePagination&&this.initSort()}},{key:"initSort",value:function(){var t=this,e=this.options.sortName,i="desc"===this.options.sortOrder?-1:1,n=this.header.fields.indexOf(this.options.sortName),o=0;-1!==n?(this.options.sortStable&&this.data.forEach((function(t,e){t.hasOwnProperty("_position")||(t._position=e)})),this.options.customSort?ua.calculateObjectValue(this.options,this.options.customSort,[this.options.sortName,this.options.sortOrder,this.data]):this.data.sort((function(o,a){t.header.sortNames[n]&&(e=t.header.sortNames[n]);var s=ua.getItemField(o,e,t.options.escape),r=ua.getItemField(a,e,t.options.escape),l=ua.calculateObjectValue(t.header,t.header.sorters[n],[s,r,o,a]);return void 0!==l?t.options.sortStable&&0===l?i*(o._position-a._position):i*l:ua.sort(s,r,i,t.options.sortStable,o._position,a._position)})),void 0!==this.options.sortClass&&(clearTimeout(o),o=setTimeout((function(){t.$el.removeClass(t.options.sortClass);var e=t.$header.find('[data-field="'.concat(t.options.sortName,'"]')).index();t.$el.find("tr td:nth-child(".concat(e+1,")")).addClass(t.options.sortClass)}),250))):this.options.sortReset&&(this.data=l(this.unsortedData))}},{key:"onSort",value:function(t){var e=t.type,n=t.currentTarget,o="keypress"===e?i.default(n):i.default(n).parent(),a=this.$header.find("th").eq(o.index());if(this.$header.add(this.$header_).find("span.order").remove(),this.options.sortName===o.data("field")){var s=this.options.sortOrder;void 0===s?this.options.sortOrder="asc":"asc"===s?this.options.sortOrder="desc":"desc"===this.options.sortOrder&&(this.options.sortOrder=this.options.sortReset?void 0:"asc"),void 0===this.options.sortOrder&&(this.options.sortName=void 0)}else this.options.sortName=o.data("field"),this.options.rememberOrder?this.options.sortOrder="asc"===o.data("order")?"desc":"asc":this.options.sortOrder=this.columns[this.fieldsColumnsIndex[o.data("field")]].sortOrder||this.columns[this.fieldsColumnsIndex[o.data("field")]].order;if(this.trigger("sort",this.options.sortName,this.options.sortOrder),o.add(a).data("order",this.options.sortOrder),this.getCaret(),"server"===this.options.sidePagination&&this.options.serverSort)return this.options.pageNumber=1,void this.initServer(this.options.silentSort);this.initSort(),this.initBody()}},{key:"initToolbar",value:function(){var t,e=this,o=this.options,a=[],s=0,l=0;this.$toolbar.find(".bs-bars").children().length&&i.default("body").append(i.default(o.toolbar)),this.$toolbar.html(""),"string"!=typeof o.toolbar&&"object"!==n(o.toolbar)||i.default(ua.sprintf('<div class="bs-bars %s-%s"></div>',this.constants.classes.pull,o.toolbarAlign)).appendTo(this.$toolbar).append(i.default(o.toolbar)),a=['<div class="'.concat(["columns","columns-".concat(o.buttonsAlign),this.constants.classes.buttonsGroup,"".concat(this.constants.classes.pull,"-").concat(o.buttonsAlign)].join(" "),'">')],"string"==typeof o.buttonsOrder&&(o.buttonsOrder=o.buttonsOrder.replace(/\[|\]| |'/g,"").split(",")),this.buttons=Object.assign(this.buttons,{paginationSwitch:{text:o.pagination?o.formatPaginationSwitchUp():o.formatPaginationSwitchDown(),icon:o.pagination?o.icons.paginationSwitchDown:o.icons.paginationSwitchUp,render:!1,event:this.togglePagination,attributes:{"aria-label":o.formatPaginationSwitch(),title:o.formatPaginationSwitch()}},refresh:{text:o.formatRefresh(),icon:o.icons.refresh,render:!1,event:this.refresh,attributes:{"aria-label":o.formatRefresh(),title:o.formatRefresh()}},toggle:{text:o.formatToggle(),icon:o.icons.toggleOff,render:!1,event:this.toggleView,attributes:{"aria-label":o.formatToggleOn(),title:o.formatToggleOn()}},fullscreen:{text:o.formatFullscreen(),icon:o.icons.fullscreen,render:!1,event:this.toggleFullscreen,attributes:{"aria-label":o.formatFullscreen(),title:o.formatFullscreen()}},columns:{render:!1,html:function(){var t=[];if(t.push('<div class="keep-open '.concat(e.constants.classes.buttonsDropdown,'" title="').concat(o.formatColumns(),'">\n            <button class="').concat(e.constants.buttonsClass,' dropdown-toggle" type="button" ').concat(e.constants.dataToggle,'="dropdown"\n            aria-label="Columns" title="').concat(o.formatColumns(),'">\n            ').concat(o.showButtonIcons?ua.sprintf(e.constants.html.icon,o.iconsPrefix,o.icons.columns):"","\n            ").concat(o.showButtonText?o.formatColumns():"","\n            ").concat(e.constants.html.dropdownCaret,"\n            </button>\n            ").concat(e.constants.html.toolbarDropdown[0])),o.showColumnsSearch&&(t.push(ua.sprintf(e.constants.html.toolbarDropdownItem,ua.sprintf('<input type="text" class="%s" name="columnsSearch" placeholder="%s" autocomplete="off">',e.constants.classes.input,o.formatSearch()))),t.push(e.constants.html.toolbarDropdownSeparator)),o.showColumnsToggleAll){var i=e.getVisibleColumns().length===e.columns.filter((function(t){return!e.isSelectionColumn(t)})).length;t.push(ua.sprintf(e.constants.html.toolbarDropdownItem,ua.sprintf('<input type="checkbox" class="toggle-all" %s> <span>%s</span>',i?'checked="checked"':"",o.formatColumnsToggleAll()))),t.push(e.constants.html.toolbarDropdownSeparator)}var n=0;return e.columns.forEach((function(t){t.visible&&n++})),e.columns.forEach((function(i,a){if(!e.isSelectionColumn(i)&&(!o.cardView||i.cardVisible)){var s=i.visible?' checked="checked"':"",r=n<=o.minimumCountColumns&&s?' disabled="disabled"':"";i.switchable&&(t.push(ua.sprintf(e.constants.html.toolbarDropdownItem,ua.sprintf('<input type="checkbox" data-field="%s" value="%s"%s%s> <span>%s</span>',i.field,a,s,r,i.title))),l++)}})),t.push(e.constants.html.toolbarDropdown[1],"</div>"),t.join("")}}});for(var c={},h=0,d=Object.entries(this.buttons);h<d.length;h++){var f=r(d[h],2),p=f[0],g=f[1],v=void 0;if(g.hasOwnProperty("html"))"function"==typeof g.html?v=g.html():"string"==typeof g.html&&(v=g.html);else{if(v='<button class="'.concat(this.constants.buttonsClass,'" type="button" name="').concat(p,'"'),g.hasOwnProperty("attributes"))for(var b=0,m=Object.entries(g.attributes);b<m.length;b++){var y=r(m[b],2),w=y[0],S=y[1];v+=" ".concat(w,'="').concat(S,'"')}v+=">",o.showButtonIcons&&g.hasOwnProperty("icon")&&(v+="".concat(ua.sprintf(this.constants.html.icon,o.iconsPrefix,g.icon)," ")),o.showButtonText&&g.hasOwnProperty("text")&&(v+=g.text),v+="</button>"}c[p]=v;var x="show".concat(p.charAt(0).toUpperCase()).concat(p.substring(1)),k=o[x];!(!g.hasOwnProperty("render")||g.hasOwnProperty("render")&&g.render)||void 0!==k&&!0!==k||(o[x]=!0),o.buttonsOrder.includes(p)||o.buttonsOrder.push(p)}var O,C=u(o.buttonsOrder);try{for(C.s();!(O=C.n()).done;){var T=O.value;o["show".concat(T.charAt(0).toUpperCase()).concat(T.substring(1))]&&a.push(c[T])}}catch(t){C.e(t)}finally{C.f()}a.push("</div>"),(this.showToolbar||a.length>2)&&this.$toolbar.append(a.join(""));for(var P=0,I=Object.entries(this.buttons);P<I.length;P++){var A=r(I[P],2),$=A[0],E=A[1];if(E.hasOwnProperty("event")){if("function"==typeof E.event||"string"==typeof E.event)if("continue"===function(){var t="string"==typeof E.event?window[E.event]:E.event;return e.$toolbar.find('button[name="'.concat($,'"]')).off("click").on("click",(function(){return t.call(e)})),"continue"}())continue;for(var R=function(){var t=r(_[j],2),i=t[0],n=t[1],o="string"==typeof n?window[n]:n;e.$toolbar.find('button[name="'.concat($,'"]')).off(i).on(i,(function(){return o.call(e)}))},j=0,_=Object.entries(E.event);j<_.length;j++)R()}}if(o.showColumns){var N=(t=this.$toolbar.find(".keep-open")).find('input[type="checkbox"]:not(".toggle-all")'),F=t.find('input[type="checkbox"].toggle-all');if(l<=o.minimumCountColumns&&t.find("input").prop("disabled",!0),t.find("li, label").off("click").on("click",(function(t){t.stopImmediatePropagation()})),N.off("click").on("click",(function(t){var n=t.currentTarget,o=i.default(n);e._toggleColumn(o.val(),o.prop("checked"),!1),e.trigger("column-switch",o.data("field"),o.prop("checked")),F.prop("checked",N.filter(":checked").length===e.columns.filter((function(t){return!e.isSelectionColumn(t)})).length)})),F.off("click").on("click",(function(t){var n=t.currentTarget;e._toggleAllColumns(i.default(n).prop("checked"))})),o.showColumnsSearch){var D=t.find('[name="columnsSearch"]'),V=t.find(".dropdown-item-marker");D.on("keyup paste change",(function(t){var e=t.currentTarget,n=i.default(e).val().toLowerCase();V.show(),N.each((function(t,e){var o=i.default(e).parents(".dropdown-item-marker");o.text().toLowerCase().includes(n)||o.hide()}))}))}}var B=function(t){var i="keyup drop blur mouseup";t.off(i).on(i,(function(t){o.searchOnEnterKey&&13!==t.keyCode||[37,38,39,40].includes(t.keyCode)||(clearTimeout(s),s=setTimeout((function(){e.onSearch({currentTarget:t.currentTarget})}),o.searchTimeOut))}))};if((o.search||this.showSearchClearButton)&&"string"!=typeof o.searchSelector){a=[];var L=ua.sprintf(this.constants.html.searchButton,this.constants.buttonsClass,o.formatSearch(),o.showButtonIcons?ua.sprintf(this.constants.html.icon,o.iconsPrefix,o.icons.search):"",o.showButtonText?o.formatSearch():""),H=ua.sprintf(this.constants.html.searchClearButton,this.constants.buttonsClass,o.formatClearSearch(),o.showButtonIcons?ua.sprintf(this.constants.html.icon,o.iconsPrefix,o.icons.clearSearch):"",o.showButtonText?o.formatClearSearch():""),M='<input class="'.concat(this.constants.classes.input,"\n        ").concat(ua.sprintf(" %s%s",this.constants.classes.inputPrefix,o.iconSize),'\n        search-input" type="search" placeholder="').concat(o.formatSearch(),'" autocomplete="off">'),U=M;if(o.showSearchButton||o.showSearchClearButton){var z=(o.showSearchButton?L:"")+(o.showSearchClearButton?H:"");U=o.search?ua.sprintf(this.constants.html.inputGroup,M,z):z}a.push(ua.sprintf('\n        <div class="'.concat(this.constants.classes.pull,"-").concat(o.searchAlign," search ").concat(this.constants.classes.inputGroup,'">\n          %s\n        </div>\n      '),U)),this.$toolbar.append(a.join(""));var q=ua.getSearchInput(this);o.showSearchButton?(this.$toolbar.find(".search button[name=search]").off("click").on("click",(function(){clearTimeout(s),s=setTimeout((function(){e.onSearch({currentTarget:q})}),o.searchTimeOut)})),o.searchOnEnterKey&&B(q)):B(q),o.showSearchClearButton&&this.$toolbar.find(".search button[name=clearSearch]").click((function(){e.resetSearch()}))}else if("string"==typeof o.searchSelector){B(ua.getSearchInput(this))}}},{key:"onSearch",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.currentTarget,n=t.firedByInitSearchText,o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(void 0!==e&&i.default(e).length&&o){var a=i.default(e).val().trim();if(this.options.trimOnSearch&&i.default(e).val()!==a&&i.default(e).val(a),this.searchText===a)return;var s=ua.getSearchInput(this),r=e instanceof jQuery?e:i.default(e);(r.is(s)||r.hasClass("search-input"))&&(this.searchText=a,this.options.searchText=a)}n||(this.options.pageNumber=1),this.initSearch(),n?"client"===this.options.sidePagination&&this.updatePagination():this.updatePagination(),this.trigger("search",this.searchText)}},{key:"initSearch",value:function(){var t=this;if(this.filterOptions=this.filterOptions||this.options.filterOptions,"server"!==this.options.sidePagination){if(this.options.customSearch)return this.data=ua.calculateObjectValue(this.options,this.options.customSearch,[this.options.data,this.searchText,this.filterColumns]),void(this.options.sortReset&&(this.unsortedData=l(this.data)));var e=this.searchText&&(this.fromHtml?ua.escapeHTML(this.searchText):this.searchText),i=e?e.toLowerCase():"",n=ua.isEmptyObject(this.filterColumns)?null:this.filterColumns;this.options.searchAccentNeutralise&&(i=ua.normalizeAccent(i)),"function"==typeof this.filterOptions.filterAlgorithm?this.data=this.options.data.filter((function(e){return t.filterOptions.filterAlgorithm.apply(null,[e,n])})):"string"==typeof this.filterOptions.filterAlgorithm&&(this.data=n?this.options.data.filter((function(e){var i=t.filterOptions.filterAlgorithm;if("and"===i){for(var o in n)if(Array.isArray(n[o])&&!n[o].includes(e[o])||!Array.isArray(n[o])&&e[o]!==n[o])return!1}else if("or"===i){var a=!1;for(var s in n)(Array.isArray(n[s])&&n[s].includes(e[s])||!Array.isArray(n[s])&&e[s]===n[s])&&(a=!0);return a}return!0})):l(this.options.data));var o=this.getVisibleFields();this.data=i?this.data.filter((function(n,a){for(var s=0;s<t.header.fields.length;s++)if(t.header.searchables[s]&&(!t.options.visibleSearch||-1!==o.indexOf(t.header.fields[s]))){var r=ua.isNumeric(t.header.fields[s])?parseInt(t.header.fields[s],10):t.header.fields[s],l=t.columns[t.fieldsColumnsIndex[r]],c=void 0;if("string"==typeof r){c=n;for(var h=r.split("."),u=0;u<h.length;u++)null!==c[h[u]]&&(c=c[h[u]])}else c=n[r];if(t.options.searchAccentNeutralise&&(c=ua.normalizeAccent(c)),l&&l.searchFormatter&&(c=ua.calculateObjectValue(l,t.header.formatters[s],[c,n,a,l.field],c)),"string"==typeof c||"number"==typeof c){if(t.options.strictSearch&&"".concat(c).toLowerCase()===i||t.options.regexSearch&&ua.regexCompare(c,e))return!0;var d=/(?:(<=|=>|=<|>=|>|<)(?:\s+)?(-?\d+)?|(-?\d+)?(\s+)?(<=|=>|=<|>=|>|<))/gm.exec(t.searchText),f=!1;if(d){var p=d[1]||"".concat(d[5],"l"),g=d[2]||d[3],v=parseInt(c,10),b=parseInt(g,10);switch(p){case">":case"<l":f=v>b;break;case"<":case">l":f=v<b;break;case"<=":case"=<":case">=l":case"=>l":f=v<=b;break;case">=":case"=>":case"<=l":case"=<l":f=v>=b}}if(f||"".concat(c).toLowerCase().includes(i))return!0}}return!1})):this.data,this.options.sortReset&&(this.unsortedData=l(this.data)),this.initSort()}}},{key:"initPagination",value:function(){var t=this,e=this.options;if(e.pagination){this.$pagination.show();var i,n,o,a,s,r,l,c=[],h=!1,u=this.getData({includeHiddenRows:!1}),d=e.pageList;if("string"==typeof d&&(d=d.replace(/\[|\]| /g,"").toLowerCase().split(",")),d=d.map((function(t){return"string"==typeof t?t.toLowerCase()===e.formatAllRows().toLowerCase()||["all","unlimited"].includes(t.toLowerCase())?e.formatAllRows():+t:t})),this.paginationParts=e.paginationParts,"string"==typeof this.paginationParts&&(this.paginationParts=this.paginationParts.replace(/\[|\]| |'/g,"").split(",")),"server"!==e.sidePagination&&(e.totalRows=u.length),this.totalPages=0,e.totalRows&&(e.pageSize===e.formatAllRows()&&(e.pageSize=e.totalRows,h=!0),this.totalPages=1+~~((e.totalRows-1)/e.pageSize),e.totalPages=this.totalPages),this.totalPages>0&&e.pageNumber>this.totalPages&&(e.pageNumber=this.totalPages),this.pageFrom=(e.pageNumber-1)*e.pageSize+1,this.pageTo=e.pageNumber*e.pageSize,this.pageTo>e.totalRows&&(this.pageTo=e.totalRows),this.options.pagination&&"server"!==this.options.sidePagination&&(this.options.totalNotFiltered=this.options.data.length),this.options.showExtendedPagination||(this.options.totalNotFiltered=void 0),(this.paginationParts.includes("pageInfo")||this.paginationParts.includes("pageInfoShort")||this.paginationParts.includes("pageSize"))&&c.push('<div class="'.concat(this.constants.classes.pull,"-").concat(e.paginationDetailHAlign,' pagination-detail">')),this.paginationParts.includes("pageInfo")||this.paginationParts.includes("pageInfoShort")){var f=this.paginationParts.includes("pageInfoShort")?e.formatDetailPagination(e.totalRows):e.formatShowingRows(this.pageFrom,this.pageTo,e.totalRows,e.totalNotFiltered);c.push('<span class="pagination-info">\n      '.concat(f,"\n      </span>"))}if(this.paginationParts.includes("pageSize")){c.push('<div class="page-list">');var p=['<div class="'.concat(this.constants.classes.paginationDropdown,'">\n        <button class="').concat(this.constants.buttonsClass,' dropdown-toggle" type="button" ').concat(this.constants.dataToggle,'="dropdown">\n        <span class="page-size">\n        ').concat(h?e.formatAllRows():e.pageSize,"\n        </span>\n        ").concat(this.constants.html.dropdownCaret,"\n        </button>\n        ").concat(this.constants.html.pageDropdown[0])];d.forEach((function(i,n){var o;(!e.smartDisplay||0===n||d[n-1]<e.totalRows||i===e.formatAllRows())&&(o=h?i===e.formatAllRows()?t.constants.classes.dropdownActive:"":i===e.pageSize?t.constants.classes.dropdownActive:"",p.push(ua.sprintf(t.constants.html.pageDropdownItem,o,i)))})),p.push("".concat(this.constants.html.pageDropdown[1],"</div>")),c.push(e.formatRecordsPerPage(p.join("")))}if((this.paginationParts.includes("pageInfo")||this.paginationParts.includes("pageInfoShort")||this.paginationParts.includes("pageSize"))&&c.push("</div></div>"),this.paginationParts.includes("pageList")){c.push('<div class="'.concat(this.constants.classes.pull,"-").concat(e.paginationHAlign,' pagination">'),ua.sprintf(this.constants.html.pagination[0],ua.sprintf(" pagination-%s",e.iconSize)),ua.sprintf(this.constants.html.paginationItem," page-pre",e.formatSRPaginationPreText(),e.paginationPreText)),this.totalPages<e.paginationSuccessivelySize?(n=1,o=this.totalPages):o=(n=e.pageNumber-e.paginationPagesBySide)+2*e.paginationPagesBySide,e.pageNumber<e.paginationSuccessivelySize-1&&(o=e.paginationSuccessivelySize),e.paginationSuccessivelySize>this.totalPages-n&&(n=n-(e.paginationSuccessivelySize-(this.totalPages-n))+1),n<1&&(n=1),o>this.totalPages&&(o=this.totalPages);var g=Math.round(e.paginationPagesBySide/2),v=function(i){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return ua.sprintf(t.constants.html.paginationItem,n+(i===e.pageNumber?" ".concat(t.constants.classes.paginationActive):""),e.formatSRPaginationPageText(i),i)};if(n>1){var b=e.paginationPagesBySide;for(b>=n&&(b=n-1),i=1;i<=b;i++)c.push(v(i));n-1===b+1?(i=n-1,c.push(v(i))):n-1>b&&(n-2*e.paginationPagesBySide>e.paginationPagesBySide&&e.paginationUseIntermediate?(i=Math.round((n-g)/2+g),c.push(v(i," page-intermediate"))):c.push(ua.sprintf(this.constants.html.paginationItem," page-first-separator disabled","","...")))}for(i=n;i<=o;i++)c.push(v(i));if(this.totalPages>o){var m=this.totalPages-(e.paginationPagesBySide-1);for(o>=m&&(m=o+1),o+1===m-1?(i=o+1,c.push(v(i))):m>o+1&&(this.totalPages-o>2*e.paginationPagesBySide&&e.paginationUseIntermediate?(i=Math.round((this.totalPages-g-o)/2+o),c.push(v(i," page-intermediate"))):c.push(ua.sprintf(this.constants.html.paginationItem," page-last-separator disabled","","..."))),i=m;i<=this.totalPages;i++)c.push(v(i))}c.push(ua.sprintf(this.constants.html.paginationItem," page-next",e.formatSRPaginationNextText(),e.paginationNextText)),c.push(this.constants.html.pagination[1],"</div>")}this.$pagination.html(c.join(""));var y=["bottom","both"].includes(e.paginationVAlign)?" ".concat(this.constants.classes.dropup):"";this.$pagination.last().find(".page-list > div").addClass(y),e.onlyInfoPagination||(a=this.$pagination.find(".page-list a"),s=this.$pagination.find(".page-pre"),r=this.$pagination.find(".page-next"),l=this.$pagination.find(".page-item").not(".page-next, .page-pre, .page-last-separator, .page-first-separator"),this.totalPages<=1&&this.$pagination.find("div.pagination").hide(),e.smartDisplay&&(d.length<2||e.totalRows<=d[0])&&this.$pagination.find("div.page-list").hide(),this.$pagination[this.getData().length?"show":"hide"](),e.paginationLoop||(1===e.pageNumber&&s.addClass("disabled"),e.pageNumber===this.totalPages&&r.addClass("disabled")),h&&(e.pageSize=e.formatAllRows()),a.off("click").on("click",(function(e){return t.onPageListChange(e)})),s.off("click").on("click",(function(e){return t.onPagePre(e)})),r.off("click").on("click",(function(e){return t.onPageNext(e)})),l.off("click").on("click",(function(e){return t.onPageNumber(e)})))}else this.$pagination.hide()}},{key:"updatePagination",value:function(t){t&&i.default(t.currentTarget).hasClass("disabled")||(this.options.maintainMetaData||this.resetRows(),this.initPagination(),this.trigger("page-change",this.options.pageNumber,this.options.pageSize),"server"===this.options.sidePagination?this.initServer():this.initBody())}},{key:"onPageListChange",value:function(t){t.preventDefault();var e=i.default(t.currentTarget);return e.parent().addClass(this.constants.classes.dropdownActive).siblings().removeClass(this.constants.classes.dropdownActive),this.options.pageSize=e.text().toUpperCase()===this.options.formatAllRows().toUpperCase()?this.options.formatAllRows():+e.text(),this.$toolbar.find(".page-size").text(this.options.pageSize),this.updatePagination(t),!1}},{key:"onPagePre",value:function(t){if(!i.default(t.target).hasClass("disabled"))return t.preventDefault(),this.options.pageNumber-1==0?this.options.pageNumber=this.options.totalPages:this.options.pageNumber--,this.updatePagination(t),!1}},{key:"onPageNext",value:function(t){if(!i.default(t.target).hasClass("disabled"))return t.preventDefault(),this.options.pageNumber+1>this.options.totalPages?this.options.pageNumber=1:this.options.pageNumber++,this.updatePagination(t),!1}},{key:"onPageNumber",value:function(t){if(t.preventDefault(),this.options.pageNumber!==+i.default(t.currentTarget).text())return this.options.pageNumber=+i.default(t.currentTarget).text(),this.updatePagination(t),!1}},{key:"initRow",value:function(t,e,i,o){var a=this,s=[],l={},c=[],h="",u={},d=[];if(!(ua.findIndex(this.hiddenRows,t)>-1)){if((l=ua.calculateObjectValue(this.options,this.options.rowStyle,[t,e],l))&&l.css)for(var f=0,p=Object.entries(l.css);f<p.length;f++){var g=r(p[f],2),v=g[0],b=g[1];c.push("".concat(v,": ").concat(b))}if(u=ua.calculateObjectValue(this.options,this.options.rowAttributes,[t,e],u))for(var m=0,y=Object.entries(u);m<y.length;m++){var w=r(y[m],2),S=w[0],x=w[1];d.push("".concat(S,'="').concat(ua.escapeHTML(x),'"'))}if(t._data&&!ua.isEmptyObject(t._data))for(var k=0,O=Object.entries(t._data);k<O.length;k++){var C=r(O[k],2),T=C[0],P=C[1];if("index"===T)return;h+=" data-".concat(T,"='").concat("object"===n(P)?JSON.stringify(P):P,"'")}s.push("<tr",ua.sprintf(" %s",d.length?d.join(" "):void 0),ua.sprintf(' id="%s"',Array.isArray(t)?void 0:t._id),ua.sprintf(' class="%s"',l.classes||(Array.isArray(t)?void 0:t._class)),ua.sprintf(' style="%s"',Array.isArray(t)?void 0:t._style),' data-index="'.concat(e,'"'),ua.sprintf(' data-uniqueid="%s"',ua.getItemField(t,this.options.uniqueId,!1)),ua.sprintf(' data-has-detail-view="%s"',this.options.detailView&&ua.calculateObjectValue(null,this.options.detailFilter,[e,t])?"true":void 0),ua.sprintf("%s",h),">"),this.options.cardView&&s.push('<td colspan="'.concat(this.header.fields.length,'"><div class="card-views">'));var I="";return ua.hasDetailViewIcon(this.options)&&(I="<td>",ua.calculateObjectValue(null,this.options.detailFilter,[e,t])&&(I+='\n          <a class="detail-icon" href="#">\n          '.concat(ua.sprintf(this.constants.html.icon,this.options.iconsPrefix,this.options.icons.detailOpen),"\n          </a>\n        ")),I+="</td>"),I&&"right"!==this.options.detailViewAlign&&s.push(I),this.header.fields.forEach((function(i,n){var o="",l=ua.getItemField(t,i,a.options.escape),h="",u="",d={},f="",p=a.header.classes[n],g="",v="",b="",m="",y="",w="",S=a.columns[n];if((!a.fromHtml&&!a.autoMergeCells||void 0!==l||S.checkbox||S.radio)&&S.visible&&(!a.options.cardView||S.cardVisible)){if(S.escape&&(l=ua.escapeHTML(l)),c.concat([a.header.styles[n]]).length&&(v+="".concat(c.concat([a.header.styles[n]]).join("; "))),t["_".concat(i,"_style")]&&(v+="".concat(t["_".concat(i,"_style")])),v&&(g=' style="'.concat(v,'"')),t["_".concat(i,"_id")]&&(f=ua.sprintf(' id="%s"',t["_".concat(i,"_id")])),t["_".concat(i,"_class")]&&(p=ua.sprintf(' class="%s"',t["_".concat(i,"_class")])),t["_".concat(i,"_rowspan")]&&(m=ua.sprintf(' rowspan="%s"',t["_".concat(i,"_rowspan")])),t["_".concat(i,"_colspan")]&&(y=ua.sprintf(' colspan="%s"',t["_".concat(i,"_colspan")])),t["_".concat(i,"_title")]&&(w=ua.sprintf(' title="%s"',t["_".concat(i,"_title")])),(d=ua.calculateObjectValue(a.header,a.header.cellStyles[n],[l,t,e,i],d)).classes&&(p=' class="'.concat(d.classes,'"')),d.css){for(var x=[],k=0,O=Object.entries(d.css);k<O.length;k++){var C=r(O[k],2),T=C[0],P=C[1];x.push("".concat(T,": ").concat(P))}g=' style="'.concat(x.concat(a.header.styles[n]).join("; "),'"')}if(h=ua.calculateObjectValue(S,a.header.formatters[n],[l,t,e,i],l),S.checkbox||S.radio||(h=null==h?a.options.undefinedText:h),S.searchable&&a.searchText&&a.options.searchHighlight&&!S.checkbox&&!S.radio){var I="",A=new RegExp("(".concat(a.searchText.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),")"),"gim"),$="<mark>$1</mark>";if(h&&/<(?=.*? .*?\/ ?>|br|hr|input|!--|wbr)[a-z]+.*?>|<([a-z]+).*?<\/\1>/i.test(h)){var E=(new DOMParser).parseFromString(h.toString(),"text/html").documentElement.textContent,R=E.replace(A,$);E=E.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),I=h.replace(new RegExp("(>\\s*)(".concat(E,")(\\s*)"),"gm"),"$1".concat(R,"$3"))}else I=h.toString().replace(A,$);h=ua.calculateObjectValue(S,S.searchHighlightFormatter,[h,a.searchText],I)}if(t["_".concat(i,"_data")]&&!ua.isEmptyObject(t["_".concat(i,"_data")]))for(var j=0,_=Object.entries(t["_".concat(i,"_data")]);j<_.length;j++){var N=r(_[j],2),F=N[0],D=N[1];if("index"===F)return;b+=" data-".concat(F,'="').concat(D,'"')}if(S.checkbox||S.radio){u=S.checkbox?"checkbox":u,u=S.radio?"radio":u;var V=S.class||"",B=ua.isObject(h)&&h.hasOwnProperty("checked")?h.checked:(!0===h||l)&&!1!==h,L=!S.checkboxEnabled||h&&h.disabled;o=[a.options.cardView?'<div class="card-view '.concat(V,'">'):'<td class="bs-checkbox '.concat(V,'"').concat(p).concat(g,">"),'<label>\n            <input\n            data-index="'.concat(e,'"\n            name="').concat(a.options.selectItemName,'"\n            type="').concat(u,'"\n            ').concat(ua.sprintf('value="%s"',t[a.options.idField]),"\n            ").concat(ua.sprintf('checked="%s"',B?"checked":void 0),"\n            ").concat(ua.sprintf('disabled="%s"',L?"disabled":void 0)," />\n            <span></span>\n            </label>"),a.header.formatters[n]&&"string"==typeof h?h:"",a.options.cardView?"</div>":"</td>"].join(""),t[a.header.stateField]=!0===h||!!l||h&&h.checked}else if(a.options.cardView){var H=a.options.showHeader?'<span class="card-view-title '.concat(d.classes,'"').concat(g,">").concat(ua.getFieldTitle(a.columns,i),"</span>"):"";o='<div class="card-view">'.concat(H,'<span class="card-view-value ').concat(d.classes,'"').concat(g,">").concat(h,"</span></div>"),a.options.smartDisplay&&""===h&&(o='<div class="card-view"></div>')}else o="<td".concat(f).concat(p).concat(g).concat(b).concat(m).concat(y).concat(w,">").concat(h,"</td>");s.push(o)}})),I&&"right"===this.options.detailViewAlign&&s.push(I),this.options.cardView&&s.push("</div></td>"),s.push("</tr>"),s.join("")}}},{key:"initBody",value:function(t,e){var n=this,o=this.getData();this.trigger("pre-body",o),this.$body=this.$el.find(">tbody"),this.$body.length||(this.$body=i.default("<tbody></tbody>").appendTo(this.$el)),this.options.pagination&&"server"!==this.options.sidePagination||(this.pageFrom=1,this.pageTo=o.length);var a=[],s=i.default(document.createDocumentFragment()),r=!1,l=[];this.autoMergeCells=ua.checkAutoMergeCells(o.slice(this.pageFrom-1,this.pageTo));for(var c=this.pageFrom-1;c<this.pageTo;c++){var h=o[c],u=this.initRow(h,c,o,s);if(r=r||!!u,u&&"string"==typeof u){var d=this.options.uniqueId;if(d&&h.hasOwnProperty(d)){var f=h[d],p=this.$body.find(ua.sprintf('> tr[data-uniqueid="%s"][data-has-detail-view]',f)).next();p.is("tr.detail-view")&&(l.push(c),e&&f===e||(u+=p[0].outerHTML))}this.options.virtualScroll?a.push(u):s.append(u)}}r?this.options.virtualScroll?(this.virtualScroll&&this.virtualScroll.destroy(),this.virtualScroll=new da({rows:a,fixedScroll:t,scrollEl:this.$tableBody[0],contentEl:this.$body[0],itemHeight:this.options.virtualScrollItemHeight,callback:function(t,e){n.fitHeader(),n.initBodyEvent(),n.trigger("virtual-scroll",t,e)}})):this.$body.html(s):this.$body.html('<tr class="no-records-found">'.concat(ua.sprintf('<td colspan="%s">%s</td>',this.getVisibleFields().length+ua.getDetailViewIndexOffset(this.options),this.options.formatNoMatches()),"</tr>")),l.forEach((function(t){n.expandRow(t)})),t||this.scrollTo(0),this.initBodyEvent(),this.initFooter(),this.resetView(),this.updateSelected(),"server"!==this.options.sidePagination&&(this.options.totalRows=o.length),this.trigger("post-body",o)}},{key:"initBodyEvent",value:function(){var t=this;this.$body.find("> tr[data-index] > td").off("click dblclick").on("click dblclick",(function(e){var n=i.default(e.currentTarget),o=n.parent(),a=i.default(e.target).parents(".card-views").children(),s=i.default(e.target).parents(".card-view"),r=o.data("index"),l=t.data[r],c=t.options.cardView?a.index(s):n[0].cellIndex,h=t.getVisibleFields()[c-ua.getDetailViewIndexOffset(t.options)],u=t.columns[t.fieldsColumnsIndex[h]],d=ua.getItemField(l,h,t.options.escape);if(!n.find(".detail-icon").length){if(t.trigger("click"===e.type?"click-cell":"dbl-click-cell",h,d,l,n),t.trigger("click"===e.type?"click-row":"dbl-click-row",l,o,h),"click"===e.type&&t.options.clickToSelect&&u.clickToSelect&&!ua.calculateObjectValue(t.options,t.options.ignoreClickToSelectOn,[e.target])){var f=o.find(ua.sprintf('[name="%s"]',t.options.selectItemName));f.length&&f[0].click()}"click"===e.type&&t.options.detailViewByClick&&t.toggleDetailView(r,t.header.detailFormatters[t.fieldsColumnsIndex[h]])}})).off("mousedown").on("mousedown",(function(e){t.multipleSelectRowCtrlKey=e.ctrlKey||e.metaKey,t.multipleSelectRowShiftKey=e.shiftKey})),this.$body.find("> tr[data-index] > td > .detail-icon").off("click").on("click",(function(e){return e.preventDefault(),t.toggleDetailView(i.default(e.currentTarget).parent().parent().data("index")),!1})),this.$selectItem=this.$body.find(ua.sprintf('[name="%s"]',this.options.selectItemName)),this.$selectItem.off("click").on("click",(function(e){e.stopImmediatePropagation();var n=i.default(e.currentTarget);t._toggleCheck(n.prop("checked"),n.data("index"))})),this.header.events.forEach((function(e,n){var o=e;if(o){"string"==typeof o&&(o=ua.calculateObjectValue(null,o));var a=t.header.fields[n],s=t.getVisibleFields().indexOf(a);if(-1!==s){s+=ua.getDetailViewIndexOffset(t.options);var r=function(e){if(!o.hasOwnProperty(e))return"continue";var n=o[e];t.$body.find(">tr:not(.no-records-found)").each((function(o,r){var l=i.default(r),c=l.find(t.options.cardView?".card-views>.card-view":">td").eq(s),h=e.indexOf(" "),u=e.substring(0,h),d=e.substring(h+1);c.find(d).off(u).on(u,(function(e){var i=l.data("index"),o=t.data[i],s=o[a];n.apply(t,[e,s,o,i])}))}))};for(var l in o)r(l)}}}))}},{key:"initServer",value:function(t,e,n){var o=this,a={},s=this.header.fields.indexOf(this.options.sortName),r={searchText:this.searchText,sortName:this.options.sortName,sortOrder:this.options.sortOrder};if(this.header.sortNames[s]&&(r.sortName=this.header.sortNames[s]),this.options.pagination&&"server"===this.options.sidePagination&&(r.pageSize=this.options.pageSize===this.options.formatAllRows()?this.options.totalRows:this.options.pageSize,r.pageNumber=this.options.pageNumber),n||this.options.url||this.options.ajax){if("limit"===this.options.queryParamsType&&(r={search:r.searchText,sort:r.sortName,order:r.sortOrder},this.options.pagination&&"server"===this.options.sidePagination&&(r.offset=this.options.pageSize===this.options.formatAllRows()?0:this.options.pageSize*(this.options.pageNumber-1),r.limit=this.options.pageSize,0!==r.limit&&this.options.pageSize!==this.options.formatAllRows()||delete r.limit)),this.options.search&&"server"===this.options.sidePagination&&this.columns.filter((function(t){return!t.searchable})).length){r.searchable=[];var l,c=u(this.columns);try{for(c.s();!(l=c.n()).done;){var h=l.value;!h.checkbox&&h.searchable&&(this.options.visibleSearch&&h.visible||!this.options.visibleSearch)&&r.searchable.push(h.field)}}catch(t){c.e(t)}finally{c.f()}}if(ua.isEmptyObject(this.filterColumnsPartial)||(r.filter=JSON.stringify(this.filterColumnsPartial,null)),i.default.extend(r,e||{}),!1!==(a=ua.calculateObjectValue(this.options,this.options.queryParams,[r],a))){t||this.showLoading();var d=i.default.extend({},ua.calculateObjectValue(null,this.options.ajaxOptions),{type:this.options.method,url:n||this.options.url,data:"application/json"===this.options.contentType&&"post"===this.options.method?JSON.stringify(a):a,cache:this.options.cache,contentType:this.options.contentType,dataType:this.options.dataType,success:function(e,i,n){var a=ua.calculateObjectValue(o.options,o.options.responseHandler,[e,n],e);o.load(a),o.trigger("load-success",a,n&&n.status,n),t||o.hideLoading(),"server"===o.options.sidePagination&&o.options.pageNumber>1&&a[o.options.totalField]>0&&!a[o.options.dataField].length&&o.updatePagination()},error:function(e){if(e&&0===e.status&&o._xhrAbort)o._xhrAbort=!1;else{var i=[];"server"===o.options.sidePagination&&((i={})[o.options.totalField]=0,i[o.options.dataField]=[]),o.load(i),o.trigger("load-error",e&&e.status,e),t||o.$tableLoading.hide()}}});return this.options.ajax?ua.calculateObjectValue(this,this.options.ajax,[d],null):(this._xhr&&4!==this._xhr.readyState&&(this._xhrAbort=!0,this._xhr.abort()),this._xhr=i.default.ajax(d)),a}}}},{key:"initSearchText",value:function(){if(this.options.search&&(this.searchText="",""!==this.options.searchText)){var t=ua.getSearchInput(this);t.val(this.options.searchText),this.onSearch({currentTarget:t,firedByInitSearchText:!0})}}},{key:"getCaret",value:function(){var t=this;this.$header.find("th").each((function(e,n){i.default(n).find(".sortable").removeClass("desc asc").addClass(i.default(n).data("field")===t.options.sortName?t.options.sortOrder:"both")}))}},{key:"updateSelected",value:function(){var t=this.$selectItem.filter(":enabled").length&&this.$selectItem.filter(":enabled").length===this.$selectItem.filter(":enabled").filter(":checked").length;this.$selectAll.add(this.$selectAll_).prop("checked",t),this.$selectItem.each((function(t,e){i.default(e).closest("tr")[i.default(e).prop("checked")?"addClass":"removeClass"]("selected")}))}},{key:"updateRows",value:function(){var t=this;this.$selectItem.each((function(e,n){t.data[i.default(n).data("index")][t.header.stateField]=i.default(n).prop("checked")}))}},{key:"resetRows",value:function(){var t,e=u(this.data);try{for(e.s();!(t=e.n()).done;){var i=t.value;this.$selectAll.prop("checked",!1),this.$selectItem.prop("checked",!1),this.header.stateField&&(i[this.header.stateField]=!1)}}catch(t){e.e(t)}finally{e.f()}this.initHiddenRows()}},{key:"trigger",value:function(e){for(var n,o,a="".concat(e,".bs.table"),s=arguments.length,r=new Array(s>1?s-1:0),l=1;l<s;l++)r[l-1]=arguments[l];(n=this.options)[t.EVENTS[a]].apply(n,[].concat(r,[this])),this.$el.trigger(i.default.Event(a,{sender:this}),r),(o=this.options).onAll.apply(o,[a].concat([].concat(r,[this]))),this.$el.trigger(i.default.Event("all.bs.table",{sender:this}),[a,r])}},{key:"resetHeader",value:function(){var t=this;clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout((function(){return t.fitHeader()}),this.$el.is(":hidden")?100:0)}},{key:"fitHeader",value:function(){var t=this;if(this.$el.is(":hidden"))this.timeoutId_=setTimeout((function(){return t.fitHeader()}),100);else{var e=this.$tableBody.get(0),n=e.scrollWidth>e.clientWidth&&e.scrollHeight>e.clientHeight+this.$header.outerHeight()?ua.getScrollBarWidth():0;this.$el.css("margin-top",-this.$header.outerHeight());var o=i.default(":focus");if(o.length>0){var a=o.parents("th");if(a.length>0){var s=a.attr("data-field");if(void 0!==s){var r=this.$header.find("[data-field='".concat(s,"']"));r.length>0&&r.find(":input").addClass("focus-temp")}}}this.$header_=this.$header.clone(!0,!0),this.$selectAll_=this.$header_.find('[name="btSelectAll"]'),this.$tableHeader.css("margin-right",n).find("table").css("width",this.$el.outerWidth()).html("").attr("class",this.$el.attr("class")).append(this.$header_),this.$tableLoading.css("width",this.$el.outerWidth());var l=i.default(".focus-temp:visible:eq(0)");l.length>0&&(l.focus(),this.$header.find(".focus-temp").removeClass("focus-temp")),this.$header.find("th[data-field]").each((function(e,n){t.$header_.find(ua.sprintf('th[data-field="%s"]',i.default(n).data("field"))).data(i.default(n).data())}));for(var c=this.getVisibleFields(),h=this.$header_.find("th"),u=this.$body.find(">tr:not(.no-records-found,.virtual-scroll-top)").eq(0);u.length&&u.find('>td[colspan]:not([colspan="1"])').length;)u=u.next();var d=u.find("> *").length;u.find("> *").each((function(e,n){var o=i.default(n);if(ua.hasDetailViewIcon(t.options)&&(0===e&&"right"!==t.options.detailViewAlign||e===d-1&&"right"===t.options.detailViewAlign)){var a=h.filter(".detail"),s=a.innerWidth()-a.find(".fht-cell").width();a.find(".fht-cell").width(o.innerWidth()-s)}else{var r=e-ua.getDetailViewIndexOffset(t.options),l=t.$header_.find(ua.sprintf('th[data-field="%s"]',c[r]));l.length>1&&(l=i.default(h[o[0].cellIndex]));var u=l.innerWidth()-l.find(".fht-cell").width();l.find(".fht-cell").width(o.innerWidth()-u)}})),this.horizontalScroll(),this.trigger("post-header")}}},{key:"initFooter",value:function(){if(this.options.showFooter&&!this.options.cardView){var t=this.getData(),e=[],i="";ua.hasDetailViewIcon(this.options)&&(i='<th class="detail"><div class="th-inner"></div><div class="fht-cell"></div></th>'),i&&"right"!==this.options.detailViewAlign&&e.push(i);var n,o=u(this.columns);try{for(o.s();!(n=o.n()).done;){var a,s,l=n.value,c=[],h={},d=ua.sprintf(' class="%s"',l.class);if(!(!l.visible||this.footerData&&this.footerData.length>0&&!(l.field in this.footerData[0]))){if(this.options.cardView&&!l.cardVisible)return;if(a=ua.sprintf("text-align: %s; ",l.falign?l.falign:l.align),s=ua.sprintf("vertical-align: %s; ",l.valign),(h=ua.calculateObjectValue(null,this.options.footerStyle,[l]))&&h.css)for(var f=0,p=Object.entries(h.css);f<p.length;f++){var g=r(p[f],2),v=g[0],b=g[1];c.push("".concat(v,": ").concat(b))}h&&h.classes&&(d=ua.sprintf(' class="%s"',l.class?[l.class,h.classes].join(" "):h.classes)),e.push("<th",d,ua.sprintf(' style="%s"',a+s+c.concat().join("; ")));var m=0;this.footerData&&this.footerData.length>0&&(m=this.footerData[0]["_".concat(l.field,"_colspan")]||0),m&&e.push(' colspan="'.concat(m,'" ')),e.push(">"),e.push('<div class="th-inner">');var y="";this.footerData&&this.footerData.length>0&&(y=this.footerData[0][l.field]||""),e.push(ua.calculateObjectValue(l,l.footerFormatter,[t,y],y)),e.push("</div>"),e.push('<div class="fht-cell"></div>'),e.push("</div>"),e.push("</th>")}}}catch(t){o.e(t)}finally{o.f()}i&&"right"===this.options.detailViewAlign&&e.push(i),this.options.height||this.$tableFooter.length||(this.$el.append("<tfoot><tr></tr></tfoot>"),this.$tableFooter=this.$el.find("tfoot")),this.$tableFooter.find("tr").length||this.$tableFooter.html("<table><thead><tr></tr></thead></table>"),this.$tableFooter.find("tr").html(e.join("")),this.trigger("post-footer",this.$tableFooter)}}},{key:"fitFooter",value:function(){var t=this;if(this.$el.is(":hidden"))setTimeout((function(){return t.fitFooter()}),100);else{var e=this.$tableBody.get(0),n=e.scrollWidth>e.clientWidth&&e.scrollHeight>e.clientHeight+this.$header.outerHeight()?ua.getScrollBarWidth():0;this.$tableFooter.css("margin-right",n).find("table").css("width",this.$el.outerWidth()).attr("class",this.$el.attr("class"));var o=this.$tableFooter.find("th"),a=this.$body.find(">tr:first-child:not(.no-records-found)");for(o.find(".fht-cell").width("auto");a.length&&a.find('>td[colspan]:not([colspan="1"])').length;)a=a.next();var s=a.find("> *").length;a.find("> *").each((function(e,n){var a=i.default(n);if(ua.hasDetailViewIcon(t.options)&&(0===e&&"left"===t.options.detailViewAlign||e===s-1&&"right"===t.options.detailViewAlign)){var r=o.filter(".detail"),l=r.innerWidth()-r.find(".fht-cell").width();r.find(".fht-cell").width(a.innerWidth()-l)}else{var c=o.eq(e),h=c.innerWidth()-c.find(".fht-cell").width();c.find(".fht-cell").width(a.innerWidth()-h)}})),this.horizontalScroll()}}},{key:"horizontalScroll",value:function(){var t=this;this.$tableBody.off("scroll").on("scroll",(function(){var e=t.$tableBody.scrollLeft();t.options.showHeader&&t.options.height&&t.$tableHeader.scrollLeft(e),t.options.showFooter&&!t.options.cardView&&t.$tableFooter.scrollLeft(e),t.trigger("scroll-body",t.$tableBody)}))}},{key:"getVisibleFields",value:function(){var t,e=[],i=u(this.header.fields);try{for(i.s();!(t=i.n()).done;){var n=t.value,o=this.columns[this.fieldsColumnsIndex[n]];o&&o.visible&&e.push(n)}}catch(t){i.e(t)}finally{i.f()}return e}},{key:"initHiddenRows",value:function(){this.hiddenRows=[]}},{key:"getOptions",value:function(){var t=i.default.extend({},this.options);return delete t.data,i.default.extend(!0,{},t)}},{key:"refreshOptions",value:function(t){ua.compareObjects(this.options,t,!0)||(this.options=i.default.extend(this.options,t),this.trigger("refresh-options",this.options),this.destroy(),this.init())}},{key:"getData",value:function(t){var e=this,i=this.options.data;if(!(this.searchText||this.options.customSearch||void 0!==this.options.sortName||this.enableCustomSort)&&ua.isEmptyObject(this.filterColumns)&&ua.isEmptyObject(this.filterColumnsPartial)||t&&t.unfiltered||(i=this.data),t&&t.useCurrentPage&&(i=i.slice(this.pageFrom-1,this.pageTo)),t&&!t.includeHiddenRows){var n=this.getHiddenRows();i=i.filter((function(t){return-1===ua.findIndex(n,t)}))}return t&&t.formatted&&i.forEach((function(t){for(var i=0,n=Object.entries(t);i<n.length;i++){var o=r(n[i],2),a=o[0],s=o[1],l=e.columns[e.fieldsColumnsIndex[a]];if(!l)return;t[a]=ua.calculateObjectValue(l,e.header.formatters[l.fieldIndex],[s,t,t.index,l.field],s)}})),i}},{key:"getSelections",value:function(){var t=this;return(this.options.maintainMetaData?this.options.data:this.data).filter((function(e){return!0===e[t.header.stateField]}))}},{key:"load",value:function(t){var e,i=t;this.options.pagination&&"server"===this.options.sidePagination&&(this.options.totalRows=i[this.options.totalField],this.options.totalNotFiltered=i[this.options.totalNotFilteredField],this.footerData=i[this.options.footerField]?[i[this.options.footerField]]:void 0),e=i.fixedScroll,i=Array.isArray(i)?i:i[this.options.dataField],this.initData(i),this.initSearch(),this.initPagination(),this.initBody(e)}},{key:"append",value:function(t){this.initData(t,"append"),this.initSearch(),this.initPagination(),this.initSort(),this.initBody(!0)}},{key:"prepend",value:function(t){this.initData(t,"prepend"),this.initSearch(),this.initPagination(),this.initSort(),this.initBody(!0)}},{key:"remove",value:function(t){for(var e=0,i=this.options.data.length-1;i>=0;i--){var n=this.options.data[i];(n.hasOwnProperty(t.field)||"$index"===t.field)&&((!n.hasOwnProperty(t.field)&&"$index"===t.field&&t.values.includes(i)||t.values.includes(n[t.field]))&&(e++,this.options.data.splice(i,1)))}e&&("server"===this.options.sidePagination&&(this.options.totalRows-=e,this.data=l(this.options.data)),this.initSearch(),this.initPagination(),this.initSort(),this.initBody(!0))}},{key:"removeAll",value:function(){this.options.data.length>0&&(this.options.data.splice(0,this.options.data.length),this.initSearch(),this.initPagination(),this.initBody(!0))}},{key:"insertRow",value:function(t){t.hasOwnProperty("index")&&t.hasOwnProperty("row")&&(this.options.data.splice(t.index,0,t.row),this.initSearch(),this.initPagination(),this.initSort(),this.initBody(!0))}},{key:"updateRow",value:function(t){var e,n=u(Array.isArray(t)?t:[t]);try{for(n.s();!(e=n.n()).done;){var o=e.value;o.hasOwnProperty("index")&&o.hasOwnProperty("row")&&(o.hasOwnProperty("replace")&&o.replace?this.options.data[o.index]=o.row:i.default.extend(this.options.data[o.index],o.row))}}catch(t){n.e(t)}finally{n.f()}this.initSearch(),this.initPagination(),this.initSort(),this.initBody(!0)}},{key:"getRowByUniqueId",value:function(t){var e,i,n,o=this.options.uniqueId,a=t,s=null;for(e=this.options.data.length-1;e>=0;e--){if((i=this.options.data[e]).hasOwnProperty(o))n=i[o];else{if(!i._data||!i._data.hasOwnProperty(o))continue;n=i._data[o]}if("string"==typeof n?a=a.toString():"number"==typeof n&&(Number(n)===n&&n%1==0?a=parseInt(a,10):n===Number(n)&&0!==n&&(a=parseFloat(a))),n===a){s=i;break}}return s}},{key:"updateByUniqueId",value:function(t){var e,n=null,o=u(Array.isArray(t)?t:[t]);try{for(o.s();!(e=o.n()).done;){var a=e.value;if(a.hasOwnProperty("id")&&a.hasOwnProperty("row")){var s=this.options.data.indexOf(this.getRowByUniqueId(a.id));-1!==s&&(a.hasOwnProperty("replace")&&a.replace?this.options.data[s]=a.row:i.default.extend(this.options.data[s],a.row),n=a.id)}}}catch(t){o.e(t)}finally{o.f()}this.initSearch(),this.initPagination(),this.initSort(),this.initBody(!0,n)}},{key:"removeByUniqueId",value:function(t){var e=this.options.data.length,i=this.getRowByUniqueId(t);i&&this.options.data.splice(this.options.data.indexOf(i),1),e!==this.options.data.length&&("server"===this.options.sidePagination&&(this.options.totalRows-=1,this.data=l(this.options.data)),this.initSearch(),this.initPagination(),this.initBody(!0))}},{key:"updateCell",value:function(t){t.hasOwnProperty("index")&&t.hasOwnProperty("field")&&t.hasOwnProperty("value")&&(this.data[t.index][t.field]=t.value,!1!==t.reinit&&(this.initSort(),this.initBody(!0)))}},{key:"updateCellByUniqueId",value:function(t){var e=this;(Array.isArray(t)?t:[t]).forEach((function(t){var i=t.id,n=t.field,o=t.value,a=e.options.data.indexOf(e.getRowByUniqueId(i));-1!==a&&(e.options.data[a][n]=o)})),!1!==t.reinit&&(this.initSort(),this.initBody(!0))}},{key:"showRow",value:function(t){this._toggleRow(t,!0)}},{key:"hideRow",value:function(t){this._toggleRow(t,!1)}},{key:"_toggleRow",value:function(t,e){var i;if(t.hasOwnProperty("index")?i=this.getData()[t.index]:t.hasOwnProperty("uniqueId")&&(i=this.getRowByUniqueId(t.uniqueId)),i){var n=ua.findIndex(this.hiddenRows,i);e||-1!==n?e&&n>-1&&this.hiddenRows.splice(n,1):this.hiddenRows.push(i),this.initBody(!0),this.initPagination()}}},{key:"getHiddenRows",value:function(t){if(t)return this.initHiddenRows(),this.initBody(!0),void this.initPagination();var e,i=[],n=u(this.getData());try{for(n.s();!(e=n.n()).done;){var o=e.value;this.hiddenRows.includes(o)&&i.push(o)}}catch(t){n.e(t)}finally{n.f()}return this.hiddenRows=i,i}},{key:"showColumn",value:function(t){var e=this;(Array.isArray(t)?t:[t]).forEach((function(t){e._toggleColumn(e.fieldsColumnsIndex[t],!0,!0)}))}},{key:"hideColumn",value:function(t){var e=this;(Array.isArray(t)?t:[t]).forEach((function(t){e._toggleColumn(e.fieldsColumnsIndex[t],!1,!0)}))}},{key:"_toggleColumn",value:function(t,e,i){if(-1!==t&&this.columns[t].visible!==e&&(this.columns[t].visible=e,this.initHeader(),this.initSearch(),this.initPagination(),this.initBody(),this.options.showColumns)){var n=this.$toolbar.find('.keep-open input:not(".toggle-all")').prop("disabled",!1);i&&n.filter(ua.sprintf('[value="%s"]',t)).prop("checked",e),n.filter(":checked").length<=this.options.minimumCountColumns&&n.filter(":checked").prop("disabled",!0)}}},{key:"getVisibleColumns",value:function(){var t=this;return this.columns.filter((function(e){return e.visible&&!t.isSelectionColumn(e)}))}},{key:"getHiddenColumns",value:function(){return this.columns.filter((function(t){return!t.visible}))}},{key:"isSelectionColumn",value:function(t){return t.radio||t.checkbox}},{key:"showAllColumns",value:function(){this._toggleAllColumns(!0)}},{key:"hideAllColumns",value:function(){this._toggleAllColumns(!1)}},{key:"_toggleAllColumns",value:function(t){var e,n=this,o=u(this.columns.slice().reverse());try{for(o.s();!(e=o.n()).done;){var a=e.value;if(a.switchable){if(!t&&this.options.showColumns&&this.getVisibleColumns().length===this.options.minimumCountColumns)continue;a.visible=t}}}catch(t){o.e(t)}finally{o.f()}if(this.initHeader(),this.initSearch(),this.initPagination(),this.initBody(),this.options.showColumns){var s=this.$toolbar.find('.keep-open input[type="checkbox"]:not(".toggle-all")').prop("disabled",!1);t?s.prop("checked",t):s.get().reverse().forEach((function(e){s.filter(":checked").length>n.options.minimumCountColumns&&i.default(e).prop("checked",t)})),s.filter(":checked").length<=this.options.minimumCountColumns&&s.filter(":checked").prop("disabled",!0)}}},{key:"mergeCells",value:function(t){var e,i,n=t.index,o=this.getVisibleFields().indexOf(t.field),a=t.rowspan||1,s=t.colspan||1,r=this.$body.find(">tr[data-index]");o+=ua.getDetailViewIndexOffset(this.options);var l=r.eq(n).find(">td").eq(o);if(!(n<0||o<0||n>=this.data.length)){for(e=n;e<n+a;e++)for(i=o;i<o+s;i++)r.eq(e).find(">td").eq(i).hide();l.attr("rowspan",a).attr("colspan",s).show()}}},{key:"checkAll",value:function(){this._toggleCheckAll(!0)}},{key:"uncheckAll",value:function(){this._toggleCheckAll(!1)}},{key:"_toggleCheckAll",value:function(t){var e=this.getSelections();this.$selectAll.add(this.$selectAll_).prop("checked",t),this.$selectItem.filter(":enabled").prop("checked",t),this.updateRows(),this.updateSelected();var i=this.getSelections();t?this.trigger("check-all",i,e):this.trigger("uncheck-all",i,e)}},{key:"checkInvert",value:function(){var t=this.$selectItem.filter(":enabled"),e=t.filter(":checked");t.each((function(t,e){i.default(e).prop("checked",!i.default(e).prop("checked"))})),this.updateRows(),this.updateSelected(),this.trigger("uncheck-some",e),e=this.getSelections(),this.trigger("check-some",e)}},{key:"check",value:function(t){this._toggleCheck(!0,t)}},{key:"uncheck",value:function(t){this._toggleCheck(!1,t)}},{key:"_toggleCheck",value:function(t,e){var i=this.$selectItem.filter('[data-index="'.concat(e,'"]')),n=this.data[e];if(i.is(":radio")||this.options.singleSelect||this.options.multipleSelectRow&&!this.multipleSelectRowCtrlKey&&!this.multipleSelectRowShiftKey){var o,a=u(this.options.data);try{for(a.s();!(o=a.n()).done;){o.value[this.header.stateField]=!1}}catch(t){a.e(t)}finally{a.f()}this.$selectItem.filter(":checked").not(i).prop("checked",!1)}if(n[this.header.stateField]=t,this.options.multipleSelectRow){if(this.multipleSelectRowShiftKey&&this.multipleSelectRowLastSelectedIndex>=0)for(var s=r(this.multipleSelectRowLastSelectedIndex<e?[this.multipleSelectRowLastSelectedIndex,e]:[e,this.multipleSelectRowLastSelectedIndex],2),l=s[0],c=s[1],h=l+1;h<c;h++)this.data[h][this.header.stateField]=!0,this.$selectItem.filter('[data-index="'.concat(h,'"]')).prop("checked",!0);this.multipleSelectRowCtrlKey=!1,this.multipleSelectRowShiftKey=!1,this.multipleSelectRowLastSelectedIndex=t?e:-1}i.prop("checked",t),this.updateSelected(),this.trigger(t?"check":"uncheck",this.data[e],i)}},{key:"checkBy",value:function(t){this._toggleCheckBy(!0,t)}},{key:"uncheckBy",value:function(t){this._toggleCheckBy(!1,t)}},{key:"_toggleCheckBy",value:function(t,e){var i=this;if(e.hasOwnProperty("field")&&e.hasOwnProperty("values")){var n=[];this.data.forEach((function(o,a){if(!o.hasOwnProperty(e.field))return!1;if(e.values.includes(o[e.field])){var s=i.$selectItem.filter(":enabled").filter(ua.sprintf('[data-index="%s"]',a)),r=!!e.hasOwnProperty("onlyCurrentPage")&&e.onlyCurrentPage;if(!(s=t?s.not(":checked"):s.filter(":checked")).length&&r)return;s.prop("checked",t),o[i.header.stateField]=t,n.push(o),i.trigger(t?"check":"uncheck",o,s)}})),this.updateSelected(),this.trigger(t?"check-some":"uncheck-some",n)}}},{key:"refresh",value:function(t){t&&t.url&&(this.options.url=t.url),t&&t.pageNumber&&(this.options.pageNumber=t.pageNumber),t&&t.pageSize&&(this.options.pageSize=t.pageSize),this.trigger("refresh",this.initServer(t&&t.silent,t&&t.query,t&&t.url))}},{key:"destroy",value:function(){this.$el.insertBefore(this.$container),i.default(this.options.toolbar).insertBefore(this.$el),this.$container.next().remove(),this.$container.remove(),this.$el.html(this.$el_.html()).css("margin-top","0").attr("class",this.$el_.attr("class")||"")}},{key:"resetView",value:function(t){var e=0;if(t&&t.height&&(this.options.height=t.height),this.$tableContainer.toggleClass("has-card-view",this.options.cardView),!this.options.cardView&&this.options.showHeader&&this.options.height?(this.$tableHeader.show(),this.resetHeader(),e+=this.$header.outerHeight(!0)+1):(this.$tableHeader.hide(),this.trigger("post-header")),!this.options.cardView&&this.options.showFooter&&(this.$tableFooter.show(),this.fitFooter(),this.options.height&&(e+=this.$tableFooter.outerHeight(!0))),this.$container.hasClass("fullscreen"))this.$tableContainer.css("height",""),this.$tableContainer.css("width","");else if(this.options.height){this.$tableBorder&&(this.$tableBorder.css("width",""),this.$tableBorder.css("height",""));var i=this.$toolbar.outerHeight(!0),n=this.$pagination.outerHeight(!0),o=this.options.height-i-n,a=this.$tableBody.find(">table"),s=a.outerHeight();if(this.$tableContainer.css("height","".concat(o,"px")),this.$tableBorder&&a.is(":visible")){var r=o-s-2;this.$tableBody[0].scrollWidth-this.$tableBody.innerWidth()&&(r-=ua.getScrollBarWidth()),this.$tableBorder.css("width","".concat(a.outerWidth(),"px")),this.$tableBorder.css("height","".concat(r,"px"))}}this.options.cardView?(this.$el.css("margin-top","0"),this.$tableContainer.css("padding-bottom","0"),this.$tableFooter.hide()):(this.getCaret(),this.$tableContainer.css("padding-bottom","".concat(e,"px"))),this.trigger("reset-view")}},{key:"showLoading",value:function(){this.$tableLoading.toggleClass("open",!0);var t=this.options.loadingFontSize;"auto"===this.options.loadingFontSize&&(t=.04*this.$tableLoading.width(),t=Math.max(12,t),t=Math.min(32,t),t="".concat(t,"px")),this.$tableLoading.find(".loading-text").css("font-size",t)}},{key:"hideLoading",value:function(){this.$tableLoading.toggleClass("open",!1)}},{key:"togglePagination",value:function(){this.options.pagination=!this.options.pagination;var t=this.options.showButtonIcons?this.options.pagination?this.options.icons.paginationSwitchDown:this.options.icons.paginationSwitchUp:"",e=this.options.showButtonText?this.options.pagination?this.options.formatPaginationSwitchUp():this.options.formatPaginationSwitchDown():"";this.$toolbar.find('button[name="paginationSwitch"]').html("".concat(ua.sprintf(this.constants.html.icon,this.options.iconsPrefix,t)," ").concat(e)),this.updatePagination(),this.trigger("toggle-pagination",this.options.pagination)}},{key:"toggleFullscreen",value:function(){this.$el.closest(".bootstrap-table").toggleClass("fullscreen"),this.resetView()}},{key:"toggleView",value:function(){this.options.cardView=!this.options.cardView,this.initHeader();var t=this.options.showButtonIcons?this.options.cardView?this.options.icons.toggleOn:this.options.icons.toggleOff:"",e=this.options.showButtonText?this.options.cardView?this.options.formatToggleOff():this.options.formatToggleOn():"";this.$toolbar.find('button[name="toggle"]').html("".concat(ua.sprintf(this.constants.html.icon,this.options.iconsPrefix,t)," ").concat(e)),this.initBody(),this.trigger("toggle",this.options.cardView)}},{key:"resetSearch",value:function(t){var e=ua.getSearchInput(this);e.val(t||""),this.onSearch({currentTarget:e})}},{key:"filterBy",value:function(t,e){this.filterOptions=ua.isEmptyObject(e)?this.options.filterOptions:i.default.extend(this.options.filterOptions,e),this.filterColumns=ua.isEmptyObject(t)?{}:t,this.options.pageNumber=1,this.initSearch(),this.updatePagination()}},{key:"scrollTo",value:function(t){var e={unit:"px",value:0};"object"===n(t)?e=Object.assign(e,t):"string"==typeof t&&"bottom"===t?e.value=this.$tableBody[0].scrollHeight:"string"!=typeof t&&"number"!=typeof t||(e.value=t);var o=e.value;"rows"===e.unit&&(o=0,this.$body.find("> tr:lt(".concat(e.value,")")).each((function(t,e){o+=i.default(e).outerHeight(!0)}))),this.$tableBody.scrollTop(o)}},{key:"getScrollPosition",value:function(){return this.$tableBody.scrollTop()}},{key:"selectPage",value:function(t){t>0&&t<=this.options.totalPages&&(this.options.pageNumber=t,this.updatePagination())}},{key:"prevPage",value:function(){this.options.pageNumber>1&&(this.options.pageNumber--,this.updatePagination())}},{key:"nextPage",value:function(){this.options.pageNumber<this.options.totalPages&&(this.options.pageNumber++,this.updatePagination())}},{key:"toggleDetailView",value:function(t,e){this.$body.find(ua.sprintf('> tr[data-index="%s"]',t)).next().is("tr.detail-view")?this.collapseRow(t):this.expandRow(t,e),this.resetView()}},{key:"expandRow",value:function(t,e){var i=this.data[t],n=this.$body.find(ua.sprintf('> tr[data-index="%s"][data-has-detail-view]',t));if(this.options.detailViewIcon&&n.find("a.detail-icon").html(ua.sprintf(this.constants.html.icon,this.options.iconsPrefix,this.options.icons.detailClose)),!n.next().is("tr.detail-view")){n.after(ua.sprintf('<tr class="detail-view"><td colspan="%s"></td></tr>',n.children("td").length));var o=n.next().find("td"),a=e||this.options.detailFormatter,s=ua.calculateObjectValue(this.options,a,[t,i,o],"");1===o.length&&o.append(s),this.trigger("expand-row",t,i,o)}}},{key:"expandRowByUniqueId",value:function(t){var e=this.getRowByUniqueId(t);e&&this.expandRow(this.data.indexOf(e))}},{key:"collapseRow",value:function(t){var e=this.data[t],i=this.$body.find(ua.sprintf('> tr[data-index="%s"][data-has-detail-view]',t));i.next().is("tr.detail-view")&&(this.options.detailViewIcon&&i.find("a.detail-icon").html(ua.sprintf(this.constants.html.icon,this.options.iconsPrefix,this.options.icons.detailOpen)),this.trigger("collapse-row",t,e,i.next()),i.next().remove())}},{key:"collapseRowByUniqueId",value:function(t){var e=this.getRowByUniqueId(t);e&&this.collapseRow(this.data.indexOf(e))}},{key:"expandAllRows",value:function(){for(var t=this.$body.find("> tr[data-index][data-has-detail-view]"),e=0;e<t.length;e++)this.expandRow(i.default(t[e]).data("index"))}},{key:"collapseAllRows",value:function(){for(var t=this.$body.find("> tr[data-index][data-has-detail-view]"),e=0;e<t.length;e++)this.collapseRow(i.default(t[e]).data("index"))}},{key:"updateColumnTitle",value:function(t){t.hasOwnProperty("field")&&t.hasOwnProperty("title")&&(this.columns[this.fieldsColumnsIndex[t.field]].title=this.options.escape?ua.escapeHTML(t.title):t.title,this.columns[this.fieldsColumnsIndex[t.field]].visible&&(this.$header.find("th[data-field]").each((function(e,n){if(i.default(n).data("field")===t.field)return i.default(i.default(n).find(".th-inner")[0]).text(t.title),!1})),this.resetView()))}},{key:"updateFormatText",value:function(t,e){/^format/.test(t)&&this.options[t]&&("string"==typeof e?this.options[t]=function(){return e}:"function"==typeof e&&(this.options[t]=e),this.initToolbar(),this.initPagination(),this.initBody())}}]),t}();return fa.VERSION=Qo.VERSION,fa.DEFAULTS=Qo.DEFAULTS,fa.LOCALES=Qo.LOCALES,fa.COLUMN_DEFAULTS=Qo.COLUMN_DEFAULTS,fa.METHODS=Qo.METHODS,fa.EVENTS=Qo.EVENTS,i.default.BootstrapTable=fa,i.default.fn.bootstrapTable=function(t){for(var e=arguments.length,o=new Array(e>1?e-1:0),a=1;a<e;a++)o[a-1]=arguments[a];var s;return this.each((function(e,a){var r=i.default(a).data("bootstrap.table"),l=i.default.extend({},fa.DEFAULTS,i.default(a).data(),"object"===n(t)&&t);if("string"==typeof t){var c;if(!Qo.METHODS.includes(t))throw new Error("Unknown method: ".concat(t));if(!r)return;s=(c=r)[t].apply(c,o),"destroy"===t&&i.default(a).removeData("bootstrap.table")}r||(r=new i.default.BootstrapTable(a,l),i.default(a).data("bootstrap.table",r),r.init())})),void 0===s?this:s},i.default.fn.bootstrapTable.Constructor=fa,i.default.fn.bootstrapTable.theme=Qo.THEME,i.default.fn.bootstrapTable.VERSION=Qo.VERSION,i.default.fn.bootstrapTable.defaults=fa.DEFAULTS,i.default.fn.bootstrapTable.columnDefaults=fa.COLUMN_DEFAULTS,i.default.fn.bootstrapTable.events=fa.EVENTS,i.default.fn.bootstrapTable.locales=fa.LOCALES,i.default.fn.bootstrapTable.methods=fa.METHODS,i.default.fn.bootstrapTable.utils=ua,i.default((function(){i.default('[data-toggle="table"]').bootstrapTable()})),fa}));

</script>
<script type="text/javascript">
$(function () {
    $(window).scroll(function () {
        if ($(window).scrollTop() >= 70) {
            $('.information-bar').removeClass('hidden');
            $('.information-bar').fadeIn('fast');
        } else {
            $('.information-bar').fadeOut('fast');
        }
    });
});

document.addEventListener('DOMContentLoaded', function () {

    $('.div_model').on('click', function (e) {
        $('.div_model').not(this).popover('hide');
    });

    new bootstrap.Tooltip(document.body, {
        selector: '.has-tooltip'
    });

    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl)
    });

});

$('#optionWideScreen').change(function () {
    if (this.checked) {
        $('.container').addClass("container-fluid").removeClass("container");
    } else {
        $('.container-fluid').addClass("container").removeClass("container-fluid");
    }

});

window.addEventListener('beforeprint', function () {
    $('table').bootstrapTable('togglePagination');
});

window.addEventListener('afterprint', function () {
    $('table').bootstrapTable('togglePagination');
});

$('#optionPagination').change(function () {
    $('table').bootstrapTable('togglePagination');
});

$('#optionExpand').change(function () {
    if (this.checked) {
        $('.collapse').addClass("collapse-cancelled").removeClass("collapse");
    } else {
        $('.collapse-cancelled').addClass("collapse").removeClass("collapse-cancelled");
    }
});

function noHtmlSorter(a, b) {
    return strip(a).localeCompare(strip(b));
}

function noHtmlSearch(data, text) {
    if (!text) {
        return data;
    }
    return data.filter(function (row) {
        return Object.entries(row).some(([key, value]) => {
            return (strip(value).indexOf(text) > -1);
        });
    });
}

function strip(html) {
    // Create a new div element
    var temporalDivEl = document.createElement("div");
    // Set HTML content using provider
    temporalDivEl.innerHTML = html;
    // Get the text property of the element (browser support)
    return temporalDivEl.textContent || temporalDivEl.innerText || "";
}

function getData(dataSelect) {
    try {
        var inlineJsonElement = document.querySelector(
            'script[type="application/json"][data-pingcastle-selector="' + dataSelect + '"]'
        );
        var data = JSON.parse(inlineJsonElement.textContent);
        return data;
    } catch (err) {
        console.error('Couldn t read JSON data from ' + dataSelect, err);
    }
}

</script>



</div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></body></html>